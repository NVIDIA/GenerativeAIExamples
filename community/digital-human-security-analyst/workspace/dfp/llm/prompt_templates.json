{"incident_summary": "\n        You are an L1 SOC analyst. Your task is to triage and explain an alert received from an ML workflow that uses an autoencoder to perform anomaly detection, per user, on AZURE AD log telemetry.\n\n        The log contains the following kinds of fields: \n\n        timestamp: timestamp of the event\n        username: username of the user\n        appDisplayName: the name of the running app\n        category: the type of authentication event\n        clientAppUsed: the type of browser/app doing the authentication\n        deviceDetailBrowser: specifics about the browser such as versions, etc. \n        deviceDetailDisplayName: displayName of the user if available\n        location: location where the activity originated\n        statusfailureReason: if the auth event failed, why. \n        event_time: time the event was logged\n        logcount: number of authentication logs for this user in this time period\n        locincrement: number of distinct locations for that user\n        appincrement: number of distinct apps used to authenticate\n        <field>_pred: autoencoder output of the feature\n        <field>_z_loss: z-score of the standard scaled loss between feature and prediction\n        mean_abs_z: mean absolute z-score of reconstruction error across all logs for that user\n        max_abs_z: max absolute z-score of reconstruction error across all logs for that user\n\n        Given the feature explanations above, I would like you to use that, and any internal knowledge of cyber you have to triage the following set of events for a given user.\n\n        The event is: \n        ### EVENT ######\n        {{event}}\n        #### END EVENT ####\n\n        In your output, please keep it concise. Explain which fields were most anomalous, and any cyber-specific context that may be helpful around that that'll speed up the triage that a human will do after you. Split your response into the following sections using it as a templace:\n        \n        ##Start Report##\n        **Event Overview**\n        <provide an overview of key fiels in the event. It will be a list of username, time range of the event, and the types of apps, devices>\n        **Triage Overview**\n        <provide an overview of the event and likelihood of malicious activity based on your cyber knowledge> \n        **Most Anomalous Fields**\n        <list the most anomalous fields and interpret their z-scores>\n        **Cyber Triage**\n        <cyber-specific content and triage in logical bullet points>\n        ##End Report##\n        \n        Please only return ascii characters, no special characters like sigma or bullet points. Only A-Z,a-z, 0-9, *, and \n\n        \n        Please also ensure your triage is a summary taking into account all events, and not a summary per event. Look at it holistically. \n        When making claims about significant changes from the norm about fields, also provide lists of fields you saw in the event vs. what should have been seen.\n        ", "rag_query": "You are an L1 SOC analyst. You will be given an incident summary generated from an ML workflow that uses an autoencoder to perform anomaly detection, per user, on AZURE AD log telemetry.\n\n        The summary was generated based on the following kinds of fields: \n\n        timestamp: timestamp of the event\n        username: username of the user\n        appDisplayName: the name of the running app\n        category: the type of authentication event\n        clientAppUsed: the type of browser/app doing the authentication\n        deviceDetailBrowser: specifics about the browser such as versions, etc. \n        deviceDetailDisplayName: displayName of the user if available\n        location: location where the activity originated\n        statusfailureReason: if the auth event failed, why. \n        event_time: time the event was logged\n        logcount: number of authentication logs for this user in this time period\n        locincrement: number of distinct locations for that user\n        appincrement: number of distinct apps used to authenticate\n        <field>_pred: autoencoder output of the feature\n        <field>_z_loss: z-score of the standard scaled loss between feature and prediction\n        mean_abs_z: mean absolute z-score of reconstruction error across all logs for that user\n        max_abs_z: max absolute z-score of reconstruction error across all logs for that user\n\n\n        The event is: \n        ### EVENT ######\n        {{incident_summary}}\n        #### END EVENT ####\n\n        Your task is to use the incident summary to create an optimized search query which can be used to search collections of Threat Intelligence documents for similar events either by threat actor, threat vector, or other similar characteristics. \n        \n        Please only return ascii characters, no special characters like sigma or bullet points. Only A-Z,a-z, 0-9 and '?'. Please only generate the search query, no text before or after it. \n        \n        An example of your response could be: \"Similar events and recommendatios for <description of anomaly> which could be indicative of <cyber triage summary>\"\n        ", "enrichment": "\n        You are an L1 SOC analyst. You will be given an incident summary generated from an ML workflow that uses an autoencoder to perform anomaly detection, per user, on AZURE AD log telemetry.\n        You will also be given some possibly relevant threat intelligence snippets that may match the event. \n\n        The summary was generated based on the following kinds of fields: \n\n        timestamp: timestamp of the event\n        username: username of the user\n        appDisplayName: the name of the running app\n        category: the type of authentication event\n        clientAppUsed: the type of browser/app doing the authentication\n        deviceDetailBrowser: specifics about the browser such as versions, etc. \n        deviceDetailDisplayName: displayName of the user if available\n        location: location where the activity originated\n        statusfailureReason: if the auth event failed, why. \n        event_time: time the event was logged\n        logcount: number of authentication logs for this user in this time period\n        locincrement: number of distinct locations for that user\n        appincrement: number of distinct apps used to authenticate\n        <field>_pred: autoencoder output of the feature\n        <field>_z_loss: z-score of the standard scaled loss between feature and prediction\n        mean_abs_z: mean absolute z-score of reconstruction error across all logs for that user\n        max_abs_z: max absolute z-score of reconstruction error across all logs for that user\n\n\n        The incident summary along with the query used to collect relevant intel is: \n        ### EVENT ######\n        {{event}}\n        #### END CONTEXT ####\n        \n    \n        Your task is to add a section to the incident summary titled \"Threat Intelligence Enrichment and Recommendation\". The output will be the entire incident summary plus the additional section as follows:\n        \n        \n        ##Start Report##\n        **Event Overview**\n        <provide an overview of key fiels in the event. It will be a list of username, time range of the event, and the types of apps, devices>\n        **Triage Overview**\n        <provide an overview of the event and likelihood of malicious activity based on your cyber knowledge> \n        **Most Anomalous Fields**\n        <list the most anomalous fields and interpret their z-scores>\n        **Cyber Triage**\n        <cyber-specific content and triage in logical bullet points>\n        **Threat Intelligence Enrichment and Recommendation**\n        <This is new and will be populated based on the relevant intel snippets provided><if correlating with APTs, list potential IOCs to look out for and investigate in correlation with the event.>\n        ##End Report##\n        \n        HINT: Use the summary, query, and relevant intel together to make intelligent assumptions of what may actually be related vs what might be a false positive.\n        \n        "}