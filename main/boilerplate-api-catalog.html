<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting up the Simple Example &mdash; NVIDIA Generative AI Examples 24.4.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/version.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Implementing the Ingest Docs Method" href="ingest-api-catalog.html" />
    <link rel="prev" title="Developing Simple Examples" href="simple-examples.html" />
 


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


<a href="index.html">
  <img src="_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
</a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">RAG Pipelines for Developers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About the RAG Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="support-matrix.html">Support Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-catalog.html">API Catalog Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="local-gpu.html">Local GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi-gpu.html">Multi-GPU for Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-decomposition.html">Query Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantized-llm-model.html">Quantized Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="structured-data.html">Structured Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="multimodal-data.html">Multimodal Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi-turn.html">Multi-turn</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-sample-web-application.html">Sample Chat Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector-database.html">Alternative Vector Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="nim-llms.html">NIM for LLMs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="simple-examples.html">Developing Simple Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Setting up the Simple Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingest-api-catalog.html">Implementing the Ingest Docs Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="documents-api-catalog.html">Listing and Searching Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="llm-api-catalog.html">Creating an LLM Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="rag-api-catalog.html">Creating a RAG Chain</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tools/evaluation/index.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="observability.html">Observability</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jupyter Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/00-llm-non-streaming-nemotron.html">Basics: Prompt, Client, and Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/01-llm-streaming-client.html">LLM Streaming Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/02_langchain_simple.html">Q&amp;A with LangChain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/03_llama_index_simple.html">Q&amp;A with LlamaIndex</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/04_llamaindex_hier_node_parser.html">Advanced Q&amp;A with LlamaIndex</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/05_dataloader.html">Press Release Chat Bot</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/07_Option%281%29_NVIDIA_AI_endpoint_simple.html">NVIDIA API Catalog with LangChain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/07_Option%282%29_minimalistic_RAG_with_langchain_local_HF_LLM.html">LangChain with Local Llama 2 Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/08_Option%281%29_llama_index_with_NVIDIA_AI_endpoint.html">NVIDIA API Catalog, LlamaIndex, and LangChain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/08_Option%282%29_llama_index_with_HF_local_LLM.html">HF Checkpoints with LlamaIndex and LangChain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/09_Agent_use_tools_leveraging_NVIDIA_AI_endpoints.html">Multimodal Models from NVIDIA AI Catelog and AI Catalog with LangChain Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/10_RAG_for_HTML_docs_with_Langchain_NVIDIA_AI_Endpoints.html">Build a RAG chain by generating embeddings for NVIDIA Triton documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/11_LangGraph_HandlingAgent_IntermediateSteps.html">LangGraph Handling LangChain Agent Intermediate_Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/12_Chat_wtih_nvidia_financial_reports.html">Notebook: Chating with NVIDIA Financial Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="llm-inference-server.html">NeMo Framework Inference Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend.html">RAG Playground Web Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter-server.html">Jupyter Notebook Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="chain-server.html">Chain Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Software Component Configuration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NVIDIA Generative AI Examples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="simple-examples.html">Developing Simple Examples</a> &raquo;</li>
      <li>Setting up the Simple Example</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!--
  SPDX-FileCopyrightText: Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
  SPDX-License-Identifier: Apache-2.0

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<section class="tex2jax_ignore mathjax_ignore" id="setting-up-the-simple-example">
<h1>Setting up the Simple Example<a class="headerlink" href="#setting-up-the-simple-example" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#creating-directories-and-boilerplate-code" id="id1">Creating Directories and Boilerplate Code</a></p></li>
<li><p><a class="reference internal" href="#building-and-running-with-docker-compose" id="id2">Building and Running with Docker Compose</a></p></li>
<li><p><a class="reference internal" href="#verify-the-chain-server-methods-using-curl" id="id3">Verify the Chain Server Methods Using Curl</a></p></li>
<li><p><a class="reference internal" href="#verify-the-chain-server-methods-using-the-rag-playground" id="id4">Verify the Chain Server Methods Using the RAG Playground</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id5">Next Steps</a></p></li>
</ul>
</div>
<section id="creating-directories-and-boilerplate-code">
<h2>Creating Directories and Boilerplate Code<a class="headerlink" href="#creating-directories-and-boilerplate-code" title="Permalink to this headline"></a></h2>
<ol class="arabic">
<li><p>Make a directory for the example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>RetrievalAugmentedGeneration/examples/simple_rag_api_catalog
</pre></div>
</div>
</li>
<li><p>Create an empty <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file to indicate it is a Python module:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>touch<span class="w"> </span>RetrievalAugmentedGeneration/examples/simple_rag_api_catalog/__init__.py
</pre></div>
</div>
</li>
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">RetrievalAugmentedGeneration/examples/simple_rag_api_catalog/chains.py</span></code> file with the following boilerplate code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">llama_index.core.base.response.schema</span> <span class="kn">import</span> <span class="n">StreamingResponse</span>
<span class="kn">from</span> <span class="nn">RetrievalAugmentedGeneration.common.base</span> <span class="kn">import</span> <span class="n">BaseExample</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SimpleExample</span><span class="p">(</span><span class="n">BaseExample</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">ingest_docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Code to ingest documents.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ingesting the documents&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">llm_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chat_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Code to form an answer using LLM when context is already supplied.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Forming response from provided context&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StreamingResponse</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="s2">&quot;TODO: Implement LLM call&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">response_gen</span>

    <span class="k">def</span> <span class="nf">rag_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chat_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Code to fetch context and form an answer using LLM.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Forming response from document store&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StreamingResponse</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="s2">&quot;TODO: Implement RAG chain call&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">response_gen</span>

    <span class="k">def</span> <span class="nf">get_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve file names from the vector store.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting document file names from the vector store&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">delete_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filenames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete documents from the vector index.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting documents from the vector index&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">document_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_docs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>  <span class="c1">## Optional method</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Search for the most relevant documents for the given search parameters.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Searching for documents based on the query&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

</pre></div>
</div>
</li>
</ol>
</section>
<section id="building-and-running-with-docker-compose">
<h2>Building and Running with Docker Compose<a class="headerlink" href="#building-and-running-with-docker-compose" title="Permalink to this headline"></a></h2>
<!--
  cp docs/simple-example/code/api-catalog/boilerplate/simple-rag-api-catalog.yaml deploy/compose
  cp docs/simple-example/code/api-catalog/boilerplate/chains.py RetrievalAugmentedGeneration/examples/simple_rag_api_catalog/
-->
<p>Like the examples provided by NVIDIA, the simple example uses Docker Compose to build and run the example.</p>
<ol class="arabic">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">deploy/compose/simple-rag-api-catalog.yaml</span></code> file with the following content.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">EXAMPLE_NAME</span></code> field identifies the directory, relative to <code class="docutils literal notranslate"><span class="pre">RetrievalAugmentedGeneration/examples</span></code> to build for the chain server.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">chain-server</span><span class="p">:</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chain-server</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chain-server:latest</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">../../</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./RetrievalAugmentedGeneration/Dockerfile</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span>
<span class="hll"><span class="w">        </span><span class="nt">EXAMPLE_NAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple_rag_api_catalog</span>
</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--port 8081 --host 0.0.0.0</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">APP_LLM_MODELNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ai-mixtral-8x7b-instruct</span>
<span class="w">      </span><span class="nt">APP_LLM_MODELENGINE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia-ai-endpoints</span>
<span class="w">      </span><span class="nt">APP_EMBEDDINGS_MODELNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ai-embed-qa-4</span>
<span class="w">      </span><span class="nt">APP_EMBEDDINGS_MODELENGINE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia-ai-endpoints</span>
<span class="w">      </span><span class="nt">APP_TEXTSPLITTER_CHUNKSIZE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1200</span>
<span class="w">      </span><span class="nt">APP_TEXTSPLITTER_CHUNKOVERLAP</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
<span class="w">      </span><span class="nt">NVIDIA_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${NVIDIA_API_KEY}</span>
<span class="w">      </span><span class="nt">APP_PROMPTS_CHATTEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;You</span><span class="nv"> </span><span class="s">are</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">helpful,</span><span class="nv"> </span><span class="s">respectful</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">honest</span><span class="nv"> </span><span class="s">assistant.</span><span class="nv"> </span><span class="s">Always</span><span class="nv"> </span><span class="s">answer</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">helpfully</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">possible,</span><span class="nv"> </span><span class="s">while</span><span class="nv"> </span><span class="s">being</span><span class="nv"> </span><span class="s">safe.</span><span class="nv"> </span><span class="s">Please</span><span class="nv"> </span><span class="s">ensure</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">responses</span><span class="nv"> </span><span class="s">are</span><span class="nv"> </span><span class="s">positive</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">nature.&quot;</span>
<span class="w">      </span><span class="nt">APP_PROMPTS_RAGTEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;You</span><span class="nv"> </span><span class="s">are</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">helpful</span><span class="nv"> </span><span class="s">AI</span><span class="nv"> </span><span class="s">assistant</span><span class="nv"> </span><span class="s">named</span><span class="nv"> </span><span class="s">Envie.</span><span class="nv"> </span><span class="s">You</span><span class="nv"> </span><span class="s">will</span><span class="nv"> </span><span class="s">reply</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">questions</span><span class="nv"> </span><span class="s">only</span><span class="nv"> </span><span class="s">based</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">context</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">you</span><span class="nv"> </span><span class="s">are</span><span class="nv"> </span><span class="s">provided.</span><span class="nv"> </span><span class="s">If</span><span class="nv"> </span><span class="s">something</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">out</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">context,</span><span class="nv"> </span><span class="s">you</span><span class="nv"> </span><span class="s">will</span><span class="nv"> </span><span class="s">refrain</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">replying</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">politely</span><span class="nv"> </span><span class="s">decline</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">respond</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">user.&quot;</span>
<span class="w">      </span><span class="nt">APP_RETRIEVER_TOPK</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">      </span><span class="nt">APP_RETRIEVER_SCORETHRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.25</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8081:8081&quot;</span>
<span class="w">    </span><span class="nt">expose</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8081&quot;</span>
<span class="w">    </span><span class="nt">shm_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5gb</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">reservations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">devices</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia</span>
<span class="w">              </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">              </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gpu</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">rag-playground</span><span class="p">:</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rag-playground</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rag-playground:latest</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">../.././RetrievalAugmentedGeneration/frontend/</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--port 8090</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">APP_SERVERURL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://chain-server</span>
<span class="w">      </span><span class="nt">APP_SERVERPORT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8081</span>
<span class="w">      </span><span class="nt">APP_MODELNAME</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ai-mixtral-8x7b-instruct</span>
<span class="w">      </span><span class="nt">RIVA_API_URI</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${RIVA_API_URI:-}</span>
<span class="w">      </span><span class="nt">RIVA_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${RIVA_API_KEY:-}</span>
<span class="w">      </span><span class="nt">RIVA_FUNCTION_ID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${RIVA_FUNCTION_ID:-}</span>
<span class="w">      </span><span class="nt">TTS_SAMPLE_RATE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${TTS_SAMPLE_RATE:-48000}</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8090:8090&quot;</span>
<span class="w">    </span><span class="nt">expose</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8090&quot;</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chain-server</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia-rag</span>
</pre></div>
</div>
</li>
<li><p>Build the containers for the simple example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>compose<span class="w"> </span>--env-file<span class="w"> </span>deploy/compose/compose.env<span class="w"> </span>-f<span class="w"> </span>deploy/compose/simple-rag-api-catalog.yaml<span class="w"> </span>build
</pre></div>
</div>
<p>Building the containers requires several minutes.</p>
</li>
<li><p>Run the containers:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>compose<span class="w"> </span>--env-file<span class="w"> </span>deploy/compose/compose.env<span class="w"> </span>-f<span class="w"> </span>deploy/compose/simple-rag-api-catalog.yaml<span class="w"> </span>up<span class="w"> </span>-d
</pre></div>
</div>
</li>
</ol>
</section>
<section id="verify-the-chain-server-methods-using-curl">
<h2>Verify the Chain Server Methods Using Curl<a class="headerlink" href="#verify-the-chain-server-methods-using-curl" title="Permalink to this headline"></a></h2>
<p>You can access the Chain Server with a URL like <a class="reference external" href="http://localhost:8081">http://localhost:8081</a>.</p>
<ul>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">llm_chain</span></code> method runs and returns the TODO response by running a command like the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://localhost:8081/generate<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;messages&quot;:[{&quot;role&quot;:&quot;user&quot;, &quot;content&quot;:&quot;What should I see in Paris?&quot;}], &quot;use_knowledge_base&quot;: false}&#39;</span>
</pre></div>
</div>
<p>The response shows the TODO message:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="go">data: {&quot;id&quot;:&quot;57d16654-6cc0-474a-832b-7563bf4eb1ce&quot;,&quot;choices&quot;:[{&quot;index&quot;:0,&quot;message&quot;:{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;TODO: Implement LLM call&quot;},&quot;finish_reason&quot;:&quot;&quot;}]}</span>
</span>
<span class="go">data: {&quot;id&quot;:&quot;57d16654-6cc0-474a-832b-7563bf4eb1ce&quot;,&quot;choices&quot;:[{&quot;index&quot;:0,&quot;message&quot;:{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;&quot;},&quot;finish_reason&quot;:&quot;[DONE]&quot;}]}</span>
</pre></div>
</div>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">rag_chain</span></code> method runs by setting <code class="docutils literal notranslate"><span class="pre">use_knowledge_base</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://localhost:8081/generate<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;messages&quot;:[{&quot;role&quot;:&quot;user&quot;, &quot;content&quot;:&quot;What should I see in Paris?&quot;}], &quot;use_knowledge_base&quot;: true}&#39;</span>
</pre></div>
</div>
<p>The response also shows the TODO message:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="go">data: {&quot;id&quot;:&quot;dc99aaf0-b6ab-4332-bbf2-4b53fc72f963&quot;,&quot;choices&quot;:[{&quot;index&quot;:0,&quot;message&quot;:{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;TODO: Implement RAG chain call&quot;},&quot;finish_reason&quot;:&quot;&quot;}]}</span>
</span>
<span class="go">data: {&quot;id&quot;:&quot;dc99aaf0-b6ab-4332-bbf2-4b53fc72f963&quot;,&quot;choices&quot;:[{&quot;index&quot;:0,&quot;message&quot;:{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;&quot;},&quot;finish_reason&quot;:&quot;[DONE]&quot;}]}</span>
</pre></div>
</div>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">ingest_docs</span></code> method runs by uploading a sample document, such as the README from the repository:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>http://localhost:8081/documents<span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;file=@README.md&quot;</span>
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;File uploaded successfully&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>View the logs for the Chain Server to see the logged message from the method:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>logs<span class="w"> </span>chain-server
</pre></div>
</div>
<p>The logs show the message from the code, but no ingest process:</p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">INFO:example:Ingesting the documents</span>
</pre></div>
</div>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">get_documents</span></code> and <code class="docutils literal notranslate"><span class="pre">delete_documents</span></code> methods run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span>http://localhost:8081/documents<span class="w"> </span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>http://localhost:8081/documents<span class="se">\?</span>filename<span class="se">\=</span>README.md<span class="w"> </span>
</pre></div>
</div>
<p>View the logs for the Chain Server to see the logged messages from the methods:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>logs<span class="w"> </span>chain-server
</pre></div>
</div>
<p>The logs show the message from the code:</p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">INFO:example:Getting document file names from the vector store</span>
<span class="go">INFO:example:Deleting documents from the vector index</span>
</pre></div>
</div>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">document_search</span></code> method runs:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://localhost:8081/search<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;query&quot;:&quot;What should I see in Paris?&quot;, &quot;top_k&quot;:4}&#39;</span>
</pre></div>
</div>
<p>The response is empty because the <code class="docutils literal notranslate"><span class="pre">ingest_docs</span></code> and <code class="docutils literal notranslate"><span class="pre">document_search</span></code> methods are not implemented:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;chunks&quot;</span><span class="p">:[]}</span>
</pre></div>
</div>
<p>View the logs for the Chain Server to see the logged message from the method:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>logs<span class="w"> </span>chain-server
</pre></div>
</div>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">INFO:example:Searching for documents based on the query</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="verify-the-chain-server-methods-using-the-rag-playground">
<h2>Verify the Chain Server Methods Using the RAG Playground<a class="headerlink" href="#verify-the-chain-server-methods-using-the-rag-playground" title="Permalink to this headline"></a></h2>
<p>You can access the RAG Playground web interface with a URL like <a class="reference external" href="http://localhost:8090">http://localhost:8090</a>.</p>
<ul>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">llm_chain</span></code> method runs by accessing <a class="reference external" href="http://localhost:8090/converse">http://localhost:8090/converse</a> and entering a query such as <code class="docutils literal notranslate"><span class="pre">What</span> <span class="pre">should</span> <span class="pre">I</span> <span class="pre">see</span> <span class="pre">in</span> <span class="pre">Paris?</span></code>.</p>
<p><img alt="RAG Playground web interface showing the message: &quot;TODO: Implement LLM call.&quot;" src="_images/simple-rag-api-catalog-boilerplate-llm.png" /></p>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">rag_chain</span></code> method runs by enabling the <strong>Use knowledge base</strong> checkbox and entering a query.</p>
<p><img alt="RAG Playground web interface showing the message: &quot;TODO: Implement RAG chain call.&quot;" src="_images/simple-rag-api-catalog-boilerplate-rag.png" /></p>
</li>
<li><p>Confirm the <code class="docutils literal notranslate"><span class="pre">ingest_docs</span></code> method runs by accessing <a class="reference external" href="http://localhost:8090/kb">http://localhost:8090/kb</a>, clicking <strong>Add File</strong>, and uploading a file.</p>
<p>After the upload, view the Chain Server logs by running <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">logs</span> <span class="pre">chain-server</span></code>.</p>
<p><em>Example Output</em></p>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">INFO:example:Ingesting the documents</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="ingest-api-catalog.html"><span class="doc std std-doc">Implementing the Ingest Docs Method</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simple-examples.html" class="btn btn-neutral float-left" title="Developing Simple Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ingest-api-catalog.html" class="btn btn-neutral float-right" title="Implementing the Ingest Docs Method" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, NVIDIA Corporation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>